<!doctype html><html><head><style>pre {background-color:GhostWhite;}</style></head><body>
<div class="amcdiv">
<h2 class="amctitle">Calculated column in one spreadsheet based on entries over 4 columns in another spreadsheet in Excel 2010</h2>
<p class="amcdate">2016-04-19T14:33:32-0400</p>

<pre class="amctext">Spreadsheet#1 has 5 columns with a heading row:
                          Column A is a list of chapters in a book
                          Columns B through E contains date entries, formatted with a custom date field (dd-mmm-yy), that may be populated if there is a query in a particular chapter.
                          
                          Spreadsheet#2:
                          Column A is linked to Spreadsheet 1 (list of chapters in a book)
                          Column B — Calculates if there is an active query on a chapter by assessing the entries in Columns B through E in Spreadsheet #1 as follows:
                          Spreadsheet#1, if Col B = date entry and Col C = blank, then Spreadsheet#2 Col B = Yes
                          Spreadsheet#1, if Col B = date entry and Col C = date entry, then Spreadsheet#2 Col B = blank cell
                          Spreadsheet#1, if Col D = date entry and Col E = blank, then Spreadsheet#2 Col B = Yes
                          Spreadsheet #1, if Col D = date entry and Col E = date entry, then Spreadsheet#2 Col B = blank cell
                          All remaining combinations = blank cell in Spreadsheet#2, Col B
                          
                          I have attached a sample spreadsheet to help illustrate the question.
                          
                          Lastly, can you let me know if the calculations required have any impact on Spreadsheet # 1, or does the overhead only impact Spreadsheet # 2? The reason I ask is that Spreadsheet # 1 belongs to another department, so if what I am asking for impacts the performance of their spreadsheet, then I would need to look at another solution (perhaps linking Col A through D from Spreadsheet # 1 to Spreadsheet # 2 as 'helper' columns', then doing the calculations entirely within Spreadsheet # 2.
                          
                          I hope I've outlined this question clearly enough...
                          
                          Thanks,
                          Andrea
                          Pulling-QRY-Status-from-another-spr.xlsx</pre>

<pre class="amctext">This seems to be solved with a simple If() function using And() as well as Or() functions.  See attached.
                                    
                                    To answer your other question, Spreadsheet #1 should not be affected.  When they update values in spreadsheet 1, your results in Spreadsheet 2 could change.
                                    Copy-of-Pulling-QRY-Status-from-ano.xlsx</pre>

<pre class="amctext">Terrific. Thanks, Jake, for the quick resolution!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Calculating active queries based on entries in another spreadsheet (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/04_w17/1092503/Pulling-QRY-Status-from-another-spr.xlsx">Pulling-QRY-Status-from-another-spr.xlsx</a></p>
<p class="amcfile">Copy-of-Pulling-QRY-Status-from-ano.xlsx (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/04_w17/1092518/Copy-of-Pulling-QRY-Status-from-ano.xlsx">Copy-of-Pulling-QRY-Status-from-ano.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Breaks links to external workbook row by row based on date criteria in Excel</h2>
<p class="amcdate">2014-11-07T14:59:01-0500</p>

<pre class="amctext">I have a spreadsheet that has specific cells linked to a continuously updating external workbook that tracks production output. Column A is a date field. Columns D and E are linked to the external workbook. A sample of the spreadsheet is attached. 
                          
                          I want to be able to get a daily 'snapshot' of production output at the same time each day by automating the following:
                          When the date changes to the following day, the external links in the row for the previous day break, changing the data in those 2 cells to static data. For example:
                          
                          As of Nov. 8, 2014 at 12:01 a.m., the following would occur in the sample spreadsheet provided:
                          In row 12, where Column A = Nov. 7, 2014, cell D12 and cell E12 would convert from an external link to static data.
                          
                          I don't know if this is a feasible or realistic request, so will be interested to see what the feedback is on this question...
                          
                          Thanks!
                          Andrea
                          Sample.xlsx</pre>

<pre class="amctext">It's fairly simple with a quick VBA script to find the row for yesterday and then replace the formula in D & E with the values that are there either with copy/paste values or just insert the value over the formula.
                                    
                                    Do you have a simple =[tab]worksheet!A3, or something in D&E? If so, that would work. If you need help writing the vba, let me know.</pre>

<pre class="amctext">Hi,
                                    
                                    in a normal module insert this code
                                    
                                    
                                     
Sub CallAt00_01()
    Call myProc
    Application.OnTime TimeValue("00:01:00"), "CallAt00_01"
End Sub
Sub StartTempo()
    Application.OnTime TimeValue("00:01:00"), "CallAt00_01"
End Sub
 
Sub StopTempo()
    On Error Resume Next
    Application.OnTime TimeValue("00:01:00"), "CallAt00_01", False
End Sub

Sub myProc()
    Set myrange = Range(Range("A10"), Range("A" & Rows.Count).End(xlUp))
    For Each c In myrange
        If c = Date Then
            c.Offset(0, 3).Resize(1, 2).Value = c.Offset(0, 3).Resize(1, 2).Value
        End If
    Next
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    in the thisWorkbook module insert this
                                    
                                    
                                    Private Sub Workbook_BeforeClose(Cancel As Boolean)
Call StopTempo
End Sub

Private Sub Workbook_Open()
Call StartTempo
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    Of course the file must be open by 12:01 to work
                                    
                                    Regards
                                    SampleV1.xlsm</pre>

<pre class="amctext">EDITED Code
                                    
                                    
                                    Private Sub Workbook_BeforeClose(Cancel As Boolean)
Call StopTempo
End Sub

Private Sub Workbook_Open()
Call StartTempo
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    
                                    Sub CallAt00_01()
    Call myProc
    Application.OnTime TimeValue("00:01:00"), "CallAt00_01"
End Sub
Sub StartTempo()
    Application.OnTime TimeValue("00:01:00"), "CallAt00_01"
End Sub
 
Sub StopTempo()
    On Error Resume Next
    Application.OnTime TimeValue("00:01:00"), "CallAt00_01", False
End Sub

Sub myProc()
    Set myrange = ThisWorkbook.Sheets(1).Range(Range("A10"), Range("A" & Rows.Count).End(xlUp))
    For Each c In myrange
        If c = Date Then
            c.Offset(0, 3).Resize(1, 2).Value = c.Offset(0, 3).Resize(1, 2).Value
        End If
    Next
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">You may be able to create a Pivot Table on your data. In doing so the values will stay static until the table is refreshed.
                                    
                                    Thanks
                                    Rob H</pre>

<pre class="amctext">Hi Rgonzo,
                                    
                                    Thanks for the code. I'm sorry for the delayed response...I've been away.
                                    
                                    I'm just trying your code now. Just to confirm, then, that if the spreadsheet is not open at 12:01 but is opened later on that day then the link break will not occur?
                                    
                                    Rob, thanks for your suggestion but I'm looking to maintain a history of the daily results, and I don't think a pivot table will do the trick in that regard, would it?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">That' right it will only happen at 00:01 
                                    
                                    if you want it on opening then pls try to change the open procedure
                                    
                                    Private Sub Workbook_Open()
                                    Call myProc
                                    Call StartTempo
                                    End Sub
                                    
                                    Regards</pre>

<pre class="amctext">Perfect. And if it's opened and closed a number of times during the day, that shouldn't be an issue, right, as it only breaks the link based on the date in column A?</pre>

<pre class="amctext">That's right</pre>

<pre class="amctext">Terrific...thanks, Rgonzo!
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample.xlsx (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/11_w45/881819/Sample.xlsx">Sample.xlsx</a></p>
<p class="amcfile">EE (35 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/11_w45/881937/SampleV1.xlsm">SampleV1.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Need macro that changes contents of cell based on various conditions, and if conditions not met, then cell remains unchanged.</h2>
<p class="amcdate">2017-06-03T22:03:33-0400</p>

<pre class="amctext">I would like to have a macro called "Late_WOs" that does the following, based on the spreadsheet attached:
                          
                          If date in $B$5 is greater than 24-May-17 at 23:00 hrs AND if $K11 does not equal "89" or "99", then replace contents of $D11 with text string = "LATE". If conditions are not met, then no change to $D11 (original text string retained, or if $D11 was blank, then it remains blank).
                          
                          Thanks!
                          Andrea
                          EE.xls</pre>

<pre class="amctext">Try this...
                                    
                                    
                                    Sub Late_WOs()
Dim lr As Long
Dim rng As Range, cell As Range
Dim compDate As Date
lr = Cells(Rows.Count, "K").End(xlUp).Row
Set rng = Range("K11:K" & lr)
compDate = DateValue("24 May 2017") + TimeValue("23:00:00")
If Range("B5").Value > compDate Then
    For Each cell In rng
        Cells(cell.Row, "D").Select
        If cell = 89 Or cell = 99 Then
            Cells(cell.Row, "D") = "Late"
        End If
    Next cell
End If
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Subodh,
                                    
                                    Works great, thanks, with one minor tweak to Row 11  to align with the condition "AND if $K11 does not equal "89" or "99" ""
                                    
                                    
                                    If cell < > 89 Or cell < > 99 Then

                                    
                                      Select all
                                      Open in new window
                                    Thanks so much for the quick response! :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're welcome Andrea!
                                    Ah... it seems I misread the condition. Sorry!
                                    Glad you tweaked it to get the desired output.</pre>

<pre class="amctext">If I am not wrong, should it be
                                    
                                    If cell < > 89 And cell < > 99 Then

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Sorry, here' s correction to my revision to Row 11 above (changed 'Or' to 'And'):
                                    
                                    
                                    If cell < > 89 And cell < > 99 Then

                                    
                                      Select all
                                      Open in new window
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Hi Subodh,
                                    
                                    I should have refreshed before entering my last comment, and I would have seen that you already fixed my error! :-)
                                    
                                    Thanks for this correction!
                                    
                                    Andrea</pre>

<pre class="amctext">You're welcome Andrea! :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of spreadsheet (33 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w22/1166036/EE.xls">EE.xls</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">One more criteria to factor into a concatenated column output solution</h2>
<p class="amcdate">2014-08-19T19:43:29-0400</p>

<pre class="amctext">I received a great solution yesterday to a question I posed, but in using it today realized today that I had left out one potential example in the "desired results" column (G) in my sample spreadsheet. Occasionally the last 2 concatenated cells are blank, and when this occurs, the resulting concatenation has a unwanted dash at the end. To demonstrate this issue I'm hoping to get resolved, I have added this example to row 9, highlighted in yellow, in the attached spreadsheet.
                          
                          Below is the original post, followed by the solution that I am currently using:
                          
                          ORIGINAL POST:
                          I would like Column G to concatenate different columns, including a specific string within one column, based on various criteria outlined below:
                          
                          If D = "CAD" or "TREP", AND H = "VOL 1, then Column G to concatenate as follows:
                          G = B + D + C [first word after closing bracket OR first second word in string if no closing bracket] + F
                          Otherwise, Column G to concatenate as follows:
                          G = B + D + E + F
                          
                          Format of output in Column G: 
                          Dashes, but no spaces, between each value (as shown in attached spreadsheet example).
                          
                          SOLUTION
                          =IF(AND(H2="VOL 1",OR(D2="CAD",D2="TREP")),B2&"-"&D2&"-"&LEFT(TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))),FIND(" ",TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))))-1)&IF(F2<>"","-"&F2,""),B2&"-"&D2&"-"&E2&F2)
                          
                          Thanks,
                          Andrea
                          EE-Sample-Concat-2Part.xlsx</pre>

<pre class="amctext">Hi,
                                    
                                    pls try
                                    
                                    
                                    =IF(AND(H9="VOL 1";OR(D9="CAD";D9="TREP"));B9&"-"&D9&"-"&LEFT(TRIM(IF(FIND(")";C9)<>LEN(C9);MID(C9;FIND(")";C9)+1;100);MID(C9;FIND(" ";C9)+1;100)));FIND(" ";TRIM(IF(FIND(")";C9)<>LEN(C9);MID(C9;FIND(")";C9)+1;100);MID(C9;FIND(" ";C9)+1;100))))-1)&IF(F9<>"";"-"&F9;"");B9&"-"&D9&IF(E9&F9="";"";"-"&E9&F9))

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">Perfect, Rgonzo...thanks very much! 
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">EE-Sample-Concat-2Part.xlsx (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w34/867427/EE-Sample-Concat-2Part.xlsx">EE-Sample-Concat-2Part.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Updating Word macro and adding a pop-up error message when applicable</h2>
<p class="amcdate">2017-03-07T17:46:00-0500</p>

<pre class="amctext">My current macro code (see code below) finds all instances of the following three string formats (which are work order #'s) in a Word 2010 file (the file can be anywhere from 10 to 100 pages) and pastes them into a new Word file, one string per line:
                            AAA-#### (where AAA could be any letter from A – Z, followed by a dash, then 4 numbers)
                            ####-####### (4 numbers, followed by a dash, then 7 numbers)
                            AAA-##-#### (where AAA could be any letter from A – Z, followed by a dash, 2 numbers, a dash, then 4 numbers)
                          
                          Two changes I would like to make to the above current macro:
                          
                          
                            I would like to update the macro so it only searches for one of the three text strings above (as the other two text strings have since become obsolete) to then paste into a new Word file, one string per line:
                          
                          
                            ####-####### (4 numbers, followed by a dash, then 7 numbers)
                          
                          
                          
                          
                            I would like the macro to generate an error message as a dialog pop-up box at the first instance it comes across a text string that does not follow the approved format as outlined above (####-####### [4 numbers, followed by a dash, then 7 numbers], with the error message that includes the problem text string (work order #) to assist the user in locating the erroneously-entered work order number in the document and fixing it. Once the user corrected the work order number, the user would then re-run the macro.
                          
                          
                          The two instances of wrongly formatted strings for the macro to detect and generate an error message are as follows:
                          ####-###### (4 numbers, followed by a dash, then 6 numbers)
                          ####-######## (4 numbers, followed by a dash, then 8 numbers)
                          
                          The error message will ensure going forward that we are not missing any work order numbers being transferred by the macro to the new Word file due to the user mis-keying in the work orders by accidentally adding or subtracting one digit.
                          
                          I've attached a sample Word file showing the two examples of wrongly-formatted text strings that can occur and for which I would like the macro to generate an error message.
                          
                          The current code is shown below:
                          
                          Sub Extract_WOs_ADCs()
'
' Extract_WOs_ADCs Macro
'
' Keyboard Shortcut: Ctrl+y
'
    Set Activedoc = ActiveDocument
    strRes = ""
    Dim reg As Object 'VBScript_RegExp_55.regexp
    Dim Match As Object ' VBScript_RegExp_55.Match
    Dim Matches As Object 'VBScript_RegExp_55.MatchCollection

    ' instanciation
    Set reg = CreateObject("VBScript.RegExp")
    With reg
        .Global = True
        .MultiLine = True
        .Ignorecase = True
        .Pattern = "\b([A-Z]{3}(-\d{2})?-\d{4}|\d{4}-\d{7})\b"
    Set Matches = .Execute(Activedoc.Range.Text)
    End With
    For Each Match In Matches
        strRes = strRes & Match.Value & vbCrLf
    Next Match
    
    If strRes <> "" Then
        Set newDoc = Documents.Add
        newDoc.Range.Text = strRes
    Else
        MsgBox "No Matches"
    End If
End Sub

                          
                            Select all
                            Open in new window
                          
                          I hope I've provided sufficient details. Please let me know if you have any questions...
                          
                          Thanks!
                          Andrea
                          Sample_EE.docx</pre>

<pre class="amctext">Hi,
                                    
                                    pls try
                                    Sub Extract_WOs_ADCs()
'
' Extract_WOs_ADCs Macro
'
' Keyboard Shortcut: Ctrl+y
'
    Set Activedoc = ActiveDocument
    strRes = ""
    Dim reg As Object 'VBScript_RegExp_55.regexp
    Dim Match As Object ' VBScript_RegExp_55.Match
    Dim Matches As Object 'VBScript_RegExp_55.MatchCollection

    ' instanciation
    Set reg = CreateObject("VBScript.RegExp")
    With reg
        .Global = True
        .MultiLine = True
        .Ignorecase = True
        .Pattern = "\b\d{4}-(\d{6}|\d{8})\b"
    Set Matches = .Execute(Activedoc.Range.Text)
    End With
    For Each Match In Matches
        ActiveDocument.Range(Match.firstIndex, Match.firstIndex + Match.Length).Select
        MsgBox "Value: " & Match.Value & " is wrong"
        Exit Sub
    Next Match
    reg.Pattern = "\b\d{4}-\d{7}\b"
    Set Matches = reg.Execute(Activedoc.Range.Text)
    For Each Match In Matches
        strRes = strRes & Match.Value & vbCrLf
    Next Match

    
    If strRes <> "" Then
        Set newDoc = Documents.Add
        newDoc.Range.Text = strRes
    Else
        MsgBox "No Matches"
    End If
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">Hi Rgonzo,
                                    
                                    Works like a charm, and thanks for the speedy response!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample (19 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w10/1149548/Sample_EE.docx">Sample_EE.docx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Getting data from another spreadsheet based on values in 2 columns</h2>
<p class="amcdate">2013-10-24T08:02:23-0400</p>

<pre class="amctext">I am currently using this formula below to find the "last match" in the Cartography_12DEC2013_Oct21_Test.xlsm spreadsheet and populate Column N in the Book Production spreadsheet:
                          
                          =IFERROR(LOOKUP(2,1/('[Cartography_12DEC2013_Oct21_Test.xlsm]Cartography'!$H$2:$H$675=M2),'[Cartography_12DEC2013_Oct21_Test.xlsm]Cartography'!$I$2:$I$675),"")
                          
                          I am hoping to be able to modify this formula as follows:
                          1. Lookup $H$2:$H$675  on Cartography spreadsheet to find match(es) for value in column “M” in Book Production spreadsheet.
                          2. Then within the result from step 1, look up most recent initials/date stamp ( format is "RS 13 Oct 13") in column $AW$2:$AW$675 in Cartography spreadsheet.
                          3. From the row identified by Step 2, insert the value from Cartography $H$2:$H$675 column into column "N" in the Book Production spreadsheet.
                          
                          I hope I've been able to express this clearly enough...don't hesitate to let me know if you have any questions...
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">The details are a little confusing.  Can you explain what the difference would be from the formula you already have (and just changing the $I$2:$I$675 to $AW$2:$AW$675?</pre>

<pre class="amctext">Sorry about that. I've attached a sample to better illustrate what I'm looking for.
                                    
                                    Thanks,
                                    Andrea
                                    EE-Andreamary-Oct24.xlsm</pre>

<pre class="amctext">Try this formula:
                                    
                                    
                                    =INDEX('Cartography Results'!$F$2:$F$15,MATCH(1,('Cartography Results'!$E$2:$E$15=A2)*(IFERROR(MID('Cartography Results'!$G$2:$G$15,4,255)+0,0)=MAX(IF('Cartography Results'!$E$2:$E$15=A2,IFERROR(MID('Cartography Results'!$G$2:$G$15,4,255)+0,0)))),0))

                                    
                                      Select all
                                      Open in new window
                                    
                                    confirmed with CTRL+SHIFT+ENTER not just ENTER and copied down.</pre>

<pre class="amctext">Success...thanks so much!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of outcome I am hoping for (39 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/10_w43/684466/EE-Andreamary-Oct24.xlsm">EE-Andreamary-Oct24.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Need revised formula as referenced cells contain formulas so are not seen as blank, so am not getting desired results</h2>
<p class="amcdate">2016-04-19T18:03:16-0400</p>

<pre class="amctext">I received a solution from EE that addressed my question, but I subsequently realized (my bad) that the following formula does not work when the cells that the formula is referencing contain underlying formulas, which I hadn't mentioned in my original question. I assume that Excel is not seeing these cells as truly blank? 
                          
                          =IF(OR(AND('Spreadsheet#1'!B2<>"",'Spreadsheet#1'!C2=""),AND('Spreadsheet#1'!D2<>"",'Spreadsheet#1'!E2="")),"Yes","")
                          
                          So as a result I am posting this as a new question with an updated sample spreadsheet that, this time around, contains the underlying formulas in Spreadsheet #1.
                          
                          Spreadsheet#1:
                          Has 5 columns with a heading row:
                          Column A is a list of chapters in a book
                          Columns B through E contains an index-match formula pulling date entries from a tab called SourceSpreadsheet.
                          
                          Spreadsheet#2:
                          Column A is the list of chapters (linked to Column A in Spreadsheet#1)
                          Column B — Need a formula that calculates if there is an active query on a chapter by assessing the entries in Columns B through E in Spreadsheet #1 as follows (I have manually entered the desired results in red in Spreadsheet #2):
                          Spreadsheet#1, if Col B = date entry and Col C = no date entry, then Spreadsheet#2 Col B = Yes
                          Spreadsheet#1, if Col B = date entry and Col C = date entry, then Spreadsheet#2 Col B = Blank
                          Spreadsheet#1, if Col D = date entry and Col E = no date entry, then Spreadsheet#2 Col B = Yes
                          Spreadsheet #1, if Col D = date entry and Col E = date entry, then Spreadsheet#2 Col B = Blank
                          All remaining combinations = blank cell in Spreadsheet#2, Col B
                          
                          All date entries use the custom format dd-mmm-yy.
                          
                          I have attached a sample spreadsheet to help illustrate the updated question. 
                          
                          Thanks,
                          Andrea
                          EE_Pulling_QRY_Status_Formulas.xlsx</pre>

<pre class="amctext">The conditions of the formula were changed to reflect numbers.  When the cell you are reading has a formula in it, it will return a zero instead of a blank.  I changed the blank to a zero instead and set the other condition to look for a datevalue greater than 1.  See below:
                                    
                                    =IF(OR(AND('Spreadsheet#1'!B5>1,'Spreadsheet#1'!C5=0),AND('Spreadsheet#1'!D5>1,'Spreadsheet#1'!E5=0)),"Yes","")</pre>

<pre class="amctext">Thanks very much, Jake...works perfectly! :-)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample spreadsheet with 3 tabs to help illustrate question. (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/04_w17/1092552/EE_Pulling_QRY_Status_Formulas.xlsx">EE_Pulling_QRY_Status_Formulas.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Populating Excel user form with value from second column of multi-column combobox dropdown</h2>
<p class="amcdate">2017-12-09T11:04:10-0500</p>

<pre class="amctext">The user form called TimeTracker has a combobox, called cboTask, that has a multi-column dropdown menu. This is to assist users with providing more context to their selection, especially as the dropdown list grows.
                          
                          Here is a description and issue:
                          
                          Name of user form: TimeTracker
                          Combobox under label called 'Task': cboTask
                          3-column dropdown: From dynamic named range on sheet called "Tasks", which includes Col A (ID), Col B (Task), Col C (PA Unit)
                          Issue with cboTask: Currently populating the 'Task' field in user form with value in Col A (Tasks!ID)
                          Fix: Would like this field to be populated instead with value from Col B (Tasks!Task)
                          
                          I have included the spreadsheet.
                          
                          Thanks,
                          Andrea
                          TimeTracker-EE.xlsm</pre>

<pre class="amctext">In Formulas Tab->Name Manager, select the TaskLIst named range and change the Refers To formula to
                                    
                                    =OFFSET(Tasks!$B$2,0,0,MAX(COUNTA(Tasks!$B:$B),COUNTA(Tasks!$C:$C)),3)
                                    
                                    if you want to see Task, PA_Unit and Date, or to 
                                    
                                    =OFFSET(Tasks!$B$2,0,0,MAX(COUNTA(Tasks!$B:$B),COUNTA(Tasks!$C:$C)),2)
                                    
                                    if you want to see Task and PA_Unit.</pre>

<pre class="amctext">Thanks, Martin, for your quick response. I tried it, and noticed that I don't see the ID number any longer in the dropdown list. Sorry, I should have mentioned that I'm looking for a solution, if possible, that retains the same columns in the original dropdown, and that VBA code can somehow select the value from the second column.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">I'm confused since if you go back to the original formula it seems to be doing that already.</pre>

<pre class="amctext">Yes, it appears that the spreadsheet is being populated correctly. It’s the user form display that is my problem. When the user selects the dropdown menu for Task, the user form fields for both Task and ID are both populated with ID. On the user form, I would like, if possible, for the Task field to be populated with the value in the Task column (column 2) instead of the value from the ID column (column 1).
                                    
                                    Hope that makes sense...?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">When the user selects the dropdown menu for Task, the user form fields for both Task and ID are both populated with ID.
                                    
                                    Are you seeing the same thing I am? It looks to me like it's already doing what you want. If it's not then please tell me what should appear, for example, in the first row of the combobox display.</pre>

<pre class="amctext">Hi Martin,
                                    
                                    The user form view is the issue, not the spreadsheets, as currently two user form fields have the same value (ID).  I'm hoping that there is VBA code that, while maintaining the current 3-column dropdown for the user, can populate the Task field in the user form from column 2 (Task) instead of column 1 (ID). I already have the ID field below, which is auto-populated based on the user's selection in the Task combobox:</pre>

<pre class="amctext">Sorry that it took me this long to understand but I think I do now. I have to go out but I'll be back in a couple of hours.</pre>

<pre class="amctext">Try this.
                                    29072884.xlsm</pre>

<pre class="amctext">Hi Martin,
                                    
                                    Good news, and a couple of issues...
                                    
                                    The good news is that the user form is now populating correctly - thank you! The 'TaskList' range, however, appeared to have been changed from referencing the 'Tasks' sheet (which was hidden, and is a unique list of the tasks), to the TrackingSheet. As a result, the dropdown was showing duplicate tasks and was out of order, etc. I changed the 'TaskList' range back to the 'Tasks' sheet, and that reverted the dropdown list to an ordered list of unique tasks, which was good. However, I noticed that when I now add new records, Column B (the task description) of the TrackingSheet remains blank. All the other columns are populated correctly.
                                    
                                    So the upshot is:
                                    The user form fields are being populated correctly
                                    The TrackingSheet is being populated correctly with the exception of Column B, which is blank
                                    
                                    Thanks for your efforts on this, and I'm hoping that the TrackingSheet issue can be resolved...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">I didn't realize that the Task sheet existed and that's why I changed the TaskList named range. I'll be back.</pre>

<pre class="amctext">Updated.
                                    29072884a.xlsm</pre>

<pre class="amctext">Thanks so much, Martin, this is perfect! And I apologize for neglecting to mention the hidden Task sheet - out of sight, out of mind. :-(
                                    
                                    I like the way you enhanced the Task combobox dropdown by adding a heading row. Thanks for going the extra mile!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You’re welcome and I’m glad I was able to help.
                                    
                                    If you expand the “Full Biography” section of my profile you’ll find links to some articles I’ve written that may interest you.
                                    
                                    Marty - Microsoft MVP 2009 to 2017
                                                  Experts Exchange MVE 2015 
                                                  Experts Exchange Top Expert Visual Basic Classic 2012 to 2017</pre>

<pre class="amctext">Thanks, Martin, I’ll follow up...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample file (29 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w49/1214498/TimeTracker-EE.xlsm">TimeTracker-EE.xlsm</a></p>
<p class="amcfile">29072884.xlsm (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w49/1214514/29072884.xlsm">29072884.xlsm</a></p>
<p class="amcfile">29072884a.xlsm (29 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w49/1214524/29072884a.xlsm">29072884a.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Hyperlink to specific folders based on criteria in another column</h2>
<p class="amcdate">2014-02-10T11:54:25-0500</p>

<pre class="amctext">Currently, Column F contains values formatted as follows:
                          13-### (ie., 13-4444)
                          This value, ie., '13-4444', corresponds to a specific sub folder on a network drive under a 'Q:\2013' folder.
                          Column G contains a formula that creates a hyperlink to that folder, based on the value entered in Column F:
                          =HYPERLINK("Q:\2013\"&TEXT(F2,"0000-00"),""&TEXT(F2,"0000-00"))
                          
                          As of January 1, there are additional folders to be factored into the original hyperlink formula:
                          Q:\2013\DND
                          Q:\2014
                          Q:\2014\DND
                          All sub folders in the above new folders are formatted the same way as the original Q:|2013 folder (yy-####).
                          
                          So now we need the hyperlink formula in Column G to be updated to hyperlink to the correct sub folder based on the following criteria outlined below:
                          
                          If Column F's value is:
                          13-1###
                          13-2###
                          13-3###
                          13-4###
                          13-5###
                          13-6###
                          13-7###
                          13-8###
                          then the formula in Column G needs to link to the 'Q:\2013' folder:
                          =HYPERLINK("Q:\2013\"&TEXT(F2,"0000-00"),""&TEXT(F2,"0000-00"))
                          
                          If Column F's value is:
                          13-9###
                          then the formula in Column G needs to link to the 'Q:\2013\DND' folder:
                          =HYPERLINK("Q:\2013\DND\"&TEXT(F22,"0000-00"),""&TEXT(F22,"0000-00"))
                          
                          If Column F's value is:
                          14-1###
                          14-2###
                          14-3###
                          14-4###
                          14-5###
                          14-6###
                          14-7###
                          14-8###
                          then the formula in Column G needs to link to the 'Q:\2014' folder:
                          =HYPERLINK("Q:\2014\"&TEXT(F2,"0000-00"),""&TEXT(F2,"0000-00"))
                          
                          If Column F's value is:
                          14-9###
                          then the formula in Column G needs to link to the 'Q:\2014\DND' folder:
                          =HYPERLINK("Q:\2014\DND\"&TEXT(F22,"0000-00"),""&TEXT(F22,"0000-00"))
                          
                          I think that covers it...thanks in advance for assistance on this.
                          
                          Andrea</pre>

<pre class="amctext">Try:
                                    
                                    =HYPERLINK("Q:\20"&LEFT(F2,2)&"\"&IF(MID(F2,FIND("-",F2)+1,1)="9","DND","")&TEXT(F2,"0000-00"),""&TEXT(F2,"0000-00"))
                                    
                                    This also selects the correct year so that you don't need to have a separate formula for 2013 and 2014.</pre>

<pre class="amctext">Hi,
                                    
                                    pls try
                                    
                                    =HYPERLINK("Q:\20"&LEFT(F2,2)&IF(MID(F2,4,1)="9","\DND","")&"\"&TEXT(F2,"0000-00"),""&TEXT(F2,"0000-00"))
                                    
                                    EDIT
                                    
                                    @NBVC you forgot the Backslash after DND
                                    
                                    Regards</pre>

<pre class="amctext">Thanks Rgonzo...
                                    
                                    that would be:
                                    
                                    =HYPERLINK("Q:\20"&LEFT(F2,2)&"\"&IF(MID(F2,FIND("-",F2)+1,1)="9","DND","")&"\"&TEXT(F2,"0000-00"),""&TEXT(F2,"0000-00"))</pre>

<pre class="amctext">@NBVC Sorry wrong once more. If the DND is not found you will have 2 Backslashes
                                    
                                    Regards</pre>

<pre class="amctext">Lol... 
                                    
                                    3rd time's a charm?
                                    
                                    =HYPERLINK("Q:\20"&LEFT(F2,2)&"\"&IF(MID(F2,FIND("-",F2)+1,1)="9","DND\","")&TEXT(F2,"0000-00"),""&TEXT(F2,"0000-00"))</pre>

<pre class="amctext">Thanks very much! I used the revised formula provided and it seems to work very well. The only issue is that column G shows "#VALUE!" now if column F is blank. My preference is that the cell in column G is blank under these circumstances. BTW, I wasn't sure if the comment immediately above impacts the proposed formula?
                                    
                                    Andrea</pre>

<pre class="amctext">I've updated the formula to the very last one provided, thanks, so if there's a way to suppress the "#VALUE!" (described above) that would be perfect.
                                    
                                    Andrea</pre>

<pre class="amctext">Try either:
                                    
                                    =IF(F2="","",HYPERLINK("Q:\20"&LEFT(F2,2)&"\"&IF(MID(F2,FIND("-",F2)+1,1)="9","DND\","")&TEXT(F2,"0000-00"),""&TEXT(F2,"0000-00")) )
                                    
                                    or
                                    
                                    =IFERROR(HYPERLINK("Q:\20"&LEFT(F2,2)&"\"&IF(MID(F2,FIND("-",F2)+1,1)="9","DND\","")&TEXT(F2,"0000-00"),""&TEXT(F2,"0000-00")) ,"")</pre>

<pre class="amctext">Terrific...very pleased! Thank you...</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Adding criteria to Excel VBA so blank rows are not calculated</h2>
<p class="amcdate">2020-03-29T21:00:33-0400</p>

<pre class="amctext">The following VBA solution from this forum has been working great. I just need to add the following criteria to stop the calculation from happening on blank rows:
                          
                          If Column A = "" then Column J (Expiry Issue) = ""
                          
                          The existing code is below. Additionally, I have attached a sample Excel file as well as a screen capture depicting what I am looking for.
                          
                          
                          Function expiryIssue(rng As Range) As String
Application.Volatile
Dim dte1 As Range
Dim dte2 As Range
Dim status As String
Set dte1 = rng.Cells(1, 1)
Set dte2 = rng.Cells(1, 2)
status = rng.Cells(1, 3)
Select Case Cells(rng.Row, "A")
    Case "AIP_ENR", "AIP_AD", "AIP_GEN"
        expiryIssue = ""
        Exit Function
End Select
If status <> "Expired" And status <> "Cancelled" And status <> "Replaced" Then
' If there is no Proposed or Approved expiry date
    If dte2 = "" And dte1 = "" Then
        expiryIssue = "Missing expiry dates"
    Else
    'If there is no Approved Expiry date and the Proposed Expiry date is within 60 days of todays date
        If dte2 = "" Then
            If dte1 < Date + 60 Then expiryIssue = "Review proposed expiry date"
        Else
        'If the Approved Expiry date is older than today's date
            If dte1 = "" Then
                If dte2 < Date Then expiryIssue = "Issue"
            Else
                If dte2 < Date Then expiryIssue = "Issue"
            End If
        End If
    End If
End If
End Function

                          
                            Select all
                            Open in new window
                          
                          Thanks!
                          Andrea
                          EE_Expiry_Add_Criteria_Blank_Rows.xlsm
                          Additional_criteria_Mar29.png</pre>

<pre class="amctext">The expiryissue function contains this code
                                    
                                                If dte1 = "" Then
                If dte2 < Date Then expiryIssue = "Issue"
            Else
                If dte2 < Date Then expiryIssue = "Issue"
            End If

                                    
                                      Select all
                                      Open in new window
                                    which looks like a mistake because the 'If' and the 'Else' do the same thing.</pre>

<pre class="amctext">I added lines 32 to 34.
                                    
                                    Function expiryIssue(rng As Range) As String
Application.Volatile
Dim dte1 As Range
Dim dte2 As Range
Dim status As String
Set dte1 = rng.Cells(1, 1)
Set dte2 = rng.Cells(1, 2)
status = rng.Cells(1, 3)
Select Case Cells(rng.Row, "A")
    Case "AIP_ENR", "AIP_AD", "AIP_GEN"
        expiryIssue = ""
        Exit Function
End Select
If status <> "Expired" And status <> "Cancelled" And status <> "Replaced" Then
' If there is no Proposed or Approved expiry date
    If dte2 = "" And dte1 = "" Then
        expiryIssue = "Missing expiry dates"
    Else
    'If there is no Approved Expiry date and the Proposed Expiry date is within 60 days of todays date
        If dte2 = "" Then
            If dte1 < Date + 60 Then expiryIssue = "Review proposed expiry date"
        Else
        'If the Approved Expiry date is older than today's date
            If dte1 = "" Then
                If dte2 < Date Then expiryIssue = "Issue"
            Else
                If dte2 < Date Then expiryIssue = "Issue"
            End If
        End If
    End If
End If
If Cells(rng.Row, "A") = "" Then
    expiryIssue = ""
End If
End Function

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Martin,
                                    
                                    Thanks for your quick turnaround - your solution works great! :-) And thanks for pointing out the code issue - this was my error in trying to tweak the code myself at one point.
                                    
                                    Andrea</pre>

<pre class="amctext">You’re welcome and I’m glad I was able to help.
                                    
                                    If you expand the “Full Biography" section of my profile you’ll find links to some articles I’ve written that may interest you.
                                    
                                    Marty - Microsoft MVP 2009 to 2017
                                                  Experts Exchange Most Valuable Expert (MVE) 2015, 2017
                                                  Experts Exchange Top Expert Visual Basic Classic 2012 to 2019
                                                  Experts Exchange Top Expert VBA 2018, 2019
                                                  Experts Exchange Distinguished Expert in Excel 2018</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of file with current VBA code (28 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/03_w14/1448214/EE_Expiry_Add_Criteria_Blank_Rows.xlsm">EE_Expiry_Add_Criteria_Blank_Rows.xlsm</a></p>
<p class="amcfile">Screen capture depicting solution I am looking for (47 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/03_w14/1448215/Additional_criteria_Mar29.png">Additional_criteria_Mar29.png</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Finding rows that contain telephone format + specific word in all caps and pasting it into another worksheet</h2>
<p class="amcdate">2014-09-16T11:57:08-0400</p>

<pre class="amctext">I've unsuccessfully tried my hand at modifying a macro (see code below) so it performs as follows:
                          
                          Finds all rows in Sheet 1 that contain the following 2 criteria in the row, and copy those rows into Sheet 5:
                          The word "CENTRE" in all caps
                          A 10-digit telephone formatted as follows with a closing bracket only "???-???-????)"
                          
                          
                          

                          
                            Select all
                            Open in new window
                          Option Explicit
                          Sub Copy_CENTRE()
                              Dim rng As Range
                              Dim cl As Object
                              Dim x As Integer
                              Dim r As Long
                              Dim arrCENTRE() As Variant
                              
                              arrCENTRE() = Array("???-???-????", "CENTRE")
                          
                              r = 2
                              Sheets("Sheet1").Activate
                              Set rng = Range("A2:A" & Cells.SpecialCells(xlLastCell).Row)
                              For Each cl In rng
                                  For x = 0 To UBound(arrCENTRE())
                                      If InStr(1, cl.Value, arrCENTRE(x), vbTextCompare) > 0 Then
                                          Sheets("Sheet5").Cells(r, 1).Value = cl.Value
                                          r = r + 1
                                      End If
                                  Next x
                              Next cl
                          End Sub
                          
                          

                          
                            Select all
                            Open in new window
                          
                          Thanks in advance for your help,
                          Andrea</pre>

<pre class="amctext">If I understand well CENTRE and the phone number could or can be in different cells on the same row right ? or it is either one of them ?
                                    gowflow</pre>

<pre class="amctext">Try this
                                    
                                    
                                    Sub Copy_CENTRE()
    Dim rng As Range
    Dim cl As Object
    Dim x As Integer
    Dim r As Long
    Dim arrCENTRE() As Variant
    
    arrCENTRE() = Array("*???-???-????)*", "CENTRE")

    r = 2
    Sheets("Sheet1").Activate
    Set rng = Range("A2:A" & Cells.SpecialCells(xlLastCell).Row)
    For Each cl In rng
        For x = 0 To UBound(arrCENTRE())
            If cl.Value Like arrCENTRE(x) Then
                Sheets("Sheet5").Cells(r, 1).Value = cl.Value
                r = r + 1
            End If
        Next x
    Next cl
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">ok here it is:
                                    
                                    replace this line
                                    If InStr(1, cl.Value, arrCENTRE(x), vbTextCompare) > 0 Then
                                    
                                    by this line
                                    If LCase(cl.Value) Like LCase(arrCENTRE(x)) Then
                                    
                                    
                                    here is the amended code
                                    
                                    
                                    Sub Copy_CENTRE()
     Dim rng As Range
     Dim cl As Object
     Dim x As Integer
     Dim r As Long
     Dim arrCENTRE() As Variant
     
     arrCENTRE() = Array("???-???-????", "CENTRE")

     r = 2
     Sheets("Sheet1").Activate
     Set rng = Range("A2:A" & Cells.SpecialCells(xlLastCell).Row)
     For Each cl In rng
         For x = 0 To UBound(arrCENTRE())
             If LCase(cl.Value) Like LCase(arrCENTRE(x)) Then
             'If InStr(1, cl.Value, arrCENTRE(x), vbTextCompare) > 0 Then
                 Sheets("Sheet5").Cells(r, 1).Value = cl.Value
                 r = r + 1
             End If
         Next x
     Next cl
 End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    gowflow</pre>

<pre class="amctext">In my code please change line 8 to
                                    
                                        arrCENTRE() = Array("*???-???-????)*", "*CENTRE*")</pre>

<pre class="amctext">Martin, didn't he mention 
                                    The word "CENTRE" in all caps
                                    ?
                                    need to lcase or else you wont trap them with the like alone.
                                    gowflow</pre>

<pre class="amctext">Actually if you change my line 8 to
                                    
                                        arrCENTRE() = Array("*???-???-????)*", "*[CENTRE]*")
                                    
                                    you ignore "centre" or anything that's not all upper case.</pre>

<pre class="amctext">Thanks for the quick responses.
                                    
                                    I tried your solution, Martin, and while every row pasted into Sheet5 met the second criteria ("???-???-????"), most did not meet the first criteria ("CENTRE"). 
                                    
                                    And Gowflow, I tried your solution and did not get any results in Sheet5.
                                    
                                    And just to confirm, Gowflow, that all the rows of data in Sheet1 is in one cell per row — all in column A1 x 54,000 rows— and not spanning several cells/columns.
                                    
                                    Hope that helps...
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">I tried changing line 8 as suggested, and my results on Sheet5 do not meet either criteria...
                                    
                                    Andrea</pre>

<pre class="amctext">I tried your solution, Martin, and while every row pasted into Sheet5 met the second criteria ("???-???-????"), most did not meet the first criteria ("CENTRE"). 
                                    
                                    Please see post ID: 40325909</pre>

<pre class="amctext">And if that doesn't work then please show a line that is a problem.</pre>

<pre class="amctext">don't understand how it didn't work here it is in the attach workbook try it
                                    
                                    gowflow
                                    copy.xlsm</pre>

<pre class="amctext">Hi MartinLiss,
                                    
                                    I've attached a sample spreadsheet with your macro inserted:
                                    
                                    Sheet1 - sample data
                                    Sheet5 - results of running the current macro
                                    Sheet2 - the results I am looking for
                                    
                                    Hope this helps...
                                    
                                    Thanks,
                                    Andrea
                                    Centre-Tel-Macro.xlsm</pre>

<pre class="amctext">Did you try mine ? the one I attached is the same that I posted earlier !
                                    gowflow</pre>

<pre class="amctext">Hi Gowflow,
                                    
                                    I tried your copy.xlsm but it wasn't doing what I'm looking for. Hopefully my sample Excel file will help illustrate what I'm after...
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">ok her eit is
                                    
                                    this is the new macro
                                    
                                    
                                    Sub Copy_CENTRE()
    Dim rng As Range
    Dim cl As Object
    Dim x As Integer
    Dim r As Long
    Dim arrCENTRE() As Variant
    Dim bPhone As Boolean, bCentre As Boolean
    
    arrCENTRE() = Array("???-???-????", "CENTRE")

    r = 2
    Sheets("Sheet1").Activate
    Set rng = Range("A2:A" & Cells.SpecialCells(xlLastCell).Row)
    For Each cl In rng
        For x = 0 To UBound(arrCENTRE())
            Select Case x
                Case 0  'phone
                    If cl.Value Like "*" & arrCENTRE(x) & "*" Then
                        'Sheets("Sheet3").Cells(r, 1).Value = cl.Value
                        'r = r + 1
                        bPhone = True
                    End If
                    
                Case 1  'centre
                    If InStr(1, cl.Value, arrCENTRE(x)) <> 0 Then
                        'Sheets("Sheet3").Cells(r, 1).Value = cl.Value
                        'r = r + 1
                        bCentre = True
                    End If
            End Select
        Next x
        
        If bPhone And bCentre Then
            Sheets("Sheet3").Cells(r, 1).Value = cl.Value
            r = r + 1
        End If
        
        bPhone = False
        bCentre = False
        
    Next cl
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    it will give results in sheet3.
                                    
                                    For next time pls give a sample from the start to avoid waste of time. 
                                    Tks
                                    gowflow
                                    Centre-Tel-Macro-V01.xlsm</pre>

<pre class="amctext">Thanks so much, Gowflow...works like a charm. My apologies for not providing a sample spreadsheet at the outset...
                                    
                                    Andrea</pre>

<pre class="amctext">Glad we were able to pull it thru !
                                    gowflow</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">copy to sheet (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/09_w38/872513/copy.xlsm">copy.xlsm</a></p>
<p class="amcfile">Centre-Tel-Macro.xlsm (21 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/09_w38/872517/Centre-Tel-Macro.xlsm">Centre-Tel-Macro.xlsm</a></p>
<p class="amcfile">centre (23 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/09_w38/872523/Centre-Tel-Macro-V01.xlsm">Centre-Tel-Macro-V01.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Adding a new condition to an existing Excel formula</h2>
<p class="amcdate">2014-10-14T11:13:14-0400</p>

<pre class="amctext">Attached is a sample spreadsheet implementing a formula (in Column J). I would like this formula revised. Column L shows the desired results I am looking for, with the new criteria that needs to be factored in highlighted in yellow (in row 4).  I've outlined the background details of the existing formula below and included the updated criteria change at the end.
                          
                          CRITERIA OF EXISTING FORMULA:
                          I would like Column J to concatenate different columns, including a specific string within one column, based on various criteria outlined below:
                          
                          If D = "CAD" or "TREP", AND H = "VOL 1" or "VOL 7" or "VOL 12" then Column J to concatenate as follows:
                          J = B + D + C [first word after closing bracket OR first second word in string if no closing bracket] + F
                          Otherwise, Column J to concatenate as follows:
                          J = B + D + E + F
                          
                          CURRENT FORMULA:
                          =IF(AND(OR(H2="VOL 1",H2="VOL 7",H2="VOL 12"),OR(D2="CAD",D2="TREP")),B2&"-"&D2&"-"&LEFT(TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))),FIND(" ",TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))))-1)&IF(F2<>"","-"&F2,""),B2&"-"&D2&IF(E2&F2="","","-"&E2&F2))
                          
                          CRITERIA OF UPDATED FORMULA:
                          As above, but including the following new conditions:
                          If Columns G and Column H is blank, and Column I is not blank, then  J = B + D + E + F
                          Otherwise: 
                          J = B + D + C [first word after closing bracket OR first second word in string if no closing bracket] + F
                          
                          Thanks,
                          Andrea
                          EE-Sample-Updated.xlsx</pre>

<pre class="amctext">There are a couple of issues:
                                    1) You refer to column H twice - once for the "Section" (actually in column H) and the "VOL" numbers (actually in column K).  The formula in the workbook refers to column K for the volume numbers; is that correct to continue?
                                    2) The formula in the workbook is not the same as your example (does not contain the OR clause for the volume numbers 1,7,12).</pre>

<pre class="amctext">Sorry, Glenn!! I should have taken more time to review everything before posting!
                                    
                                    I believe I've fixed the spreadsheet, and I've reuploaded it. Here is the current (fixed) formula in the spreadsheet:
                                    
                                    =IF(AND(OR(K2="VOL 1",K2="VOL 7",K2="VOL 12"),OR(D2="CAD",D2="TREP")),B2&"-"&D2&"-"&LEFT(TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))),FIND(" ",TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))))-1)&IF(F2<>"","-"&F2,""),B2&"-"&D2&IF(E2&F2="","","-"&E2&F2))
                                    EE-Sample-Fixed.xlsx</pre>

<pre class="amctext">This modification to your formula seems to work:
                                    =IF(AND(NOT(AND(G2&H2="",I2<>"")),OR(K2="VOL 1",K2="VOL 7",K2="VOL 12"),OR(D2="CAD",D2="TREP")),B2&"-"&D2&"-"&LEFT(TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))),FIND(" ",TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))))-1)&IF(F2<>"","-"&F2,""),B2&"-"&D2&IF(E2&F2="","","-"&E2&F2))
                                    
                                    I highlighted the updated portion.  Since your condition of - 
                                    
                                    
                                      Columns G and Column H is blank, and Column I is not blank, then  J = B + D + E + F
                                    
                                    is the same as the FALSE result of the original formula, its opposite 
                                    NOT(AND(G2&H2="",I2<>""))
                                    should follow the TRUE result.
                                    
                                    -Glenn</pre>

<pre class="amctext">FWIW, a little shorter:
                                    
                                    =IF(AND(OR(G2&H2<>"",I2=""),OR(K2={"VOL 1","VOL 7","VOL 12"}),OR(D2={"CAD","TREP"})),B2&"-"&D2&"-"&LEFT(TRIM(MID(C2,FIND(IF(FIND(")",C2)<>LEN(C2),")"," "),C2)+1,100)),FIND(" ",TRIM(MID(C2,FIND(IF(FIND(")",C2)<>LEN(C2),")"," "),C2)+1,100)))-1)&IF(F2<>"","-"&F2,""),B2&"-"&D2&IF(E2&F2="","","-"&E2&F2))</pre>

<pre class="amctext">Rory, I did not know you could do that (i.e., compare a value to an array of values)!  That's my cool knowledge for the week.  :-)
                                    
                                    And darnit, I don't know why I didn't figure out the first OR clause like yours; it's much simpler and easier to follow.</pre>

<pre class="amctext">Both worked like a charm...thanks so much!
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">EE-Sample-Updated.xlsx (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/10_w42/877407/EE-Sample-Updated.xlsx">EE-Sample-Updated.xlsx</a></p>
<p class="amcfile">EE-Sample-Fixed.xlsx (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/10_w42/877431/EE-Sample-Fixed.xlsx">EE-Sample-Fixed.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Change Excel button from static to dynamic name + apply VBA code "On open" action of workbook</h2>
<p class="amcdate">2020-02-27T13:26:02-0500</p>

<pre class="amctext">Attached is a sample spreadsheet with a button associated with a macro that, when clicked, hides rows based on specific text strings in Column J in Sheet1. Clicking the button again releases the hidden rows. The macro code is included below.
                          
                          I would like to do the following:
                          
                          
                            Change the button name from static to dynamic, depending on the state:
                          
                          
                            
                              When macro is applied, and all the rows deemed 'closed' are hidden, the button name = "Active"
                              When macro is not applied, and all rows are visible, the button name = "All"
                            
                          
                          
                          
                          
                            I would like the spreadsheet to always open with the macro applied to Sheet1 (so button name would = "Active" when spreadsheet opened)
                          
                          
                          There are multiple worksheets in this workbook, so I want to ensure the VBA only applies to Sheet1.
                          
                          Lastly, as I am inexperienced at VBA, I wondered if the macro code I supplied could be improved? For instance, could I have combined the 3 conditions (Expired, Replaced, Cancelled) into one section of code instead of repeating them separately as I have done below?
                          
                          
                          Public Hidden As Boolean

Sub Hide_Closed()
Dim LastRow As Long, c As Range
Application.EnableEvents = False
Application.ScreenUpdating = False
LastRow = Cells(Cells.Rows.Count, "A").End(xlUp).Row
On Error Resume Next
If Not Hidden Then
    For Each c In Range("J1:J" & LastRow)
       If c.Value = "Expired" Then
            c.EntireRow.Hidden = True
            Hidden = True
        ElseIf c.Value = "Replaced" Then
            c.EntireRow.Hidden = True
            Hidden = True
        ElseIf c.Value = "Cancelled" Then
            c.EntireRow.Hidden = True
            Hidden = True
        ElseIf c.Value = "" Then
            c.EntireRow.Hidden = False
        End If
    Next
Else
    Hidden = False
    ActiveSheet.Rows.Hidden = False
End If
On Error GoTo 0
Application.EnableEvents = True
Application.ScreenUpdating = True
End Sub

                          
                            Select all
                            Open in new window
                          
                          Thanks!
                          Andrea
                          EE_Button_DynamicName.xlsm</pre>

<pre class="amctext">To start with Sheet1, you use a Workbook_Open sub
                                    
                                    'Put this sub in This Workbook code pane
Private Sub Workbook_Open()
Hidden = False
Worksheets("Sheet1").Activate
Hide_Closed
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    Your sub becomes:
                                    
                                    Sub Hide_Closed()
Dim LastRow As Long
Dim c As Range
Dim shp As Shape

Application.EnableEvents = False
Application.ScreenUpdating = False
On Error Resume Next

With Worksheets("Sheet1")
    If Not Hidden Then
        .Buttons("Button 1").Caption = "Active"
        LastRow = .Cells(.Cells.Rows.Count, "A").End(xlUp).Row
        For Each c In .Range("J1:J" & LastRow).Cells
            Select Case c.Value
            Case "Expired", "Replaced", "Cancelled"
                c.EntireRow.Hidden = True
                Hidden = True
            Case Else
                 c.EntireRow.Hidden = False
            End Select
        Next
    Else
        .Buttons("Button 1").Caption = "All"
        Hidden = False
        .Rows.Hidden = False
    End If

End With

On Error GoTo 0
Application.EnableEvents = True
End Sub

                                    
                                      Select all
                                      Open in new window
                                    EE_Button_DynamicName.xlsm</pre>

<pre class="amctext">Thanks very much for the quick turnaround - your solution works like a charm! 
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example with button (25 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/02_w09/1445253/EE_Button_DynamicName.xlsm">EE_Button_DynamicName.xlsm</a></p>
<p class="amcfile">Your file with new code (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/02_w09/1445284/EE_Button_DynamicName.xlsm">EE_Button_DynamicName.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Summing across multiple columns based on various criteria in Excel</h2>
<p class="amcdate">2017-05-18T15:32:20-0400</p>

<pre class="amctext">Sheet 1
                          Contains data (Col A to Col AN) that is extracted from an book inventory list that tracks changes to the books for one cycle. 
                          
                          Sheet 1 details:
                          Column A = Number of each book inventory item
                          Columns B, O and AB = work order #'s associated with the changes for the cycle against the inventory item in Column A. There can be multiple different work orders against one inventory item. The same work order can impact same inventory item more than once. One work order can impact more than one inventory item. Not every inventory item will have a work order, as not all items in the inventory list change every cycle.
                          
                          Sheet 2
                          Summary of # of minutes the changes per work order, broken down into process minutes (Col B) vs Rework minutes (Col C).
                          
                          Sheet 2 details:
                          Col A = list of all work orders for the cycle
                          
                          Formulas I would like for Sheet 2
                          Col B = sum of minutes (Col E and Col H) + sum of minutes (Col R and Col U) if WO# in Col O does not equal WO# in the same row in Col A + sum of minutes (Col AE and Col AH) if WO# in Column AB does not equal WO# in the same row in Col A or the same row in Col O.
                          
                          Col C = sum of minutes (Col K and Col N) + sum of minutes (Col X and Col AA) if WO# in Col O does not equal WO# in the same row in Col A + sum of minutes (Col AK and Col AN) if WO# in Column AB does not equal WO# in the same row in Col A or the same row in Col O.
                          
                          To help illustrate what I am looking for, I've included a spreadsheet with both Sheet1 and Sheet2 tabs, and entered the results I am looking for in Sheet2, and colour-coded the cells to help explain the criteria outlined above.
                          
                          Thanks in advance for assistance with this!
                          Andrea
                          EE_Process_vs_Rework_Minutes.xlsx</pre>

<pre class="amctext">This seems to be a Sheet2 column B formula, but it doesn't give the same value as the one you had hard-coded into B2.
                                    
                                    =Table1[[#This Row],[Comp1_Min]]+Table1[[#This Row],[Ver1_Min]]+ IF(Table1[[#This Row],[WO2]]<>Sheet2!A2, Table1[[#This Row],[Comp2_Min]]+ 
Table1[[#This Row],[Ver2_Min]],0) + IF(AND(Table1[[#This Row],[WO2]]=Table1[[#This Row],[WO3]], Table1[[#This Row],[WO2]]=Sheet2!A2),0,
 Table1[[#This Row],[Comp3_Min]]+Table1[[#This Row],[Ver3_Min]])

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Aikimark,
                                    
                                    Thanks for your response. Unfortunately, as you say, it's not providing the results I am looking for...
                                    
                                    Andrea</pre>

<pre class="amctext">Col B = sum of minutes (Col E and Col H) + sum of minutes (Col R and Col U) if WO# in Col O does not equal WO# in the same row in Col A + sum of minutes (Col AE and Col AH) if WO# in Column AB does not equal WO# in the same row in Col A or the same row in Col O.
                                    
                                    
                                    Let's go over your description and see where the formula might differ.
                                    sum of minutes (Col E and Col H)
                                    Table1[[#This Row],[Comp1_Min]]+Table1[[#This Row],[Ver1_Min]]
                                    
                                    If WO# in Col O does not equal WO# in the same row in Col A Then sum of minutes (Col R and Col U)  Else 0
                                    + IF(Table1[[#This Row],[WO2]]<>Sheet2!A2, 
                                    Table1[[#This Row],[Comp2_Min]]+ Table1[[#This Row],[Ver2_Min]], 0) 
                                    
                                    If WO# in Column AB does not equal WO# in the same row in Col A or the same row in Col O Then sum of minutes (Col AE and Col AH) Else 0
                                    + IF(AND(Table1[[#This Row],[WO2]]=Table1[[#This Row],[WO3]], Table1[[#This Row],[WO2]]=Sheet2!A2), 
                                     0, Table1[[#This Row],[Comp3_Min]]+Table1[[#This Row],[Ver3_Min]])
                                    
                                    In the last condition, I used an AND() function and swapped the True/False parameters and changed your <> comparison for an = comparison
                                    
                                    How was my interpretation of your description?</pre>

<pre class="amctext">Hi Aikimark,
                                    
                                    Thanks for your response. I was worried that maybe my description may not have considered everything, so thought I'd better include my sample spreadsheet in hopes it helped better illustrate what I'm hoping for. 
                                    
                                    Because I'm not an expert, I'm hoping you can bear with me if I try to describe what I'm looking for using the example WO# 2016-0000701 in the sample spreadsheet:
                                    
                                    Process Minutes (Sheet2!Column B formulas):
                                    So on Sheet1:
                                    Col B lists WO# 2016-0000701 four times, so formula would sum all 8 entries (Sum of E2, E3, E5, E6, H2, H3, H5, H6) in Sheet2!B2 for a total of 64 minutes of 'Process' time
                                    Col O lists WO# 2016-0000701 once, but because this WO is already listed in Col B in the same row, there are no 'Process' minutes to include in Sheet2!B2 total.
                                    Col AB does not list WO# 2016-0000701, there are no 'Process' minutes to include in Sheet2!B2 total.
                                    
                                    I'll hold off on elaborating on the 'Rework' Minutes (Sheet2!Column C formulas) until the Process Minutes formulas are resolved. 
                                    
                                    Is what I am hoping for possible, given the structure of the spreadsheet?
                                    
                                    Thanks for your patience!
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Please try below formula for Process Minutes in Sheet2 Column B:
                                    =IF(OR(COUNTIF(Table1[WO1],Sheet2!A2),COUNTIF(Table1[WO2],Sheet2!A2),COUNTIF(Table1[WO3],Sheet2!A2)),IF(SUMIF(Table1[WO1],A2,Table1[Comp1_Min])+SUMIF(Table1[WO1],A2,Table1[Ver1_Min])>0,SUMIF(Table1[WO1],A2,Table1[Comp1_Min])+SUMIF(Table1[WO1],A2,Table1[Ver1_Min]),IF(SUMIF(Table1[WO2],A2,Table1[Comp2_Min])+SUMIF(Table1[WO2],A2,Table1[Ver2_Min])>0,SUMIF(Table1[WO2],A2,Table1[Comp2_Min])+SUMIF(Table1[WO2],A2,Table1[Ver2_Min]),SUMIF(Table1[WO3],A2,Table1[Comp3_Min])+SUMIF(Table1[WO3],A2,Table1[Ver3_Min]))),"")
                                    
                                    I am not sure, why you don't have any value for WO#2016-0003271, where with above formula I get 14. Please check attached...
                                    
                                    Please explain formula for Col C as well.
                                    EE_Process_vs_Rework_Minutes_v1.xlsx</pre>

<pre class="amctext">Hi Shums,
                                    
                                    Terrific...thank you so much! And it was my error missing on entering the value of 14 for WO# 2016-0003271 - your formula result is the correct one - so much for my manual calculations!
                                    
                                    So to explain Col C, I'll use WO# 2016-0000701 again:
                                    
                                    Rework Minutes (Sheet2!Col C formulas):
                                    So on Sheet1:
                                    Col B lists WO# 2016-0000701 four times, and of those four entries, there are only two cells in this section that have values under the 'Rework' columns (Col K and Col N), so the formula would sum these two entries (Sum of K6 and N6) + Col O lists 2016-0000701 once, and because WO# 2016-0000701 was already listed in the same row in Col B in the same row, then sum all minutes in this section (both Process minutes in R2 and U2, and Rework minutes in X2 and AA2) in Sheet2!C2 + if Col AB also listed WO# 2016-0000701 in the same row as previous entries for 2016-0000701, then all minutes in this section would be summed as 'Rework' minutes (both Process minutes in AE2 and AH2, and Rework minutes in AK2 and AN2) and included in Sheet2!C2.
                                    
                                    So on Sheet1, whichever of the 3 WO columns (Col B, Col O, or Col AB) first list a WO#, then the first two subsequent columns following the WO entry that contain minutes are considered 'Process' minutes and are to be included in Sheet2!B2 columns formulas, and any subsequent listing of that same WO in the same row in a subsequent section converts all minutes to Rework minutes, and should be included in the Sheet2!Col 2 formula as Rework minutes. 
                                    
                                    Perhaps it would also help to explain rationale: a second, duplicate WO listed in the same row is an amendment to the original WO, hence all minutes recorded after that first duplicate are considered 'rework' by the organization. Alternatively, if a row has up to 1, 2 or 3 unique WOs listed in Col B, Col O, and Col AB, it indicates original WOs, and the first two 'minutes' columns after Col B (Col E, Col H) and Col O (Col R, Col U) and Col AB (Col AE, Col AH) are 'Process' minutes that are included in Sheet2!Col B results.
                                    
                                    Lastly, the following columns are always considered 'Rework' columns, regardless of whether the WO # is listed once or multiple times in a row, and are included in Sheet2!Col C results: Col B (Col K, Col N) and Col O (Col X, Col AA) and Col AB (Col AK, Col AN).
                                    
                                    The cell colours in the sample spreadsheet is my attempt to illustrate the above.
                                    
                                    I hope the Col C explanation helps...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">I misinterpreted the requirements.  Looks like Shums correctly used SumIf() to process multiple rows.</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    It was difficult for getting Col C in Sheet2, here is the solution with some helper columns.
                                    
                                    It is not a cleaner version, there would be some other other professional way, which Aiki may help :)
                                    
                                    Again you missed 6 for WO#2016-0003271 :)
                                    
                                    Please check and let us know.
                                    EE_Process_vs_Rework_Minutes_v2.xlsx</pre>

<pre class="amctext">Thanks so much, Shums, I will have a chance to review this later this evening...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Hi Shums,
                                    
                                    Thanks again for sticking with this! Yes, the gremlin WO#2016-0003271 tricked me for Column C too! :-) 
                                    
                                    The only discrepancy I noticed in your results was actually for this same WO. Since Col B already lists WO# 2016-0003271, then any subsequent entry of this WO# - in the same row - would convert all subsequent columns containing minutes to 'Rework' (Col C) values. As WO# 2016-0003271 is entered again in Col O - in the same row as it's original entry - then this makes it an 'amendment' to the original WO, and all minutes in columns R, U, X and AA would all go into Column C, for a total of 21, not 6.  It appears your formula captured Col X and AA in this case (for a total of 6), but not Col R and Col U. If this had been the first entry for WO# 2016-0003271, then your formula would have been correct in summing Col X and Col AA only as 'Rework', for a total of 6 minutes in Col C.
                                    
                                    I'm very happy that a solution appears to be close at hand! Hopefully the above explanation is helpful, and that the direction you've taken for a solution will still be feasible...? 
                                    
                                    Thanks again, Shums
                                    
                                    Andrea</pre>

<pre class="amctext">Hi Shums,
                                    
                                    In thinking further about this, given that the formula for Process Minutes (Col B) is working, then maybe the Rework Minutes (Col C) could be:
                                    
                                    Total minutes for a WO - Process Minutes (Col B) = Rework Minutes (Col C)
                                    
                                    So, for instance, if WO# 2016-0003271 entered in Col B, then sum E, H, K, N + if WO # 2016-0003271 in Col O, then sum R, U, X, AA + if WO# 2016-0003271 in Col AB, then sum AE, AH, AK, AN) - Process minutes = Rework Minutes
                                    
                                    Wondering is this might work, or if there would be issues with it...?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Following your advice 
                                    
                                      Total minutes for a WO - Process Minutes (Col B) = Rework Minutes (Col C)
                                    
                                    
                                    See attached...
                                    EE_Process_vs_Rework_Minutes_v2.xlsx</pre>

<pre class="amctext">Perfect...thanks very much, Shums!! :-) BTW, what's the best way to award the points - choose your last entry as the best solution, or split the points between your Process B solution earlier in this thread and your last entry?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Andrea!, last solution is already included with the previous solution :)</pre>

<pre class="amctext">Very pleased...thanks, Shums!</pre>

<pre class="amctext">Pleased to help Andrea!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of results I am hoping for (17 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/05_w20/1163101/EE_Process_vs_Rework_Minutes.xlsx">EE_Process_vs_Rework_Minutes.xlsx</a></p>
<p class="amcfile">Rework (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/05_w20/1163134/EE_Process_vs_Rework_Minutes_v1.xlsx">EE_Process_vs_Rework_Minutes_v1.xlsx</a></p>
<p class="amcfile">Sum Ifs (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/05_w20/1163330/EE_Process_vs_Rework_Minutes_v2.xlsx">EE_Process_vs_Rework_Minutes_v2.xlsx</a></p>
<p class="amcfile">Rework (31 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/05_w20/1163445/EE_Process_vs_Rework_Minutes_v2.xlsx">EE_Process_vs_Rework_Minutes_v2.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Tweaking a concatenated formula in Excel</h2>
<p class="amcdate">2014-10-14T10:51:06-0400</p>

<pre class="amctext">I am using a simple formula in Column I to concatenate the values in Columns B, F, G & H and insert hyphens in between each string being concatenated. Sometimes there no values in Columns G & H, so the concatenated result ends up with a hyphen dangling at the end. Other times there are no values in B, F, G & H, in which case the concatenated results contains hyphens only. I would like to revise the formula to eliminate the dangling hyphen, and if there are no values, then have the cell remain blank.
                          
                          I've attached a sample spreadsheet illustrating the existing formula + desired results.
                          
                          Thanks!
                          Andrea
                          Sample-Concatenation.xlsm</pre>

<pre class="amctext">This formula (using the ampersand instead of CONCATENATE) should meet your requirements:
                                    =B2&IF(F2<>"","-"&F2,"")&IF(G2&H2<>"","-"&G2&H2,"")
                                    
                                    Regards,
                                    -Glenn</pre>

<pre class="amctext">Perfect...thanks very much, Glenn!
                                    Andrea</pre>

<pre class="amctext">You're welcome very much, Andrea. :-)</pre>

<pre class="amctext">Glenn,  
                                    
                                    glad to see you back :-)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample-Concatenation.xlsm (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/10_w42/877400/Sample-Concatenation.xlsm">Sample-Concatenation.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">VBA to hide hide specific columns on more than one worksheet</h2>
<p class="amcdate">2014-03-05T07:18:18-0500</p>

<pre class="amctext">I am currently using this code below to hide columns H and M on the Cartoworkflow sheet. I would also like to hide column G on a worksheet called "NEW_Procedures" located in the same workbook. I tried to just add a line in the code below, but am getting an error message. 
                          
                          Private Sub Workbook_Open()
                              Sheets("Cartoworkflow").Columns("h:h").ColumnWidth = 0
                              Sheets("Cartoworkflow").Columns("m:m").ColumnWidth = 0
                              If WorksheetFunction.CountA(Sheet8.Cells) = 0 Then
                                  InitCopyRow
                              End If
                          End Sub
                          
                          Please advise...thanks!
                          Andrea</pre>

<pre class="amctext">Hi,
                                    
                                    pls try
                                    
                                    
                                        Sheets("Cartoworkflow").Range("h:h,m:m").ColumnWidth = 0
    Sheets("NEW_Procedures").Range("g:g").ColumnWidth = 0

                                    
                                      Select all
                                      Open in new window
                                    
                                    if you get an error pls verify the Sheets names for blank spaces or other typing errrors.
                                    
                                    Regards</pre>

<pre class="amctext">Still receiving the error, and I've checked the spreadsheet names as recommended...</pre>

<pre class="amctext">Could you send a dummy example
                                    
                                    EDIT 
                                    
                                    What is the text of the error and where does the code stop?
                                    
                                    Regards</pre>

<pre class="amctext">Try
                                    
                                    Sheets("Cartoworkflow").Select
                                    Columns("G:G").Select
                                    Selection.EntireColumn.Hidden = True</pre>

<pre class="amctext">Rgonzo, since you answered first I'll respond to your questions before trying other solutions offered..
                                    
                                    I get a run-time error 1004
                                    Unable to set the ColumnWidth property of the Range class
                                    
                                    When I click on debug the following line is highlighed in yellow:
                                    
                                    Sheets("NEW_Procedures").Range("g:g").ColumnWidth = 0
                                    
                                    Due to the confidentiality and complexity of the workbook I haven't had the time to create a dummy yet. I'm hoping to find someone that can offer a solution without going that route, but understand that may not be possible, in which case I'll follow up...
                                    
                                    Andrea</pre>

<pre class="amctext">Hi,
                                    
                                    Do you have some buttons or checkboxes on the G column?
                                    
                                    Regards</pre>

<pre class="amctext">No, column G is empty...</pre>

<pre class="amctext">If you want 1 line command...
                                    
                                    Sheets("NEW_Procedures").Columns("G:G").Hidden = True</pre>

<pre class="amctext">I will create a dummy spreadsheet and upload it...
                                    
                                    Andrea</pre>

<pre class="amctext">Sorry to have taken so long to close this question. The spreadsheet was undergoing some substantive structural changes and I've been waiting on input. Upon completion of the changes, I tried this solution and it worked perfectly. Thanks!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Expanding existing macro to include several ranges</h2>
<p class="amcdate">2017-08-17T21:49:11-0400</p>

<pre class="amctext">The macro below converts a column of false dates in Column B to real dates in a spreadsheet. I would like to expand the functionality of this macro to convert several columns of false dates in a spreadsheet. 
                          
                          
                          Sub Metrics_PubWOs_RealDates()
Dim cel As Range, rg As Range
Application.ScreenUpdating = False
With ActiveSheet
    Set rg = .Range("b2")
    Set rg = Range(rg, .Cells(.Rows.Count, rg.Column).End(xlUp))
    For Each cel In rg.Cells
        If Application.IsText(cel.Value) Then
            If IsDate(cel.Value) Then cel.Value = CDate(cel.Value)
        End If
    Next
End With
End Sub

                          
                            Select all
                            Open in new window
                          
                          So in addition to converting false dates in Column B, I would like this macro to also convert dates in Columns D, F, H, J, L, N, P, R, T, V, X, Z, AB, AD, AF, AH, AJ, AL, and AN. (Note that all columns requiring this macro to be run has a column header with the text string "Col", in case it's easier to write VBA code using this criteria instead).
                          
                          I have attached an example of the spreadsheet.
                          
                          Thanks,
                          Andrea
                          EE_MultipleRanges.xlsm</pre>

<pre class="amctext">try this
                                    
                                    
                                    Sub Metrics_PubWOs_RealDates()
Dim cel As Range, rg As Range
Application.ScreenUpdating = False
With ActiveSheet
    Range("A2").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
   
    Set rg = Selection
    For Each cel In rg.Cells
        If Application.IsText(cel.Value) Then
            If IsDate(cel.Value) Then cel.Value = CDate(cel.Value)
        End If
    Next
End With
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Terrific...thanks, Hainkurt!</pre>

<pre class="amctext">no it is not terrific!
                                    
                                    but this one is...
                                    
                                    
                                    Sub Metrics_PubWOs_RealDate(rg)
    For Each cel In rg.Cells
        If Application.IsText(cel.Value) Then
            If IsDate(cel.Value) Then cel.Value = CDate(cel.Value)
        End If
    Next
End Sub

Sub Metrics_PubWOs_RealDates()
    Application.ScreenUpdating = False
    Range("A2").Select
    Selection.End(xlDown).Select
    
    Dim r As Integer
    Dim rg As Range
    r = ActiveCell.Row
    
    Dim cols As Variant
    cols = Array("D", "F", "H", "J", "L", "N", "P", "R", "T", "V", "X", "Z", "AB", "AD", "AF", "AH", "AJ", "AL", "AN")
    For Each col In cols
        Set rg = Range(col & 2 & ":" & col & r)
        Metrics_PubWOs_RealDate rg
    Next
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    above one checks every cell, but this one is just those columns...
                                    
                                    :)</pre>

<pre class="amctext">There's no reason to select a range and you are using a Table so use the parts of that Table, i.e. the Data is the DatBodyRange.
                                    
                                    Try this
                                    
                                    
                                    Option Explicit

Sub Metrics_PubWOs_RealDates()
    Dim cel As Range

    For Each cel In ActiveSheet.ListObjects(1).DataBodyRange.SpecialCells(xlCellTypeConstants).Cells
        On Error Resume Next
        If IsDate(cel.Value) Then cel.Value = CDate(cel.Value)
        On Error GoTo 0
    Next cel

End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks to you both for your follow-up - I hadn't realized there were further responses until tonight.
                                    
                                    HainKurt, I appreciated your updated solution but when I tried it I got the following error in Line 20: For Each col In cols:
                                    Compile Error: Variable not defined
                                    
                                    Roy, thanks for your streamlined code. I tried your solution and noticed a couple of issues:
                                    1. It took 10 to 15 minutes for the macro to complete.
                                    2. A work order # in column A was converted to a date.
                                    
                                    Thanks again! BTW, if you think I should be starting this as a new question, given I've already awarded the points, please let me know...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">I do not believe the code too that long to work, I tested it on your example workbook an it was instantaneous, can you attach the actual workbook that took so long. 
                                    
                                    What was the actual order number?</pre>

<pre class="amctext">Hi Roy,
                                    
                                    Thanks for your note. Attached is the actual workbook (confidential information removed) so you can view how the macro performs. 
                                    
                                    The actual work order numbers are located in Col A, called WO. Interestingly, there was only one WO number, that appears 3 times in Col A, that converted to a date — 2017-0000004.
                                    
                                    Thanks for your continued assistance!
                                    
                                    Andrea
                                    EE_TextDates.xlsx</pre>

<pre class="amctext">I've just run the code and it takes seconds to complete. I'll take a look at the WO now</pre>

<pre class="amctext">Excel for some reason thinks that number is a date. I've excluded the column from the check because it's not necessary to check it.
                                    
                                    This runs in seconds for me. I've highlighted the problem cells in yellow so you can find them easily.
                                    EE_TextDates.xlsm</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of spreadsheet (793 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w33/1188385/EE_MultipleRanges.xlsm">EE_MultipleRanges.xlsm</a></p>
<p class="amcfile">Sample of workbook with several columns of text dates (458 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w33/1188636/EE_TextDates.xlsx">EE_TextDates.xlsx</a></p>
<p class="amcfile">EE_TextDates.xlsm (434 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w33/1188640/EE_TextDates.xlsm">EE_TextDates.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Add another condition to an existing formula that supersedes the first condition</h2>
<p class="amcdate">2017-06-21T16:42:10-0400</p>

<pre class="amctext">I would like to add another condition to the current formula in Column C, which is based on the entry in Col B. The current formula is:
                          
                          =IFERROR(IF($B2="","",IF(RIGHT($B2,3)="YES","",TEXT(TODAY(),"dd mmm yyyy"))),"")
                          
                          The format for Col B is always:
                          AA-DD MMM YYYY-NO
                          or
                          AA-DD MMM YYYY-YES
                          
                          I would like to add the following condition to the above formula, based on the entry in Col E:
                          
                          If Col E = "Cancelled" OR "Deferred", then populate Col C with date from Col E (formatted as above — TEXT(TODAY(),"dd mmm yyyy")
                          
                          The format for Col E is always:
                          Cancelled-DD MMM YYYY
                          or
                          Deferred-DD MMM YYYY
                          
                          Lastly, if both Col B and Col E have entries, then I would like the date from Col E to be entered in Col C, not the date from Col B.
                          
                          I have attached a sample spreadsheet to show the results I am hoping for.
                          
                          Thanks!
                          Andrea
                          EE_Sample_TwoConditions.xlsx</pre>

<pre class="amctext">In your sample workbook Col C does not have a formula. Anyway, set the number format for Col C to General, then use this formula in C2:
                                    
                                    =IFERROR(IF(OR(LEFT(E2,9)="Cancelled",LEFT(E2,8)="Deferred"),RIGHT(E2,11),IF(RIGHT(B2,2)="NO",MID(B2,4,11),"")),"")
                                    
                                    Copy down as needed.</pre>

<pre class="amctext">BTW, if you want the dates to really be dates, and not just text values, set Col C to a custom number format of dd mmm yyyy and use this formula instead:
                                    
                                    =IFERROR(DATEVALUE(IF(OR(LEFT(E2,9)="Cancelled",LEFT(E2,8)="Deferred"),RIGHT(E2,11),IF(RIGHT(B2,2)="NO",MID(B2,4,11),""))),"")</pre>

<pre class="amctext">Hi Patrick,
                                    
                                    Thanks very much for the (super-quick) solution plus the tip on making it a real date value...much appreciated!
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w25/1177294/EE_Sample_TwoConditions.xlsx">EE_Sample_TwoConditions.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Update Excel macro with variable criteria</h2>
<p class="amcdate">2017-08-02T13:00:38-0400</p>

<pre class="amctext">I have a macro that I run on a daily report. Within the macro code, there is a date that needs to be revised every two months for the macro to be effective. I would like to revise a macro if possible so that instead of having to edit the date in the VBA code every publication cycle, that a reference table is included within the VBA code.
                          
                          The current macro does the following:
                          
                          
                            Extracts the publication date from the text string in B4 and copies it into $C$5
                          
                          
                            If date in $B$5 is greater than the hard-coded cut-off date of 19-July-17 at 23:00 hrs AND if $K11 does not equal "89" or "99", then replace contents of $D11 with text string = "LATE". If conditions are not met, then no change to $D11 (original text string retained, or if $D11 was blank, then it remains blank).
                          
                          
                          Current macro code:
                          
                          Sub ProMS_Transfer_Late_WOs()
Dim lr As Long
Dim rng As Range, cell As Range
Dim compDate As Date
lr = Cells(Rows.Count, "K").End(xlUp).Row
Set rng = Range("K11:K" & lr)
compDate = DateValue("19 July 2017") + TimeValue("23:00:00")
Columns("B:B").ColumnWidth = 5
Columns("D:D").ColumnWidth = 32.43
Columns("F:F").ColumnWidth = 6
Columns("G:G").ColumnWidth = 42.14
Range("C5").Select
ActiveCell.FormulaR1C1 = "=TEXT(MID(R4C2,169,11),""dd-mmm-yyyy"")"
If Range("c5").Value > compDate Then
    For Each cell In rng
        Cells(cell.Row, "D").Select
        If cell <> 89 And cell <> 99 Then
            Cells(cell.Row, "D") = "LATE"
        End If
    Next cell
End If
End Sub

                          
                            Select all
                            Open in new window
                          
                          Desired revisions to current macro:
                          
                          
                             Determine the Cut-off Date for the Pub Date listed in $C$5 by finding the $C$5 pub date in the Pub Date list (see below)
                            
                              
                                The Cut-off Date associated with each Pub Date is listed in the column to the right of the Pub Date called Cut-off Date, in the same row
                              
                            
                            If report 'Execution' date (B5) is > than the determined Cut-off Date at 23:00 hrs AND if $K11 does not equal "89" or "99", then replace contents of $D11 with text string = "LATE". If conditions are not met, then no change to $D11 (original text string retained, or if $D11 was blank, then it remains blank).
                          
                          
                          Error handling:
                          If Publication Date in $C$5 is not found in the Pub Cycle list below, a message box pops up saying 'Pub Cycle date not found'.
                          
                          Here is the reference table of Pub Dates and associated Cut-off Dates:
                          Pub Date      Cut-off Date
                          17-Aug-17      24-May-17
                          12-Oct-17            19-Jul-17
                          07-Dec-17      13-Sep-17
                          01-Feb-18      08-Nov-17
                          29-Mar-18      03-Jan-18
                          24-May-18      28-Feb-18
                          19-Jul-18            25-Apr-18
                          13-Sep-18      20-Jun-18
                          08-Nov-18      15-Aug-18
                          03-Jan-19            10-Oct-18
                          28-Feb-19      05-Dec-18
                          25-Apr-19            30-Jan-19
                          20-Jun-19            27-Mar-19
                          15-Aug-19      22-May-19
                          10-Oct-19            17-Jul-19
                          05-Dec-19      11-Sep-19
                          
                          I have attached a sample of the report that the macro is run on.
                          
                          I hope I've provided enough detail and clarity. Just let me know if you need anything more.
                          
                          Thanks!
                          Andrea
                          EE_macro.xls</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try below:
                                    
                                    Sub ProMS_Transfer_Late_WOs()
Dim Ws As Worksheet
Dim LR As Long
Dim Rng As Range, c As Range
Dim CompDate As Date
Set Ws = Worksheets("PA01")
LR = Ws.Cells(Rows.Count, "K").End(xlUp).Row
Set Rng = Ws.Range("K11:K" & LR)
Application.ScreenUpdating = False
CompDate = Ws.Range("D5") + TimeValue("23:00:00")
Ws.Columns("B:B").ColumnWidth = 17.5
Ws.Columns("D:D").ColumnWidth = 10
Ws.Columns("F:F").ColumnWidth = 7
Ws.Columns("G:G").ColumnWidth = 42.14
Ws.Range("C5").FormulaR1C1 = "=TEXT(MID(R4C2,169,11),""dd-mmm-yyyy"")"
Ws.Range("D5").FormulaR1C1 = "=IFERROR(VLOOKUP(DATEVALUE(RC3),Table!C1:C2,2,0),""Pub Cycle date not found"")"
If Ws.Range("D5").Value = "Pub Cycle date not found" Then
    MsgBox "Pub Cycle date not found"
    Exit Sub
ElseIf Ws.Range("C5").Value > CompDate Then
    For Each c In Rng
        If Ws.Cells(c.Row, "K") <> 89 And Ws.Cells(c.Row, "K") <> 99 Then
            Ws.Cells(c.Row, "D").Value = "LATE"
        End If
    Next c
End If
Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Andrea_EE_macro.xlsm</pre>

<pre class="amctext">You don't need a table, it looks like they are all 85 days apart. If this is the case you can just modify your code like this:
                                    
                                    
                                    Sub ProMS_Transfer_Late_WOs()
    Dim lr As Long
    Dim rng As Range, cell As Range
    Dim compDate As Date, intYear As Integer, intMonth As Integer, intDay As Integer
    lr = Cells(Rows.Count, "K").End(xlUp).Row
    Set rng = Range("K11:K" & lr)
    'compDate = DateValue("19 July 2017") + TimeValue("23:00:00") This is not needed
    Columns("B:B").ColumnWidth = 5
    Columns("D:D").ColumnWidth = 32.43
    Columns("F:F").ColumnWidth = 6
    Columns("G:G").ColumnWidth = 42.14
    Range("C5").Select
    ActiveCell.FormulaR1C1 = "=TEXT(MID(R4C2,169,11),""dd-mmm-yyyy"")"
    ' added this part
    Set compDate = CDate(Range("C5").Value) 'not using the time yet
    Set intYear = Year(compDate)
    Set intMonth = Month(compDate)
    Set intDay = Day(compDate)
    Set compDate = DateSerial(intYear, intMonth, intDay - 85) + TimeValue("23:00:00") 'adding the time in here
    ' end of what I added
    If Range("c5").Value > compDate Then
        For Each cell In rng
            Cells(cell.Row, "D").Select
            If cell <> 89 And cell <> 99 Then
                Cells(cell.Row, "D") = "LATE"
            End If
        Next cell
    End If
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Shums and Mike,
                                    
                                    Thanks for your quick responses...much appreciated!
                                    
                                    Shums — I was testing your solution on some of my actual reports and found it wasn't working. In drilling down, I realize it's because my daily reports do not have the table in the second tab, so I get the 'Pub cycle not found' message box. I do store this macro in a Personal.xlsb file. Is it possible for me to add the table tab into that file instead, and have the macro code reference it in that location, since the Personal.xlsb file will always be open and available?
                                    
                                    Mike — I ran your macro and got the following error:
                                    Compile error: Object required, and 'compDate' on line 15 was highlighted
                                    I wasn't sure what that meant...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">If you don't need prompt "Pub Cycle not found" message, then follow Mike's code as corrected below:
                                    
                                    Sub ProMS_Transfer_Late_WOs()
Dim Ws As Worksheet
Dim LR As Long
Dim Rng As Range, c As Range
Dim CompDate As Date, IntYear As Integer, IntMonth As Integer, IntDay As Integer
Set Ws = Worksheets("PA01")
LR = Ws.Cells(Rows.Count, "K").End(xlUp).Row
Set Rng = Ws.Range("K11:K" & LR)
Application.ScreenUpdating = False
Ws.Range("C5").FormulaR1C1 = "=TEXT(MID(R4C2,169,11),""dd-mmm-yyyy"")"
CompDate = CDate(Ws.Range("C5").Value)
IntYear = Year(CompDate)
IntMonth = Month(CompDate)
IntDay = Day(CompDate)
CompDate = DateSerial(IntYear, IntMonth, IntDay - 85) + TimeValue("23:00:00")
Ws.Columns("B:B").ColumnWidth = 17.5
Ws.Columns("D:D").ColumnWidth = 10
Ws.Columns("F:F").ColumnWidth = 7
Ws.Columns("G:G").ColumnWidth = 42.14
If Ws.Range("C5").Value > CompDate Then
    For Each c In Rng
        If Ws.Cells(c.Row, "K") <> 89 And Ws.Cells(c.Row, "K") <> 99 Then
            Ws.Cells(c.Row, "D").Value = "LATE"
        End If
    Next c
End If
Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Shums,
                                    
                                    Thanks for the second solution. It worked fine for the 12-Oct-2017 Pub Date, but when I tested it on the 07-Dec-2017 Pub Date (which has a Cut-off Date of 13-Sep-2017) with a report 'Execution' date in B5 of 07-Sep-2017, it interpreted the work orders as late. Just to confirm:
                                    
                                    If 'Execution' date (B5) of report is < or = to Cut-off Date at 23:00, no work orders are converted to LATE as described above.
                                    If 'Execution' date (B5) of report is > Cut-off Date at 23:00, work orders that do not have '89' or '99' in Col K are converted to LATE as described above.
                                    
                                    I have attached the test DEC report in case that helps.
                                    
                                    Thanks,
                                    Andrea
                                    Test-Report_DEC.xls</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    I tried and it worked...try attached...
                                    Test-Report_DEC.xlsm</pre>

<pre class="amctext">Hi Shums,
                                    
                                    Just to confirm what's not working at my end: the work orders in the test DEC report are being changed to LATE , and they should not be.
                                    
                                    In the DEC report, B5 date (07-Sep-2017)  is < the DEC Cut-off date of 13-Sep-2017, so the macro should not change any work orders to LATE. When I run the macro, however, the work orders are being changed to LATE.
                                    
                                    Hope that helps...
                                    
                                    Andrea</pre>

<pre class="amctext">Try attached...
                                    Test-Report_DEC.xlsm</pre>

<pre class="amctext">Hi Shums,
                                    
                                    I tried your latest version and it appears to be doing the same thing as the previous version: identifying the work orders as LATE when, in fact, they are not, since the cut-off date for 07-DEC-2017 is 13-Sep-2017, and the B5 date in the test report is 07-Sep-2017. The reason I am testing this scenario is to ensure the macro will work correctly when run anytime, and only changing work orders to LATE if the report execution date is > than the cut-off date.
                                    
                                    Maybe we can return to your first solution provided in the file called "Andrea_EE_macro" , in which the code inserted the correct 'Cut-off Date' into D5. The only challenge with that solution was having the table in the report because my daily reports will not have the table in them. I do store this macro in a Personal.xlsb file. Is it possible for me to add the table tab into that file instead, and have the macro code reference it in that location, since the Personal.xlsb file will always be open and available?
                                    
                                    I'm sorry this is taking up so much of your time. I hope I am being clear enough in my feedback...
                                    
                                    Andrea</pre>

<pre class="amctext">Hi Shums,
                                    
                                    I just noticed that the following line of macro code referred to "C5", which is the Pub Date and not the report Execution date. So I tested revising the code to "B5", and it's working:
                                    
                                    I changed this line:
                                    If Ws.Range("C5").Value > CompDate Then
                                    
                                    To read:
                                    If Ws.Range("B5").Value > CompDate Then
                                    
                                    So thanks very much for your patient work on this solution! I will close the question, and share the points to acknowledge both you and Mike's much appreciated contributions.
                                    
                                    Cheers
                                    Andrea</pre>

<pre class="amctext">Thanks for your approach, Mike, and for taking it through to completion, Shums!</pre>

<pre class="amctext">Glad it worked out and sorry for not being able to return to this question sooner to help more.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample report that macro is used for (34 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185361/EE_macro.xls">EE_macro.xls</a></p>
<p class="amcfile">VBA (21 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185382/Andrea_EE_macro.xlsm">Andrea_EE_macro.xlsm</a></p>
<p class="amcfile">DEC report not returning correct results after macro run (25 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185409/Test-Report_DEC.xls">Test-Report_DEC.xls</a></p>
<p class="amcfile">VBA (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185413/Test-Report_DEC.xlsm">Test-Report_DEC.xlsm</a></p>
<p class="amcfile">VBA (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185437/Test-Report_DEC.xlsm">Test-Report_DEC.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Using conditional formatting in Excel to identify late responses to inquiries</h2>
<p class="amcdate">2018-05-30T11:13:53-0400</p>

<pre class="amctext">To identify late responses to inquiries during our production cycle, I would like to apply conditional formatting in my Excel spreadsheet based on the following conditions. I have attached a sample spreadsheet to illustrate the examples. 
                          
                          Conditional formatting:
                          If Column G or Column K is not blank, then Column F, Column J = no color
                          If Column F date is <= 5 networkdays from today's date, then Column F cell = no color
                          If Column F date is > 5 networkdays from today's date, and Column J is blank, Column F cell = pink
                          If Column F date is > 5 networkdays from today's date, and Column J has a date > 5 networkdays from today's date, Column F and Column J cells = pink
                          If Column F date is > 5 networkdays from today's date, and Column J has a date <= 5 networkdays from today's date, Column F cell = pink, Column J cell = no color
                          
                          Thanks!
                          Andrea
                          EE_Example.xlsx</pre>

<pre class="amctext">1)  If Column G or Column K is not blank, then Column F, Column J = no color
                                    =OR(G2<>"",K2<>"")  
                                       Applies to: F2:F#;J2:J#
                                    
                                    2)  If Column F date is <= 5 networkdays from today's date, then Column F cell = no color
                                    =AND(F2>TODAY(),F2<=WORKDAY(TODAY(),5))
                                       Applies to: F2:F#
                                    
                                    3)  If Column F date is > 5 networkdays from today's date, and Column J is blank, Column F cell = pink
                                    =AND(F2>WORKDAY(TODAY(),5),J2="")
                                       Applies to: F2:F#
                                    
                                    4)  If Column F date is > 5 networkdays from today's date, and Column J has a date > 5 networkdays from today's date, Column F and Column J cells = pink
                                    =AND(F2>WORKDAY(TODAY(),5),J2>WORKDAY(TODAY(),5)
                                       Applies to: F2:F#;J2:J#
                                    
                                    5)  If Column F date is > 5 networkdays from today's date, and Column J has a date <= 5 networkdays from today's date, Column F cell = pink, Column J cell = no color
                                    =AND(F2>WORKDAY(TODAY(),5),J2<=WORKDAY(TODAY(),5)
                                       Applies to: F2:F#  with Pink
                                    
                                    =AND(F2>WORKDAY(TODAY(),5),J2<=WORKDAY(TODAY(),5)
                                       Applies to: J2:J#  with no colour
                                    
                                    Note: if all rules start in row 2, applies to range must also start in row 2. # refers to last row of required selection.</pre>

<pre class="amctext">Just to clarify, I have assumed that "5 days From Today's Date" is in the future.</pre>

<pre class="amctext">Hi Rob,
                                    
                                    Thanks for your quick response. Yes, 5 days from today's date is in the future. My rows start on row 3, so I adjusted the formulas accordingly. I got a couple of errors when entering about a parenthesis missing, and in looking over your other formulas, it appeared it was just a matter of adding the ")" at the end of the formulas, so I did that. 
                                    
                                    I updated my Example Excel file (as attached) with all the formulas listed above, but unfortunately am not getting the results of any cells turning pink. From there, I checked that the order in which I entered the conditions matched the list you provided, but it didn't seem to make a difference. 
                                    
                                    I wondered if you might have a look at my updated Excel spreadsheet to see if I did anything wrong at my end, as I can't seem to figure out why it isn't working.
                                    
                                    Thanks very much!
                                    Andrea
                                    
                                    
                                    Is it a matter of the order in which the conditions are entered
                                    EE_Example_CondFormat_Added.xlsx</pre>

<pre class="amctext">BTW, the cells I am applying conditional formatting to have data validation (dropdown to enter the day’s date). Would that be having an impact on the conditional formatting formulas working, by any chance?
                                    
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Firstly, apologies about the missing brackets; I had written the formulas on the fly as it were without using Excel so didn't get the brackets checked/confirmed as would have happened in Excel.
                                    
                                    See attached file.
                                    
                                    I have re-ordered the rules so all the pink formats come first and ticked the "Stop if true" option and have also made slight changes to the formulas to lock the reference to columns F, J & K but still to no avail.
                                    
                                    So I have copied the 5 rules to cells to the right of the data; for the format to occur the result has to be True. For all of those samples the only rule that gives true is a no-format rule. I have found an error in this rule, it was referring to F rather than G.
                                    
                                    Strictly speaking, the No-Format rules are not required; if the cells to which they apply have no format anyway the condition which results in True and gives no format will do nothing.
                                    
                                    Can you explain for each of the samples what you would expect and why?
                                    
                                    Thanks
                                    Rob
                                    EE_Example_CondFormat_Added.xlsx</pre>

<pre class="amctext">I am thinking that you might have misunderstood my question about 5 days from today being in the future.
                                    
                                    With your sample number 2 (2018-0002345) - the original query was dated 10 May, the SLA date was extended to 15 May. The extended date is more than 5 days ago so should be formatted pink. Is that correct??
                                    
                                    Based on that assumption, the rules have been reversed ("<TODAY -5" rather than ">TODAY+5") in the attached and the pink formatting is happening.
                                    EE_Example_CondFormat_Added.xlsx</pre>

<pre class="amctext">Hi Rob,
                                    
                                    Sorry, I did misunderstand your question! Reversing the rules aligns the formulas with what I was looking for.
                                    
                                    Thanks very much for supplying the updated spreadsheet with the rules on the right. It is very helpful as I go through the various scenarios.
                                    
                                    I now have the answers I need...much appreciated! :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Thanks for the feedback.  You may have noticed that I added a condition on the front of each rule for column F not being blank; this avoids the blank rows included in the Applies To range being formatted.</pre>

<pre class="amctext">Hi Rob,
                                    Thanks for the helpful explanation...good to know...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of conditional formatting (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/05_w22/1323755/EE_Example.xlsx">EE_Example.xlsx</a></p>
<p class="amcfile">Original example with conditional formatting solutions entered (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/05_w22/1323957/EE_Example_CondFormat_Added.xlsx">EE_Example_CondFormat_Added.xlsx</a></p>
<p class="amcfile">Conditional Formatting (13 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/05_w22/1324421/EE_Example_CondFormat_Added.xlsx">EE_Example_CondFormat_Added.xlsx</a></p>
<p class="amcfile">Conditional Formatting (13 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/05_w22/1324434/EE_Example_CondFormat_Added.xlsx">EE_Example_CondFormat_Added.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Macro to move columns in Excel and delete unnecessary rows and paste results into Word file</h2>
<p class="amcdate">2017-08-05T10:37:14-0400</p>

<pre class="amctext">We need to extract a table from a PDF document into Excel and clean it up by moving columns around and deleting unnecessary rows, and then paste the results into a new Word file. This task is done several times weekly, so we would like to create a macro to automate the task.
                          
                          Details:
                          
                          
                            The number of columns in Excel, and their position in the table may vary, but the column headings that we need are always named the same.
                          
                          
                            The Excel table will always reside in Sheet2.
                          
                          
                          Macro steps;
                          
                          
                            Move Column called IDENT to right of Column called NAME
                          
                          
                            Move Column called TYPE to right of Column called IDENT
                          
                          
                            Move Column called LATITUDE to right of Column called TYPE
                          
                          
                            Move Column called LONGITUDE to right of Column called LATITUDE
                          
                          
                            Remove all remaining columns to right of LONGITUDE that contain data
                          
                          
                            Under Column B (NAME) find first row with "-" in cell, and delete this entire row and all subsequent entire rows to last row containing any data
                          
                          
                            Copy the table, and then paste `as text only`, into a new Word file
                          
                          
                          I have attached a sample of the Excel table pre-cleanup.
                          
                          Thanks!
                          Andrea
                          EE_Table_Cleanup.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try below, it will save as word file with the name "WayPoint" in the same folder where you will save attached file:
                                    
                                    Option Explicit
Sub ColumnAdjustments()
Dim Ws As Worksheet
Dim LRow As Long, LCol As Long, FRow As Long
Dim MyCol As Variant, ColIndex As Integer
Dim ColFound As Range, ColCounter As Integer, CopyRng As Range
Dim AppWord As New Word.Application
Dim WordDoc As Word.Document

Set Ws = Worksheets("Sheet2")
MyCol = Array("NUM", "NAME", "IDENT", "TYPE", "LATITUDE", "LONGITUDE")
ColCounter = 1
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
    .Calculation = xlManual
End With

For ColIndex = LBound(MyCol) To UBound(MyCol)
    Set ColFound = Ws.Rows("1:1").Find(MyCol(ColIndex), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)
    If Not ColFound Is Nothing Then
        If ColFound.Column <> ColCounter Then
            ColFound.EntireColumn.Cut
            Ws.Columns(ColCounter).Insert Shift:=xlToRight
            Application.CutCopyMode = False
        End If
        ColCounter = ColCounter + 1
    End If
Next ColIndex
LRow = Ws.Range("A" & Rows.Count).End(xlUp).Row
LCol = Ws.Cells(1, Columns.Count).End(xlToLeft).Column
Ws.Range(Ws.Cells(1, 7), Ws.Cells(LRow, LCol)).Delete
Ws.Range("C1").End(xlDown).Offset(1).Resize(Ws.UsedRange.Rows.Count).EntireRow.Delete
Ws.Columns.AutoFit
LRow = Ws.Range("A" & Rows.Count).End(xlUp).Row
Ws.Range("A1:F" & LRow).Copy

AppWord.Visible = True
Set WordDoc = AppWord.Documents.Add

With WordDoc
    .Content.Paste
    .SaveAs Filename:=ThisWorkbook.Path & "\" & "Waypoint" & ".docx"
End With
Application.CutCopyMode = False
AppWord.Quit
Set WordDoc = Nothing
Set AppWord = Nothing
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Please make sure you have clicked Word Reference before running the code. Here is the link which will guide you how to get reference ticked :)
                                    Andrea_Table_Cleanup_v1.xlsm</pre>

<pre class="amctext">Super! Thanks so much, Shums! The only tweak I need is for the Excel data to be pasted into Word `as text` so it has a tabs between each value (so we can apply a paragraph style with the tab values already established)...</pre>

<pre class="amctext">Try below:
                                    
                                    Option Explicit
Sub ColumnAdjustments()
Dim Ws As Worksheet
Dim LRow As Long, LCol As Long, FRow As Long
Dim MyCol As Variant, ColIndex As Integer
Dim ColFound As Range, ColCounter As Integer, CopyRng As Range
Dim AppWord As New Word.Application
Dim WordDoc As Word.Document

Set Ws = Worksheets("Sheet2")
MyCol = Array("NUM", "NAME", "IDENT", "TYPE", "LATITUDE", "LONGITUDE")
ColCounter = 1
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
    .Calculation = xlManual
End With

For ColIndex = LBound(MyCol) To UBound(MyCol)
    Set ColFound = Ws.Rows("1:1").Find(MyCol(ColIndex), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)
    If Not ColFound Is Nothing Then
        If ColFound.Column <> ColCounter Then
            ColFound.EntireColumn.Cut
            Ws.Columns(ColCounter).Insert Shift:=xlToRight
            Application.CutCopyMode = False
        End If
        ColCounter = ColCounter + 1
    End If
Next ColIndex
LRow = Ws.Range("A" & Rows.Count).End(xlUp).Row
LCol = Ws.Cells(1, Columns.Count).End(xlToLeft).Column
Ws.Range(Ws.Cells(1, 7), Ws.Cells(LRow, LCol)).Delete
Ws.Range("C1").End(xlDown).Offset(1).Resize(Ws.UsedRange.Rows.Count).EntireRow.Delete
Ws.Columns.AutoFit
LRow = Ws.Range("A" & Rows.Count).End(xlUp).Row
Ws.Range("A1:F" & LRow).Copy

AppWord.Visible = True
Set WordDoc = AppWord.Documents.Add

With WordDoc
    .Content.PasteSpecial DataType:=wdPasteText
    .SaveAs Filename:=ThisWorkbook.Path & "\" & "Waypoint" & ".docx"
End With
Application.CutCopyMode = False
AppWord.Quit
Set WordDoc = Nothing
Set AppWord = Nothing
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Andrea_Table_Cleanup_v2.xlsm</pre>

<pre class="amctext">I gave that a try, and tried it a couple of times, and it still seems to be pasting into Word as a table instead of text (so not with tabs between the data)...</pre>

<pre class="amctext">Sorry, just check the last one, you tried before refreshing the page :)</pre>

<pre class="amctext">Perfection!! Thanks a bunch, Shums, for a quick and excellent solution! :-)</pre>

<pre class="amctext">Very much appreciated, Shums!</pre>

<pre class="amctext">You're Welcome Andrea! Glad I was able to help :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of Excel table (9 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185932/EE_Table_Cleanup.xlsx">EE_Table_Cleanup.xlsx</a></p>
<p class="amcfile">Excel Automation (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185937/Andrea_Table_Cleanup_v1.xlsm">Andrea_Table_Cleanup_v1.xlsm</a></p>
<p class="amcfile">V2 (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185940/Andrea_Table_Cleanup_v2.xlsm">Andrea_Table_Cleanup_v2.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Add criteria to existing formula that references another worksheet in Excel</h2>
<p class="amcdate">2018-03-01T15:27:30-0500</p>

<pre class="amctext">Column J in UDS! has the current formula:
                          =IF(LEN([@[Work_Order_ID]])<10,"Land Use","WO")
                          
                          I would like to revise the Column J formula as follows:
                          IF(LEN([@[Work_Order_ID]])<10,"Land Use"
                          If ([@[Work_Order_ID]]) is listed in PLAN10!Id (Column A), and the PLAN10!Close Work Order (Column E) = "Yes", then UDS!Type_Task (Column J) = "AFI"
                          Else
                          UDS!Type_Task (Column J) = "WO"
                          
                          I have attached a sample spreadsheet, and entered the results in red under UDS!Type_Task that I am hoping for.
                          
                          Thanks,
                          Andrea
                          EE_Example.xlsx</pre>

<pre class="amctext">See column K in attached
                                    EE_Example.xlsx</pre>

<pre class="amctext">Perfect, and a very quick turnaround! Thanks very much, Ejgil!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example file (26 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/03_w09/1280627/EE_Example.xlsx">EE_Example.xlsx</a></p>
<p class="amcfile">Formula (26 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/03_w09/1280645/EE_Example.xlsx">EE_Example.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Automatically hyperlinking to specific folder based on value entered in cell</h2>
<p class="amcdate">2014-03-22T09:36:17-0400</p>

<pre class="amctext">The following formula currently resides in Column G:
                          =IFERROR(HYPERLINK("Q:\20"&LEFT(F78,2)&"\"&IF(MID(F78,FIND("-",F78)+1,1)="9","DND\","")&TEXT(F78,"0000-00"),""&TEXT(F78,"0000-00")),"")
                          
                          The formula references a numeric value in Column F, which corresponds to a folder name on the Q network drive. It takes the number in Column F, and creates a hyperlink to the correct network folder on Q based on the criteria within the formula (this criteria is outlined at the end of my question below), and autopopulates the hyperlinked folder number in Column G.
                          
                          The numeric value in column F is always formatted as follows:
                          yy-xxxx where yy is the last 2 digits of a year, followed by a dash, followed by a 4-digit number.
                          
                          Instead of having 2 columns with the same data, Column F with the un-hyperlinked folder number, and Column G with the hyperlinked folder number, I would like to:
                          1. Eliminate Column F
                          2. Have the user enter the folder number (yy-xxxx) into Column G, upon which the hyperlink would automatically be created, based on the same criteria as the current formula above (and outlined in detail below).
                          
                          Outline of criteria contained in the current formula:
                          
                          The 3 sub folders on the Q network drive that could contain the folder number entered by the user into Column G:
                          Q:\2013\DND
                          Q:\2014
                          Q:\2014\DND
                          All sub folders in the above folders are formatted the same way as described above: "yy-####".
                          
                          If value entered into Column G is:
                          13-1###
                          13-2###
                          13-3###
                          13-4###
                          13-5###
                          13-6###
                          13-7###
                          13-8###
                          then the value needs to hyperlink to corresponding folder number within the 'Q:\2013' sub folder.
                          
                          If value entered into Column G is:
                          13-9###
                          then the value needs to hyperlink to corresponding folder number within the 'Q:\2013\DND' sub folder:
                          
                          If value entered into Column G is:
                          14-1###
                          14-2###
                          14-3###
                          14-4###
                          14-5###
                          14-6###
                          14-7###
                          14-8###
                          then the value needs to hyperlink to corresponding folder number within the 'Q:\2014' sub folder.
                          
                          If value entered into Column G is:
                          14-9###
                          then the value needs to hyperlink to corresponding folder number within the 'Q:\2014\DND' sub folder:
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">Hi,
                                    
                                    pls try
                                    
                                    
                                    Private Sub Worksheet_Change(ByVal Target As Range)
If Target.Column = 7 Then ' Col G
    If Target.Value Like "##-####" Then
        If Target.Value Like "##-9###" Then
            addDND = "DND\"
        Else
            addDND = ""
        End If
        Application.EnableEvents = False
        Target.Formula = "=HYPERLINK(""Q:\20" & Left(Target, 2) & "\" & addDND & Target.Value & Chr(34) & ")"
        Application.EnableEvents = True
    End If
End If
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">Thanks for the quick response! 
                                    
                                    It worked the first time I clicked on the cell in Column G, but when I went back and clicked on the same cell, it didn't work, and seemed to be adding "C:\20C:\" to the path every time I reclicked as shown below:
                                    
                                    =HYPERLINK("C:\20C:\C:\20C:\C:\2013\13-5555")
                                    
                                    Secondly, clicking on it changed the cell value from the original "13-5555" to "C:\2013\13-5555", and my hope is for the cell value to stay as 13-5555, as it did when using the formula (as there are some long filepaths and it clutters the spreadsheet). Is that possible?
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">Sorry, my error! Just realized I caused the error above by mis-entering your solution — I hadn't included the third line of code. Now that I have, link works multiple times just fine.
                                    
                                    So if it would be possible to resolve my second point above — having the cell value remain unchanged after it is clicked, showing just the folder number (i.e., 13-5555) as originally entered instead of changing to include the filepath, that would be great!
                                    
                                    Thanks again,
                                    Andrea</pre>

<pre class="amctext">pls try
                                    
                                    
                                    Private Sub Worksheet_Change(ByVal Target As Range)
If Target.Column = 7 Then ' Col G
    If Target.Value Like "##-####" Then
        If Target.Value Like "##-9###" Then
            addDND = "DND\"
        Else
            addDND = ""
        End If
        Application.EnableEvents = False
        Target.Formula = "=HYPERLINK(""Q:\20" & Left(Target, 2) & "\" & addDND & Target.Value _
            & Chr(34) & "," & Chr(34) & Target.Value & Chr(34) & ")"
        Application.EnableEvents = True
    End If
End If
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">Perfect...thanks so much, Rgonzo!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Expand Word macro to find an additional string format</h2>
<p class="amcdate">2015-12-08T14:10:02-0500</p>

<pre class="amctext">My current macro code finds all instances of the following two string formats in a Word 2010 file (can be anywhere from 10 to 100 pages) and pastes them into a new Word file, one string per line:
                           AAA-#### (where AAA could be any letter from A – Z, followed by a dash, then 4 numbers)
                           ####-####### (4 numbers, followed by a dash, then 7 numbers)
                          
                          I need to revise it to include a third string format as follows:
                           AAA-##-#### (where AAA could be any letter from A – Z, followed by a dash, 2 numbers, a dash, then 4 numbers)
                          
                          The current code is shown below:
                          
                          
                          Sub Extract_WOs_ADCs()
    Set Activedoc = ActiveDocument
    strRes = ""
    Dim reg As Object 'VBScript_RegExp_55.regexp
    Dim Match As Object ' VBScript_RegExp_55.Match
    Dim Matches As Object 'VBScript_RegExp_55.MatchCollection

    ' instanciation
    Set reg = CreateObject("VBScript.RegExp")
    With reg
        .Global = True
        .MultiLine = True
        .Ignorecase = True
        .Pattern = "\b([A-Z]{3}-\d{4}|\d{4}-\d{7})\b"
    Set Matches = .Execute(Activedoc.Range.Text)
    End With
    For Each Match In Matches
        strRes = strRes & Match.Value & vbCrLf
    Next Match
    
    If strRes <> "" Then
        Set newDoc = Documents.Add
        newDoc.Range.Text = strRes
    Else
        MsgBox "No Matches"
    End If
End Sub

                          
                            Select all
                            Open in new window
                          
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">If I understand your requirements...
                                    
                                     .Pattern = "\b([A-Z]{3}-\d{2}-\d{4}|[A-Z]{3}-\d{4}|\d{4}-\d{7})\b"
                                    
                                    For those who stumble across this... 
                                    
                                    
                                      you may need to add a reference to Microsoft VBScript Regular Expressions 5.5 to get this to work: VBA IDE > Tools > References > scroll and check the box > Ok 
                                    
                                    
                                      the pipes | are an OR operator for RegEx - looking for: (Pattern1|Pattern2|Pattern3)</pre>

<pre class="amctext">Hi,
                                    
                                    pls try
                                    
                                    
                                    .Pattern = "\b([A-Z]{3}-\d{2}(\d{5}|-\d{4})|\d{4}-\d{7})\b"

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">Hey Rgonzo - love your thinking on that... but it does not seem to pickup AAA-1234
                                    
                                    Cheers,</pre>

<pre class="amctext">Sorry false assumption
                                    
                                    .Pattern = "\b([A-Z]{3}(-\d{2})?-\d{4}|\d{4}-\d{7})\b"</pre>

<pre class="amctext">Terrific...thanks to you both!</pre>

<pre class="amctext">No worries glad to help.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Refining my clunky SUMIF formula referencing an Excel table</h2>
<p class="amcdate">2017-06-11T09:58:18-0400</p>

<pre class="amctext">I am just learning to work with formulas in Excel tables. The following formula that I created works, but seems clunky having to duplicate the range criteria, and I have not been able to successfully streamline it:
                          
                          =SUMIF(Table1[WO1],$A2,Table1[WO1_Process_Min])+SUMIF(Table1[WO1],$A2,Table1[WO1_RWK_Min])
                          
                          My attempts have caused errors in the sum_range:
                          
                          =SUMIF(Table1[WO1],$A299,Table1[@[WO1_Process_Min]],[@[WO1_RWK_Min]])
                          
                          Is it possible to simplify the formula so that SUMIF only has to be entered once?
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">try use SUMIFS function instead of SUMIF.
                                    
                                    SUMIFS function allows you to put multiple criteria</pre>

<pre class="amctext">if you need to sum 2 different columns, you will need to use the "+" operator</pre>

<pre class="amctext">I've attached a sample of the workbook. Sheet1 contains the Excel table. Sheet2 is a roll-up of Sheet1, which is to sum all the minutes worked per work order (1 through 5). I've started by totalling WO1, and Sheet2, Col B contains the formula that I am trying to simplify:
                                    
                                    =SUMIF(Table1[WO1],$A2,Table1[WO1_Process_Min])+SUMIF(Table1[WO1],$A2,Table1[WO1_RWK_Min])
                                    
                                    Hope this helps,
                                    
                                    Andrea
                                    EE_SUMIF.xlsm</pre>

<pre class="amctext">well, i guess your original formula could be the simplest based on your requirements and it cannot be further simplified since you're summing 2 different ranges.
                                    
                                    
                                    =SUMIF(Table1[WO1],$A2,Table1[WO1_Process_Min])+SUMIF(Table1[WO1],$A2,Table1[WO1_RWK_Min])

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">This is the formula using SUMIF for your WO1
                                    
                                    =SUMIF(Table1[WO1],"="&$A2,Table1[[WO1_Process_Min]:[WO1_RWK_Min]])

                                    
                                      Select all
                                      Open in new window
                                    
                                    and this one is for all your WO's as you indicated in your question you will see the total in Col C of sheet2
                                    
                                    =SUMIF(Table1[WO1],"="&$A2,Table1[[WO1_Process_Min]:[WO5_RWK_Min]])

                                    
                                      Select all
                                      Open in new window
                                    
                                    check Col D
                                    
                                    I put in Col C the total as you did for each column to verify its the same as D
                                    
                                    chk the file
                                    gowlfow
                                    EE_SUMIF-V01.xlsm</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try below formula in B2 and drag down:
                                    
                                    =SUMPRODUCT(Table1[[WO1_Process_Min]:[WO1_RWK_Min]]*(Table1[WO1]=A2))

                                    
                                      Select all
                                      Open in new window
                                    Andrea_EE_SUMIF.xlsm</pre>

<pre class="amctext">Works perfectly - thanks, Shums!
                                    
                                    Thanks, Gowflow, for your response - in reviewing it for WO1 it appeared to give me the total minutes for [WO1_Process_Min] only, and didn't include the RWK minutes. For my purposes, I needed the separate totals for each of the 5 WOs.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Very pleased. :-)</pre>

<pre class="amctext">You're Welcome Andrea! Pleased to help :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of SUMIF formula (3.2 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w24/1167630/EE_SUMIF.xlsm">EE_SUMIF.xlsm</a></p>
<p class="amcfile">EE_SUMIF-V01.xlsm (3.2 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w24/1167636/EE_SUMIF-V01.xlsm">EE_SUMIF-V01.xlsm</a></p>
<p class="amcfile">Multiple Range Sum (3.2 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w24/1167637/Andrea_EE_SUMIF.xlsm">Andrea_EE_SUMIF.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Developing and automating a custom alphanumeric sort in Excel</h2>
<p class="amcdate">2014-07-25T11:00:45-0400</p>

<pre class="amctext">I need to be able to develop and automate a custom sort on an alphanumeric list. We will be sorting this type of data on a regular basis, hence the most automated approach would be best. I have attached a sample excel showing the Excel default sort in column A, and the correct custom sort I need in column B.
                          
                          Thanks,
                          Andrea
                          Sample-alphanumeric-sort.xlsx</pre>

<pre class="amctext">Correct me if my observation is wrong. This is the sort you need:
                                    1. The data should be separated into subsets for each number of characters per word
                                    2.  Each subset should be sorted by itself.
                                    3. Once the data is separated into subsets it actually is sorted already.</pre>

<pre class="amctext">If MacroShadow is correct, to achieve that sort use a helper cell alongside the data with the following formula:
                                    
                                    =LEN(A2)
                                    
                                    Sort on the column contianing this formula and then on column A.
                                    
                                    Thanks
                                    Rob H</pre>

<pre class="amctext">I tried the above formula but it wasn't entirely successful...I've attached my results and highlighted the errors in red. They pertain to the "N" section, with those identified as "4's" in the helper column. To answer Macroshadow to the best of my abilities:
                                    
                                    First sort — alpha, on first letter in string
                                    Second sort — numeric, on all numbers within string, treating the number sequence within the string as a single number (it can be 1, 2, 3+ digits as per the example).
                                    Third sort — alpha, on last letter in string
                                    
                                    Thanks!
                                    Andrea
                                    Alphanumeric-HelperColumn.xlsx</pre>

<pre class="amctext">No points..just clarifying how you should sort using Rob's helper column:
                                    
                                    -Glenn</pre>

<pre class="amctext">Followup:  Where would the value "CUT16" be ordered?  It does not have a single letter to start, but based on your rules above, I presume it should be at the top of the list.  Are there any other designations like this that might need to be considered?</pre>

<pre class="amctext">Hi Glenn,
                                    Thanks for noting the CUT exception...I'm not very familiar with the data (troubleshooting for a colleague) but you're right, CUT should be at the top of the list. And confirming that I did sort as per your example with the helper column.
                                    
                                    Andrea</pre>

<pre class="amctext">So, given that issue, would it be correct to re-state the sorting algorithm like so?
                                    
                                    1) Sort on all alphabetic characters at the start of each string, ascending
                                    2) Sort on all numeric characters that follow, ascending
                                    3) Sort on any alphabetic characters at the end of the string (if they exist), ascending</pre>

<pre class="amctext">Yes, a formula (or VBA) that does that should do the trick...
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">As I was writing a UDF (user-defined function) that would help supply a new sorting string, I noticed that there were no instances where there was more than one letter suffix for any given set of letter-number combinations.  For example:
                                    N104A
                                    N104D
                                    
                                    N300A
                                    N300C
                                    
                                    Put another way, instead of the designations being constructed like this:
                                    AlphaCode1 - NumericCode (- AlphaCode2)   <---last value optional
                                    it's more like:
                                    AlphaCode1 - AlphanumericCode
                                    
                                    Ex:
                                    N-300-A
                                    N-300A
                                    
                                    meaning that the alphanumeric group is mutually-exclusive.
                                    
                                    Long story short, I wanted to make sure that this would work if the first case was true, so I added some extra test values (in green) to ensure the UDF would work.  The attached workbook contains this function:
                                    
                                    Function SortString(strInput As String)
    Dim x As Integer
    Dim strNum As String
    Dim boolBreak As Boolean
    For x = 1 To Len(strInput)
        If IsNumeric(Mid(strInput, x, 1)) Then
            boolBreak = True
            Do
                strNum = strNum & Mid(strInput, x, 1)
                x = x + 1
            Loop Until IsNumeric(Mid(strInput, x, 1)) = False
            SortString = SortString & Format(Val(strNum), "000000")
        Else
            SortString = SortString & Mid(strInput, x, 1)
        End If
    Next x
End Function

                                    
                                      Select all
                                      Open in new window
                                    
                                    You would sort on the helper column with the function (col. B), then the Designation column to ensure that extra letter combinations are picked up correctly.
                                    
                                    Regards,
                                    -Glenn
                                    EE-Alphanumeric-HelperColumn.xlsm</pre>

<pre class="amctext">Hi Glenn,
                                    
                                    Thanks very much. I've tested this out, and it appears that when I sort by Column B (SortString), then by column A, there are still issues with the numbers being out of order (3-digit numbers preceding 2-digit numbers as shown below). It appears, though, if I change the order in which I sort the columns, sorting Column A first, then Column B, it appears to work. Is there a reason it would work this way, and would it always work? I've attached my test SortString file.
                                    
                                    N388A
                                    N389A
                                    N38F
                                    
                                    N419A
                                    N41D
                                    N420A
                                    AlphaNumeric-SortString-Test.xlsm</pre>

<pre class="amctext">When you do the sort, it should show the column names and you should select as follows:
                                    
                                    This is the only way it should work.
                                    
                                    -Glenn</pre>

<pre class="amctext">It works perfectly, Glenn...much appreciated! (Thanks for your patience in steering me in the right direction..I was manually sorting each column instead of using the SORT interface as shown in your screen capture.)
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're welcome.  Wish I could have figured an "elegant" helper formula instead of a UDF, but glad that it works.
                                    
                                    -Glenn</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample-alphanumeric-sort.xlsx (9 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/07_w30/862672/Sample-alphanumeric-sort.xlsx">Sample-alphanumeric-sort.xlsx</a></p>
<p class="amcfile">Alphanumeric-HelperColumn.xlsx (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/07_w30/862700/Alphanumeric-HelperColumn.xlsx">Alphanumeric-HelperColumn.xlsx</a></p>
<p class="amcfile">macro-enabled wkbk with sorting string function (19 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/07_w30/862736/EE-Alphanumeric-HelperColumn.xlsm">EE-Alphanumeric-HelperColumn.xlsm</a></p>
<p class="amcfile">AlphaNumeric-SortString-Test.xlsm (22 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/07_w31/862959/AlphaNumeric-SortString-Test.xlsm">AlphaNumeric-SortString-Test.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Need to make Excel 'isnumber search' formula case sensitive</h2>
<p class="amcdate">2017-11-02T10:49:46-0400</p>

<pre class="amctext">I have a conditional formatting formula that changes a cell color in Column H based on if the cell in Column F contains "NO":
                          
                          Format of Column F data:
                          AA–DD MMM YY–YES or  AA–DD MMM YY–NO
                          
                          Examples of Column F data:
                          MC–13 Oct 17–YES
                          MC–14 Oct 17–YES
                          MC–31 Oct 17–NO
                          
                          Conditional Format formula:
                          
                          =ISNUMBER(SEARCH("*NO*",$F2))

                          
                            Select all
                            Open in new window
                          
                          This formula has been working fine until we hit November, whereby the month also contains "No" so the formula is no longer working properly:
                          MC–01 Nov 17–YES
                          MC–01 Nov 17–NO
                          
                          I need to revise the conditional format formula so it is case sensitive, so it only detects 'NO' in all capital letters:
                          
                          =ISNUMBER(SEARCH("*NO*",$F2))  'this formula needs to be case sensitive, detecting only 'NO' and not 'No'

                          
                            Select all
                            Open in new window
                          
                          I have attached a sample spreadsheet.
                          
                          Thanks!
                          Andrea
                          CaseSensitive_Search_IsNumber_EE.xlsm</pre>

<pre class="amctext">for case sensitive replace the SEARCH function with FIND function</pre>

<pre class="amctext">If the cell contents will always be in the format that the contents end with Yes or No then you don't need to use the SEARCH or FIND function.
                                    
                                    See screenshot below showing the format.</pre>

<pre class="amctext">i modified the conditonal formatting on sheet  WO_List
                                    
                                    see attached.
                                    
                                    also with FIND you do not need to use asterisks 
                                    
                                    just put  =ISNUMBER(FIND("NO",$F2))
                                    CaseSensitive_Search_IsNumber_EE.xlsm</pre>

<pre class="amctext">Thanks to you both for responding so quickly with solutions! While Rob's solution worked for this specific instance, I also appreciated the versatility of Jim's formula in case the format in Column F changes so that 'NO' and 'YES' are no longer at the end of the string (a very likely scenario in the near future, actually), so thought it best to share the points. Hope that works for everyone! :-)
                                    
                                    Best regards,
                                    Andrea</pre>

<pre class="amctext">Glad to be of help.</pre>

<pre class="amctext">You're welcome</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample spreadsheet (24 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w44/1202779/CaseSensitive_Search_IsNumber_EE.xlsm">CaseSensitive_Search_IsNumber_EE.xlsm</a></p>
<p class="amcfile">CaseSensitive_Search_IsNumber_EE.xlsm (23 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w44/1202784/CaseSensitive_Search_IsNumber_EE.xlsm">CaseSensitive_Search_IsNumber_EE.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Enabling Excel user form to scroll to previous records + hiding application</h2>
<p class="amcdate">2017-12-05T20:59:25-0500</p>

<pre class="amctext">I am working on an Excel user form, and have created a form that enters data into a sheet called 'TrackingSheet'. I would like to make the following enhancements:
                          
                          
                            Have only the user form visible, and not the Excel application.
                            Enable the user to scroll back to previous records within the user form (read-only view)
                          
                          
                          I have attached the user form I have created.
                          
                          Thanks,
                          Andrea
                          ProdMainTimeTracker_EE.xlsm</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try attached...
                                    
                                    Before clicking Previous or Next Button, select any item from List Box. Will this work for you?
                                    Andrea_Mary_ProdMainTimeTracker_EE.xlsm</pre>

<pre class="amctext">@Shums: One suggestion - your code hides the Excel application permanently. When I re-opened it, the application crashed.
                                    
                                    You may need to add to your "cancel" button something like
                                    
                                    
                                    Private Sub cmdCancel_Click()
    Unload Me
    ThisWorkbook.Close SaveChanges:=True
   'RESTORE EXCEL VISIBILITY>>>
    Application.Visible = True
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">@ Neil,
                                    
                                    It doesn't crash here :) I tried many times before uploading final version. I haven't used Application.Visible = True or hiding Excel Application completely as probably Andrea doesn't wanted user to know if its Excel.
                                    
                                    I just noticed date format was not displaying properly :)
                                    Andrea_Mary_ProdMainTimeTracker_EE.xlsm</pre>

<pre class="amctext">Very cool, Shums, thanks so much for this!!
                                    Cheers,
                                    Andrea
                                    BTW, if I want to view the VBA for the form, how do I access it?</pre>

<pre class="amctext">Andrea,
                                    
                                    Once you open this file, open another excelfile. You will be able to see developer tab even userform is on top view.</pre>

<pre class="amctext">:) ah OK. Maybe I had put Excel into an unstable state some other way... quite likely ...</pre>

<pre class="amctext">Thanks, Shums, for letting me know how to access the developer tab...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">User form (26 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w49/1213943/ProdMainTimeTracker_EE.xlsm">ProdMainTimeTracker_EE.xlsm</a></p>
<p class="amcfile">UserForm (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w49/1214187/Andrea_Mary_ProdMainTimeTracker_EE.xlsm">Andrea_Mary_ProdMainTimeTracker_EE.xlsm</a></p>
<p class="amcfile">UserForm (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w49/1214244/Andrea_Mary_ProdMainTimeTracker_EE.xlsm">Andrea_Mary_ProdMainTimeTracker_EE.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">In Excel, find last column with value > 0 and populate column M with the date listed in the heading row of the last column</h2>
<p class="amcdate">2017-10-24T15:21:01-0400</p>

<pre class="amctext">I need to identify the last date that each work order was worked on. To do so, I need a formula in Column M as follows:
                          
                          
                            For each row in Column M in Sheet1 of spreadsheet, find the last column between Col B and Col L that has a value > 0, and then enter the date listed in the heading row of the last column into the cell of the corresponding row under Column M.
                          
                          
                          I have attached a sample spreadsheet and have populated the desired results in red in Column M, as well as shaded the corresponding 'last column' cells in green to illustrate what I am after.
                          
                          Thanks!
                          Andrea
                          EE_Last_Date.xlsx</pre>

<pre class="amctext">Place this formula in M3 and then copy down as far as needed.
                                    
                                    
                                    =LOOKUP(2,1/(B3:L3<>0),B$1:L$1)

                                    
                                      Select all
                                      Open in new window
                                    
                                    »bp</pre>

<pre class="amctext">Perfect - thanks very much, Bill!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample file with desired results (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201174/EE_Last_Date.xlsx">EE_Last_Date.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Revising a LOOKUP formula finding last match to ignore rows if column K contains either of two values ("No Change" or "CX'd")</h2>
<p class="amcdate">2016-09-23T12:49:38-0400</p>

<pre class="amctext">I am currently using the following LOOKUP formula in spreadsheet EE_Pub (columns N, O and P) to find 'last match' values in spreadsheet EE_Cat (columns J, K and L), unless the value in column K of EE_Cat spreadsheet = "No Change", in which case it ignores this row.
                          
                          =IFERROR(LOOKUP(2,1/([EE_Cat.xlsx]Sheet1!$I$2:$I$1200=$M2)/([EE_Cat.xlsx]Sheet1!$K$2:$K$1200<>"No Change"),[EE_Cat.xlsx]Sheet1!$J$2:$J$1200),"")
                          
                          I need to add an additional criteria to this formula so that it ignores all rows where column K in EE_Cat spreadsheet = "No Change" or "CX'd"
                          
                          I have provided the two sample spreadsheets. I have highlighted the cells and included comments on the EE_Pub spreadsheet containing the results I am looking for with the updated formula.
                          
                          I hope I have provided sufficient information, and that it is clear enough...
                          
                          Thanks!
                          Andrea
                          EE_Cat.xlsx
                          EE_Pub.xlsx</pre>

<pre class="amctext">Try this
                                    =IFERROR(LOOKUP(2,1/([EE_Cat.xlsx]Sheet1!$I$2:$I$1200=$M3)/([EE_Cat.xlsx]Sheet1!$K$2:$K$1200<>"CX'd")/([EE_Cat.xlsx]Sheet1!$K$2:$K$1200<>"No Change"),[EE_Cat.xlsx]Sheet1!$J$2:$J$1200),"")</pre>

<pre class="amctext">Thanks, Ejgil, for the quick response...works like a charm! :-)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample file #1 (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/09_w39/1118484/EE_Cat.xlsx">EE_Cat.xlsx</a></p>
<p class="amcfile">Sample file #2 (14 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/09_w39/1118485/EE_Pub.xlsx">EE_Pub.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Automated way of removing line breaks within a cell in Excel</h2>
<p class="amcdate">2014-03-24T12:59:50-0400</p>

<pre class="amctext">I have inherited a large spreadsheet which contains a significant number of line breaks (using ALT + ENTER) within the cells of several columns of text. I am looking for a macro or automated way to remove all line breaks within cells so that the text wraps properly. I couldn't find anything in the "Find & replace" feature to address this...
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">You can do with formulas in another column:
                                    
                                    =SUBSTITUTE(C3,CHAR(10),"")
                                    
                                    The ASCII code for "Carriage Return" is 10 so this will substitute all CRs with "". Might be worth changing to " " (Space) instead otherwise last word on one line will be concatenated with first word on the next.
                                    
                                    Thanks
                                    Rob H</pre>

<pre class="amctext">Or using Find and Replace:
                                    
                                    In the find box press Alt and type 010
                                    In the replace type a space
                                    
                                    Thanks
                                    Rob H</pre>

<pre class="amctext">Perfect. And I followed your advice on building in the " " (space). Thanks for your quick response...
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Results based on matching first 4 characters in a text string</h2>
<p class="amcdate">2013-10-25T12:58:10-0400</p>

<pre class="amctext">I am currently using the index match formula below:
                          
                          =IFERROR(INDEX('M:\[BookProduction_12DEC2013.xlsm]Charts_Pub'!$S$2:$S$3633,MATCH(A2,'M:\[BookProduction_12DEC2013.xlsm]Charts_Pub'!$M$2:$M$3633,0)),"—")
                          
                          I would like to modify it to match only the first 4 characters of the text string in A2 instead of the entire text string in the cell. The first 4 characters are a mix of alpha-numeric characters, and always have an underscore following them. If there is no match, I would like the result to say "Not in book". See examples below of text string:
                          
                          CCA6_XXX_32_0_1.pdf
                          CYVR_POYR_NN75_32_0_1.pdf
                          CYSJ_IPSJ_DEMR_32_0_1.pdf
                          CYWK_IPSJ_DEMR_36_0_1.pdf
                          
                          I've also included a sample file to illustrate what I'm looking for.
                          
                          Thanks,
                          Andrea
                          EE-match-partial-Oct25.xlsx</pre>

<pre class="amctext">Try:
                                    
                                    =IFERROR(INDEX(Data!$D$2:$D$33,MATCH(LEFT(A2,4),Data!$B$2:$B$33,0)),"Not in book")
                                    
                                    
                                    
                                    also, can you please close off any other threads you have open if the issues are resolved.  Thanks.</pre>

<pre class="amctext">Given your example you could also use VLOOKUP, i.e.
                                    
                                    =IFERROR(VLOOKUP(LEFT(A2,4),Data!$B$2:$D$33,3,0),"Not in book")
                                    
                                    regards, barry</pre>

<pre class="amctext">The first solution provided worked, thanks, so I will follow up and close this post. In trying the second solution, I adjusted it for my spreadsheet, and in doing so had to change "3,0), "Not in book")" to "20,0), "Not in book")", and got "0" as a result. In experimenting, it appears that going beyond "9,0), "Not in book")" causes it to fail. Is that a limitation of the VLOOKUP?</pre>

<pre class="amctext">You have to make sure that the lookup table:  Data!$B$2:$D$33 starts from the column you are looking up the items in, and the table must end at or after the column you are looking to extract from.  The column Index Number (4th parameter in the VLOOKUP function) must be the count of columns starting from your lookup column to the column you are extracting from.
                                    
                                    This is why the INDEX/MATCH is perhaps a good choice.  You just index and match the columns of interest without having to worry about column counts, or if column of the lookup column is to the left or right of the column to extract from.</pre>

<pre class="amctext">No there's no such limitation on VLOOKUP - if you specify 20 then the result will be from the 20th column of the specified "lookup array" - what formula did you try?
                                    
                                    regards, barry</pre>

<pre class="amctext">Thanks for your patience and explanations. I went back to the drawing board and both formulas work perfectly!</pre>

<pre class="amctext">Since both solutions worked, and you both provided helpful comments, I decided to distribute the points. The formula chosen as the "Best solution" was the shorter one of the two. I hope I've handled this to everyone's satisfaction. Thanks again for your prompt responses and great solutions!
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Index match on a partial text string (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/10_w43/684699/EE-match-partial-Oct25.xlsx">EE-match-partial-Oct25.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Revising VBA code's behavior when column is blank</h2>
<p class="amcdate">2017-07-07T20:01:26-0400</p>

<pre class="amctext">This VBA solution (as per the attached spreadsheet and shown below) works perfectly as long as there is at least one date value entered in Column G. When Column G is completely blank, however, then the code changes the column heading in Column H of that tab to 'No'. Is it possible to revise the code so that if there are no dates in Column G in the spreadsheet, then nothing happens?
                          
                          The attached spreadsheet illustrates the issue in that the third tab, Planning_01-Feb-18, which has no values in Column G, has changed the heading in Column H to 'No'.
                          
                          If it helps to see my original question for more context, it is ID # 42193721.
                          
                          Current VBA code:
                          
                          
                          Sub UpdatePlanningSheets()
Dim Ws As Worksheet, Ws1 As Worksheet, Ws2 As Worksheet
Dim LR As Long, LR1 As Long

'Disable Events
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
    .Calculation = xlManual
End With

'Set Variables
Set Ws1 = Worksheets("Deadline_Dates")
Set Ws2 = Worksheets("Lookups")
LR1 = Ws1.Range("A" & Rows.Count).End(xlUp).Row

'Get Sheet Names of Every Worksheet & Update Column G
For Each Ws In ThisWorkbook.Worksheets
    If Ws.Name <> Ws1.Name And Ws.Name <> Ws2.Name Then
        LR = Ws.Range("G" & Rows.Count).End(xlUp).Row
        If IsEmpty(Ws.Range("H2:H" & LR + 1)) = False Then
            Ws.Range("H2:H" & LR + 1).ClearContents
        End If
        Ws.Range("K2").FormulaR1C1 = "=RIGHT(CELL(""filename"",R[-1]C1),9)"
        Ws.Range("K2").Value = Ws.Range("K2").Value
        Ws.Range("H2:H" & LR).FormulaR1C1 = "=IF(RC7="""","""",IF(RC7<=VLOOKUP(R2C11,Deadline_Dates!C1:C2,2,0),""Yes"",""No""))"
        Ws.Range("H2:H" & LR).Value = Ws.Range("H2:H" & LR).Value
    End If
Next Ws

'Enable Events
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                          
                            Select all
                            Open in new window
                          
                          I hope I have provided enough information...
                          
                          Thanks,
                          Andrea
                          Index_Match_Date_Deadline_WO.xlsm</pre>

<pre class="amctext">hi Andrea,
                                    
                                    after LR = Ws.Range("G" & Rows.Count).End(xlUp).Row, add:
                                            If LR = 1 Then 'no data
           GoTo NextWorkSheet
        End If

                                    
                                      Select all
                                      Open in new window
                                    before Next Ws, add a line label: 
                                    NextWorkSheet:

                                    
                                      Select all
                                      Open in new window
                                    by the way, you should be releasing object variables when the procedure is done: 
                                       set Ws=nothing
   set Ws1 = nothing
   set Ws2 = nothing

                                    
                                      Select all
                                      Open in new window
                                    error handlers are good to add. Here is a short video on error handling. There are 2 other videos in this series if you wish to know more. 
                                    basic error handling code for VBA (3:48)
                                    https://www.experts-exchange.com/videos/1478/Excel-Error-Handling-Part-1-Basic-Concepts.html</pre>

<pre class="amctext">Hi Crystal,
                                    
                                    Thanks very much...it works perfectly! I am not very savvy with VBA, so I wasn't sure where to add the code for 'releasing object variables'. Below is the updated code...could you just let me know where to add the 'Set Ws=nothing', etc code in?
                                    
                                    BTW, thanks for suggesting the videos re: error handling. 
                                    
                                    
                                    Sub UpdatePlanningSheets()
Dim Ws As Worksheet, Ws1 As Worksheet, Ws2 As Worksheet
Dim LR As Long, LR1 As Long

'Disable Events
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
    .Calculation = xlManual
End With

'Set Variables
Set Ws1 = Worksheets("Deadline_Dates")
Set Ws2 = Worksheets("Lookups")
LR1 = Ws1.Range("A" & Rows.Count).End(xlUp).Row

'Get Sheet Names of Every Worksheet & Update Column G
For Each Ws In ThisWorkbook.Worksheets
    If Ws.Name <> Ws1.Name And Ws.Name <> Ws2.Name Then
        LR = Ws.Range("G" & Rows.Count).End(xlUp).Row
        If LR = 1 Then 'no data
        GoTo NextWorkSheet
        End If
        If IsEmpty(Ws.Range("H2:H" & LR + 1)) = False Then
            Ws.Range("H2:H" & LR + 1).ClearContents
        End If
        Ws.Range("K2").FormulaR1C1 = "=RIGHT(CELL(""filename"",R[-1]C1),9)"
        Ws.Range("K2").Value = Ws.Range("K2").Value
        Ws.Range("H2:H" & LR).FormulaR1C1 = "=IF(RC7="""","""",IF(RC7<=VLOOKUP(R2C11,Deadline_Dates!C1:C2,2,0),""Yes"",""No""))"
        Ws.Range("H2:H" & LR).Value = Ws.Range("H2:H" & LR).Value
    End If
NextWorkSheet: Next Ws

'Enable Events
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">hi Andrea,
                                    
                                    you're welcome
                                    
                                    >> could you just let me know where to add the 'Set Ws=nothing', etc code in? <<
                                    at the end ... just before End Sub -- watch the video, and then the other 2 (Excel is the example application). It is Friday! Make it a 'movie' night :)</pre>

<pre class="amctext">Thanks again for the quick turnaround on a solution...much appreciated! And I'll follow up with the videos.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">you're welcome, Andrea ~ happy to help</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of current VBA code results when no date in Column G (24 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w27/1180573/Index_Match_Date_Deadline_WO.xlsm">Index_Match_Date_Deadline_WO.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excluding zero in concatenated results in Excel</h2>
<p class="amcdate">2015-11-27T09:57:02-0500</p>

<pre class="amctext">I have a formula in Column C that concatenates numbers from column A and Column B:
                          =CONCATENATE(A2,B2)
                          
                          Occasionally Column B may have a blank cell, and in those instances the concatenation is adding a zero at the end of the numeric string results in Column C. How do I revise the formula so that in the instance of a blank cell a zero is not added to the concatenated result in Column C?
                          
                          I've included a sample Excel sheet to help explain my issue.
                          
                          Thanks,
                          Andrea
                          EE_Concatenating_ZeroAdded.xlsx</pre>

<pre class="amctext">=IF(ISBLANK(B2),A2,CONCATENATE(A2,B2))</pre>

<pre class="amctext">The provided Excel file seems not to have that issue. My =CONCAT(A2,B2) shows exactly the desired results.
                                    Are you certain your B values are really empty, and not numeric 0 with 0 display suppressed?</pre>

<pre class="amctext">Hi,
                                    
                                    pls try
                                    
                                    =A6&IF(B6=0,"",B6)

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">Hi Qlemo,
                                    
                                    The active spreadsheet does have the issue...I didn't realize my sample spreadsheet doesn't, sorry, but I do need a solution.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Works like a charm...thanks, Rgonzo!! 
                                    
                                    I tried your solution, Missus Miss_Sellaneus, but it did not remove the zero...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">If I'm correct, and the cells are not empty but 0, Rgonzo's approach should work.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Concatenating results sample (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2015/11_w48/1040901/EE_Concatenating_ZeroAdded.xlsx">EE_Concatenating_ZeroAdded.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Trim formula that extracts the date only from the middle of an alpha-numeric string</h2>
<p class="amcdate">2017-06-08T13:44:30-0400</p>

<pre class="amctext">I need a trim formula that extracts the date only (DD MMM YY) from a column that can contain the following two formats only:
                          
                          AA-DD MMM YY
                          AA-DD MMM YY N/A
                          
                          Examples of actual entries:
                          RT–02 Apr 17 N/A
                          RT–21 Mar 17
                          MN–25 Mar 17 N/A
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Must this be strictly be in Excel formula code or will you accept a VBA solution?</pre>

<pre class="amctext">Assuming your string is in A2, then try this...
                                    
                                    =DATEVALUE(MID(A2,4,9))

                                    
                                      Select all
                                      Open in new window
                                    and format as Date.</pre>

<pre class="amctext">Perfect...thanks so much, Subhodh! :-)
                                    
                                    Andrea</pre>

<pre class="amctext">You're welcome Andreamary! Glad I could help. :)</pre>

<pre class="amctext">You can use this function in a formula:
                                    
                                    Public Function ParseDate(ByVal parmCellValue)
    Static oRE As Object
    Dim oMatches As Object
    Dim oM As Object
    Dim oSM As Object
    Dim lngSM As Long

    If oRE Is Nothing Then
        Set oRE = CreateObject("vbscript.regexp")
        oRE.Global = False
        oRE.Pattern = "\b((?:0[1-9]|[12][0-9]|3[01]) (?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (?:\d\d))\b"
    End If

    If oRE.test(parmCellValue) Then
        ParseDate = oRE.Execute(parmCellValue)(0).submatches(0)
    Else
        ParseDate = vbNullString
    End If

End Function

                                    
                                      Select all
                                      Open in new window
                                    Example:
                                    
                                    =ParseDate(A1)

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks, Aikimark! It looks like I was already closing the question as your solution came in. I was actually looking for an Excel formula for this instance, but thanks!
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Compare 2 dates and use conditional formatting if specific column has an older date</h2>
<p class="amcdate">2013-12-11T18:12:41-0500</p>

<pre class="amctext">Both column P and column R contain dates. I would like to apply conditional formatting to R2 if the date in that cell is older than the date in P2, as that flags a production issue. I only want the conditional formatting applied if both R2 and P2 have dates — if either R2 or P2 is blank, then no conditional formatting is to be applied.
                          
                          What formula would I use in this situation?
                          
                          Thanks in advance!
                          Andrea</pre>

<pre class="amctext">Try using this formula in conditional formatting
                                    
                                    =AND(R2<P2,R2<>"")
                                    
                                    that can be applied to cell R2 - cell is formatted if it's older than P2 but not blank
                                    
                                    regards, barry</pre>

<pre class="amctext">At risk of being a little harder to understand than the AND formula, since dates are always stored as numbers greater than 0, you could use the following Conditional Formatting formula:
                                    =P2/R2>1
                                    
                                    If P2 is blank, you get =0/R2>1     which becomes =0>1, which is FALSE--no Conditional Format
                                    If R2 is blank, you get =P2/0>1      which becomes #DIV/0! error value--no Conditional Format
                                    If R2 is later than P2, you get =P2/R2>1     but P2/R2 is less than 1--so FALSE no Conditional Format
                                    
                                    If R2 is earlier than P2, you get =P2/R2>1   P2/R2 will be greater than 1--so test is TRUE & Conditional Format will be applied</pre>

<pre class="amctext">My apologies to you both!!! I overlooked the fact that the dates are prefaced with initials (as per a formula implemented before my time)...sorry about that!
                                    
                                    Here are examples of what might be in R2 or P2:
                                    
                                    MJ–28 Dec 12
                                    MC–20 Jan 13
                                    
                                    Given this, is it still possible to proceed with the date compare as outlined above?
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">To convert each to a true date you can use:
                                    
                                    =DATEVALUE(RIGHT(R2,LEN(R2)-3))
                                    
                                    Assumes as per comment that only first 3 characters are note part of the date.
                                    
                                    Thanks
                                    Rob H</pre>

<pre class="amctext">If the date portion of the cell value always takes 9 characters (i.e. you use leading zeros on the day), you can use:
                                    =RIGHT(P2,9)/RIGHT(R2,9)>1
                                    
                                    Otherwise, you can use:
                                    =MID(P2,FIND("-",P2)+1,20)/MID(R2,FIND("-",R2)+1,20)>1</pre>

<pre class="amctext">byundt - I went with the assumption the other way, that the non-date part was always 3 characters.
                                    
                                    I assume you have missed out the DATEVALUE part as Excel would recognise the result as a date when calculating on it so not required. Whereas using the section of my formula without the DATEVALUE would still give a text string until it was referred to in a formula.
                                    
                                    Thanks
                                    Rob H</pre>

<pre class="amctext">Correct me if I'm wrong, but it appears that to obtain the "true date" then, I would have to extract it using the formula above and create a new column for it...? If that's the case, is it possible instead, then, using VBA, to:
                                    
                                    
                                      interpret the "true date" in column "R" and column "P" as it is currently formatted with initials first without having to extract the date and/or create another column for it
                                    
                                    
                                      change the cell color in column "R" when the date is older than the date in the corresponding row in Column "P"
                                    
                                    
                                      leave cell color unchanged if corresponding cells in either column "R" or "P" are blank
                                    
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">Andrea,
                                    To obtain the "true date" you can either extract the date portion of the cell's text and put it in the DATEVALUE function (as suggested by Rob) or use it in an arithmetic expression (as occurs in the two formulas I suggested in my last Comment). Either way, it is not necessary to create new columns for the dates.
                                    
                                    Using Rob's suggestion and barryhoudini's formula, the Conditional Formatting formula would be:
                                    =AND(R2<>"",DATEVALUE(RIGHT(R2,LEN(R2)-3))<DATEVALUE(RIGHT(P2,LEN(P2)-3)))
                                    
                                    My formulas (just repeating my previous Comment) for the Conditional Formatting formula are:
                                    =RIGHT(P2,9)/RIGHT(R2,9)>1
                                    =MID(P2,FIND("-",P2)+1,20)/MID(R2,FIND("-",R2)+1,20)>1
                                    
                                    The three formulas are making different assumptions about the text in the cell:
                                    
                                    
                                      Rob assumed there were two initials and a hyphen
                                    
                                    
                                      My first formula assumed the date would be the last 9 characters in the cell (i.e. three for the month, two for the day and two for the year).
                                    
                                    
                                      My second formula assumed that the initials would always be followed by a hyphen
                                    
                                    
                                    You will need to look at how your users fill out the worksheet to determine if any of the three methods will work in all cases--or if the users need to be trained.
                                    
                                    Brad</pre>

<pre class="amctext">Brad,
                                    
                                    Thanks so much for an excellent explanation and summary of the 3 possible formulas, which all work! All the assumptions were correct. I will be using the shortest formula.
                                    
                                    And thanks as well to Rob and Barry Houdini for your answers, which Brad combined for a successful formula. 
                                    
                                    Experts Exchange is an impressive resource!
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Conditional formatting based on another column not containing a specific word (Excel)</h2>
<p class="amcdate">2017-04-03T10:33:47-0400</p>

<pre class="amctext">I would like to implement the following in my Excel spreadsheet:
                          
                          If Column A does not contain the text string 'internal', then Column B cell changes to green.
                          
                          The Column A dropdown menu is as follows:
                          EDX-QA (STiR created)
                          NC-EQV
                          NC-FQV
                          NC-Internal
                          EDO
                          NC-NQV
                          GA QA
                          UJA-QA (STiR created)
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Hi,
                                    
                                    You can use below formula in Conditional Formatting selecting column B range:
                                    
                                    =ISNUMBER(SEARCH("Internal",A2))=False

                                    
                                      Select all
                                      Open in new window
                                    See image below:</pre>

<pre class="amctext">Alternatively you can try the below formula for making a new rule for conditional formatting.
                                    
                                    
                                    =ISERROR(SEARCH("Internal",A2))

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">If you have long list and you want VBA to do that then try below code:
                                    
                                    Sub CondFormat()
Dim Ws As Worksheet
Dim LR As Long
Dim ColRng As Range
Application.ScreenUpdating = False
Set Ws = ActiveSheet
LR = Ws.Range("A" & Rows.Count).End(xlUp).Row
Set ColRng = Ws.Range("B2:B" & LR)
With Ws
    .Cells.FormatConditions.Delete
    With ColRng
        .FormatConditions.Add Type:=xlExpression, Formula1:="=ISNUMBER(SEARCH(""Internal"",RC[-1]))=FALSE"
        .FormatConditions(.FormatConditions.Count).SetFirstPriority
        With .FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = RGB(0, 128, 0)
            .TintAndShade = 0
        End With
        .FormatConditions(1).StopIfTrue = False
    End With
End With
Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Conditional-Formatting-Based-on-Ajd.xlsm</pre>

<pre class="amctext">Thanks to you both for your timely solutions! And thanks, Shums, for the taking the extra step of providing a VBA option. 
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're Welcome Andrea! We're glad that we're able to help you</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Conditional Formatting (18 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/04_w14/1154458/Conditional-Formatting-Based-on-Ajd.xlsm">Conditional-Formatting-Based-on-Ajd.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Removing duplicate work orders based on latest date and time stamp in Excel report</h2>
<p class="amcdate">2019-03-11T17:04:57-0400</p>

<pre class="amctext">I get a daily report generated in Excel from our workflow system. The report lists all the work orders in Column A, and the date/time various tasks were completed for that work order in Column D. Column A can include duplicate work order entries for those work orders that required a variety of tasks to be completed.
                          
                          I need a macro that removes all duplicate work orders as follows:
                          
                          
                            Determines the latest date/time stamp in Column D for any duplicate work orders
                          
                          
                            Removes all entries for that work order that have older date/time stamps
                          
                          
                            Retains a single entry only for that work order that has the latest date/time stamp
                          
                          
                          I have attached a sample of the report. I have applied conditional formatting in Column A to highlight the duplicate work orders. In Column D, where there are duplicates in Column A, I have highlighted in yellow the rows that should be retained (as they have the latest date/time stamp) after the duplicate work orders are removed to illustrate the results I am hoping for.
                          
                          Thanks!
                          Andrea
                          EE_Duplicate_WO_Removal.xlsx</pre>

<pre class="amctext">I assume you also want to retain all the ID's where there's just one entry like rows 8 to 12. True?</pre>

<pre class="amctext">Try this
                                    EE_Duplicate_WO_Removal.xlsm</pre>

<pre class="amctext">You may try something like this...
                                    
                                    Sub RemoveDuplicateWorkOrders()
    Dim wsData As Worksheet
    Dim lr As Long
    Application.ScreenUpdating = False
    
    Set wsData = Worksheets("PA08")
    wsData.AutoFilterMode = False
    lr = wsData.Cells(Rows.Count, 1).End(xlUp).Row
    
    wsData.Range("Z2:Z" & lr).Formula = "=D2<>MAXIFS($D$2:$D$" & lr & ",$A$2:$A$" & lr & ",A2)"
    With wsData.Range("Z1:Z" & lr)
        .AutoFilter field:=1, Criteria1:=True
        If .SpecialCells(xlCellTypeVisible).Cells.Count > 1 Then
            wsData.Range("Z2:Z" & lr).SpecialCells(xlCellTypeVisible).EntireRow.Delete
        End If
        .AutoFilter
        .ClearContents
    End With
    wsData.Range("A1").AutoFilter
    Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    Please click the button called "Remove Duplicate Work Orders" on PA08 Sheet to run the macro.
                                    EE_Duplicate_WO_Removal.xlsm</pre>

<pre class="amctext">Thanks to everyone for your quick responses! 
                                    
                                    Martin - yes, that's correct, I did want to retain all the IDs where there was just one entry.
                                    
                                    Ejgil - your solution did the trick. 
                                    
                                    Subodh - I tried your solution a few times but the macro didn't appear to run. I tried both clicking on the button, as well as through the Developer > Macro icon.
                                    
                                    Best,
                                    Andrea</pre>

<pre class="amctext">That's very strange?
                                    I just tested it and it worked without an issue.
                                    
                                    Anyways glad your issue has been resolved.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample Excel report with rows highlighted to illustrate results I am hoping for (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/03_w11/1414770/EE_Duplicate_WO_Removal.xlsx">EE_Duplicate_WO_Removal.xlsx</a></p>
<p class="amcfile">Remove duplicates (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/03_w11/1414779/EE_Duplicate_WO_Removal.xlsm">EE_Duplicate_WO_Removal.xlsm</a></p>
<p class="amcfile">EE_Duplicate_WO_Removal.xlsm (22 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/03_w11/1414791/EE_Duplicate_WO_Removal.xlsm">EE_Duplicate_WO_Removal.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Counting # of WOs in Excel meeting specific criteria (updated)</h2>
<p class="amcdate">2016-10-04T10:59:51-0400</p>

<pre class="amctext">I realized in implementing a solution yesterday that I need a tweak.
                          
                          The current formula is showing Column F (COUNT_WO) = 1 when Column D is not blank and Column E is blank. I need the formula to be revised so that Column F (COUNT_WO) = 0 if Column D is not blank and Column E is blank.
                          
                          I am resubmitting my sample spreadsheet that uses the current formula as outlined below, and I've added a column called 'Desired Results' to show what I am after.
                          
                          The current formula being used in the sample spreadsheet in F2 is:
                          =IF(AND(COUNTIF($A$2:A2,A2)=1,IFERROR(SEARCH("amd",B2),0)=0,NOT(ISBLANK(D2)),IFERROR(FIND("N/A",E2),0)=0),1,0)
                          
                          SUMMARY OF CRITERIA
                          The criteria to be met:
                          Col A is not blank, and the number is unique (format of number is always "yyyy-#######")
                          Col B does not contain the text string "amd" or "AMD"
                          Col D is not blank
                          Col E is not blank, and does not contain "N/A"
                          
                          Then:
                          Column F (COUNT_WO) = 1
                          
                          If the above conditions are not met, then:
                          Column F (COUNT_WO) = 0
                          
                          If Col D is not blank and Col E is blank, then:
                          Column F (COUNT_WO) = blank
                          
                          If error, then:
                          Column F (COUNT_WO) = blank
                          EE_Summary_Count_WOs_Updated.xlsx</pre>

<pre class="amctext">Here is the revised formula.  It only needed an extra test inside the AND(...) function to see if the value in column E is not blank.
                                    =IF(AND(NOT(ISBLANK(A2)),COUNTIF($A$2:A2,A2)=1,IFERROR(SEARCH("amd",B2),0)=0,NOT(ISBLANK(D2)),NOT(ISBLANK(E2)),IFERROR(FIND("N/A",E2),0)=0),1,0)
                                    
                                    I also added a test to check if the value in column A is also not blank; that was left out of the previous formula. 
                                    
                                    -Glenn</pre>

<pre class="amctext">Perfect...thanks, Glenn!
                                    
                                    Andrea</pre>

<pre class="amctext">You're welcome.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample file updated (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/10_w41/1120430/EE_Summary_Count_WOs_Updated.xlsx">EE_Summary_Count_WOs_Updated.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel VBA that applies a 'group' number to each 'batch' of unique work order numbers</h2>
<p class="amcdate">2019-05-10T14:46:29-0400</p>

<pre class="amctext">Column A is a list of 'child' WOs. Column B is a list of the 'parent' WO associated with the 'child' work order. There can be a single, or multiple, 'child' work orders associated with a 'parent' work order. 
                          
                          I am looking for a VBA solution that, based on the work orders in Column B, enters a group number to each unique Column B work order into Column C (Parent WO Group No). 
                          
                          I have included a sample spreadsheet with the Column C manually populated (in red) to demonstrate the outcome that I am looking for.
                          
                          Thanks!
                          Andrea
                          EE_WO_Groupings.xlsm</pre>

<pre class="amctext">You can use this macro.
                                    
                                    Sub AssignParentGroup()
Dim lngLastRow As Long
Dim lngRow As Long
Dim intGroup As Integer
Dim cel As Range
Dim rngVisible As Range

    Application.ScreenUpdating = False
    
    With ActiveSheet
        lngLastRow = .Range("B1048576").End(xlUp).Row
        For lngRow = 2 To lngLastRow
            .Cells.AutoFilter
            .Range("A1:A" & lngLastRow).AutoFilter Field:=2, Criteria1:=.Cells(lngRow, "B")
            intGroup = intGroup + 1
            Set rngVisible = Range("A2:D" & Cells(Rows.Count, "B").End(xlUp).Row).SpecialCells(xlCellTypeVisible)
            For Each cel In rngVisible
                Range("C" & cel.Row).Value = intGroup
            Next
            .Cells.AutoFilter
        Next
    End With
    
    Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Martin,
                                    
                                    Thanks very much for the quick response and solution! I just had a couple of questions:
                                    
                                    1) When I ran the macro, I got an error message at this line of code:
                                    
                                                .Range("A1:A" & lngLastRow).AutoFilter Field:=2, Criteria1:=.Cells(lngRow, "B")
                                    
                                    It appears to be associated with column filters I have on, because when I stop the debugger, the column filters are gone, and then the macro runs fine. I'd prefer to be able to maintain column filters if possible, but if not then I can apply them after the macro has run,
                                    
                                    2) I noticed the group numbers start at 7, then 9, 15, 21, etc. Is it possible to have the group number start at 1 instead, and then increase consecutively by 1 (ie., 2, 3, 4, etc)? 
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">This should be better.
                                    
                                    Sub AssignParentGroup()
Dim lngLastRow As Long
Dim lngRow As Long
Dim cel As Range
Dim rngVisible As Range
Dim colPG As New Collection
Dim intEntry As Integer

    Application.ScreenUpdating = False
    lngLastRow = Range("B1048576").End(xlUp).Row

    With Range("A1:D" & lngLastRow)
        .AutoFilter
        
        For lngRow = 2 To lngLastRow
            On Error Resume Next
                colPG.Add .Cells(lngRow, "B"), CStr(.Cells(lngRow, "B"))
            On Error GoTo 0
        Next
        For intEntry = 1 To colPG.Count
            .AutoFilter Field:=2, Criteria1:=colPG(intEntry)
            Set rngVisible = Range("A2:D" & Cells(Rows.Count, "B").End(xlUp).Row).SpecialCells(xlCellTypeVisible)
            For Each cel In rngVisible
                Range("C" & cel.Row).Value = intEntry
            Next
        Next
        .AutoFilter
    End With
    
    Application.ScreenUpdating = True

End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Martin,
                                    
                                    Excellent...thanks so much! Before I mark the above as the solution, I noticed the code was missing the 'End Sub' at the end. Did you want to add this line, or should I mark the above as the solution as is, since the missing line is noted here...?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">I updated the post.</pre>

<pre class="amctext">Thanks, Martin...i'm very pleased with the solution!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You’re welcome and I’m glad I was able to help.
                                    
                                    If you expand the “Full Biography” section of my profile you’ll find links to some articles I’ve written that may interest you.
                                    
                                    Marty - Microsoft MVP 2009 to 2017
                                                  Experts Exchange Most Valuable Expert (MVE) 2015, 2017
                                                  Experts Exchange Top Expert Visual Basic Classic 2012 to 2018
                                                  Experts Exchange Top Expert VBA 2018
                                                  Experts Exchange Distinguished Expert in Excel 2018</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example with solution manually entered (9 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/05_w19/1420303/EE_WO_Groupings.xlsm">EE_WO_Groupings.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Overriding Excel's default handling of cut, copy and paste</h2>
<p class="amcdate">2014-02-23T21:55:53-0500</p>

<pre class="amctext">I am looking for a way to make my Excel workbook default to always pasting as "values" to prevent users from messing up the formatting. I came across this code below in the Professional Excel Development book, but it's not working as hoped. I don't know if the problem is with the code or with where I have pasted it into the workbook. I tried pasting it into the worksheet, and when that didn't have an impact, tried it in the workbook.
                          
                          The code I used is as follows:
                          
                          
                          
                          Dim mbCut As Boolean
Dim mrngSource As Range

'Initialise cell copy-paste
Public Sub InitCutCopyPaste()

    'Hook all the cut, copy and paste keystrokes
    Application.OnKey "^X", "DoCut"
    Application.OnKey "^x", "DoCut"
    Application.OnKey "+{DEL}", "DoCut"

    Application.OnKey "^C", "DoCopy"
    Application.OnKey "^c", "DoCopy"
    Application.OnKey "^{INSERT}", "DoCopy"

    Application.OnKey "^V", "DoPaste"
    Application.OnKey "^v", "DoPaste"
    Application.OnKey "+{INSERT}", "DoPaste"

    Application.OnKey "{ENTER}", "DoPaste"
    Application.OnKey "~", "DoPaste"

    'Switch off drag/drop
    Application.CellDragAndDrop = False

End Sub

'Handle Cutting cells
Public Sub DoCut()

    If TypeOf Selection Is Range Then
     mbCut = True
     Set mrngSource = Selection
     Selection.Copy
    Else
     Set mrngSource = Nothing
     Selection.Cut
    End If

End Sub

'Handle Copying cells
Public Sub DoCopy()

    If TypeOf Selection Is Range Then
        mbCut = False
        Set mrngSource = Selection
    Else
        Set mrngSource = Nothing
    End If
    
    Selection.Copy
End Sub

'Handle Pasting cells
Public Sub DoPaste()
    If Application.CutCopyMode And Not mrngSource Is Nothing Then
        Selection.PasteSpecial xlValues
        If mbCut Then
            mrngSource.ClearContents
        End If
        
        Application.CutCopyMode = False
    Else
        ActiveSheet.Paste
    End If
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub

Private Sub Workbook_Open()

End Sub
[b][/b]

                          
                            Select all
                            Open in new window</pre>

<pre class="amctext">Put the code in a regular module, and run the InitCutCopyPaste sub, then it will behave as you expect.</pre>

<pre class="amctext">Hi,
                                    
                                    You were almost there!
                                    
                                    Within the attached example workbook, I have placed the following code within the "ThisWorkbook" ("wbkQ_28372327") code module:
                                    
                                    
                                    Option Explicit
Private Sub Workbook_BeforeClose(Cancel As Boolean)

  Application.OnKey "^X"
  Application.OnKey "^x"
  Application.OnKey "+{DEL}"

  Application.OnKey "^C"
  Application.OnKey "^c"
  Application.OnKey "^{INSERT}"

  Application.OnKey "^V"
  Application.OnKey "^v"
  Application.OnKey "+{INSERT}"

  Application.OnKey "{ENTER}"
  Application.OnKey "~"

End Sub
Private Sub Workbook_Open()

  Call InitCutCopyPaste
  
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    Note that the Workbook_BeforeClose(...) event code is not within your original code listing.  The purpose of these code statements is to return the functionality of all the keyboard shortcuts (the "hooks") prior to the workbook being closed (so other workbooks opened thereafter are not affected).  However, workbooks open concurrently within the same EXCEL.exe session, will also only allow pasting "as values".
                                    
                                    Within a new (Public) code module, "basQ_28372327", I have placed the following code:
                                    
                                    
                                    Option Explicit

Dim mbCut                                               As Boolean
Dim mrngSource                                          As Range
Public Sub InitCutCopyPaste()

'Initialise cell copy-paste

'Hook all the cut, copy and paste keystrokes
  Application.OnKey "^X", "DoCut"
  Application.OnKey "^x", "DoCut"
  Application.OnKey "+{DEL}", "DoCut"

  Application.OnKey "^C", "DoCopy"
  Application.OnKey "^c", "DoCopy"
  Application.OnKey "^{INSERT}", "DoCopy"

  Application.OnKey "^V", "DoPaste"
  Application.OnKey "^v", "DoPaste"
  Application.OnKey "+{INSERT}", "DoPaste"

  Application.OnKey "{ENTER}", "DoPaste"
  Application.OnKey "~", "DoPaste"

'Switch off drag/drop
  Application.CellDragAndDrop = False

End Sub
Public Sub DoCut()

'Handle Cutting cells

  If TypeOf Selection Is Range Then
     mbCut = True
     Set mrngSource = Selection
     Selection.Copy
  Else
     Set mrngSource = Nothing
     Selection.Cut
  End If ' If TypeOf Selection Is Range Then

End Sub
Public Sub DoCopy()

'Handle Copying cells

  If TypeOf Selection Is Range Then
      mbCut = False
      Set mrngSource = Selection
  Else
      Set mrngSource = Nothing
  End If ' If TypeOf Selection Is Range Then
    
  Selection.Copy

End Sub
Public Sub DoPaste()
 
'Handle Pasting cells
    
  If Application.CutCopyMode And _
     Not mrngSource Is Nothing Then
     Selection.PasteSpecial xlValues
     If mbCut Then
        mrngSource.ClearContents
     End If ' If mbCut Then
        
     Application.CutCopyMode = False
  Else
     ActiveSheet.Paste
  End If ' If Application.CutCopyMode And Not mrngSource Is Nothing Then

End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    BFN,
                                    
                                    fp.
                                    Q-28372327.xls</pre>

<pre class="amctext">Note it will only work for the keyboard shortcuts not for Excel's right-click context menu.</pre>

<pre class="amctext">To address MacroShadow's concerns, I would suggest looking at the previous question thread, "How to Disable Cut, Copy and Paste in Excel ?":
                                    
                                    [ https://www.experts-exchange.com/Q_27965314.html ]
                                    
                                    Also for information, "Paste special causes loss of cell data validation":
                                    
                                    [ https://www.experts-exchange.com/Q_23982408.html ]
                                    
                                    Other threads exists on a similar topic, too.</pre>

<pre class="amctext">This did the trick! Thanks to everyone who responded.</pre>

<pre class="amctext">Two of us responded.  You credited the other "Expert" even though given my extended response (including an example workbook, & advice about adding a "Workbook_BeforeClose()" event), I was only 3 seconds later than the first reply (of a single sentence).
                                    
                                    (Sigh)</pre>

<pre class="amctext">Hi fanpages,
                                    
                                    Thanks for flagging this. In view of your note, I am now concerned that I may not have handled this fairly or correctly. I was impressed with the depth of your response, but thought that awarding the points to the "first out of the gate" with the solution that solved my problem was the protocol on this site. And I have to confess that because my problem was solved with the first response, I didn't proceed further. :-(
                                    
                                    Please advise as to what I should do in this situation. The expertise on this website is invaluable to me, and I want to make sure I'm acknowledging and awarding points correctly.
                                    
                                    Andrea</pre>

<pre class="amctext">Please don't worry, Andrea.
                                    
                                    The fact you came back to explain what you did, is worth more to me than any point allocation.
                                    
                                    For your information, "first out of the gate" is not the protocol.
                                    
                                    You may award any contributing "Expert" the resolution to a question, & also highlight other "Experts" within the same question thread that contributed to the resolution.
                                    
                                    If you ever feel you have made a mistake allocation points &/or the "accepted" answer, you may simply click the "Request Attention" icon, complete the form with any details you feel relevant, & submit it.  One of the site staff will then look at the thread, & act accordingly.
                                    
                                    In instances such as this, though, it is usually common practice to split the resolution (& hence, the point allocation) between the "Experts" that answered in close proximity.
                                    
                                    Common practice, though, not a "hard & fast" rule.
                                    
                                    As I said, please don't worry about it.
                                    
                                    Acknowledgement of my contribution is praise enough :)
                                    
                                    Good luck with the rest of your project.
                                    
                                    BFN,
                                    
                                    fp.</pre>

<pre class="amctext">Thanks very much, fp, for your gracious and helpful response...
                                    
                                    Andrea</pre>

<pre class="amctext">You're very welcome.
                                    
                                    Thank you for not mentioning my typographical error, corrected with the italicised word in the prefix to this sentence; "If you ever feel you have made a mistake allocating points...".
                                    
                                    :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Q_28372327 (53 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/02_w09/836418/Q-28372327.xls">Q-28372327.xls</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Finding total # of minutes between two dates for multiple columns using partial text string match as part of criteria</h2>
<p class="amcdate">2016-03-16T20:09:35-0400</p>

<pre class="amctext">I am providing a sample spreadsheet to illustrate what I am currently doing and how I would like to improve it:
                          
                          TAB CALLED "26_MAY_2016"
                          This spreadsheet is normally linked to specific columns in another excel workbook to pull in the essential data for dates that tasks were completed and number of minutes the task took in our book production process for each of the 3 types of books: CAP, GPH and RCAP. For the purposes of providing a sample spreadsheet, I have broken those links and am providing static data.
                          
                          Column A
                          Names of books
                          
                          Column B
                          
                          
                            This is a helper for Column A that trims the book names to the first 3 characters because I didn't know how to match a partial text string in my SUMPRODUCT formula, so that I could total by the three types of books: CAP, GPH and RCAP.
                          
                          
                            I want to delete this helper Column by improving my formula so that it matches the first 3 characters of the data in Column A.
                          
                          
                          Columns C through P
                          Date columns and minutes columns for the 7 book production tasks (there are a total of 30+ book production tasks, but for the purposes of this example I am just providing 7).
                          
                          TAB CALLED "MAY_Results"
                          Rows 1 through 13
                          
                          
                            This is an 'intermediate' table of calculations to enable me, due to my limited excel expertise, to achieve the FINAL RESULTS (as shown in rows 16 through 20 on the same tab)
                          
                          Rows 16 through 20
                          
                          
                            The FINAL RESULTS table is the desired output.
                          
                          
                            I would ideally like to bypass the above 'intermediate'  table (Rows 1 through 13) by obtaining a formula that achieves the results shown in the FINAL RESULTS table.
                          
                          
                          Closing summary:
                          
                          
                            The FINAL RESULTS table is linked to an external spreadsheet for my manager to review/access.
                          
                          
                            I'm looking for a 'no maintenance' solution in providing these metrics to my manager — once the formulas and links are in place, the numbers will update automatically without intervention by me.
                          
                          
                            If the formulas can reference the Volume column (column A) in the 26_MAY_2016 tab, thereby eliminating the necessity of the helper column called 'Vol_Trim' (Column B) in the same tab, that would be ideal.
                          
                          
                          Thanks!
                          Andrea
                          EE_Metrics_Sample.xlsx</pre>

<pre class="amctext">Andrea,
                                    Your Table layout is not geared towards an efficient formula. 
                                    
                                    If you are willing to put all the Col columns together and all the Min columns together (as shown in attached workbook), then you can use the following formula for your totals:
                                    =SUMPRODUCT((Table1[[Col1]:[Col7]]>=B$16)*(Table1[[Col1]:[Col7]]<=B$17)*(Table1[[Min1]:[Min7]])*(LEFT(Table1[[Volume]:[Volume]],3)=LEFT($A18,3)))
                                    
                                    The above formula may be copied across and down. All auxiliary columns may be deleted with this formula, including Table1[Vol_Trim] and rows 1:13 on worksheet May_Results.
                                    
                                    Brad
                                    EE_Metrics_SampleQ28933655.xlsx</pre>

<pre class="amctext">Andrea,
                                    Although it is more efficient calculation-wise to rearrange your Table, if the counts in the MIN columns will never be in the 40,000 range (and thereby be confusable with dates), you can use the following formula without rearranging your table:
                                    =SUMPRODUCT((Table1[[Col1]:[Col7]]>=B$16)*(Table1[[Col1]:[Col7]]<=B$17)*(LEFT(Table1[[Volume]:[Volume]],3)=LEFT($A18,3)),Table1[[Min1]:[Min7]])
                                    
                                    There are two key differences compared to the previous formula.
                                    1. The formula is evaluating twice as many columns because alternating Col and Min columns mean that you perform a date test on many of the Min columns, and multiply by many of the Col columns. You still get the right answer if the values in the Min columns can never be confused with valid dates because they are all less than 40,000.
                                    2. I had to move the Table1[[Min]:[Min7]] bit to the end of the SUMPRODUCT and precede it with a comma instead of an asterisk. Preceding with a comma means that any text values in that range are ignored. When I used an asterisk, the formula returned #VALUE! error value because the "blank" cells in Col columns in Table1 actually contained empty strings (look like blanks). And a number times an empty string returns #VALUE!
                                    
                                    I can also use the above SUMPRODUCT formula with the rearranged Table1. Rearranging the Table makes the calculation more efficient and bullet-proof. Once that has been done, there is no additional efficiency advantage for the new formula compared to the previously suggested one.
                                    
                                    Brad</pre>

<pre class="amctext">Alternative arrangement of the table would be to arrange with the following columns:
                                    
                                    Volume
                                    Trim
                                    Stage
                                    Date
                                    Time
                                    
                                    You can then setup your results table with SUMIF(S) functions or SUMPRODUCTS as suggested above. You might even be able to use a Pivot Table. Multiple SUMIFS or SUMPRODUCTS can be quite resource intense whereas a Pivot is a one off resource hit each time it is generated or refreshed rather than resource use every time the workbook calculates.
                                    
                                    Thanks
                                    Rob</pre>

<pre class="amctext">See attached with my suggestion.
                                    Copy-of-EE_Metrics_Sample.xlsx</pre>

<pre class="amctext">Thanks very much, Brad, for your detailed explanation and solution options...much appreciated! Since the MIN columns will never be in the range of 40,000 I will go with your second solution, but if performance becomes an issue then it's good to know how I can make it more efficient and bullet-proof. BTW, how do I tell if a cell is not a 'blank', but actually contains an empty string? And if other columns in the future happen to contain empty strings, I take it the formula would be to be revised accordingly?
                                    
                                    Rob, thank you for your suggestion and sample spreadsheet. As my preference was to eliminate the 'Trim' column + avoid having to refresh the data (as I assume would be required for a pivot table) but instead have a 'no maintenance' solution in case I'm away on holidays, etc. I didn't opt to go this route, but appreciate your input.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">If the data is set as a Table (rather than a standard list) the TRIM function can be "installed" in the table and will be populated as new data is entered. The pivot is linked to the table so the source data range will update as data is entered. The summary would then be updated with a simple right click and select refresh.</pre>

<pre class="amctext">How do I tell if a cell is not a 'blank', but actually contains an empty string?
                                    
                                    I was able to figure it out by applying the logic used in The Hound of the Baskervilles. SUMPRODUCT always returns #VALUE! error when you multiply text by a number. It usually returns a numeric answer when you use a comma to separate a SUMPRODUCT parameter that might contain a mix of text and numbers. Even though I couldn't see the text values, Sherlock Holmes would have instantly deduced their presence by the absence of a numeric result.
                                    
                                    Being quite a bit duller than Mr. Holmes, I used the Formulas...Evaluate Formula menu item. After clicking the Evaluate button 11 times in a row, I saw a mix of empty strings and dates (in the Table1[[Min1]:Min7]] expression in the Evaluate Formula dialog. And when I clicked the Evaluate button once again to perform the multiplication, that mix turned into a jumble of #VALUE! errors and numbers.
                                    
                                    Given this inkling that text was afoot, I dutifully examined the cell contents in the formula bar. No text. No apostrophe. No shift of the cursor in the formula bar when I hit the Backspace key. Arghh!
                                    
                                    Still following the clue like a bloodhound, I used the F5 Special Cells menu item to count the number of blank cells in the range. Even though I could see blank cells with my own two eyes, F5 Special Cells told me that there weren't any.
                                    
                                    Having treed the rascal, I confirmed his guilt using the ISBLANK function to test the "blank" cell in question. It returned FALSE with the clap of a verdict in the Old Bailey. An invisible empty string it was, the Excellian consequence of one range containing formulas returning empty strings being delivered via Paste Special...Values into another.
                                    
                                    
                                    
                                      And if other columns in the future happen to contain empty strings, I take it the formula would be to be revised accordingly?
                                    
                                    Actually, you should be able to leave the formula as-is. The other pieces of the SUMPRODUCT are all Boolean expressions. They are usually quite tolerant of text, especially the way they are constructed in the suggested formula.</pre>

<pre class="amctext">Thanks, Rob, for elaborating on the solution. 
                                    
                                    And Brad...thank you for the most delightful comment/explanation I have had the pleasure of reading on this website. :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample file of current process and example of final desired output (17 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/03_w12/1087042/EE_Metrics_Sample.xlsx">EE_Metrics_Sample.xlsx</a></p>
<p class="amcfile">Your file with Table rearranged and suggested formulas (21 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/03_w12/1087066/EE_Metrics_SampleQ28933655.xlsx">EE_Metrics_SampleQ28933655.xlsx</a></p>
<p class="amcfile">Pivot table (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/03_w12/1087108/Copy-of-EE_Metrics_Sample.xlsx">Copy-of-EE_Metrics_Sample.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Concatenated column output in 2 different ways depending on criteria as outlined</h2>
<p class="amcdate">2014-08-18T17:50:26-0400</p>

<pre class="amctext">I would like Column G to concatenate different columns, including a specific string within one column, based on various criteria outlined below:
                          
                          If D = "CAD" or "TREP", AND H = "VOL 1, then Column G to concatenate as follows:
                          G = B + D + C [first word after closing bracket OR first second word in string if no closing bracket] + F
                          Otherwise, Column G to concatenate as follows:
                          G = B + D + E + F
                          
                          Format of output in Column G: 
                          Dashes, but no spaces, between each value (as shown in attached spreadsheet example).
                          
                          Thanks!
                          Andrea
                          Sample-Concatenation-Result.xlsm</pre>

<pre class="amctext">You know the old saying:  "Be careful what you ask for; you just might get it."  
                                    
                                    Here's the formula:
                                    =IF(AND(H2="VOL 1",OR(D2="CAD",D2="TREP")),B2&"-"&D2&"-"&LEFT(TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))),FIND(" ",TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))))-1)&IF(F2<>"","-"&F2,""),B2&"-"&D2&"-"&E2&F2)
                                    
                                    Example workbook attached.
                                    
                                    -Glenn
                                    EE-Sample-Concat-Result.xlsx</pre>

<pre class="amctext">Wow...very cool!! Thanks so much, Glenn. :-)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample-Concatenation-Result.xlsm (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w34/867115/Sample-Concatenation-Result.xlsm">Sample-Concatenation-Result.xlsm</a></p>
<p class="amcfile">modified workbook with concatenation formula (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w34/867123/EE-Sample-Concat-Result.xlsx">EE-Sample-Concat-Result.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Finding earliest date in table range with multiple non-contiguous date columns while excluding blanks and zeros</h2>
<p class="amcdate">2018-01-20T11:38:50-0500</p>

<pre class="amctext">I am trying to find a formula that returns the earliest date from a table called DC_Table that has 11 non-contiguous 'Date' columns, excluding blank cells or cells = 0.
                          
                          All cells in the DC_Table are linked cells, and for the purposes of providing an spreadsheet example I have added the source spreadsheet to the workbook. It's called DC_WOs_Extracted. 
                          
                          There are several non-continuous columns in DC_Table that are date fields [Date1], [Date2], etc., and the alternating columns are 'Minutes' fields [Min1], [Min2], etc.
                          
                          As shown on the worksheet tab called  'Dates', the following formula works but seems cumbersome. It references the first 3 [Date] columns (ultimately I will need to include columns Date4 through to Date11), and returns the earliest date found:
                          
                          =IF(MIN(DC_Table[[Date1]:[Date1]],DC_Table[[Date2]:[Date2]],DC_Table[[Date3]:[Date3]])<>0,MIN(DC_Table[[Date1]:[Date1]],DC_Table[[Date2]:[Date2]],DC_Table[[Date3]:[Date3]]),"")
                          
                          I am hoping for a formula that is simpler (ie., using the range as opposed to having to list each date column as above), as some of my spreadsheets will have up to 25 [Date] columns. Is that possible?
                          
                          Thanks,
                          Andrea
                          Metrics_DCWOs_01FEB2018_EE.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Better to create a Named Range for non-contiguous columns, in your case, I created a Named Range called, DateCols with below formula:
                                    =DC_Table[Date1],DC_Table[Date2],DC_Table[Date3],DC_Table[Date4],DC_Table[Date5],DC_Table[Date6],DC_Table[Date7],DC_Table[Date8],DC_Table[Date9],DC_Table[Date10],DC_Table[Date11]
                                    Then for Earliest Dates enter below formula:
                                    
                                    =IF(NOT(ISBLANK((DateCols))),SMALL((DateCols),1))

                                    
                                      Select all
                                      Open in new window
                                     
                                    And for Latest Dates enter below formula:
                                    
                                    =IF(NOT(ISBLANK((DateCols))),LARGE((DateCols),1))

                                    
                                      Select all
                                      Open in new window
                                    Whenever you have new date columns, just add in Named Range.
                                    AndreaMary_Metrics_DCWOs_01FEB2018_.xlsx</pre>

<pre class="amctext">I hadn't realized that a range could include non-contiguous columns - this is great - thanks so much, Shums! :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example spreadsheet (170 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/01_w03/1221299/Metrics_DCWOs_01FEB2018_EE.xlsx">Metrics_DCWOs_01FEB2018_EE.xlsx</a></p>
<p class="amcfile">MinMax (170 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/01_w03/1221330/AndreaMary_Metrics_DCWOs_01FEB2018_.xlsx">AndreaMary_Metrics_DCWOs_01FEB2018_.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Finding last match using INDEX MATCH</h2>
<p class="amcdate">2013-10-21T18:12:31-0400</p>

<pre class="amctext">With the following formula I am finding the first match:
                          
                          =IFERROR(INDEX('[Cartography_12DEC2013_Oct21_Test.xlsm]Cartography'!$I$2:$I$675,MATCH(M2,'.[Cartography_12DEC2013_Oct21_Test.xlsm]Cartography'!$H$2:$H$675,0)),"")
                          
                          I would like to change the formula so that it finds the last match.
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">This may help...
                                    
                                    NOTE: I got the above from
                                    http://www.mrexcel.com/forum/excel-questions/635062-how-find-last-occurrence-repeated-value-average-count-how-many-times-occurred-column.html</pre>

<pre class="amctext">For "last match" try this formula with LOOKUP
                                    
                                    =IFERROR(LOOKUP(2,1/('[Cartography_12DEC2013_Oct21_Test.xlsm]Cartography'!$H$2:$H$675=M2),'[Cartography_12DEC2013_Oct21_Test.xlsm]Cartography'!$I$2:$I$675),"")
                                    
                                    regards, barry</pre>

<pre class="amctext">Worked perfectly, thanks! And appreciate the very quick turnaround...
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Index-match formula with multiple 'if' and 'or' criteria</h2>
<p class="amcdate">2017-09-04T16:34:48-0400</p>

<pre class="amctext">I am looking for formula for Sheet2, Col B (Status) as outlined below:
                          
                          Sheet2, Col B (Status) = 'Active' if:
                          If WO in Sheet2, Col A (WO_Pub) is listed in Sheet1, Col C and if Sheet1, Col D is blank
                          OR
                          If WO in Sheet2, Col A (WO_Pub) is listed in Sheet1, Col C and if Sheet1, Col D = 'Cancelled' or 'Lifted', and Col F is blank
                          
                          Sheet2, Col B (Status) = 'Not Active' if:
                          If WO in Sheet2, Col A (WO_Pub) is not listed in Sheet1, Col C
                          OR
                          If WO in Sheet2, Col A (WO_Pub) is listed in Sheet1, Col C and if Sheet1, Col D = 'LIFTED' OR 'Cancelled', and Col F is not blank
                          
                          I would like the formula to ignore case (ie., LIFTED or Lifted, etc.) since I don't have control over the entries in this spreadsheet.
                          
                          I have attached the sample spreadsheet, with the expected results listed in Sheet2, Col B (Status) column in red.
                          
                          Thanks!
                          Andrea
                          EE_AQ_Status.xlsx</pre>

<pre class="amctext">HI Andrea,
                                    
                                    Try below in B2 and drag down:
                                    
                                    =IFERROR(IF(AND(OR(INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))="",INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))="Cancelled",INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))="Lifted"),INDEX(Sheet1!$F:$F,MATCH($A2,Sheet1!$C:$C,0))=""),"Active","Not Active"),"Not Active")

                                    
                                      Select all
                                      Open in new window
                                    Kindly note, your Status for WO 2016-0002058 should be Not Active as Col F is not blank.
                                    Check attached...
                                    Andrea_EE_AQ_Status.xlsx</pre>

<pre class="amctext">Thanks for the quick response, Shums! In regard to WO 2016-0002058, it actually would be considered 'Active' since Sheet1, Col D is blank (as per the first criteria listed under 'Active' conditions in my original question)...let me know your thoughts...thanks! Andrea</pre>

<pre class="amctext">If we gonna consider 1st criteria, then WO 2017-0000544 would be Active? As Col D has "Cancelled".</pre>

<pre class="amctext">Criteria for 'Not Active' are:
                                    As long as Sheet1, Col D = 'Lifted' or 'Cancelled' and Col F is not blank, then the Status = 'Not Active'
                                    OR
                                    The WO in Sheet2, Col A is not found in Sheet1, Col C
                                    
                                    Hope that helps...let me know if you need further clarification...thanks, Shums!
                                    
                                    Andrea</pre>

<pre class="amctext">Ok Try below:
                                    
                                    =IFERROR(IF(INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))=0,"Active",IF(AND(OR(INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))=0,INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))="Cancelled",INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))="Lifted"),INDEX(Sheet1!$F:$F,MATCH($A2,Sheet1!$C:$C,0))=""),"Active","Not Active")),"Not Active")

                                    
                                      Select all
                                      Open in new window
                                    Check attached...
                                    Andrea_EE_AQ_Status_v4.xlsx</pre>

<pre class="amctext">Work like a charm, Shums - I'm delighted!
                                    
                                    Thanks so much...
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example with formula results in red (14 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/09_w36/1191549/EE_AQ_Status.xlsx">EE_AQ_Status.xlsx</a></p>
<p class="amcfile">Andrea_EE_AQ_Status.xlsx (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/09_w36/1191553/Andrea_EE_AQ_Status.xlsx">Andrea_EE_AQ_Status.xlsx</a></p>
<p class="amcfile">Index Match (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/09_w36/1191565/Andrea_EE_AQ_Status_v4.xlsx">Andrea_EE_AQ_Status_v4.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Revising a macro so it runs on the active spreadsheet rather than a specific (ie., Sheet 2) spreadsheet</h2>
<p class="amcdate">2016-05-03T16:09:53-0400</p>

<pre class="amctext">How do I revise this macro so that it runs on the spreadsheet that is active , as opposed to "Sheet 2"?
                          
                          
                          Sub WO_Validation()

    Dim ws As Worksheet
    Dim lr As Long
    Set ws = Sheets("Sheet 2")
    lr = ws.Cells(Rows.Count, 1).End(xlUp).Row
    ws.Range("B2:B" & lr).Formula = "=IFERROR(INDEX(WO,MATCH(A2,WO,0)),""WO not in current cycle"")"
    
End Sub

                          
                            Select all
                            Open in new window
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Try this.....
                                    
                                    
                                    Sub WO_Validation()

    Dim ws As Worksheet
    Dim lr As Long
    Set ws = ActiveSheet
    lr = ws.Cells(Rows.Count, 1).End(xlUp).Row
    ws.Range("B2:B" & lr).Formula = "=IFERROR(INDEX(WO,MATCH(A2,WO,0)),""WO not in current cycle"")"
    
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Perfect...thanks again!!</pre>

<pre class="amctext">Andrea, 
                                    I'm assuming you mean,
                                    
                                    How do I revise this macro so that it runs on the Sheet that is active , as opposed to "Sheet 2"?
                                    
                                    You would use the activesheet property, and replace line 5 with
                                    
                                    Set ws = Me.ActiveSheet</pre>

<pre class="amctext">You're welcome Andrea! Glad to help.</pre>

<pre class="amctext">Thanks, Jeremy...it looks like your response came in just after I closed the question.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Formula that includes two conditions</h2>
<p class="amcdate">2014-03-20T16:30:25-0400</p>

<pre class="amctext">I need a formula that includes both conditions below and that will populate Column D as follows:
                          If alpha-numeric text in Column A = column B and Column C is blank, then the word "Filematch" is inserted into Column D
                          If Column A is not blank, and alpha-numeric text in Column B = Column C, then the word "Unique chart" is inserted into Column D
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">I would say it would be close to
                                    
                                    =(IF(AND(A1=B1,C=''),"FILE MATCH",IF(AND(A1<>'',B1=C1),"UNIQUE CHART",''),'')
                                    
                                    I think that would work pretty close to what you need</pre>

<pre class="amctext">for conditions
                                    
                                    
                                      If alpha-numeric text in Column A = column B and Column C is blank, then the word "Filematch" is inserted into Column D
                                    
                                    you can use
                                    =IF(AND(A2=B2,C2=""),"Filematch","")</pre>

<pre class="amctext">Try this
                                    
                                    =IF(AND(A11=B11,C11=""),"FileMatch",IF(AND(NOT(A11=""),B12=C11),"Unique Chart",""))</pre>

<pre class="amctext">I tried the solutions in the order I received them, and this is the one that worked. Thanks for the quick response!
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Changing Countif to Sumif formula so works if external workbook is closed</h2>
<p class="amcdate">2014-03-11T13:57:27-0400</p>

<pre class="amctext">Workbook 2 (DailyMetrics.xlsm) contains the statistics based on data in Workbook 1 (CAP_29MAY.xlsm) using the "Countif" formula. But if Workbook 1 is closed, then Workbook 2 shows #VALUES instead of numbers. In researching this, it appears that Countif doesn't work when linking to closed Workbooks, but Sumif does. I am trying to convert my Countif formula to a Sumif formula, but the Sumif calculations vary from the Countif ones.
                          
                          Countif formula: (result is "12")
                          =COUNTIFS(CAP_29MAY2014.xlsm!LOE_Range,"Major",CAP_29MAY2014.xlsm!MasterCompUpdateRange,"<>",CAP_29MAY2014.xlsm!ADC_AMD_Range,"ADC*")
                          
                          Sumif formula: (result is "0")
                          =SUM(IF(CAP_29MAY2014.xlsm!LOE_Range="Major",IF(CAP_29MAY2014.xlsm!MasterCompUpdateRange="<>",IF(CAP_29MAY2014.xlsm!ADC_AMD_Range="ADC*",0)*1,0)))
                          
                          I need to know if I'm correct in saying that the Sumif formula will work if Workbook 1 is closed. If not, then is there an alternative formula that can be implemented to work under these conditions? And if so, then how do I translate my Countif formula to a Sumif formula correctly so I get the same results?
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">Can you post a sample workbook to know a bit what your talking about ?
                                    gowflow</pre>

<pre class="amctext">offhand
                                    you have COUNTIFS tha tis the formula you first referred to
                                    
                                    But after you show
                                    =SUM(IF(CAP_29MAY2014.xlsm!LOE_Range="Major",IF(CAP_29MAY2014.xlsm!MasterCompUpdateRange="<>",IF(CAP_29MAY2014.xlsm!ADC_AMD_Range="ADC*",0)*1,0)))
                                    
                                    This formula is not SUMIFS !!! it is a SUM that have IF statement, that is nothing to do with SUMIFS.
                                    
                                    So I suggest you post both workbook the one that have the formula and the one that have the data so I can make some tests for you and get you what you need.
                                    
                                    gowflow</pre>

<pre class="amctext">I believe the SUMIF formula in the syntax that you have needs to be array entered by pressing Ctrl Shift & Enter to confirm it. When doing so Excel will put {  } brackets around the formula.
                                    
                                    However, you don't have a SUM Range at the end of it, you have 3 criteria:
                                    LOE_Range = "Major"
                                    MasterCompUpdateRange ="<>" (Iassume you are aiming for not blank)
                                    ADC_AMD_Range = "ADC"
                                    Sum Range ???
                                    
                                    The equivalent to your COUNTIFS would be SUMIFS but unfortunately, you are right that the SUMIFS doesn't work when source workbook is closed.
                                    
                                    The other option would be to use SUMPRODUCT with similar syntax:
                                    
                                    =SUMPRODUCT((LOE_Range="Major")*(MasterCompUpdateRange="ADC")*(ADC_AMD_Range="ADC")*SumRange)
                                    
                                    Thanks
                                    Rob H</pre>

<pre class="amctext">Thanks for the quick feedback and explanation that my SUMIF formula isn't going to perform as a COUNTIF.
                                    
                                    Rob, your interpretation of the criteria is correct.
                                    
                                    Since my goal is to find a formula that works with a closed Workbook, which COUNTIF and SUMIF won't do, I tried the SUMPRODUCT formula above and it returned a #NAME? error. Any advice as to why that might be happening?
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">try your countIF formula as array
                                    click on the cell that have the countif formula press F2 then Press CTRL SHIFT ENTER at the same time
                                    then drag down. sometime COUNTIF as array work on closed workbooks.
                                    gowflow</pre>

<pre class="amctext">Hello Andrea,
                                    
                                    None of the COUNTIF/SUMIF/AVERAGEIF "family" of formulas works with closed workbooks - that's because those functions expect ranges (not arrays) as the arguments and when the ranges are retrieved from closed workbooks they become arrays, which doesn't work.
                                    
                                    I think you can use SUMPRODUCT, as Rob says, but one of your criteria uses a wildcard - that won't work in SUMPRODUCT (or within a SUM9IF array formula) so you need LEFT function - try like this:
                                    
                                    =SUMPRODUCT((CAP_29MAY2014.xlsm!LOE_Range="Major")*(CAP_29MAY2014.xlsm!MasterCompUpdateRange<>"")*(LEFT(CAP_29MAY2014.xlsm!ADC_AMD_Range,3)="ADC"))
                                    
                                    regards, barry</pre>

<pre class="amctext">Hi gowflow,
                                    
                                    I tried the COUNTIF as an array, but unfortunately it didn't make a difference. The #VALUE errror message cropped up when Workbook 1 was closed.
                                    
                                    Andrea</pre>

<pre class="amctext">Hello Andrea,
                                    
                                    Did you see my reply above?
                                    
                                    regards, barry</pre>

<pre class="amctext">Hi Barry, 
                                    
                                    I could have guessed you would be able to contribute when SUMPRODUCT was mentioned. Is that one of your search terms by any chance? I wasn't aware of the Wild Card restriction in SUMPRODUCT.
                                    
                                    Thanks
                                    Rob</pre>

<pre class="amctext">Andrea, apologies if you misunderstood my suggestion and just copied and pasted what I wrote; that was only intended as a guide for the syntax.
                                    
                                    I had missed the Wild Card element of the ADC range anyway!!
                                    
                                    Thanks
                                    Rob</pre>

<pre class="amctext">Hello Rob,
                                    
                                    Actually it's not strictly SUMPRODUCT where the problem lies - you can't use a wildcard when doing a straight comparison with =
                                    
                                    So, for example, if you use this formula
                                    
                                    =A1=xyz*
                                    
                                    that will only be true if A1 contains literally xyz*
                                    
                                    regards, barry</pre>

<pre class="amctext">Hi Barry,
                                    
                                    Thanks so much. This solution works exactly as hoped! BTW, I must have been posting my response to a previous suggestion at the same time you posted your solution, since it's only now, logging back in after my commute, that I'm seeing your answer...
                                    
                                    Thanks to everyone else who offered suggestions...
                                    
                                    Andrea</pre>

<pre class="amctext">Barry,
                                    
                                    How is your SUMPRODUCT getting a number when the three columns its referring to are text?
                                    
                                    Unless of course the column that is being checked for "not blank" is a number. If so, could this criterion go? If it were blank, it would return zero anyway, wouldn't it?
                                    
                                    Thanks
                                    Rob</pre>

<pre class="amctext">Hello Rob,
                                    
                                    In this case the SUMPRODUCT formula is simply replicating a COUNTIFS formula, i.e. counting rows where multiple conditions apply.
                                    
                                    SUMPRODUCT can be used for counting or summing so the equivalent of
                                    
                                    =COUNTIFS(A1:A10,"x",B1:B10,"y")
                                    
                                    is just
                                    
                                    =SUMPRODUCT((A1:A10="x")*(B1:B10="y"))
                                    
                                    in which the two arrays are multiplied against each other, thereby returning 1 for each row where both conditions are met, and when summed giving a count of rows that meet both conditions.
                                    
                                    ......but if you want to sum column C in rows where those conditions apply you can use SUMIFS
                                    
                                    =SUMIFS(C1:C10,A1:A10,"x",B1:B10,"y")
                                    
                                    or the SUMPRODUCT equivalent
                                    
                                    =SUMPRODUCT((A1:A10="x")*(B1:B10="y"),C1:C10)
                                    
                                    regards, barry</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Summing non-contiguous cells based on text criteria of another cell in Excel</h2>
<p class="amcdate">2017-04-12T22:35:47-0400</p>

<pre class="amctext">I need formulas for Column O and Column P based on the following criteria:
                          
                          If B2 = "No", or if B2 = "", then:
                          O2 = sum of D2, F2, H2, J2
                          P2 = sum of L2, N2
                          
                          If B2 = "Yes", then:
                          O2 = "0"
                          P2 = sum of D2, F2, H2, J2, L2, N2
                          
                          I have attached a sample spreadsheet.
                          
                          Thanks!
                          Andrea
                          EE_DM.xlsx</pre>

<pre class="amctext">Column O:  =IF(OR(B2="No", B2=""), SUM(D2,F2,H2,J2), 0)
                                    Column P:  =IF(B2="Yes", SUM(D2,F2,H2,J2,L2,N2),SUM(L2,N2))</pre>

<pre class="amctext">put these formulas
                                    
                                    O2:
                                    
                                    =IF( OR(B2="No", B2=""), D2 + F2 + H2 + J2, IF(B2 = "Yes", 0))

                                    
                                      Select all
                                      Open in new window
                                    
                                    P2:
                                    
                                    =IF( OR(B2="No", B2=""), L2 + N2, IF(B2="Yes", D2 + F2 + H2 + J2 + L2 + N2))

                                    
                                      Select all
                                      Open in new window
                                    
                                    drag the formula down for other cells.</pre>

<pre class="amctext">Thanks very much to you both for the quick response!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of desired results (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/04_w15/1156448/EE_DM.xlsx">EE_DM.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Modify a column by adding a prefix, changing the year format and reducing the number of digits</h2>
<p class="amcdate">2015-04-15T16:06:12-0400</p>

<pre class="amctext">We receive weekly reports listing changes. Column A contains ID #'s. For our purposes, we would like to modify the ID number as follows:
                          
                          
                          
                            Add a two-character alpha prefix: WO
                          
                          
                            Truncate the year from 4-digits to 2-digits
                          
                          
                            Reduce the number of digits following the dash from 7 digits to the last 5 digits
                          
                          
                          Example of original ID: 2015-0000247
                          Example of modified ID: WO 15-00247
                          
                          I've attached a sample spreadsheet.
                          
                          Thanks!
                          Andrea
                          Changing-ID-number.xlsx</pre>

<pre class="amctext">Create a new column with this formula. (assuming the 1st cell to change is in A1):
                                    
                                    =CONCATENATE("WO ", RIGHT(A1, 10))
                                    
                                    then drag it down or double click the plus sign on the bottom right of the cell.</pre>

<pre class="amctext">Actually try this one instead. sorry. 
                                    
                                    =CONCATENATE("WO ", MID(A2,3,3), RIGHT(A2,5))
                                    
                                    See the attached file.
                                    Changing-ID-number.xlsx</pre>

<pre class="amctext">Use this formula and drag it down to see the desired results..
                                    
                                    ="WO "&MID(A2,3,3)&RIGHT(A2,5)
                                    
                                    Saurabh...</pre>

<pre class="amctext">Terrific...both worked perfectly! Thanks very much...
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Changing-ID-number.xlsx (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2015/04_w16/908797/Changing-ID-number.xlsx">Changing-ID-number.xlsx</a></p>
<p class="amcfile">Changing-ID-number.xlsx (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2015/04_w16/908807/Changing-ID-number.xlsx">Changing-ID-number.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Find rows that contain one of 6 variations of specific character string and paste those rows into another worksheet</h2>
<p class="amcdate">2014-09-15T13:49:17-0400</p>

<pre class="amctext">Sheet 1 contains 54,000 rows of text and/or numbers. I am looking for a macro that will find those rows that contain any of the variations of the 6 RCO strings outlined below and copy those rows that meet this criteria into Sheet 2. The RCO string could be located anywhere within the row.
                          
                          Variations of RCO string:
                          "-RCO"
                          "- RCO"
                          "– RCO"
                          "–RCO"
                          "—RCO"
                          "— RCO"
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">You can achieve this with a user-defined function (UDF) like so:
                                    
                                    Function Find_Matches(Test_Cell As Range, Lookup_array As Range) As String
    Dim cl As Object
    For Each cl In Lookup_array
        If InStr(1, Test_Cell, cl.Value, vbTextCompare) > 0 Then
            Find_Matches = Find_Matches & cl.Value & ", "
        End If
    Next cl
    If Find_Matches <> "" Then
        Find_Matches = Left(Find_Matches, Len(Find_Matches) - 2)
    Else
        Find_Matches = "NOT FOUND"
    End If
End Function

                                    
                                      Select all
                                      Open in new window
                                    
                                    In Excel, you enter this function this way:
                                    =Find_Matches(text_to_search,range_of_values)
                                    
                                    For example, if your cell to check is in A2 and you have a list of values to check is on Sheet3 in cells A2:A9 then you'd enter:
                                    =Find_Matches(A2,Sheet3!$A$2:$A$9)
                                    
                                    The function will show ALL possible matches in a string, otherwise will return "NOT FOUND" (that result can be changed in the UDF, of course).
                                    
                                    You can copy this down, filter out the "NOT FOUND" values, and then copy/paste them to Sheet2.
                                    
                                    Regards,
                                    -Glenn</pre>

<pre class="amctext">...and here is a macro that will copy all values from Sheet1, Column A that have any of the six strings listed into Sheet2 (starting in row 2):
                                    
                                    Option Explicit
Sub Copy_RCO()
    Dim rng As Range
    Dim cl As Object
    Dim x As Integer
    Dim r As Long
    Dim arrRCO() As Variant
    
    arrRCO() = Array("-RCO", "- RCO", "– RCO", "–RCO", "—RCO", "— RCO")

    r = 2
    Sheets("Sheet1").Activate
    Set rng = Range("A2:A" & Cells.SpecialCells(xlLastCell).Row)
    For Each cl In rng
        For x = 0 To UBound(arrRCO())
            If InStr(1, cl.Value, arrRCO(x), vbTextCompare) > 0 Then
                Sheets("Sheet2").Cells(r, 1).Value = cl.Value
                r = r + 1
            End If
        Next x
    Next cl
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    Regards,
                                    -Glenn</pre>

<pre class="amctext">Hi Glenn,
                                    
                                    Thanks very much for both the UDF and the macro. I had success with the UDF, but the macro is giving me a run-time error '13', Type mismatch, on line 16:
                                    
                                     If InStr(1, cl.Value, arrRCO(x), vbTextCompare) > 0 Then
                                    
                                    It would be nice to have the macro option if possible.
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">Hi Glenn,
                                    
                                    On further investigation, I found I had a few rows that contained "#NAME?" that were causing the problem and preventing the macro from being able to run. Once I deleted those offending rows, the macro worked perfectly. 
                                    
                                    Thanks so much for the quick and thorough solutions!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Glad I was able to help. 
                                    
                                    Regards,
                                    -Glenn</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Need help getting SUMIF formula in Excel to work</h2>
<p class="amcdate">2014-07-02T13:34:46-0400</p>

<pre class="amctext">I have a spreadsheet containing a list of jobs in various states of completion. I want to create a formula that adds up only the minutes from the "GrandTotalMinutes" for those jobs that meet the following criteria listed in the named range called "JobPhase1_Range":
                          
                          QC-complete/ready to generate
                          See next ADC (done in conjunction)
                          
                          Below is a SUMIF formula I have constructed, but it is not giving me the correct total # of minutes. It appears to be adding just the first 2 cells in the named range "GrandTotalMinutes".
                          
                          =SUMIF(JobPhase1_Range,{"QC-complete/ready to generate","See next ADC (done in conjunction)"},GrandTotalMinutes)
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">can you post an example of your workbook?</pre>

<pre class="amctext">Excel won't recognize an array like this in a SUMIF statement; you'll need to use SUMPRODUCT:
                                    =SUMPRODUCT(SUMIF(JobPhase1_Range,{"QC-complete/ready to generate","See next ADC (done in conjunction)"},GrandTotalMinutes))
                                    
                                    You also need to check:
                                    
                                    
                                      Ensure that your two named ranges cover the same exact set of rows.
                                    
                                    If they start on different rows, you'll get erroneous results.
                                    
                                    
                                    
                                      Ensure that the two possible matching values in the Job Phase column EXACTLY MATCH your two strings in your array.
                                    
                                    Any extra spaces or characters will void a match.
                                    
                                    -Glenn</pre>

<pre class="amctext">Hi Glenn,
                                    
                                    I checked my named ranges and they did not cover the same set of rows, so once I fixed that issue I implemented your solution, and the formula worked perfectly.
                                    
                                    I'm very pleased...thanks, Glenn!
                                    
                                    Andrea</pre>

<pre class="amctext">You're welcome; I'm glad I was able to help.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Median formula not working</h2>
<p class="amcdate">2017-07-29T00:15:56-0400</p>

<pre class="amctext">I have an Excel spreadsheet called 'WO_Tracking'. There is another spreadsheet, called 'Linked', that is linked to 'WO_Tracking', and is formatted as an Excel table. There is a third spreadsheet called 'Summary' to serve as a dashboard for supervisors.
                          
                          In the Summary spreadsheet, in cell A2, I am trying to get the median (excluding cells with zero values) of Column F (Total Minutes) in the 'Linked' spreadsheets, using the following formula:
                          =MEDIAN(Table2[Total_Minutes])
                          
                          But I am only getting '0' as a result. 
                          
                          I have provided a sample workbook with all three spreadsheets included. The formula needs to be based on the 'Linked' spreadsheet, not the 'WO_Tracking' spreadsheet.
                          
                          Thanks!
                          Andrea
                          Linked_Spreadsheet_Median_Formula_E.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Replace your formula in summary sheet with this: =MEDIAN(IF(Table2>0,Table2)).
                                    
                                    Best regards.</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Please try below Array Formula confirmed with Ctrl+Shift+Enter:
                                    
                                    =MEDIAN(IF(Table2[Total_Minutes]>0,Table2[Total_Minutes]))

                                    
                                      Select all
                                      Open in new window
                                    Andrea_Linked_Spreadsheet_Median.xlsx</pre>

<pre class="amctext">Hi Yamaafg,
                                    
                                    Thanks for responding to my question. I tried your solution but got the same result of "0" as I was getting with my formula.
                                    
                                    Andrea</pre>

<pre class="amctext">Works like a charm -- thanks so much, Shums! :-)</pre>

<pre class="amctext">You're welcome Andrea! Pleased to help :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Median formula (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w30/1184599/Linked_Spreadsheet_Median_Formula_E.xlsx">Linked_Spreadsheet_Median_Formula_E.xlsx</a></p>
<p class="amcfile">Median Formula (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w30/1184611/Andrea_Linked_Spreadsheet_Median.xlsx">Andrea_Linked_Spreadsheet_Median.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Basing conditional formatting on more than one text string</h2>
<p class="amcdate">2015-12-22T11:43:44-0500</p>

<pre class="amctext">I am using the following formula in conditional formatting to change the cell in column AE to yellow when the criteria is met:
                          
                          =AND(ISBLANK(AE2)=FALSE, ISNUMBER(SEARCH("DND",D2)))
                          
                          I need to revise the formula to include an additional string of "MDN", so that the criteria is now:
                          
                          If AE2 is not blank, and D2 has text string "DND" or "MDN", then change cell AE2 to yellow
                          
                          I took a stab at trying to solve it myself with the following formula but it did not work for either "DND" or "MDN":
                          
                          =AND(ISBLANK(AE2)=FALSE,IF(OR(ISNUMBER(SEARCH("DND",D2))),ISNUMBER(SEARCH("MDN",D2)))
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">here is the working formula.
                                    
                                    =IF(AND(ISBLANK(AE2)=FALSE,OR(ISNUMBER(SEARCH("DND",D2)),ISNUMBER(SEARCH("MDN",D2)))),1)</pre>

<pre class="amctext">Try this...
                                    
                                    
                                    =AND(AE2<>"",OR(ISNUMBER(SEARCH("DND",D2)),ISNUMBER(SEARCH("MDN",D2))))

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Both formulas work perfectly...thanks, folks! Since I'm forced to identify the 'best solution', and I'm not an expert, I made a choice based on the length of the formula, figuring a shorter formula is better, but please don't hesitate to correct me if this is an erroneous assumption.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're welcome Andrea! Glad we could help.</pre>

<pre class="amctext">Andrea
                                    while my IF condition was unnecessary, i have put it to portray a better picture otherwise it works like this =AND(ISBLANK(AE2)=FALSE,OR(ISNUMBER(SEARCH("DND",D2)),ISNUMBER(SEARCH("MDN",D2))))
                                    
                                    but i prefer using the ISBLANK instead of nullstring  ""  becuase lets say if you have a formula  in cell AE2 where the result is a double qoure (nullstring" in that case it <>""  then in that case the formula would not work.
                                    
                                    so isblank is much preferable.  
                                    
                                    i am happy with split of points between me and my friend sktneer.
                                    
                                    at the end what matter is that you get your solution,  i do not really care much about points.</pre>

<pre class="amctext">Thank you, Professor Jim Jam, for your explanation...much appreciated!</pre>

<pre class="amctext">You are welcome</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">How do I truncate within a concatenation?</h2>
<p class="amcdate">2015-04-09T17:25:18-0400</p>

<pre class="amctext">Column A has a prefix: CAT
                          Column B has a category #: can be up to 3 digits (for example, 22)
                          Column C is the year: needs to be in 4-digit format for chronological sorting (for example, 2000)
                          Column D is the concatenated results: Column A + " " + Column B + "/" + last 2 digits of Column C (CAT 22/00)
                          
                          I know how to concatenate, but not how to truncate the year within the concatenated formula.
                          
                          I have attached a sample spreadsheet to help illustrate what I'm after. 
                          
                          Thanks!
                          Andrea
                          EE-Example-Concatenate-TruncateYear.xlsx</pre>

<pre class="amctext">Use this
                                    =A2&" "&B2&"/"&RIGHT(C2,2)</pre>

<pre class="amctext">Use this formula in A2..
                                    
                                    =A2&" "&B2&"/"&RIGHT(D2,2)
                                    
                                    And simply drag this..
                                    
                                    Saurabh...</pre>

<pre class="amctext">Your workbook attached...
                                    
                                    Correction in the above formula it will be C2
                                    
                                    =A2&" "&B2&"/"&RIGHT(C2,2)
                                    
                                    Saurabh...
                                    EE-Example-Concatenate-TruncateYear.xlsx</pre>

<pre class="amctext">Works perfectly. Thanks to you both for your quick responses!
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of desired concatenated results (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2015/04_w15/907826/EE-Example-Concatenate-TruncateYear.xlsx">EE-Example-Concatenate-TruncateYear.xlsx</a></p>
<p class="amcfile">data (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2015/04_w15/907829/EE-Example-Concatenate-TruncateYear.xlsx">EE-Example-Concatenate-TruncateYear.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Change a formula in one cell based on the value in another cell</h2>
<p class="amcdate">2013-12-19T10:49:45-0500</p>

<pre class="amctext">The following formula resides in column N:
                          =IFERROR(LOOKUP(2,1/('M:\xxx\[XXX_2014.xlsm]Workflow'!$H$2:$H$676=M2),'M:\xxx\[XXX_2014.xlsm]Workflow'!$J$2:$J$676),"")
                          
                          I need to add a second formula in column N that references a different workbook that is very similar in structure but contains different data. The formula is as follows:
                          =IFERROR(LOOKUP(2,1/('M:\aaa\[XXX_2014.xlsm]Workflow'!$H$2:$H$676=M2),'M:\aaa\[XXX_2014.xlsm]Workflow'!$J$2:$J$676),"")
                          
                          The trigger to determine which formula to use in column N is determined by the value in column V as follows:
                          
                          If column V contains the phrase "Book 3", then use the SECOND formula above.
                          Otherwise, if column V is blank or contains any other phrase, then use the FIRST formula above.
                          
                          How do I revise the current formula to meet the new requirements?
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">You should be able to use a IF statement for that:
                                    
                                    
                                    IF(V1="Book 3", IFERROR(LOOKUP(2,1/('M:\aaa\[XXX_2014.xlsm]Workflow'!$H$2:$H$676=M2),'M:\aaa\[XXX_2014.xlsm]Workflow'!$J$2:$J$676),""), IFERROR(LOOKUP(2,1/('M:\xxx\[XXX_2014.xlsm]Workflow'!$H$2:$H$676=M2),'M:\xxx\[XXX_2014.xlsm]Workflow'!$J$2:$J$676),""))

                                    
                                      Select all
                                      Open in new window
                                    Just change V1 to the row you need to refer to.
                                    
                                    Flyster</pre>

<pre class="amctext">Can be further reduced to
                                    
                                    =IFERROR(LOOKUP(2,1/if(v2="Book 3",('M:\aaa\[XXX_2014.xlsm]Workflow'!$H$2:$H$676=M2),'M:\aaa\[XXX_2014.xlsm]Workflow'!$J$2:$J$676),('M:\xxx\[XXX_2014.xlsm]Workflow'!$H$2:$H$676=M2),'M:\xxx\[XXX_2014.xlsm]Workflow'!$J$2:$J$676)),"")</pre>

<pre class="amctext">Will both source books be open at the same time as the destination book?
                                    
                                    If so, you could use INDIRECT and pull together the file path string using IF statements creating a different string for the two different files depending on the criteria specified.
                                    
                                    If the source books will be closed, this won't work because INDIRECT doesn't work on closed books.
                                    
                                    Thanks
                                    Rob H</pre>

<pre class="amctext">The source books will not always be open, but thanks for the suggestion.
                                    
                                    I'm just implementing the formulas proposed above and should have feedback soon.
                                    
                                    Andrea</pre>

<pre class="amctext">Thanks for the prompt responses and excellent solutions!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Word macro that references an Excel file to update work order numbers</h2>
<p class="amcdate">2019-02-16T10:41:26-0500</p>

<pre class="amctext">I would like a macro for Word 2016 that searches through the file for each work order number, then checks for the work order number in Column A of an Excel list, and if found, then replaces the work order number in the Word file based on the value listed in Column C of the Excel list. (Column C is a formula that concatenates Column A [the work order number] and Column B [initials]).
                          
                          Additional notes:
                          
                          
                            Excel spreadsheet is in a table format
                          
                          
                            Column A and Column C are dynamic named ranges, as the number of work orders listed in the spreadsheet will change/fluctuate
                          
                          
                            I would like the original formatting of the work order number in Word to be retained when the work order number is updated in the file.
                          
                          
                            If the work order is not found in Column A of the Excel file, then no action is required in the Word file.
                          
                          
                          The format of the work order number is:
                           ####-####### (4 numbers, followed by a dash, then 7 numbers)
                          
                          I have attached the following files:
                          1. Cycle_Changes_Depot.docx
                          2. WO_Initials_List.xlsm
                          3. Cycle_Changes_Depot_After_Update.docx (this is an example file of the results I am looking for after the macro is run)
                          
                          I hope I've included all the relevant information/files. Please let me know if you have any questions or need anything further.
                          
                          Thanks!
                          Andrea
                          Cycle_Changes_Depot.docx
                          Cycle_Changes_Depot_After_Update.docx
                          WO_Initials_List.xlsm</pre>

<pre class="amctext">It isn't clear which file is meant in the first sentence, so this Excel-hosted macro will simply step throught the sheet and modify the input document.
                                    
                                    Sub AugmentWO()
    Dim wdApp As Word.Application
    Dim wdDoc As Word.Document
    Dim strWO As String
    Dim strConcatenate As String
    Dim xlWks As Excel.Worksheet
    Dim r As Integer
    Dim strWordFile As String
    
    Set xlWks = Sheets("WO_Initial")
    r = 2
    
    'create a word application instance if necessary
    On Error Resume Next
        Set wdApp = GetObject(, "Word.Application")
    On Error GoTo 0
    If wdApp Is Nothing Then
        Set wdApp = CreateObject("Word.Application")
    End If
    
    'open the document
    strWordFile = "J:\Allwork\ee\29136233\Cycle_Changes_Depot.docx"
    Set wdDoc = wdApp.Documents.Open(strWordFile)
    
    'do find and replace for each valid row of the sheet
    Do
        strWO = xlWks.Cells(r, 1)
        strConcatenate = xlWks.Cells(r, 3)
        r = r + 1
        With wdDoc.Range.Find
            .Text = strWO
            .Replacement.Text = strConcatenate
            .Execute Replace:=wdReplaceAll
        End With
    Loop Until xlWks.Cells(r, 1) = ""
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Graham,
                                    
                                    Thanks for your quick response. I've added this macro into my Excel file. When I try to run it, I get a compile error on the following line:
                                    
                                    
                                    Dim wdApp As Word.Application

                                    
                                      Select all
                                      Open in new window
                                    
                                    I have attached the screen capture of the error in hopes that it can be resolved...
                                    
                                    Thanks,
                                    Andrea
                                    Compile_Error.PNG</pre>

<pre class="amctext">Hi Graham,
                                    
                                    Update: I figured out the issue above (Tools > References > checking MS Word) and then ran the macro, which worked perfectly, thanks! So please ignore my previous response.
                                    
                                    One thing I realize now, and should have included in my question, is that we will be running it on the same Word files more than once as we add new work orders, so there will be a mix of work order numbers: some that have already been updated to match Column C of the Excel file, and some that are not updated.
                                    
                                    Currently, when I rerun the macro, it adds additional instances of "(*)", as shown below:
                                    
                                    2017-0004801 (TPG) (TPG)
                                    
                                    Is it possible to have the macro revised so that:
                                    If the work order number is found in Column A, and the work order number in the Word file already matches the value in Column C of the Excel file, then no action required.
                                    
                                    Graham, given that this is an additional request, please don't hesitate to let me know if I should be posing this as a new question instead of adding it to this one.
                                    
                                    Thanks again for your assistance,
                                    Andrea</pre>

<pre class="amctext">Sorry -  I was away for an extended weekend. Well done for figuring out that I had neglected to tell you that a reference was needed.
                                    
                                    I have added a few lines to the code:
                                    
                                    Sub AugmentWO()
    Dim wdApp As Word.Application
    Dim wdDoc As Word.Document
    Dim strWO As String
    Dim strConcatenate As String
    Dim xlWks As Excel.Worksheet
    Dim r As Integer
    Dim strWordFile As String
    
    Set xlWks = Sheets("WO_Initial")
    r = 2
    
    'create a word application instance if necessary
    On Error Resume Next
        Set wdApp = GetObject(, "Word.Application")
    On Error GoTo 0
    If wdApp Is Nothing Then
        Set wdApp = CreateObject("Word.Application")
    End If
    
    'open the document
    strWordFile = "J:\Allwork\ee\29136233\Cycle_Changes_Depot.docx"
    Set wdDoc = wdApp.Documents.Open(strWordFile)
    
    'do find and replace for each valid row of the sheet
    Do
        strWO = xlWks.Cells(r, 1)
        strConcatenate = xlWks.Cells(r, 3)
        r = r + 1
        With wdDoc.Range.Find
            .Text = strConcatenate 'look for concatenated text
            If Not .Execute Then
                .Text = strWO 'not there, so perform change
                .Replacement.Text = strConcatenate
                .Execute Replace:=wdReplaceAll
            End If
        End With
    Loop Until xlWks.Cells(r, 1) = ""
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Graham,
                                    
                                    I'm sorry for my tardiness in responding - I was assigned to a special project this week and so this has been my first chance to review the updated macro. It works perfectly - I'm very pleased. Thanks so much!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Word file before macro is run (28 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/02_w07/1412478/Cycle_Changes_Depot.docx">Cycle_Changes_Depot.docx</a></p>
<p class="amcfile">Example of results after macro is run (28 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/02_w07/1412479/Cycle_Changes_Depot_After_Update.docx">Cycle_Changes_Depot_After_Update.docx</a></p>
<p class="amcfile">Excel list of work order numbers (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/02_w07/1412480/WO_Initials_List.xlsm">WO_Initials_List.xlsm</a></p>
<p class="amcfile">Screen capture of compile error (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/02_w08/1412536/Compile_Error.PNG">Compile_Error.PNG</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Count of uniques in one column based on criteria in another column</h2>
<p class="amcdate">2014-08-13T14:20:36-0400</p>

<pre class="amctext">Column B contains primarily 4-digit numbers stored as text, with the balance of rows that are either blank or have a single word in the cell (I don't have control of how this data is entered, unfortunately). Column C contains initials + date, with some rows that include "N/A" at the end, as shown below:
                          
                          Column C
                          MN–18 Jun 14
                          MC–16 Jun 14 N/A
                          AC–13 May 14
                          MN–25 May 14 N/A
                          
                          I would like a formula that returns a count of the # of unique 4-digit characters in Column B for all the rows where Column C doesn't not contain "N/A". 
                          
                          I've attached a sample spreadsheet.
                          
                          Thanks!
                          Andrea
                          --of-unique-book-IDs.xlsm</pre>

<pre class="amctext">Hello Andrea,
                                    
                                    When you say "unique" I'm assuming you really mean "different", i.e. the number of different 4 digit codes
                                    
                                    I used this formula
                                    
                                    =SUM(IF(FREQUENCY(IF(RIGHT(C2:C1000,3)<>"N/A",IFERROR(B2:B1000+0,-1)),IFERROR(B2:B1000+0,0)),1))
                                    
                                    confirmed with CTRL+SHIFT+ENTER
                                    
                                    and that gave me a result of 322
                                    
                                    regards, barry</pre>

<pre class="amctext">Hi Barry,
                                    Thanks for the quick response. I was verifying the result of 322 by doing this manually (filtering out the n/a's in column C, then filtering out all but the 4-digit numbers in column B, copying and pasting results of Column B into a new sheet and using "Remove duplicates") and I got 321. I did it several times, always with the same result of 321. Is there a chance the heading is being included in the formula, giving the result of 322?
                                    
                                    Andrea</pre>

<pre class="amctext">Yes, you're right, apologies - I tried adjusting that formula several different ways without success so try this different approach to get 321
                                    
                                    =SUM(IF(ISNUMBER(MATCH(ROW(INDIRECT("1:10000")),IF(RIGHT(C2:C1000,3)<>"N/A",B2:B1000+0),0)),1))
                                    
                                    still confirmed with CTRL+SHIFT+ENTER
                                    
                                    regards, barry</pre>

<pre class="amctext">Works like a charm...thanks, Barry, much appreciated!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">--of-unique-book-IDs.xlsm (62 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w33/866168/--of-unique-book-IDs.xlsm">--of-unique-book-IDs.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Conditional formatting based on multiple criteria</h2>
<p class="amcdate">2014-09-18T11:56:29-0400</p>

<pre class="amctext">I would like to implement conditional formatting in my Excel sheet as follows:
                          
                          A2 cell background turns green if the following 2 criteria are met:
                          B2 is blank
                          C2 = "DOG 1" or "DOG 2" or "DOG 3" or "DOG 4" or "DOG 5"
                          
                          Is is possible to do this with the Conditional Formatting feature, or is VBA required? I have attached a simple spreadsheet as an example of what I am looking for.
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">No attachment! :-)
                                    
                                    However, it should be possible to check for this condition by creating the following rule in Conditional Formatting:
                                    =AND($B2="",OR($C2="DOG 1", $C2="DOG 2",$C2="DOG 3",$C2="DOG 4",$C2="DOG 5"))
                                    
                                    -Glenn</pre>

<pre class="amctext">Yes -
                                    Select A2.
                                    Go to Home - Conditional Formatting - New Rule
                                    select "Use a formula to determine which cells to format"
                                    Type the following in Format values where this formula is true:
                                    
                                    =and(b2="",or(c2="DOG 1",C2="DOG 2",C2="DOG 3",C2="DOG 4",C2="DOG 5"))
                                    
                                    Click Format... and select your formatting. Click OK.
                                    Then click OK.</pre>

<pre class="amctext">Appending...sample file attached.
                                    
                                    -Glenn
                                    EE-Q-28521167.xlsx</pre>

<pre class="amctext">Thanks for providing solutions so quickly...much appreciated! Sorry about forgetting the attachment...! Given that both responses came in within a couple of minutes of each other, I've shared the points. I identified the first solution as the best one, since it was first and it included the "$" in the formula which was beneficial.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">sample conditional formatting (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/09_w38/872961/EE-Q-28521167.xlsx">EE-Q-28521167.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Looking to SQL to see if it can streamline a cumbersome Excel task</h2>
<p class="amcdate">2018-03-11T14:01:57-0400</p>

<pre class="amctext">There is a bimonthly task that I do, comparing ~ 4000 rows of data in Excel between the 'Start' and 'End' of a production cycle to determine the changes that occurred. Currently I'm using index-match in a rather cumbersome process in Excel to get my results. I am hoping there is a much faster way of doing this task, and to that end am posting my question in the Access forum in case SQL is an option.
                          
                          Description:
                          I'm looking for a (?SQL query) based on two tables (EE_Start_Final and EE_End_Final tables) that extracts a list of all Chart #'s from both tables that meet the following criteria:
                          [Chart #] in Start table <> [Chart #] in End table
                          OR
                          [Chart #] in End table <> [Chart #] in Start table
                          OR
                          [Chart #]&[Type] in Start table <> [Chart #]&[Type] in End table
                          OR
                          [Chart #]&[BookA_#] in Start table <>[Chart #]&[BookA_#] in End table
                          OR
                          [Chart #]&[BookB_#] in Start table <>[Chart #]&[BookB_#] in End table
                          OR
                          [Chart #]&[BookC] in Start table <>[Chart #]&[BookC] in End table
                          
                          The resulting Query table extracted based on the above criteria to include, in following order:
                          LIst of (unique)[Chart #]'s
                          [Type] from Start table
                          [Type] from End table
                          [BookA_#] from Start table
                          [BookA_#] from End table
                          [BookB_#] from Start table
                          [BookB_#] from End table
                          [BookC] from Start table
                          [BookC] from End table
                          
                          I have attached a sample database with the Start and End tables as described. I did try a union join in SQL, but wasn't able to proceed any further and wasn't sure if that was the direction to take.
                          
                          Please let me know if you have any questions. Also, if you recommend using another approach or software instead of Access, or if you think Excel can do the job better, please include your recommendations. Excel is the most readily available tool in my environment at the moment, which is why I've been it for solutions but if MS Access can do the job better, then that software can be made available to me.
                          
                          Thanks!
                          Andrea
                          Cycle_Start_End_Compare.accdb</pre>

<pre class="amctext">Given those two sets of data, what is your desired output?
                                    
                                    Combinations like this:
                                    
                                    [Chart #] in Start table <> [Chart #] in End table
                                    OR
                                    [Chart #] in End table <> [Chart #] in Start table
                                    
                                    Are called a full outer join in database terminology.  They are implemented by creating a left join query and a right join query and then unioning the two.
                                    
                                    You should also reconsider your naming standard since you are moving to a relational database.  Object names should use only the upper and lower case letters, numbers, and the underscore.  I prefer CamelCase which capitalizes the first letter of each word over the_underscore which separates words with the underscore.  NEVER use embedded spaces or special characters such as the #.  Also do not use Access, VBA, or SQL function or property names such as Name, Month, Year since they can cause subtle errors or conflicts.  For example, is Me.Name the name of your form or is it a control named "Name" on your form?</pre>

<pre class="amctext">Hi,
                                    
                                    Below will be your SQL query based on information provided:
                                    
                                    
                                    SELECT DISTINCT
	s.[Chart #],
	e.[Chart #],
	s.[Type],
	e.[Type],
	s.[BookA_#],
	e.[BookA_#],
	s.[BookB_#],
	e.[BookB_#],
	s.[BookC],
	e.[BookC]
FROM EE_Start_Final s 
INNER JOIN EE_End_Final e ON
	s.[Chart #] <> e.[Chart #] OR
	s.[Chart #] + s.[Type] <> e.[Chart #] + e.[Type] OR
	s.[Chart #] + s.[BookA_#] <> e.[Chart #] + e.[BookA_#] OR
	s.[Chart #] + s.[BookB_#] <> e.[Chart #]+ e.[BookB_#] OR
	s.[Chart #] + s.[BookC] <> e.[Chart #] + e.[BookC] 

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">E.g. 
                                    
                                    
                                    SELECT *
FROM EE_Start AS S 
  INNER JOIN EE_End AS E ON S.UniqueChart = E.UniqueChart
WHERE (((S.[Chart #])<>[E].[Chart #])) 
  OR (((S.Type)<>[ E].[Type])) 
  OR (((S.[Book_A_#])<>[E].[Book_A_#])) 
  OR (((S.[Book_B_#])<>[E].[Book_B_#])) 
  OR (((S.Book_C)<>[E].[Book_C]));

                                    
                                      Select all
                                      Open in new window
                                    
                                    You don't need to test for the concatenated values with [Chart #], cause you test it already on its own. 
                                    
                                    The onle question is: can rows be added or deleted? Then you need a FULL JOIN.</pre>

<pre class="amctext">Thanks for the quick responses, which I am going through now and trying them out...
                                    
                                    Ste5an, rows can be added and deleted, so it sounds like I need a FULL JOIN. How would I modify the code for that? Also, when I ran the query I got a dialog box saying 'Enter parameter value' for 'E.Type'...how do I rectify that.
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">The dialog box comes from a typo. It must be [E].[Type] not [ E].Type:
                                    
                                    
                                    SELECT *
FROM EE_Start AS S 
  INNER JOIN EE_End AS E ON S.UniqueChart = E.UniqueChart
WHERE (((S.[Chart #])<>[E].[Chart #])) 
  OR (((S.Type)<>[E].[Type])) 
  OR (((S.[Book_A_#])<>[E].[Book_A_#])) 
  OR (((S.[Book_B_#])<>[E].[Book_B_#])) 
  OR (((S.Book_C)<>[E].[Book_C]));

                                    
                                      Select all
                                      Open in new window
                                    
                                    As already posted, you need to simulate it:
                                    
                                    
                                    SELECT 'C' AS ChangeType, *
FROM EE_Start AS S
INNER JOIN EE_End AS E ON S.UniqueChart = E.UniqueChart
WHERE
 (((S.[Chart #])<>[E].[Chart #])) OR (((S.Type)<>[E].[Type])) OR (((S.[Book_A_#])<>[E].[Book_A_#])) OR (((S.[Book_B_#])<>[E].[Book_B_#])) OR (((S.Book_C)<>[E].[Book_C]))
UNION ALL
SELECT 'D' AS ChangeType, *
FROM EE_Start AS S
LEFT JOIN EE_End AS E ON S.UniqueChart = E.UniqueChart
WHERE E.UniqueChart IS NULL
UNION ALL
SELECT 'A' AS ChangeType, *
FROM EE_Start AS S
RIGHT JOIN EE_End AS E ON S.UniqueChart = E.UniqueChart
WHERE S.UniqueChart IS NULL

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">@Andreamary
                                    None of the suggested queries returns the set of data I think you need and they all have typos.  Once we see what you want returned, that will clarify what the query needs to do.
                                    
                                    PS - although the + works as a concatenation operator under some conditions, it works differently than the & which is the standard Access query concatenation operator.  So, unless you want the specific property that + provides, always use the &.
                                    
                                    A + B = sum of a + b when both are numeric
                                    A + B = AB when one or both are strings
                                    A + B = Null when one or both values are null
                                    
                                    A & B = always = AB  even when both are numeric or one of them is null.</pre>

<pre class="amctext">Hi all,
                                    
                                    Pat, thank you for your guidance on Access. As you can probably tell, I have very little recent experience in it, and none in SQL. To clarify the results I am after, I have attached the expected results (included the column order I am hoping for) of this query in an Excel spreadsheet (since this is the current and only way I know how to do this task). 
                                    
                                    Nishant, I tried your solution but received many errors unfortunately.
                                    
                                    Ste5an, thanks for your updated solution. In terms of the charts listed, they almost matched the results I was expecting. The one chart that was missing — City 1-Chart4-E — should be listed due to changes in the book section of the comparison, in Book B and in Book C. This is captured in my results as attached. Is it possible for the code to be revised so this change is captured? Also, is it possible for the results to be formatted with the same columns, in the same order, as my attached results? Not being savvy in Access myself, I'm not sure if what I am asking is possible or realistic.
                                    
                                    Thanks again for your contributions...
                                    
                                    Andrea
                                    Start_End_Changes_Results.xlsx</pre>

<pre class="amctext">The problem is, that there is a NULL instead of a empty string. In databases these are two different things. Even when they look the same in the grid view.
                                    
                                    Either
                                    
                                    
                                    SELECT 'C' AS ChangeType ,
       *
FROM   EE_Start S
       INNER JOIN EE_End E ON S.UniqueChart = E.UniqueChart
WHERE     Nz(S.[Chart #] , '') <> Nz(E.[Chart #] , '')
       OR Nz(S.[Type]    , '') <> Nz(E.[Type]    , '')
       OR Nz(S.[Book_A_#], '') <> Nz(E.[Book_A_#], '')
       OR Nz(S.[Book_B_#], '') <> Nz(E.[Book_B_#], '')
       OR Nz(S.[Book_C]  , '') <> Nz(E.[Book_C]  , '')
UNION ALL
SELECT 'D' AS ChangeType ,
       *
FROM   EE_Start S
       LEFT JOIN EE_End E ON S.UniqueChart = E.UniqueChart
WHERE  E.UniqueChart IS NULL
UNION ALL
SELECT 'A' AS ChangeType ,
       *
FROM   EE_Start S
       RIGHT JOIN EE_End E ON S.UniqueChart = E.UniqueChart
WHERE  S.UniqueChart IS NULL;

                                    
                                      Select all
                                      Open in new window
                                    or
                                    
                                    
                                    SELECT 'C' AS ChangeType ,
       *
FROM   EE_Start S
       INNER JOIN EE_End E ON S.UniqueChart = E.UniqueChart
WHERE     S.[Chart #]  & '' <> E.[Chart #]  & ''
       OR S.[Type]     & '' <> E.[Type]     & ''
       OR S.[Book_A_#] & '' <> E.[Book_A_#] & ''
       OR S.[Book_B_#] & '' <> E.[Book_B_#] & ''
       OR S.[Book_C]   & '' <> E.[Book_C]   & ''
UNION ALL
SELECT 'D' AS ChangeType ,
       *
FROM   EE_Start S
       LEFT JOIN EE_End E ON S.UniqueChart = E.UniqueChart
WHERE  E.UniqueChart IS NULL
UNION ALL
SELECT 'A' AS ChangeType ,
       *
FROM   EE_Start S
       RIGHT JOIN EE_End E ON S.UniqueChart = E.UniqueChart
WHERE  S.UniqueChart IS NULL;

                                    
                                      Select all
                                      Open in new window
                                    
                                    Cause SQL has a tri-value logic with NULL and comparison with NULL is special: 'test' <> NULL evaluates to UNKOWN, not to TRUE. Such test require the special IS NULL or IS NOT NULL test predicates. 
                                    
                                    Or we use Nz(valu1, value2). If value1 is NULL, then the second value is returned.
                                    
                                    Or we use the specialty of the string concatenation of NULL & '' which becomes '' (empty string).</pre>

<pre class="amctext">Thanks so much for your solution (and explanation)...much appreciated, Ste5an! Using this approach in Access will save me a lot of time. :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You can colorize the differences on a report or form by using Conditional Formatting.  Please start a new thread if you need help with that.</pre>

<pre class="amctext">Thanks, Pat,, for that information....
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're welcome.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Cycle_Start_End_Compare.accdb (448 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/03_w11/1284420/Cycle_Start_End_Compare.accdb">Cycle_Start_End_Compare.accdb</a></p>
<p class="amcfile">Expected results in Excel format (8 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/03_w11/1284562/Start_End_Changes_Results.xlsx">Start_End_Changes_Results.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Expanding index-match formula to search for first non-blank cell in column</h2>
<p class="amcdate">2013-08-28T14:28:49-0400</p>

<pre class="amctext">I have an index-match formula that I need to change so that it goes to the first non-blank cell in the column and returns the result. Currently, the formula does not proceed beyond its first match, therefore sometimes returning "n/a" when, in fact, there is a value. I've attached a sample file demonstrating this. The first worksheet contains the book data, the second worksheet contains the results I'm getting using the formula below, and the third worksheet shows the results I want.
                          
                          =IFERROR(INDEX(Book_Data!$D$2:$D$17,MATCH(A2,Book_Data!$C$2:$C$17,0)),"n/a")
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">Hello Andrea, there's no attachment here. Would you like to explain how it should work - you want a value returned even if A2 isn't found in Book_Data!$C$2:$C$17?
                                    
                                    regards, barry</pre>

<pre class="amctext">Hi Barry,
                                    
                                    Sorry about that. I've now attached the file!
                                    
                                    Andrea
                                    Index-Match-Sample.xls</pre>

<pre class="amctext">I used the following array-entered formula:
                                    =IFERROR(INDEX(Bookings,MIN(IF((INDEX(Bookings,,1)=$A2)*(INDEX(Bookings,,MATCH(B$1,Book_Data!$A$1:$E$1,0))<>""),ROW(Bookings)-ROW(Book_Data!$A$2)+1,"")),MATCH(B$1,Book_Data!$A$1:$E$1,0)) & "","")
                                    
                                    To make the above formula work, I created a dynamic named range called Bookings that will grow with the amount of data you have. It has a Refers To formula of:
                                    =Book_Data!$A$2:INDEX(Book_Data!$E$2:$E$65536,COUNTA(Book_Data!$A$2:$A$65536))
                                    
                                    I also needed to have unique column header labels. So I changed column A to "BOOKINGS" on both worksheeets Book_Data and Desired_Results
                                    
                                    To array-enter a formula:
                                    1.  Click in the formula bar
                                    2.  Hold Control and Shift keys down
                                    3.  Hit Enter, then release all three keys
                                    Excel should respond by adding curly braces { } surrounding the formula
                                    
                                    Formula is installed in cells E2:G5 of worksheet Desired_Results.
                                    Index-Match-SampleQ28225256.xlsm</pre>

<pre class="amctext">Excellent! Thanks so much for the quick turnaround on this, too!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of current formula results vs mock-up of desired results (33 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/08_w35/674289/Index-Match-Sample.xls">Index-Match-Sample.xls</a></p>
<p class="amcfile">Sample file (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/08_w35/674303/Index-Match-SampleQ28225256.xlsm">Index-Match-SampleQ28225256.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">In Excel, find first column in row with value > 0 and populate column N with the date listed in the heading row of this first column</h2>
<p class="amcdate">2017-10-25T20:39:06-0400</p>

<pre class="amctext">In column M of the attached spreadsheet, I have a formula (thanks to this forum) that identifies the last date that each work order was worked on:
                          
                          
                          =LOOKUP(2,1/(B3:L3<>0),B$1:L$1)

                          
                            Select all
                            Open in new window
                          
                          I now need to identify the earliest date that each work order was worked on in Column N of the same spreadsheet, as follows:
                          
                          
                            For each row in Column N in Sheet1 of spreadsheet, find the first column between Col B and Col L that has a value > 0, and then enter the date listed in the heading row of this first column into the cell of the corresponding row under Column N.
                          
                          
                          I have attached a sample spreadsheet and have populated the desired results in red in Column N, as well as shaded the corresponding 'first column' cells in orange to illustrate what I am after.
                          
                          Thanks!
                          Andrea
                          EE_First_Date.xlsx</pre>

<pre class="amctext">Hi,
                                    
                                    See attached.
                                    
                                    Alan.
                                    EE-29064726-EE_First_Date-Version1.xlsx</pre>

<pre class="amctext">Perfect - thanks so much, Alan!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're most welcome Andrea - happy to help.
                                    
                                    Alan.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example with desired results in Column N (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201413/EE_First_Date.xlsx">EE_First_Date.xlsx</a></p>
<p class="amcfile">EE-29064726-EE_First_Date-Version1.xlsx (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201415/EE-29064726-EE_First_Date-Version1.xlsx">EE-29064726-EE_First_Date-Version1.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Need Excel macro to populate a column based on two criteria that includes referencing a second tab</h2>
<p class="amcdate">2019-08-14T10:54:15-0400</p>

<pre class="amctext">I have a spreadsheet with two tabs: WO_List and Depot_WOs. I need a macro to populate the WO_List tab's Column F (IFP Initials) based on following criteria:
                          If Column F (IFP Initials) is blank AND the WO # in Column A (WO) of the WO_List is in Column A (Depot_WOs) of the Depot_WOs tab, then populate Column F (IFP Initials) with "Non-IP"; otherwise, leave blank
                          
                          Pseudo-code:
                          IF WO_List $F2 = BLANK, and if WO_List $A2 = Depot_WOs(A:A), then "Non-IFP", otherwise ""
                          
                          I've attached a sample spreadsheet.
                          
                          Screen capture showing that first row met criteria, so Col F populated with "Non-IP"
                          Example.PNG
                          EE_Depot_WOs.xlsm</pre>

<pre class="amctext">Please give this a try....
                                    
                                    Place the following code on a Standard Module like Module1.
                                    
                                    
                                    Sub PopulateColumnF_WOList()
Dim wsWO As Worksheet, wsDepot As Worksheet
Dim lr As Long
Dim Rng As Range, Cel As Range
Dim n

Application.ScreenUpdating = False

Set wsWO = Worksheets("WO_List")
Set wsDepot = Worksheets("Depot_WOs")

lr = wsWO.Cells(Rows.Count, 1).End(xlUp).Row
Set Rng = wsWO.Range("A2:A" & lr)

For Each Cel In Rng
    If wsWO.Cells(Cel.Row, "F") = "" Then
        n = Application.Match(Cel.Value, wsDepot.Range("A:A"), 0)
        If Not IsError(n) Then
            wsWO.Cells(Cel.Row, "F").Value = "Non-IP"
        End If
    End If
Next Cel
Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks very much, Subodh, it worked like a charm! :-)
                                    
                                    Andrea</pre>

<pre class="amctext">You're welcome Andrea! Glad it worked as desired.
                                    Thanks for the feedback!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Screen capture of first row met criteria and Col F populated with "Non-IP" (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/08_w33/1429122/Example.PNG">Example.PNG</a></p>
<p class="amcfile">Sample spreadsheet (56 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/08_w33/1429123/EE_Depot_WOs.xlsm">EE_Depot_WOs.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Countifs formula meeting 2 criteria and using named ranges</h2>
<p class="amcdate">2014-03-27T17:55:17-0400</p>

<pre class="amctext">Sheet 1 contains data and has 2 named ranges: AIAStatusRange and TypeChange_Range. On Sheet 2 I am trying to use the 'Countifs' formula that references the data on Sheet 1 to find all instances that meet the following two criteria:
                          
                          =COUNTIFS(AIAStatusRange,"=Not started",TypeChange_Range,"=New")
                          
                          Unfortunately, I am getting the #VALUE error. Any suggestions?
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">Try removing the equal sign, though I don't think that's the issue.
                                    
                                    =COUNTIFS(AIAStatusRange,"Not started",TypeChange_Range,"New")
                                    
                                    Are both your ranges one column wide and of equal number of rows?
                                    
                                    Thomas</pre>

<pre class="amctext">if the equal sign is not a problem as nutsch wrote then it´s hard to tell you what´s going on. It could be a typo in your formula but because we do not see the excel workbook you are working with we do not know if your range name is really the same as you have it in the formula or not,</pre>

<pre class="amctext">@helpfinder:
                                    
                                    if the name was typed wrong, the error would be #NAME!, with a #VALUE! error, it is most likely two ranges of different sizes, or more than one column per range.</pre>

<pre class="amctext">I agree, Thomas - the ranges can be multiple columns....but both need to be the exact same size and shape, i.e. same number of columns and same number of rows, otherwise you get #VALUE! error. That applies to  SUMIFS and AVERAGEIFS too.
                                    
                                    regards, barry</pre>

<pre class="amctext">Congrats on your 5th million BTW, barry!
                                    
                                    Thomas</pre>

<pre class="amctext">Hey, Thomas, thanks.......I didn't notice :)
                                    
                                    regards, barry</pre>

<pre class="amctext">Thanks to you both!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Resolving #VALUE error in spreadsheet</h2>
<p class="amcdate">2017-05-23T16:06:02-0400</p>

<pre class="amctext">Table 1, Column B has an index-match formula, whereby the results will either be no value or AU######
                          
                          I need a formula for Column I using the following criteria:
                          If Column B is blank, then sum Col C, Col E, Col G
                          If Column B = AU######, then sum Col C, Col D, Col E, Col F, Col G, Col H
                          
                          Note:
                          Columns B to Column H contain index-match formulas.
                          
                          In attempting the formula myself, I was receiving the #VALUE error message in Column I, which I realized was because some of the cells do not have values. I understand that using SUMIF may be the solution in dealing with this scenario...?
                          
                          I have included an example spreadsheet.
                          
                          Thanks!
                          Andrea
                          Resolving-VALUE-Error_EE.xlsm</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Please try below formula which will ignore blank cells in Sum Function:
                                    
                                    =IF(LEFT([@[ISSUE_WOs_APR]],2)="AU",SUM(Table1[@[Product1_Process_Min]:[Produc3_RWK_Min]]),IF([@[ISSUE_WOs_APR]]="",(SUM([@[Product1_Process_Min]])+SUM([@[Product2_Process_Min]])+SUM([@[Product3_Process_Min]]))))
                                    
                                    Please see attached...
                                    Andrea_Resolving-VALUE-Error_EE.xlsm</pre>

<pre class="amctext">Thanks for the super-quick turnaround, Shums! It works like a charm. :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example (22 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/05_w21/1163917/Resolving-VALUE-Error_EE.xlsm">Resolving-VALUE-Error_EE.xlsm</a></p>
<p class="amcfile">Error (23 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/05_w21/1163923/Andrea_Resolving-VALUE-Error_EE.xlsm">Andrea_Resolving-VALUE-Error_EE.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Updating a formula that removes a specific text string from a concatenation in Excel</h2>
<p class="amcdate">2018-09-23T16:04:48-0400</p>

<pre class="amctext">The current formula in Column E, shown below, concatenates Columns A, B, C and D to create a unique Product Number:
                          
                          
                          =A2&IF(B2<>"","-"&B2,"")&IF(C2&D2<>"","-"&C2&D2,"")

                          
                            Select all
                            Open in new window
                          
                          I need to update the current formula whereby if the specific text string "-AAU" is in Column B, it is not to be included in the final concatenated Product Number in Column E.
                          
                          I have included a sample spreadsheet that has the current formula in Column E, and the updated, desired results I am looking for in Column F. 
                          
                          Thanks in advance for assistance with this...
                          
                          Andrea
                          Product_Numbering.xlsx</pre>

<pre class="amctext">Try this
                                    
                                    
                                    =A2&IF(B2<>"",IF(RIGHT(B2,4)="-AAU","-AAU","-"&B2),"")&IF(C2&D2<>"","-"&C2&D2,"")

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks very much, Ejgil, it works like a charm!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of current formula + column showing desired results of an updated formula (9 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/09_w39/1386873/Product_Numbering.xlsx">Product_Numbering.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Change VBA code so partial row to be copied to another sheet if cell not blank</h2>
<p class="amcdate">2014-03-28T16:42:06-0400</p>

<pre class="amctext">Attached is a sample of the current VBA code I am using, which copies over a partial row to another sheet if a cell = "Yes". I would like to change the code so that the partial row will be copied over to another sheet if the cell is not blank.
                          
                          Thanks!
                          Andrea
                          CopyPartialRow-Example.xlsm</pre>

<pre class="amctext">Andreamary,
                                    
                                    You vba macro is not even functional. How can you be using it at the moment? Are you sure you have included the full macro with your sample?</pre>

<pre class="amctext">Andrea,
                                    
                                    If your vba is actually working, you have to change the Line 3 of the following code
                                    Sub InitCopyRow()
    For I = 1 To Sheet1.UsedRange.Rows.Count
        If Sheet1.Cells(I, 24) = "Yes" Then
            CopyRow (I)
        End If
    Next
End Sub

                                    
                                      Select all
                                      Open in new window
                                    From:
                                    If Sheet1.Cells(I,24) = "Yes" Then

                                    
                                      Select all
                                      Open in new window
                                    To:
                                    If Sheet1.Cells(I,24) <> "" Then

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Harry,
                                    
                                    That's odd, as it works on my system. On Worksheet 1, with 4 lines of sample text, if I enter "Yes" in Column X,  a partial row is copied to Worksheet 2. Removing and re-entering "Yes" again in Column X will trigger the row to copy over a second time.
                                    
                                    Andrea</pre>

<pre class="amctext">Sorry Andrea!
                                    
                                    It's my bad. I have overlooked by security setting to prevent it from functioning properly.
                                    
                                    I have retested your vba.
                                    
                                    In order to trigger the macro to function if the test cell is not blank instead of the test cell being "Yes", you have 2 places to change.
                                    
                                    Open VBA Editor by pressing Alt-F11. Then in the Project Explorer (Ctrl-R), find:
                                    1) ThisWorkbook, and double click to open it.
                                        Change: If Target.EntireRow.Cells(1, 24) = "Yes" Then
                                        To: If Target.EntireRow.Cells(1, 24) <> "" Then
                                    
                                    2) Module1, and double click to open it.
                                        Change: If Sheet1.Cells(I, 24) = "Yes" Then
                                        To: If Sheet1.Cells(I, 24) <> "" Then
                                    
                                    That should do it.</pre>

<pre class="amctext">Thanks, Harry, works perfectly!</pre>

<pre class="amctext">And thanks to you both, since this helped me with a similar problem!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">CopyPartialRow-Example.xlsm (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/03_w13/842329/CopyPartialRow-Example.xlsm">CopyPartialRow-Example.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel conditional formatting rule for specific text string format</h2>
<p class="amcdate">2018-03-14T18:23:12-0400</p>

<pre class="amctext">In Excel, what is the conditional formatting rule for changing a cell color if it contains either of the following strings:
                          "SUP /##"
                          "AIC /##"
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">Make a rule for each string for the cell value equal to the string.
                                    Or a formula for both
                                    =OR(A1="SUP /##",A1="AIC /##")
                                    where A1 is the first cell in the range</pre>

<pre class="amctext">Hi Ejgil,
                                    
                                    For some reason I can’t seem to get this to work. I tried it both ways, then realized I most likely, and I apologize, didn’t explain my question very well. 
                                    
                                    “SUP /##” whereby the ## is a wildcard for a numeric value, such as SUP /18, or SUP /29, etc.
                                    And the same goes for “AIC /##”  (ie., AIC /55, AIC /10
                                    Lastly, the number of digits after the “/“ could be one, two or three digits.
                                    
                                    Hope this clarifies things... :-/
                                    
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    With Ejgil's suggestion, just replace the ## with *, ie:
                                    
                                    =OR(A1="SUP /*",A1="AIC /*")
                                    
                                    Will there always be a space between the 3 letters and the /?
                                    Will there always be the /? If so, would "SUP*" or "AIC*" cover the options?</pre>

<pre class="amctext">Thanks, Rob. For some reason I am not having success in getting this formula to work, so thought it best to supply an example Excel file. The column I am trying to apply the conditional formatting to is column D:
                                    
                                    
                                    The answer is 'Yes' to both of your questions. That being said, this represents an 'incomplete' format, hence the desire for conditional formatting to identify it as such. Once all the columns are populated (as column D is a concatenated string), then the final, complete format will be as shown below, at which point the conditional formatting should no longer take effect:
                                    
                                    SUP or AIC ##/## or SUP or AIC ##/###
                                    
                                    For example:
                                    SUP 17/18
                                    or
                                    SUP 17/181
                                    or 
                                    AIC 17/18
                                    or
                                    AIC 17/181
                                    
                                    I hope this helps...
                                    
                                    Andrea</pre>

<pre class="amctext">Sorry, forgot to upload my sample Excel file!
                                    
                                    Here it is...
                                    
                                    Andrea
                                    EE_ConditionalFormatting.xlsm</pre>

<pre class="amctext">I will take a look later</pre>

<pre class="amctext">You can use
                                    
                                    =OR(LEFT(D2,5)="SUP /",LEFT(D2,5)="AIC /")

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Shaun's suggestion using LEFT works. Don't understand why using a wild card doesn't though.</pre>

<pre class="amctext">Since column D is a composed value, I would use the cells that compose the value, instead of the result.
                                    =AND(OR(A2="AIC",A2="SUP"),OR(B2="",C2=""))
                                    
                                    But what you really want to show are the missing values in B or C, so I would highlight them instead.
                                    Like this for column B and C
                                    =AND(OR($A2="AIC",$A2="SUP"),B2="")</pre>

<pre class="amctext">Thanks for everyone's input...much appreciated! Shaun's solution was the first one to work, and fulfilled my request, and I appreciated the insights and alternate solutions provided by Ejgil, so I have shared the points.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of attempt to apply conditional formatting (31 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/03_w11/1286570/EE_ConditionalFormatting.xlsm">EE_ConditionalFormatting.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Changing value in one cell based on last part of text string in another cell</h2>
<p class="amcdate">2014-03-15T15:11:01-0400</p>

<pre class="amctext">Column L contains text strings of various lengths. Column S has data validation that includes the following words in the dropdown menu: NEW, REVISED, DELETED. 
                          
                          I want to create a formula that changes the value in Column S if specific criteria are met in Column L as follows:
                          
                          If the text string in column L ends with "- NEW", then the cell in Column S (in same row) autopopulates with the word "NEW".
                          
                          If text string in column L does not end with "- NEW",  then the cell in Column S (in same row) autopopulates with the word "REVISED"
                          
                          If cell in column L is blank, then the cell in Column S (in same row) remains blank.
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Pls try below,
                                    
                                    
                                    =IF(L1="","",IF(RIGHT(L1,3)="NEW","NEW","REVISED"))</pre>

<pre class="amctext">Perfect...and thanks for answering so quickly!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel formula not working when calculating on cells containing formulas</h2>
<p class="amcdate">2018-01-16T19:59:20-0500</p>

<pre class="amctext">Sheet1 is a linked worksheet, so every cell contains a formula.
                          
                          Sheet2 is a validation spreadsheet to ensure that all minutes entered in Sheet1, Column E have an associated date entry in Sheet1, Column D. To that end, I'm trying to write a validation formula that meets this criteria:
                          
                          If Sheet 1, Column E has a number >= to 1, and Sheet1, Column D does not have a date, then populate Sheet2 with "Missing", otherwise "". 
                          
                          =IF(AND(Sheet1!$D2=0,Sheet1!$E2>=1),"Missing","")
                          
                          The above formula is not working, as despite Sheet1, Column D missing dates in cells D7:D11, Sheet2 does not indicate this by populating B7:B11 with the word "Missing".
                          
                          I have included a spreadsheet to demonstrate the issue.
                          
                          Thanks,
                          Andrea
                          EE_validation.xlsx</pre>

<pre class="amctext">Please try it like this...
                                    
                                    
                                    =IF(AND(Sheet1!$D2="",Sheet1!$E2>=1),"Missing","")

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks, Subodh!</pre>

<pre class="amctext">You're welcome Andrea!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example (131 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/01_w03/1219992/EE_validation.xlsx">EE_validation.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Updating the date and time fields of Excel user form when form saved</h2>
<p class="amcdate">2017-12-10T18:11:28-0500</p>

<pre class="amctext">My Excel user form has a date and time field that auto-populates when the form is opened. This is to reduce the overhead for the user, and to ensure the format is entered correctly. Once the form is saved, the data from the form populates a spreadsheet called 'TrackingSheet'. 
                          
                          I am finding that users have the form open on their computer over the course of the day, or possibly a couple of days, and as a result the date and time being recorded when the form is saved isn't accurate. I would prefer that users continue to keep the form open on their systems, to facilitate data entry. Is there a way to have clicking of the 'Save' button of the user form also update the date and time fields simultaneously, thus ensuring the accuracy of the date/time stamp in the TrackingSheet?
                          
                          I have attached the user form in question.
                          
                          Thanks,
                          Andrea
                          UserForm_EE.xlsm</pre>

<pre class="amctext">Change the formatting of column "D" to d-mmm-yy and replace your sub with this.
                                    
                                    
                                    Private Sub cmdSave_Click()
Dim NextRow As Long

    With Me

        If .cboIDList.Value = "" _
           Or .cboTask.Value = "" _
           Or .txtPA_Unit.Value = "" _
           Or .txtDate = "" _
           Or .txtTime = "" _
           Or .cboInitials = "" _
           Or txtMinutes = "" _
           Or cboStatus = "" Then

            MsgBox "Cannot save as form is not complete yet", vbExclamation, "Incomplete"
            Exit Sub
        End If

        NextRow = Sheets("TrackingSheet").Range("A" & Rows.Count).End(xlUp).Row + 1
        Sheets("TrackingSheet").Range("A" & NextRow).Value = .cboIDList.Value
        Sheets("TrackingSheet").Range("B" & NextRow).Value = lblTaskText.Caption
        Sheets("TrackingSheet").Range("C" & NextRow).Value = .txtPA_Unit.Value
        Sheets("TrackingSheet").Range("D" & NextRow).Value = Format(Date, "d-mmm-yy")  
        Sheets("TrackingSheet").Range("E" & NextRow).Value = Format(TimeValue(Now), "hh:mm AM/PM") 
        Sheets("TrackingSheet").Range("F" & NextRow).Value = .txtMinutes.Value
        Sheets("TrackingSheet").Range("G" & NextRow).Value = .cboInitials.Value
        Sheets("TrackingSheet").Range("H" & NextRow).Value = .cboStatus.Value
        
        .cboIDList.Value = ""
        .cboTask.Value = ""
        .txtPA_Unit.Value = ""
        .txtMinutes.Value = ""
    End With

End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Martin,
                                    
                                    Excellent...thank you!! I was comparing the old and new code to try and understand what you did...if you had a moment, would you be able to explain it to me?
                                    
                                    Thanks for the quick turnaround too!
                                    Andrea</pre>

<pre class="amctext">OK, I changed lines 23 and 24.
                                    
                                    For line 23 Date is a built in function that in my local returns a date like 12/10/2017 . The Format function changes that so that it shows up in d (day number), mmm (abbreviated name of month), yy (two-digit tear) format with dashes in-between. You can find a lot more information about Format on the web.
                                    
                                    For line 24 TimeValue is a built in function that given in input parameter Now (which is date and time) returns a string like 6:08:57 PM . Again Format changes that and you should be able to find the explanation at the same time that you look up Format on the web.
                                    
                                    In any case you’re welcome and I’m glad I was able to help.
                                    
                                    If you expand the “Full Biography” section of my profile you’ll find links to some articles I’ve written that may interest you.
                                    
                                    Marty - Microsoft MVP 2009 to 2017
                                                  Experts Exchange MVE 2015 
                                                  Experts Exchange Top Expert Visual Basic Classic 2012 to 2017</pre>

<pre class="amctext">Thanks, Martin!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of user form (30 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w50/1214591/UserForm_EE.xlsm">UserForm_EE.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Adding a second worksheet that has same 'Copy partial row' functionality as Worksheet 1</h2>
<p class="amcdate">2014-02-28T12:23:37-0500</p>

<pre class="amctext">I am working in Excel 2010. I have attached a sample file that currently copies a partial row from Worksheet 1 to Worksheet 2 based on the criteria outlined below. I need to add Worksheet 3 to this workbook, and want it to have exactly the same functionality as Worksheet 1 — if it meets the same criteria as outlined below, then a partial row is copied into Worksheet 2. So basically Worksheet 2 can be populated by both Worksheet 1 and Worksheet 3. 
                          
                          Criteria and desired result as per sample file attached:
                          If, in worksheet called "Worksheet 1":
                          A cell in any row in Column V: is not blank
                          A cell in the same row as above in Column X: = "Yes"
                          Then the following cells from the above row are copied and pasted, as values, into the next available blank row in "Worksheet 2", mapped as follows:
                          Column V value to Column A
                          Column W value to Column B
                          Column A value to Column C
                          Column B value to Column D
                          Column L value to Column E
                          Column M value to Column F
                          
                          Further details:
                          If there are blank values in any of the cells being copied from Worksheet 1 or Worksheet 3, then the cell in Worksheet 2 would also show as blank.
                          The values are to be copied over just once into Worksheet 2.
                          The process would happen automatically anytime the above two conditions are met in Worksheet 1 or Worksheet 3.
                          
                          Thanks,
                          Andrea
                          CopyPartialRow.xlsm</pre>

<pre class="amctext">Remove the code from Sheet1 and paste this code in the ThisWorkbook module.
                                    
                                    Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)

    If Sh Is Sheet2 Then Exit Sub
    
    If Target.EntireRow.Cells(R, 22) <> "" And Target.EntireRow.Cells(R, 24) = "Yes" Then
        CopyRow Target
    End If
    
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    Also, adjust CopyRow and CopyRow2 to take a range as an argument.
                                    
                                    Sub CopyRow2(ByVal R As Range, ByVal R2 As Integer)

    Sheet2.Cells(R2, 1) = R.EntireRow.Cells(1, 22)
    Sheet2.Cells(R2, 2) = R.EntireRow.Cells(1, 23)
    Sheet2.Cells(R2, 3) = R.EntireRow.Cells(1, 1)
    Sheet2.Cells(R2, 4) = R.EntireRow.Cells(1, 2)
    Sheet2.Cells(R2, 5) = R.EntireRow.Cells(1, 12)
    Sheet2.Cells(R2, 6) = R.EntireRow.Cells(1, 13)

End Sub

Sub CopyRow(ByVal R As Range)

    If WorksheetFunction.CountA(Sheet2.Cells) = 0 Then
        R2 = 1
    Else
        R2 = Sheet2.Range("A" & Sheet2.Rows.Count).End(xlUp).Row + 1
    End If
    
    CopyRow2 R, R2
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Perfect! Thanks very much for the quick response...</pre>

<pre class="amctext">The initial test of this solution worked, but runtime errors are surfacing after more than a copy of rows are copied over. Should I start a new thread, or can this be addressed in this thread? I've attached the file to illustrate what is happening.
                                    CopyPartialRow-TwoSheetTest.xlsm</pre>

<pre class="amctext">What do you mean 'more than a copy of the rows are copied over'?</pre>

<pre class="amctext">I'm sorry but I really jumped the gun on closing this question when I did. :-( Please advise how to best rectify this. I'm providing a description of the errors I'm encountering in the file I attached in my previous post. I'm not an expert, so don't hesitate to ask for clarification if my explanations aren't clear. And if you feel that this should be handled as a new thread on my part, just let me know:
                                    
                                    1. When entering "Yes" in X1 on either Worksheet 1 or Worksheet 3, run-time error 1004 triggered and line not copied to Worksheet 2 despite meeting criteria
                                    
                                    2. Removing "Yes" from Worksheet 1 or Worksheet 3 triggers the line to be copied into Worksheet 2. We need the ability to remove "Yes" without it triggering any action.
                                    
                                    3. Reapplying "Yes" to a line that has already been copied over to Worksheet 2 does not trigger the line to be copied over again. (We need the ability to remove "Yes" and reapply "Yes" to lines that have already been copied into Worksheet 2. Worksheet 1 and 3 are lists of chapters in a book, and the same chapter could be revised several times within one cycle, and each time it's going to be revised we copy it again into Worksheet 2.)
                                    
                                    4. Removing "Yes" and/or reinserting "Yes" from X1 in either Worksheet 1 or Worksheet 3 triggers run-time error 1004 in Private Sub Workbook_SheetChange: the following line is highlighted in yellow:
                                     If Target.EntireRow.Cells(R, 22) <> "" And Target.EntireRow.Cells(R, 24) = "Yes" Then
                                    
                                    Thanks for your patience,
                                    
                                    Andrea</pre>

<pre class="amctext">Oops, the problem is something from the old code that I should have fixed.
                                    
                                    Try this for the code in the workbook module.
                                    
                                    Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)

    If Sh Is Sheet2 Then Exit Sub
    
    If Target.EntireRow.Cells(1, 22) <> "" And Target.EntireRow.Cells(1, 24) = "Yes" Then
        Application.EnableEvents = False
        CopyRow Target
        Application.EnableEvents = True
    End If
    
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    I think that fixes all the points you raised but it's probably best if you check again.</pre>

<pre class="amctext">All good now! I made sure to test it in several ways. Thanks so much...</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of copy partial row from Worksheet 1 to Worksheet 2 (18 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/02_w09/837467/CopyPartialRow.xlsm">CopyPartialRow.xlsm</a></p>
<p class="amcfile">Run-time error (19 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/02_w09/837506/CopyPartialRow-TwoSheetTest.xlsm">CopyPartialRow-TwoSheetTest.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Adding worksheet change event when there is already a SelectionChange event associated with worksheet</h2>
<p class="amcdate">2014-08-14T11:03:27-0400</p>

<pre class="amctext">I am a VBA novice, so my apologies for this basic question. How do you add a General Declarations + Worksheet Change event to a worksheet (called IAP_Charts_Pub) that already has a Worksheet SelectionChange event associated with it? I tried pasting the Worksheet Change code above the Worksheet SelectionChange code associated with IAP_Charts_Pub, but that is triggering a debug error (at the line "Private Sub Worksheet_SelectionChange(ByVal Target As Range)"). I've included both event codes below:
                          
                          PRE-EXISTING CODE (Worksheet SelectionChange)
                          
                          Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    If Target.Column = 31 Or Target.Column = 48 Or Target.Column = 65 Or Target.Column = 82 Or Target.Column = 99 Or Target.Column = 116 Then ' Col AD
        If Target.Value Like "##-####" Then
            If Target.Value Like "##-9###" Then
             addDND = "DND\"
          Else
                addDND = ""
          End If
          Application.EnableEvents = False
          Target.Formula = "=HYPERLINK(""Q:\20" & Left(Target, 2) & "\" & addDND & Target.Value & Chr(34) & "," & Chr(34) & Target.Value & Chr(34) & ")"
          Application.EnableEvents = True
    End If
End If
End Sub

                          
                            Select all
                            Open in new window
                          NEW EVENT CODE TO BE ADDED (General Declarations + Worksheet Change):
                          
                          Option Explicit
Dim rng As Range
Dim cl As Object
Dim boolChange As Boolean
Dim x As Integer

Private Sub Worksheet_Change(ByVal Target As Range)
    If boolChange Then
        boolChange = False
        Exit Sub
    End If
    Set rng = Range("AD2", Range("AD2").End(xlDown))
    For Each cl In rng
        For x = 2 To 27 Step 5
            If cl.Offset(0, x) = "NEW" Or cl.Offset(0, x) = "REVISED" Then
                boolChange = True
                cl.Value = Format(Now(), "dd-mmm-yy")
                Exit For
            End If
        Next x
    Next cl
    boolChange = False
End Sub

                          
                            Select all
                            Open in new window
                          Thanks,
                          Andrea</pre>

<pre class="amctext">I'm confused about what you want to do since SelectionChange and Change are different events that both already exist. SelectionChange occurs when you move from one cell to another and Change occurs after you leave a cell that you have changed.</pre>

<pre class="amctext">The SelectionChange event was a solution from this website (let's call it hyperlinking) that I applied to my worksheet a few months ago. Recently, I needed another VBA solution (let's call it auto-date update) for a different section of the same worksheet, which again was provided to me through this website. Now I need to know how to add the second VBA solution to my worksheet, given that there is already the existing code associated with this worksheet. 
                                    
                                    I hope that helps.
                                    
                                    Andrea</pre>

<pre class="amctext">Further to the above, I combined the code (see below) for both solutions, and I'm getting a Compile Error at line 29 for the phrase "addDND":
                                    
                                    
                                    Option Explicit
Dim rng As Range
Dim cl As Object
Dim boolChange As Boolean
Dim x As Integer

Private Sub Worksheet_Change(ByVal Target As Range)
    If boolChange Then
        boolChange = False
        Exit Sub
    End If
    Set rng = Range("AD2", Range("AD2").End(xlDown))
    For Each cl In rng
        For x = 2 To 27 Step 5
            If cl.Offset(0, x) = "NEW" Or cl.Offset(0, x) = "REVISED" Then
                boolChange = True
                cl.Value = Format(Now(), "dd-mmm-yy")
                Exit For
            End If
        Next x
    Next cl
    boolChange = False
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    If Target.Column = 31 Or Target.Column = 48 Or Target.Column = 65 Or Target.Column = 82 Or Target.Column = 99 Or Target.Column = 116 Then ' Col AD
        If Target.Value Like "##-####" Then
            If Target.Value Like "##-9###" Then
             addDND = "DND\"
          Else
                addDND = ""
          End If
          Application.EnableEvents = False
          Target.Formula = "=HYPERLINK(""Q:\20" & Left(Target, 2) & "\" & addDND & Target.Value & Chr(34) & "," & Chr(34) & Target.Value & Chr(34) & ")"
          Application.EnableEvents = True
    End If
End If
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">I'm still not sure I understand the question but you can use Intersect to do different things.
                                    
                                    
                                    Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If Not Intersect(ActiveCell, Range("A1:A6")) Is Nothing Then
    MsgBox "I selected " & Target.Address
Else
    MsgBox "I'm somewhere else"
End If
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">What is addDND?</pre>

<pre class="amctext">It also might help if you attached your workbook and described in words, rather than code, what you are trying to do.</pre>

<pre class="amctext">Good idea, Martin. I've created a sample worksheet to which I want to add the following functionality:
                                    
                                    If the value in Column AF is updated to "NEW" or "REVISED", then the date in Column AD changes to "13 Nov 14".
                                    
                                    I would like to have this solution in both VBA and as a macro, as I may decide to go the macro route.
                                    
                                    Let me know if you need anything further...thanks!
                                    
                                     Thanks,
                                     Andrea
                                    Sample-UpdateEFFDate.xlsm</pre>

<pre class="amctext">I'm going out for lunch and will get back to you within a couple of hours.</pre>

<pre class="amctext">Here's your workbook updated with a Worksheet_Change event that looks like this
                                    
                                    Private Sub Worksheet_Change(ByVal Target As Range)

If Not Intersect(ActiveCell, Range("AF2:AF" & ActiveSheet.UsedRange.Rows.Count)) Is Nothing Then
    Select Case UCase(Target.Value)
        Case "NEW", "REVISED"
            Range("AD" & Target.Row).Value = #8/13/2014#
    End Select
End If
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    and a macro (in Module1) that looks like this
                                    
                                    Sub NewRevised()
Dim lngRow As Long

For lngRow = 2 To ActiveSheet.UsedRange.Rows.Count
    Select Case UCase(Cells(lngRow, 32).Value) ' 32 = row AF
        Case "NEW", "REVISED"
            Range("AD" & lngRow).Value = #8/13/2014#
    End Select
Next
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Q-28497661.xlsm</pre>

<pre class="amctext">Terrific, Martin. All good. Thanks for your patience!</pre>

<pre class="amctext">You're welcome and I'm glad I was able to help. Note that while there's noting wrong with the way you coded your SelectionChange event, line 26 in post ID : 40261203 it could have been more easily coded using a Select Case structure like I did in my ChangeEvent code.
                                    
                                    In my profile you'll find links to some articles I've written that may interest you.
                                    Marty - MVP 2009 to 2014</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample-UpdateEFFDate.xlsm (123 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w33/866388/Sample-UpdateEFFDate.xlsm">Sample-UpdateEFFDate.xlsm</a></p>
<p class="amcfile">Modified (126 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w33/866404/Q-28497661.xlsm">Q-28497661.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Add a condition to an Excel formula to include when date in one cell equals date in another cell</h2>
<p class="amcdate">2017-04-04T18:04:58-0400</p>

<pre class="amctext">Column AH = Date WO was completed
                          Column AI = Deadline date
                          
                          My formula below indicates whether the WO was completed by the deadline or not:
                          
                          =IFERROR(IF($AH2="","",IF($AH2<$AI2,"Yes","No")),"")
                          
                          I need the above formula to be modified to include the additional condition below:
                          
                          If AH2 = AI2, the result is also 'Yes' (the deadline was met)
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Andrea,
                                    
                                    This was simple :)  just to add <=
                                    =IFERROR(IF($AH2="","",IF($AH2<=$AI2,"Yes","No")),"")</pre>

<pre class="amctext">Thanks for the quick response, Shums! For some reason, the results I'm getting are still showing the deadline isn't met if AH2 = AI2. It appears that column AH includes a date and time stamp, whereas column AI only includes the date. Is it possible for the formula to ignore the time stamp, and if so, do you think that would resolve the issue?</pre>

<pre class="amctext">Show me the format of both the columns</pre>

<pre class="amctext">If that's the case, then try below:
                                    =IFERROR(IF($AH2="","",IF(TEXT($AH2,"dd-mm-yyyy")<=TEXT($AI2,"dd-mm-yyyy"),"Yes","No")),"")</pre>

<pre class="amctext">try this:
                                    =IFERROR(IF($Ah2="","",IF(DATEVALUE(TEXT($Ah2,"DD/MM/yy"))<=$ai2,"Yes","No")),"")</pre>

<pre class="amctext">That did the trick! Thanks, Shums!</pre>

<pre class="amctext">Pleased to help Andrea!
                                    
                                    Arana great formula</pre>

<pre class="amctext">Hi Arana,
                                    
                                    I'm sorry, but I had already closed the question before I saw your response, which also worked. Thanks very much!
                                    
                                    Andrea</pre>

<pre class="amctext">Nothing to be sorry about, glad it worked, it was in fact Shum's answer just adjusted for your comment about time stamp, all credit goes to him, just wanted to give you an alternate way to do it , as a future reference.</pre>

<pre class="amctext">Andrea,
                                    
                                    Please request to re-open your question and split the points, Arana's solution is as helpful as mine.</pre>

<pre class="amctext">Thanks, Shums, I'll follow up...
                                    
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    As requested, I have reopened the question for you.</pre>

<pre class="amctext">Thanks very much, Kyle!</pre>

<pre class="amctext">Thanks again to you both! And thanks, Shums, for arranging for the question to be reopened so I could share the points!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're Welcome Andrea! Glad we both were able to help you.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Help with user form in Excel (combobox and linking entry to next available row in spreadsheet)</h2>
<p class="amcdate">2017-11-23T16:15:50-0500</p>

<pre class="amctext">I have created a user form called Time Tracker, and been able to link the first combobox (called cboIDList) to the range called ID.
                          
                          I am having difficulty with the next steps:
                          
                          
                            Autopopulating the combobox called cboPA_Unit, which is to be based on the value that users selects for cboIDList and references the range called PA_Unit.
                          
                          
                            Autopopulating the combobox called cboDesc, which is based on the value that users selects for cboIDList, and references the range called Description
                          
                          
                            Getting data of a completed user form to populate the next available row in a target spreadsheet
                          
                          
                          For example, if the user opens the user form and selects 2017-0001 in the dropdown for the ID combo box, then the PA Unit and Description combo boxes would both autopopulate with "Unit 1" and "Reduce Publication Files" respectively.
                          
                          The txtDate field should already be autopopulated with the current date:
                          
                          
                            I would like users to be able to edit the date if necessary, in case they were away and need to back date a record.
                          
                          
                          Once the user completes the form by entering a value in the 'Minutes' text box, then I would like the data from the form to populate the next available row in the spreadsheet called TrackingSheet as follows:
                          
                          TrackingSheet!Column A = reflects value entered in cboIDList
                          TrackingSheet!Column B = reflects value entered in cboPA_List
                          Tracking Sheet!Column C = reflects value entered in cboDesc
                          TrackingSheet!Column D = reflects value entered in txtDate
                          TrackingSheet!Column E = reflects value entered in txtMinutes
                          
                          If the user form is not completely filled out, then no data should be entered into the TrackingSheet.
                          
                          Description of my attached sample spreadsheet:
                          
                          Dynamic named ranges:
                          ID = Tasks!Column A
                          PA_Unit = Tasks! Column B
                          Description = Tasks!Column C
                          
                          I think I've covered it. I am new at user forms, so if you feel there are glaring issues or error handling that I should add, it would be very helpful to know.
                          
                          I have attached a sample spreadsheet with my user form completed thus far, as described above.
                          ProdMainTimeTracker.xlsm</pre>

<pre class="amctext">The first part is easy, Though I'm not quite sure why you are using comboboxes when there aren't multiple values.
                                    
                                    
                                    Private Sub cboIDList_Change()
Dim idx As Long

    With Me
        idx = .cboIDList.ListIndex
        
        If idx <> -1 Then
            .cboDesc.Value = Sheets("Tasks").Range("C" & idx + 2).Value
            .cboPA_Unit.Value = Sheets("Tasks").Range("B" & idx + 2).Value
        End If

    End With
    
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    For the data part, you are already populating a textbox with the current date and the user can easily change that if they want.
                                    
                                    As for transferring the data from the userform to the sheet 'TrackingSheet', you could use this code,
                                    
                                    Dim NextRow As Long

    With Me
    
        If .cboIDList.Value = "" _
            Or .cboDesc.Value = "" _
            Or .cboPA_Unit.Value = "" _
            Or .txtDate = "" _
            Or txtMinutes = "" Then
            
            MsgBox "Form not completed!", vbCritical, "Incomplete"
            Exit Sub
        End If
    

        NextRow = Sheets("TrackingSheet").Range("A" & Rows.Count).End(xlUp).Row + 1
        Sheets("TrackingSheet").Range("A" & NextRow).Value = .cboIDList.Value
        Sheets("TrackingSheet").Range("B" & NextRow).Value = .cboPA_Unit.Value
        Sheets("TrackingSheet").Range("C" & NextRow).Value = .cboDesc.Value
        Sheets("TrackingSheet").Range("D" & NextRow).Value = .txtDate.Value
        Sheets("TrackingSheet").Range("E" & NextRow).Value = .txtMinutes.Value
        
    End With

                                    
                                      Select all
                                      Open in new window
                                     
                                    which I've put in the Click event of the command button cmdSave I've added to the userform in the attached file.
                                    ProdMainTimeTracker-with-Save-butto.xlsm</pre>

<pre class="amctext">Terrific - thanks very much, Norie!
                                    
                                    I will change the combo boxes, since they aren't necessary, as you mentioned. The one thing I realized as I tested is that I should have included the clearing of the form of data after clicking the 'Save' button as part of the criteria. I'll see if I can figure that out. :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Thanks for the quick response...</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">User form so far (19 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w47/1212332/ProdMainTimeTracker.xlsm">ProdMainTimeTracker.xlsm</a></p>
<p class="amcfile">Original file updated with save button added to userform. (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w47/1212338/ProdMainTimeTracker-with-Save-butto.xlsm">ProdMainTimeTracker-with-Save-butto.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Revise concatenated formula in Excel so only executed under certain conditions</h2>
<p class="amcdate">2015-07-21T16:30:52-0400</p>

<pre class="amctext">In the attached spreadsheet, I would like to revise the formula in Column C as follows:
                          
                          Current formula:
                          The current formula in Column C concatenates Columns A & B
                          
                          Revised formula:
                          Would like the formula to concatenate Columns A & B only when the format of Column A is ##- and the format of Column B is ####, otherwise Column C is to remain blank.
                          
                          Thanks!
                          Andrea
                          EE-Example-July2015.xlsm</pre>

<pre class="amctext">Try this:
                                    
                                    =IF(AND(LEN(A2)=3,LEN(B2)=4), CONCATENATE(A2,B2),"")</pre>

<pre class="amctext">Try changing your formula as follows:
                                    
                                    =IF(OR(ISBLANK(A2), ISBLANK(B2)), "", CONCATENATE(A2,B2))</pre>

<pre class="amctext">Small changes in tomfarrar to make it more robust which will be this..
                                    
                                    
                                    =IF(AND(LEN(A2)=3,RIGHT(A2,1)="-",LEN(B2)=4),A2&B2,"")

                                    
                                      Select all
                                      Open in new window
                                    
                                    Saurabh...</pre>

<pre class="amctext">If your requirement is to check whether col. A and B contains numbers and have a definite length, the most accurate formula would be this....
                                    
                                    
                                    =IF(AND(ISNUMBER(LEFT(A2,2)+0),RIGHT(A2,1)="-",LEN(B2)=4,ISNUMBER(B2+0)),A2&B2,"")

                                    
                                      Select all
                                      Open in new window
                                    
                                    The above formula will make sure that the col. A and B contains numbers and will not concatenate if A2 is like 1a- and B2 is like abcd.</pre>

<pre class="amctext">Thanks, everyone, for your quick responses!
                                    
                                    I tested all the formulas provided, and all worked with the exception of the following one, which seemed to result in Column C being populated regardless of the format in Columns A & B:
                                    
                                    =IF(OR(ISBLANK(A2), ISBLANK(B2)), "", CONCATENATE(A2,B2)) 
                                    
                                    I appreciated the accuracy of sktneer's formula, so identified that one as the best solution.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're welcome Andrea! Glad I could help. :)</pre>

<pre class="amctext">Nice working with you, Andrea.  Thanks for the assist, Saurabh.</pre>

<pre class="amctext">Andrea.. HTH..Glad it worked for you..</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example with notes as to desired results (32 KB) <a href="https://filedb.experts-exchange.com/incoming/2015/07_w30/924510/EE-Example-July2015.xlsm">EE-Example-July2015.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excluding specific cells from array formula</h2>
<p class="amcdate">2014-03-04T09:22:03-0500</p>

<pre class="amctext">I am using this array formula to get the total number of minutes:
                          {=SUM(IF(ISERROR(Y2:BI2),"",Y2:BI2))}
                          
                          I need to revise the above formula to exclude the following 3 cells: AV2, AY2, BB2
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">HI,
                                    
                                    pls try
                                    
                                    
                                    {=SUM(IF(ISERROR(Y2:AU2);"";Y2:AU2))+SUM(IF(ISERROR(AW2:AX2);"";AX2:AX2))+SUM(IF(ISERROR(AZ2:BB2);"";AZ2:BB2))}

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">Try
                                    
                                    =SUM(IF(ISERROR(Y2:BI2)+NOT(ISERROR(FIND((ADDRESS(ROW(Y2:BI2),COLUMN(Y2:BI2))),"$AV$2,$AY$2,$BB$2"))),"",Y2:BI2))</pre>

<pre class="amctext">With commas instead of semicolons
                                    
                                    
                                    {=SUM(IF(ISERROR(Y2:AU2),"",Y2:AU2))+SUM(IF(ISERROR(AW2:AX2),"",AX2:AX2))+SUM(IF(ISERROR(AZ2:BB2),"",AZ2:BB2))}

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">I tested all the solutions offered and this is the solution that worked properly. Thanks very much!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Highlighting duplicate values in Excel in different colors</h2>
<p class="amcdate">2014-02-06T10:59:40-0500</p>

<pre class="amctext">Column D in my spreadsheet lists chapter titles. The spreadsheet tracks every time a chapter is being revised, so there are a number of duplicate values. I would to have the spreadsheet automatically highlight duplicate chapter titles in column D with its own unique color. Any chapter titles not duplicated would not have any color. For example:
                          
                          Column D
                          The Cat Came Back (color # 1)
                          The Dog Sits Still (color # 2)
                          Charley Goes to Camp (unique, so no color)
                          The Cat Came Back (color # 1)
                          Trixie Likes Icecream (unique, so no color)
                          The Dog Sits Still (color # 2)
                          The Dog Sits Still (color # 2)
                          The Cat Came Back (color # 1)
                          
                          Thanks in advance for help with this...
                          
                          Cheers,
                          Andrea</pre>

<pre class="amctext">Try this:
                                    
                                    
                                    Sub Find_Duplicate_Entry()
    Dim cel As Variant
    Dim myrng As Range
    Dim clr As Long
    Set myrng = Range("A1:A" & Range("A65536").End(xlUp).Row)
    myrng.Interior.ColorIndex = xlNone
    clr = 3
    For Each cel In myrng
        If Application.WorksheetFunction.CountIf(myrng, cel) > 1 Then
            If WorksheetFunction.CountIf(Range("A1:A" & cel.Row), cel) = 1 Then
                cel.Interior.ColorIndex = clr
                clr = clr + 1
            Else
                cel.Interior.ColorIndex = myrng.Cells(WorksheetFunction.Match(cel.Value, myrng, False), 1).Interior.ColorIndex
            End If
        End If
    Next
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks for the quick response. Can I just get your guidance on putting this code into my workbook, as this it not an area I have much experience in...
                                    
                                    I tried to enter the code above by right-mouse clicking on the relevant tab and clicking on "View Code", and then pasting the code into a blank window, at the top of which it says "General" on the left, and "Find_Duplicate_Entry" on the right. I flipped back to the spreadsheet view and saved the spreadsheet, but don't see any results in column D. I suspect I'm doing something wrong at my end.
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">Seems like you added the code correctly, now you just have to run the macro.
                                    
                                    Hit Alt+F8 to bring up the macro dialog, chose the macro and click run.</pre>

<pre class="amctext">It worked...cool!
                                    
                                    A couple of things...
                                    
                                    
                                      The macro ran on Column A, not D...how do I change it to column D?
                                    
                                    
                                      My preference would be for this highlighting to be "on the fly" as new rows are added, rather than having to run a macro...is this possible?
                                    
                                    
                                      Is there a way I can reference a custom color palette instead of the default colors so it's a little easier on the eyes?
                                    
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">The macro ran on Column A, not D...how do I change it to column D?
                                    
                                    Change this:
                                    
                                    Set myrng = Range("A1:A" & Range("A65536").End(xlUp).Row)

                                    
                                      Select all
                                      Open in new window
                                    To this:
                                    
                                    Set myrng = Range("D1:D" & Range("D65536").End(xlUp).Row)

                                    
                                      Select all
                                      Open in new window
                                    
                                    
                                    
                                      My preference would be for this highlighting to be "on the fly" as new rows are added, rather than having to run a macro...is this possible?
                                    
                                    This will work but be forewarned, it is not very efficient since it will process all records each time a change is made.
                                    
                                    Private Sub Worksheet_Change(ByVal Target As Range)
    Dim cel As Variant
    Dim myrng As Range
    Dim clr As Long
    If Not Intersect(Target, Range("D1:D65536")) Is Nothing Then
        Set myrng = Range("D1:D" & Range("D65536").End(xlUp).Row)
        myrng.Interior.ColorIndex = xlNone
        clr = 3
        For Each cel In myrng
            If Application.WorksheetFunction.CountIf(myrng, cel) > 1 Then
                If WorksheetFunction.CountIf(Range("A1:A" & cel.Row), cel) = 1 Then
                    cel.Interior.ColorIndex = clr
                    clr = clr + 1
                Else
                    cel.Interior.ColorIndex = myrng.Cells(WorksheetFunction.Match(cel.Value, myrng, False), 1).Interior.ColorIndex
                End If
            End If
        Next
    End If
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    
                                    
                                      Is there a way I can reference a custom color palette instead of the default colors so it's a little easier on the eyes?
                                    
                                    Yes, but that is much more complicated and therefore warrants a separate question.</pre>

<pre class="amctext">Thanks for the quick response and the explanation on points #2 and #3. I tried the new code above so it works 'on the fly' (pasting the code in the same way as I did originally), but it doesn't seem to be taking effect. I did notice that in line 11, there is still a reference to A1:A, so tried changing that to "D1:D" but that didn't do the trick. 
                                    
                                    Any advice?
                                    
                                    Thanks</pre>

<pre class="amctext">An update...
                                    
                                    With line # 11 revised as described above, I happened to make a revision to a new row in the spreadsheet, and that suddenly triggered the duplicates in Column D to show...success, thanks!
                                    
                                    One last thing if possible — is there any way to prevent my heading row for Column D from being included: ie., for the code to start at D2 instead of D1?</pre>

<pre class="amctext">Change all occurrences of D1 to D2.</pre>

<pre class="amctext">Terrific...thanks very much!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Summing all minutes from Excel table that is linked to another spreadsheet, while excluding minutes with specific text strings in one column</h2>
<p class="amcdate">2017-07-28T15:16:39-0400</p>

<pre class="amctext">I have an Excel spreadsheet called 'WO_Tracking'. There is another spreadsheet, called 'Linked', that is linked to 'WO_Tracking', and is formatted as an Excel table. There is a third spreadsheet called 'Summary' to serve as a dashboard for supervisors.
                          
                          In the Summary spreadsheet, I am trying to total the following from the 'Linked' spreadsheet:
                          Linked![Minutes] column + Linked![Minutes2] column, excluding minutes in rows that have either 'Cancelled' or 'Deferred' text string in [WO_Change] column
                          
                          I have provided a sample workbook with all three spreadsheets included, and filled in the expected result in red in the Summary tab. The formula needs to be based on the 'Linked' spreadsheet, not the 'WO_Tracking' spreadsheet.
                          
                          Thanks!
                          Andrea
                          Linked_Spreadsheet_Table_Formulas_E.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try below:
                                    
                                    =SUMIFS(Table2[Minutes],Table2[WO_Change],"<>*Cancelled*",Table2[WO_Change],"<>*Deferred*")+SUMIFS(Table2[Minutes2],Table2[WO_Change],"<>*Cancelled*",Table2[WO_Change],"<>*Deferred*")

                                    
                                      Select all
                                      Open in new window
                                    Andrea_Linked_Spreadsheet_Table.xlsx</pre>

<pre class="amctext">Excellent! Thanks very much, Shums :-)
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample workbook with all 3 spreadsheets and the result needed (14 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w30/1184546/Linked_Spreadsheet_Table_Formulas_E.xlsx">Linked_Spreadsheet_Table_Formulas_E.xlsx</a></p>
<p class="amcfile">SumIFS (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w30/1184553/Andrea_Linked_Spreadsheet_Table.xlsx">Andrea_Linked_Spreadsheet_Table.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Autopopulate field as Yes or No based on whether date in previous column is past a specific date</h2>
<p class="amcdate">2017-03-29T16:32:44-0400</p>

<pre class="amctext">In my spreadsheet, Column A has the following consistent entry format (initials–date) as shown below:
                          AA–DD-MMM-YY
                          AA–DD-MMM-YY
                          Where 'AA' denotes the various users' two-letter initials (RB, SC, etc.)
                          (Please note that the dash between the initials and the date is an EN dash, not a regular dash)
                          
                          I would like Column B to auto-populate based on the following conditions:
                          If date in Column A is on or before a specific date (ie., 21-Mar-17), then Column B = 'Yes'
                          If date in Column A is after the specific date (21-Mar-17) , then Column B = 'No'
                          
                          The 'specific date' in the formula would be changed every two or three months, depending on our production cycle. For example, in two months time I would be changing the date from 21-Mar-17 to 27-May-17.
                          
                          Would VBA be the better solution vs. a cell-based formula, given that the 'specific date' value would only need to be changed in once in the code?
                          
                          I have attached a sample file to illustrate this question.
                          
                          Thanks!
                          Andrea
                          EE_Sample_YesNo_Based_on_Date.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Do you need formula or VBA?
                                    
                                    Formula would be:
                                    
                                    =IF(TEXT(RIGHT(A2,9),"dd-mmm-yy")<TEXT(TODAY()-7,"dd-mmm-yy"),"Yes", "No")

                                    
                                      Select all
                                      Open in new window
                                    Please find attached...If you need VBA, then let me know
                                    EE_Sample_YesNo_Based_on_Date.xlsx</pre>

<pre class="amctext">Thanks, Shum, for the quick response! Yes, actually, I'd prefer VBA if possible?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Please try below, assuming your sheet name is Sheet1 & you need to fill result from C2 to the whole range:
                                    
                                    Sub UpdateDeadLine()
Dim Ws As Worksheet
Dim LR As Long
Application.ScreenUpdating = False
Set Ws = Worksheets("Sheet1") ' Change the sheet name here
LR = Ws.Range("A" & Rows.Count).End(xlUp).Row
Ws.Range("C2:C" & LR).FormulaR1C1 = "=IF(TEXT(RIGHT(RC1,9),""dd-mmm-yy"")<TEXT(TODAY()-7,""dd-mmm-yy""),""Yes"", ""No"")"
Ws.Range("C2:C" & LR).Value = Ws.Range("C2:C" & LR).Value
Ws.Range("C1").Select
Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Please find attached...
                                    EE_Sample_YesNo_Based_on_Date_v1.xlsm</pre>

<pre class="amctext">Thanks, Shum! I'll check this out. BTW, just confirming that the specific date (ie., 21-Mar-17) is a static value (it's a deadline date), so will that date stay fixed as 21-Mar-17 when I open the spreadsheet in the future?
                                    
                                    Andrea</pre>

<pre class="amctext">Andrea,
                                    
                                    Please try to change date and check if formula works, if yes then go for VBA option.</pre>

<pre class="amctext">I have used less 7 days as a deadline, that what you want?</pre>

<pre class="amctext">Or is it every Tuesday?</pre>

<pre class="amctext">It's actually a fixed date, and in this case it is 21-Mar-17.</pre>

<pre class="amctext">Then you should have another column as Dead Line date then Comments. Let me work out for you.</pre>

<pre class="amctext">Thanks, Shum...much appreciated. And sorry, I realized I should have mentioned that if the cell in column A is blank, than the cell in column B should be blank as well. Column B should only auto-populate when Column A is not blank...
                                    
                                    Andrea</pre>

<pre class="amctext">OK I have added a Deadline date in Column B, so your formula in Column C would be:
                                    
                                    =IF(TEXT(RIGHT($A2,9),"dd-mmm-yy")<TEXT($B2,"dd-mmm-yy"),"Yes", "No")

                                    
                                      Select all
                                      Open in new window
                                    And your VBA code would be:
                                    
                                    Sub UpdateDeadLine()
Dim Ws As Worksheet
Dim LR As Long
Application.ScreenUpdating = False
Set Ws = Worksheets("Sheet1") ' Change the sheet name here
LR = Ws.Range("A" & Rows.Count).End(xlUp).Row
Ws.Range("C2:C" & LR).FormulaR1C1 = "=IF(TEXT(RIGHT(RC1,9),""dd-mmm-yy"")<TEXT(RC2,""dd-mmm-yy""),""Yes"", ""No"")"
Ws.Range("C2:C" & LR).Value = Ws.Range("C2:C" & LR).Value
Ws.Range("C1").Select
Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Now you don't need to worry about Static Dates.
                                    EE_Sample_YesNo_Based_on_Date_v2.xlsm</pre>

<pre class="amctext">BTW, is it possible to avoid having another column as a deadline date if we use VBA, and just include the deadline date in the code?</pre>

<pre class="amctext">You mean you need an Input Box to enter Deadline date?</pre>

<pre class="amctext">Thanks, but I don't think I need an Input Box. I'll have a look at what you've provided in more detail...</pre>

<pre class="amctext">I would still recommend you have extra column as Deadline, because you may need different date for different row. Input Box will fill the whole range.
                                    
                                    Please find attached modified with blanks.
                                    EE_Sample_YesNo_Based_on_Date_v3.xlsm</pre>

<pre class="amctext">The deadline date is a single date, and is fixed for several months, so I actually won't need a different date. I would prefer if the user did not have to click on an 'Update' button to auto-populate the column (trying to reduce their 'overhead'), but that it is automated so that as soon as the user populates Column A with their Initials + Date in the approved format, then 'Yes' or 'No' autopopulates accordingly. Is this possible?
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">Hi,
                                    
                                    Thanks again for your help. I've added a 'Deadline' column as suggested and have used the formula you provided in the sample spreadsheet uploaded with this comment, and the only tweak I need in the formula to make this work is to include the following condition:
                                    
                                    If Column A is blank, then Column C should be blank
                                    
                                    Thanks!
                                    Andrea
                                    EE_Sample_YesNo_Based_on_Date_Updat.xlsx</pre>

<pre class="amctext">You can use below formula:
                                    
                                    =IF(A2="","",IF(TEXT(RIGHT($A2,9),"dd-mmm-yy")<TEXT($B2,"dd-mmm-yy"),"Yes","No"))

                                    
                                      Select all
                                      Open in new window
                                    EE_Sample_YesNo_Based_on_Date_v4.xlsx</pre>

<pre class="amctext">Thanks so much, Shum, for your patience and quick responses...much appreciated! :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're Welcome Andrea! Glad I was able to help :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w13/1153710/EE_Sample_YesNo_Based_on_Date.xlsx">EE_Sample_YesNo_Based_on_Date.xlsx</a></p>
<p class="amcfile">Example (9 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w13/1153711/EE_Sample_YesNo_Based_on_Date.xlsx">EE_Sample_YesNo_Based_on_Date.xlsx</a></p>
<p class="amcfile">Update Deadline (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w13/1153714/EE_Sample_YesNo_Based_on_Date_v1.xlsm">EE_Sample_YesNo_Based_on_Date_v1.xlsm</a></p>
<p class="amcfile">Comments (17 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w13/1153718/EE_Sample_YesNo_Based_on_Date_v2.xlsm">EE_Sample_YesNo_Based_on_Date_v2.xlsm</a></p>
<p class="amcfile">Comments (17 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w13/1153719/EE_Sample_YesNo_Based_on_Date_v3.xlsm">EE_Sample_YesNo_Based_on_Date_v3.xlsm</a></p>
<p class="amcfile">Sample utilizing formula provided above (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w13/1153723/EE_Sample_YesNo_Based_on_Date_Updat.xlsx">EE_Sample_YesNo_Based_on_Date_Updat.xlsx</a></p>
<p class="amcfile">Comment (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w13/1153724/EE_Sample_YesNo_Based_on_Date_v4.xlsx">EE_Sample_YesNo_Based_on_Date_v4.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Userform (?) for selecting specific row(s) from one spreadsheet and paste partial part of row into another spreadsheet</h2>
<p class="amcdate">2013-11-10T13:14:00-0500</p>

<pre class="amctext">I have attached a sample file to show our current process:
                          
                          Worksheet 1: a static inventory list
                          Worksheet 2: a tracking tool for select procedures from Worksheet 1 that have revisions
                          
                          Current process:
                          In Worksheet 1, inserting "Yes" in column "X" triggers 6 cells from that row to be copied and pasted into Worksheet 2 into the next available blank row, as follows:
                          Column V copied into Column A
                          Column W copied into Column B
                          Column A copied into Column C
                          Column B copied into Column D
                          Column L copied into Column E
                          Column M copied into Column F
                          
                          There are instances when the same row needs to be copied over to Worksheet 2 a second, third and fourth time (as there can be multiple revisions to the same procedure during the 2-month production cycle), which requires the user to go back to Worksheet 1 and remove and re-insert "Yes" in Column "X" each time.
                          
                          I am looking for a more sophisticated solution where:
                          
                          
                            Users don't have to go back and forth between 2 spreadsheets, but can work exclusively in Worksheet 2
                          
                          
                            Users have a means from within Worksheet 2 to find and select rows from Worksheet 1, based on selecting the values for up to 3 columns in Worksheet 1 (Column A, B and D)
                          
                          
                            That from the selected rows, only specific cells are copied & pasted (as "values") into Worksheet 2 (as originally outlined above).
                          
                          
                          Thanks!
                          Andrea
                          EE-SampleExistingProcess.xlsm</pre>

<pre class="amctext">I made a slight revision to your code. Instead of entering "Yes" for revision, you enter the number of revisions you want to copy over.
                                    
                                    Flyster
                                    EE-SampleExistingProcess.xlsm</pre>

<pre class="amctext">Hi Flyster,
                                    
                                    While some of the rows may be copied over more than once over the span of the 2-month production period, they would only ever be transferred once each time they are transferred. The catalyst to transfer a row is when there are subsequent revisions to a procedure, and that it unpredictable, and can happen at any time during the cycle.
                                    
                                    So unfortunately your code isn't something we can use for our situation. But thanks anyway!
                                    
                                    Andrea</pre>

<pre class="amctext">I assume Flyster would be able to amend his code such that each run of the revision would check how many revisions have already occurred for a particular ID and then only repeat it if the number of revisions is less than the number quoted against it.
                                    
                                    Thanks
                                    Rob H</pre>

<pre class="amctext">If Flyster would be able to amend the code as you describe, Rob, then that would certainly be an improvement to my current process, and hopefully could be incorporated into a final solution that addresses the issues identified in my original post.</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Sorry I misunderstood your need. How do you determine if there has been a revision and which field do you use for your ID?
                                    
                                    Paul</pre>

<pre class="amctext">My apologies for missing this most recent post to my question!
                                    
                                    The revision request is received by e-mail, but there is no ID to link the e-mail request to the spreadsheet. The user interprets the e-mailed request to identify which procedure is being revised, goes into Worksheet 1 in the spreadsheet, changes the value in the "Revision" column to "Yes", which then triggers the cells to autopopulate in Worksheet 2.
                                    
                                    My goal is to be able to have a userform interface of some sort if possible, which would display the rows contained in Worksheet 1 with the ability for the user to check off the procedure(s) to be transferred into Worksheet 2, then click OK. This would trigger the rows (partial, as per my spreadsheet example supplied in my first post) to autopopulate in Worksheet 2, as well to as "clear" the userform of all checkmarks, so that the userform can be repeated as many times as required for the same or different procedures.
                                    
                                    I don't know if my request is realistic or not. If not, then alternatively, if it is possible that, instead of "Yes" in the Revision column of Worksheet 1, if the user could use the number 1 for the first revision, and if a 2nd request for a revision came in for the same procedure, the user changes the number 1 in that row to 2, which would trigger the partial row to be copied over once more, for a total of 2 rows of the same procedure in Worksheet 2. There could be as many as 10 revisions on the same procedure. If a revision was cancelled, however, the user would not being revising the number downwards in the Revision column of Worksheet 1: they would be going into Worksheet 2 and manually removing the last row copied over for that procedure. So there is no requirement that the number of rows in Worksheet 2 match the number in the Revisions column in Worksheet 1. It is just about improving a currently clumsy, counter-intuitive interface, where the user toggles back and forth, inserting Yes, then removing it again at a later date and re-inserting it every time the same procedure needs to be copied over again.</pre>

<pre class="amctext">For your review. I put a command button on worksheet 2 to open the user form. There's 10 rows on the form so you should see all data in worksheet 1 from A2 to D11. The user will select the checkbox next to the data needed to be copied onto worksheet 2. Selecting the copy command button will copy the required data to worksheet 2 and then clear the checkboxes. As I don't believe in reinventing the wheel, I used your original code for that. Hope this is what you were looking for!
                                    EE-SampleExistingProcess.xlsm</pre>

<pre class="amctext">This is the kind of interface I was looking for...I'm so pleased!
                                    
                                    I haven't used userforms before, and have a question before I figure out how to implement what you've achieved — our Worksheet 1 has about 2500 rows in it, so will the userform automatically add a scrollbar when the # of records exceed what the userform can show? I like the size of the userform you have created.
                                    
                                    Please don't hesitate to let me know if this question should be entered in EE as a new one, rather than asked here...
                                    
                                    Andrea</pre>

<pre class="amctext">I have to admit, I'm somewhat new to user forms myself. There's no automatic scroll bar, but I believe it can be achieved through programing. I have already figured out how to scroll down through the data, just having a little problem going the other way. Then I have to figure out how to transfer that information to the worksheet 2 update routine!</pre>

<pre class="amctext">OK. The scroll down and up buttons will scroll through your data. Selecting a checkbox and copy revision will add your data to worksheet 2. As you can't page up or down while the user form is open, I added two buttons on the left (U & D) which will do it without having to close the form. Let me know what you think!
                                    EE-SampleExistingProcessScroll.xlsm</pre>

<pre class="amctext">Super...thanks so much for all your work! And I appreciate the ability to page up and down with the form open. Look forward to implementing this.</pre>

<pre class="amctext">Thanks! Hope it works out for you.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of current process used to select rows from one sheet, and copy specific cells of that row to another sheet (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/11_w46/687285/EE-SampleExistingProcess.xlsm">EE-SampleExistingProcess.xlsm</a></p>
<p class="amcfile">Number of Revisions (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/11_w46/687297/EE-SampleExistingProcess.xlsm">EE-SampleExistingProcess.xlsm</a></p>
<p class="amcfile">Userform (33 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/11_w47/689248/EE-SampleExistingProcess.xlsm">EE-SampleExistingProcess.xlsm</a></p>
<p class="amcfile">Userform with Scroll (71 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/11_w48/689851/EE-SampleExistingProcessScroll.xlsm">EE-SampleExistingProcessScroll.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Using "sum" and "countif" to meet multiple criteria in Excel</h2>
<p class="amcdate">2014-07-02T22:23:28-0400</p>

<pre class="amctext">I need a formula that gives me the number of instances when BOTH sets of criteria outlined below are met. Instead the formula I came up with appears to be acting as an "OR" formula, not an "AND" formula, and adding the results of the individually met criteria together:
                          
                          =SUM(COUNTIFS(JobPhase1_Range,{"QC-complete/ready to generate","See next ADC (done in conjunction)"}),(COUNTIFS(TypeOfChange1,{"New"})))
                          
                          I am wondering how to fix this formula...
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">Again, SUMPRODUCT solves this:
                                    =SUMPRODUCT(--(JobPhase1_Range="QC-complete/ready to generate")+--(JobPhase1_Range="See next ADC (done in conjunction)"),--(TypeOfChange1="New"))
                                    
                                    If you could store your string tests in another pair of cells this would be simpler and more-dynamic.  
                                    For example, if you stored the two strings in cells H1 and H2, the formula would look like this:
                                    =SUMPRODUCT(--(JobPhase1_Range=H1)+--(JobPhase1_Range=H2),--(TypeOfChange1="New"))
                                    
                                    The double dashes (--) convert the TRUE/FALSE results in each group to 1/0.
                                    
                                    Adding the first two tests is the mathematical equivalent to an OR condition on the first test.
                                    
                                    Regards,
                                    -Glenn</pre>

<pre class="amctext">You could also add two COUNTIFS functions:
                                    =COUNTIFS(JobPhase1_Range,"QC-complete/ready to generate",TypeOfChange1,"New")+COUNTIFS(JobPhase1_Range,"See next ADC (done in conjunction)",TypeOfChange1,"New")</pre>

<pre class="amctext">Both work perfectly! Thanks so much for the quick and excellent solutions, Glenn....</pre>

<pre class="amctext">You're welcome.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Controlling user entry in Excel user form combo boxes</h2>
<p class="amcdate">2018-02-15T08:40:43-0500</p>

<pre class="amctext">I have an Excel user form with two combo boxes ('Task' and 'Status'):
                          > I tried to set the Style property of both combo boxes to 2 - fmStyleDropDownList to restrict the user to only selecting entries from the dropdown box and not being able to place their cursor in the field and remove or enter text.
                          > The 'Status' combo box appears to work without generating an error message
                          > The 'Task' combo box now gives me the following error message when I go to select an item from the dropdown menu:
                          
                          Run-time error '380'
                          Could not set the Text property. Invalid property value.
                          
                          When I click on Debug, it points me to a highlighted line:
                          
                          
                              .Text = .List(.ListIndex, 1)

                          
                            Select all
                            Open in new window
                          
                          As I am not very savvy in this area, I have attached the Excel file with the user form in question to demonstrate what is happening.
                          
                          Please let me know if you need any more information.
                          
                          Thanks,
                          Andrea
                          Task_Plan_EE.xlsm</pre>

<pre class="amctext">Try it like this...
                                    
                                    
                                    .Text = .List(.ListIndex, 0)

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Subodh,
                                    
                                    Thanks for the quick response! I tested the solution, and while it fixes the issue, it has changed the way the Task field is populated. Instead of being populated with the Task, it is being populated with the ID number. I set up the 3-column dropdown, etc. with the help of this forum, and during the course of the solution, a 'hidden' field was added to the user form which may be impacting this behaviour...? See screen captures below. 
                                    
                                    Is it possible for the task field to revert to being populated by the task, as per the original user form, but still benefit from the solution you have provided?</pre>

<pre class="amctext">Actually the ComboBox will display the content of the first column.
                                    To display the Task which is second column in the ComboBox list, all you can do is, change the order of columns i.e. Task, ID and PA Unit instead of ID, Task and PA Unit.
                                    
                                    In the attached, I created a table with desired column order in range M:O (Columns are hidden) on Task Sheet. 
                                    And then created a named range called "TaskCombo" which I used as the RowSource for the cboTask.
                                    I also commented out the code in UserForm Initialize event which sets the cboTask ComboBox properties as it is not required now.
                                    
                                    See if this is something you can work with.
                                    Task_Plan_EE.xlsm</pre>

<pre class="amctext">Perfect...thanks very much for the solution and explanation, Subodh!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're welcome Andrea! Glad I could help.
                                    Thanks for the feedback.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Excel user form (414 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/02_w07/1274578/Task_Plan_EE.xlsm">Task_Plan_EE.xlsm</a></p>
<p class="amcfile">Task_Plan_EE.xlsm (408 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/02_w07/1274671/Task_Plan_EE.xlsm">Task_Plan_EE.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Converting a formula to a macro in Excel 2010</h2>
<p class="amcdate">2016-05-03T15:07:33-0400</p>

<pre class="amctext">I would like to convert a formula to a macro that I can run on demand, and additionally, refine the results. I have attached a sample spreadsheet to help illustrate what I am looking for:
                          
                          WO_List tab:
                          Col A - is a dynamic name range called "WO", and is a list of work orders to be published for July
                          
                          Sheet 2 tab:
                          Col A - is a list of work orders extracted from a publication for verification
                          Col B - contains the following formula which checks the work order in Col A against the 'WO_List' Col A work orders, and if there is a match, it populates the cell with the work order number, and if there is not a match, the cell remains blank:
                          
                          =IFERROR(INDEX(EE_IndexMatch.xlsm!WO,MATCH($A2,EE_IndexMatch.xlsm!WO,0)),"")
                          
                          Refinement:
                          On Sheet 2 tab, Col B, when there is not a work order match, then instead of a blank cell I would like the following phrase to be entered into the respective cell: "WO not in current cycle"
                          
                          If you have any questions or need anything further, please let me know...
                          
                          Thanks,
                          Andrea
                          EE_IndexMatch.xlsm</pre>

<pre class="amctext">Try this....
                                    
                                    
                                    Sub InsertFormula()
Dim ws As Worksheet
Dim lr As Long
Set ws = Sheets("Sheet 2")
lr = ws.Cells(Rows.Count, 1).End(xlUp).Row
ws.Range("B2:B" & lr).Formula = "=IFERROR(INDEX(WO,MATCH(A2,WO,0)),""WO not in current cycle"")"
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Excellent! And thanks for the quick response. :-)
                                    
                                    Andrea</pre>

<pre class="amctext">You're welcome Andrea! Glad I could help.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of formula to be converted to macro (38 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/05_w19/1094947/EE_IndexMatch.xlsm">EE_IndexMatch.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Replacing TRUE and FALSE with more meaningful text in date compare formula</h2>
<p class="amcdate">2014-03-16T12:47:11-0400</p>

<pre class="amctext">Column B and Column D contain date/time stamps. I am using this formula below to check whether the date in Column B is newer than the one in Column D, and Column E gives TRUE or FALSE results:
                          
                          =($B2)/($D2)>1
                          
                          I would like a formula that replaces TRUE and FALSE results with more meaningful text as follows:
                          
                          If FALSE, then "Book okay"
                          IF TRUE, then "Update book"
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">=if(($B2)/($D2)>1,"Update book","Book okay")</pre>

<pre class="amctext">Thanks for your quick response...works perfectly!
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Expanding an IF argument to checking condition in 3 different cells</h2>
<p class="amcdate">2013-10-21T13:49:24-0400</p>

<pre class="amctext">I have a formula that populates cell F2 based on the contents of AA2:
                          
                          =IF(AA2="","n/a",IF(AA2="Cancelled","n/a",IF(AA2="New","Need sign-off",IF(AA2="No change","n/a",""))))
                          
                          I would like to expand this formula so that in addition to checking the contents of AA2, it also checks the contents of AQ2 and BG2. That is the only change to the formula that is required...all other elements would stay the same.
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">The following formula should accomplish what you're looking for, if I understand you correctly, and will do so a bit more efficiently (fewer IF statements) using the OR option.
                                    
                                    =IF(OR(AA2="",AA2="Cancelled",AA2="No change",AQ2="",AQ2="Cancelled",AQ2="No change",BG2="",BG2="Cancelled",BG2="No change"),"n/a",IF(OR(AA2="New",AQ2="New",BG2="New"),"Need sign-off"))</pre>

<pre class="amctext">A little shorter formula using array constants:
                                    =IF(SUM(COUNTIF(INDIRECT({"AA","AQ","BG"}&ROW(AA2)),{"","Cancelled","No change"})),"n/a",IF(OR(AA2="New",AQ2="New",BG2="New"),"Need sign-off",""))</pre>

<pre class="amctext">Thanks to both of you for answering my question so quickly! I tried both solutions, and this is the one that worked + it has the added bonus of being a shorter formula!
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Resolving incorrect count of completed work orders between two dates</h2>
<p class="amcdate">2017-06-02T16:13:55-0400</p>

<pre class="amctext">I am not getting the correct results with my current formula that determines the # of work orders completed between two dates. Specifically, if the date range is from March 16, 2017 to May 11, 2017, then any work orders completed on last date, May 11, 2017 are not being counted. How do I revise my formula so that the work orders completed on the last date in the date range are included in the results?
                          
                          I have outlined the spreadsheet details and current formula being used below, and included a sample spreadsheet with Row 4 on Sheet2 showing the desired results in red.
                          
                          Sheet1:
                          List of the work orders
                          Col E – date that the WO was completed
                          
                          Sheet2:
                          Calculates the number of work orders completed between two dates:
                          Row 1: 'Start' dates
                          Row 2: 'End' dates
                          Row 3: # of WOs in Column E in Sheet 1 between Row 1 'Start' date and 'Row 2' End date
                          
                          Formula in Row 3:
                          =COUNTIFS(Sheet1!$E$2:$E$189,">="&B$1,Sheet1!$E$2:$E$189,"<="&B$2)
                          
                          Desired results listed in Row 4 in red.
                          
                          I think that covers it...
                          
                          Thanks!
                          Andrea
                          EE_IncorrectCountBetweenDates.xlsm</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Because some of the cells are formatted with time, I corrected only with date.
                                    
                                    See attached...
                                    EE_IncorrectCountBetweenDates.xlsm</pre>

<pre class="amctext">Hi Shums,
                                    
                                    Thanks for the quick response. So just so I understand - you fixed the date column by removing the time so that I got the correct results? If so, I need to address this at the source to ensure that only the date, and not the time, is entered in Col E. Currently, the Col E date is entered using data validation, and the lookup = NOW() and the cell containing the lookup value is formatted as '14-Mar-01'. Yet somehow, from what you discovered, the time is also being included along with the date.
                                    
                                    I've updated the sample spreadsheet to include the data validation I'm using for Column E, to illustrate what I mean, in hopes that the lookup for Col E will result in a date only so that my formula for calculating the # of work orders will be accurate.
                                    
                                    Thanks!
                                    Andrea
                                    EE_IncorrectCountBetweenDates_Ver2.xlsm</pre>

<pre class="amctext">Andrea,
                                    
                                    =Now() is for date and time, rather use =Today() and it should work.</pre>

<pre class="amctext">Excellent...thanks very much, Shums!
                                    
                                    Andrea</pre>

<pre class="amctext">Thank you!!</pre>

<pre class="amctext">You're Welcome Andrea! Pleased to help you :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of spreadsheet formula issue (1.1 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w22/1165912/EE_IncorrectCountBetweenDates.xlsm">EE_IncorrectCountBetweenDates.xlsm</a></p>
<p class="amcfile">Count IFS (1.1 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w22/1165918/EE_IncorrectCountBetweenDates.xlsm">EE_IncorrectCountBetweenDates.xlsm</a></p>
<p class="amcfile">Showing data validation being used for date entry (1.1 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w22/1165922/EE_IncorrectCountBetweenDates_Ver2.xlsm">EE_IncorrectCountBetweenDates_Ver2.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Dynamic named range question related to Excel user form combo box</h2>
<p class="amcdate">2018-04-02T16:19:47-0400</p>

<pre class="amctext">I've created an Excel user form to track time spent on projects. Each employee will have their own User Form workbook. Each workbook will have a 'Tasks' list linked to a single Master Project List so that everyone has the same list of projects within their User Form workbook.
                          
                          DESCRIPTION OF WORKBOOK WITH USER FORM:
                          User form: Opens when workbook opens, or when 'Add a record' button is clicked, and is the form employees use to enter the project name and # of minutes worked on it. The 'Task' field is a combo box, pulling from a dynamically named range as described under 'Tasks' tab below.
                          Tracking sheet tab: A hidden spreadsheet that is updated by entering records in the User Form
                          Tracking view tab: The employee view (read-only) of records, populated from the hidden tracking sheet as described in previous line
                          Tasks tab:
                          
                          
                            Linked to a 'Master Project List' spreadsheet so it will update whenever new projects are added to the Master Project List
                          
                          
                            There is a dynamic named range on the Tasks tab called "TaskList" that serves as the dropdown list for the User Form's combo box called cboTask. It includes a number of 'blank' linked rows originating from the Master Project List that serve as placeholders so that the list of projects in the Tasks tab will update as soon as they are added to the Master Project List
                          
                          
                            The Master Task List resides as a separate workbook, but for the purposes of posting this question on EE, I have added it as a tab to this workbook
                          
                          
                          CHALLENGE:
                          On the User Form is a combo-box listing the projects. Because of the dynamic named range including the blank placeholder rows as described above, these rows show up in the drop down box and can be accidentally selected. When a blank row is accidentally selected, it populates the following fields with "0":
                          
                          
                            Task
                          
                          
                            ID
                          
                          
                            Product/Unit
                          
                          
                          DESIRED SOLUTION(S):
                          Is there any way that the dynamic named range on the 'Tasks' tab called TaskList can be set to ignore the rows that have links but are not populated with data, so that the combo box dropdown on the User Form is limited to showing the projects, and not also all the blank placeholder rows?
                          
                          
                          If the above is not possible, then is there a way to update the existing error-handling for the 'Save' button such that if the cboTask = 0, then it would trigger the error message? I attempted this myself, but did not have success.
                          
                          Please let me know if you have any questions or need clarification on any details...
                          
                          Thanks!
                          Andrea
                          Task_Plan_AC.xlsm</pre>

<pre class="amctext">Where is the data in the Master Task List coming from, is it manually inputted?</pre>

<pre class="amctext">Hi Mason,
                                    
                                    Yes, the Master Task List is manually updated as new projects come online...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">The blank rows are a poor idea. Why not simply sort the source as it is entered.</pre>

<pre class="amctext">I've just looked at your WorkBook and you have a Table for the Tasks, so I can see no advantage in using a Named Range. Tables are Dynamic anyway.
                                    
                                    Providing that the format is correct then this will do what you want
                                    Task_Plan_AC.xlsm</pre>

<pre class="amctext">I've amended the code for the Status combo, note I have removed all unused rows in the Table.
                                    
                                    Now the zeros do not appear in cboStatus
                                    
                                    Also, removed TaskList
                                    Task_Plan_AC.xlsm</pre>

<pre class="amctext">Hi Roy,
                                    
                                    Thanks for your replies. I've tried out the updated file, and unfortunately ran into a few issues. 
                                    
                                    The 'Tracking View" tab (not the "Tasks" tab) is meant to be the active spreadsheet for the employee. It provides read-only views of their saved records, and has the button to re-activate the User Form if/ as needed (as the employee can choose to cancel the User Form to view their read-only records). When I opened the file, the tab that was active was the "Tasks" tab. When I switched to the "Tracking View" tab and clicked on 'Add a Record' button to open the User Form and select an item from the Task drop down, the drop down menu did not contain the list of tasks, as shown below:
                                    
                                    
                                    I then tested the User form, and when I tried to save a record, I received an error message "Run-time error 438". The default date in the user form was 30-Dec-99 instead of the current date (is that actually a zero value in a date format, which perhaps is causing the error message?).
                                    
                                    
                                    Please let me know if you have any questions about my feedback...
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">I've only answered the question relating to the combobox. I haven't changed or looked at the other code.I'll have a look at the rest of the code.
                                    
                                    The workbook opened on the last used sheet, which is how Excel works. If you need it to always open on a specific sheet then you require code to force that to happen.</pre>

<pre class="amctext">Is this right now?
                                    Task_Plan_AC.xlsm</pre>

<pre class="amctext">Hi Roy,
                                    
                                    Thanks for your helpful tip on ensuring that the spreadsheet opens on a specific tab.
                                    
                                    I opened your latest file, and the default date is working fine now - thanks!
                                    
                                     I then tested out entering a record, and noticed that unfortunately the drop down for the combo box is still problematic, as shown in the screen capture below. I've also included a second screen capture of how the drop down should look:
                                    
                                    
                                    Andrea</pre>

<pre class="amctext">Slight modification made. I hadn't allowed for you opening the userform on a different sheet.
                                    
                                    Note the other Tables don't need those empty rows.
                                    Task_Plan_AC--1-.xlsm</pre>

<pre class="amctext">I,m not a big fan of hiding the Application but I've added an error handler in case problems occur loading the form. Without this if an error occurs then the application will remain invisible. I can't actually see any need for it in the Open event of the userform.
                                    
                                    Also, your code opens the userform to the right of my screen, is this what you intended?</pre>

<pre class="amctext">Hi Roy,
                                    
                                    Yes, having the userform open to the right is intentional. Thanks for your replies. I just got back from being out of town so haven’t had a chance to review your most recent feedback, but will have time tomorrow evening to do so and get back to you...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">No problem</pre>

<pre class="amctext">Hi Roy,
                                    
                                    I'm sorry about the delay in getting back to you. I tested out the latest file, and there are a couple of issues:
                                    
                                    1. I am receiving a runtime error when trying to save a record. 
                                    2. The combo box still shows the blank rows below the list of tasks, which can be selected, populating 3 fields with zeroes.
                                    
                                    
                                    
                                    I do appreciate your efforts, Roy. I suspect that how I have set this workbook up in the first place is causing problems that may not be fixable...? My idea of setting up the combo box that references a dynamically named range, that in turn links to an external spreadsheet may be fundamentally problematic. I am not savvy enough in Excel to determine this, but at this point maybe it's best to abandon my idea. Perhaps you can advise?
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">the debugging error occurs because you haven't assigned a value to NextRow before saving.
                                    
                                    The empty rows are because you have empty rows in the source Table, the only way around this would be to have a separate table for each ComboBox</pre>

<pre class="amctext">Thanks for all your help with this, Roy. I have the answers I need to proceed...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Let me know if you need further help. I can split the Table and use two for populating the comboboxes if you want.</pre>

<pre class="amctext">I've split the Table and removed the empty rows on the ComboBox
                                    Task_Plan_AC--1---3-.xlsm</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of User Form workbook (439 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/04_w14/1293868/Task_Plan_AC.xlsm">Task_Plan_AC.xlsm</a></p>
<p class="amcfile">Task_Plan_AC.xlsm (413 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/04_w14/1294022/Task_Plan_AC.xlsm">Task_Plan_AC.xlsm</a></p>
<p class="amcfile">Task_Plan_AC.xlsm (379 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/04_w14/1294081/Task_Plan_AC.xlsm">Task_Plan_AC.xlsm</a></p>
<p class="amcfile">Task_Plan_AC.xlsm (380 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/04_w14/1294555/Task_Plan_AC.xlsm">Task_Plan_AC.xlsm</a></p>
<p class="amcfile">Task_Plan_AC--1-.xlsm (379 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/04_w14/1294995/Task_Plan_AC--1-.xlsm">Task_Plan_AC--1-.xlsm</a></p>
<p class="amcfile">Task_Plan_AC--1---3-.xlsm (384 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/04_w15/1296823/Task_Plan_AC--1---3-.xlsm">Task_Plan_AC--1---3-.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Adding another Private Sub Worksheet_Change in Excel 2010</h2>
<p class="amcdate">2014-03-02T17:10:54-0500</p>

<pre class="amctext">I am implementing the following code found through this website to simulate autocomplete in column A of a worksheet called "NEW_Procedures" using data from a named range called "Location" located in another worksheet called "Lookups". I would like to also use autocomplete for column D in worksheet "NEW_Procedures" using data from a named range called "ProcedureIdent" in worksheet "Lookups". 
                          
                          How do I add another Private Sub Worksheet_Change as described above to the existing code below?
                          
                          
                          Private Sub Worksheet_Change(ByVal Target As Range)
     'Sub "autocompletes" data entered into column A using a source table on a different worksheet. If more than one match is
     '    found, the user is allowed to continue entering characters until a unique match is found. If no matches are found, the
     '    data is accepted as entered. ALT + Enter, Enter to force the macro to accept data as entered. The sub is triggered by
     '    the Enter key.
    Dim cel As Range, match1 As Range, match2 As Range, rg As Range, targ As Range
     
     '***Please adjust the next two statements before using this code!***
    Set targ = Intersect(Target, Range("A:A")) 'Watch the cells in column A
    Set rg = Worksheets("Lookups").Range("Location") 'Use named range Location for "autocomplete" info
     
    If targ Is Nothing Then Exit Sub
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    On Error GoTo errhandler 'If code encounters an error, turn events back on
     
    For Each cel In targ
        If Not IsError(cel) Then
            If cel <> "" And Right(cel, 1) <> Chr(10) Then
                Set match1 = Nothing
                Set match1 = rg.Find(cel & "*", lookat:=xlWhole, MatchCase:=False) 'Match is case insensitive
                If Not match1 Is Nothing Then
                    Set match2 = rg.FindNext(after:=match1)
                    If match2.Address = match1.Address Then 'Code is fooled by identical strings in two cells
                        cel = match1 'Only one match found. Use it to "autocomplete" the cell
                    Else 'More than one match found. User must enter more data. Return to "Edit" mode
                        cel.Activate
                        Application.SendKeys ("{F2}") 'Begin editing after last character entered
                    End If
                Else 'No matches found. Do not change entered text
                End If
            Else 'Strip the line feed from the end of the text string
                If cel <> "" And Right(cel, 1) = Chr(10) Then cel = Left(cel, Len(cel) - 1)
            End If
        End If
    Next cel
     
errhandler:     Application.EnableEvents = True
    On Error GoTo 0
    Application.ScreenUpdating = True
End Sub

                          
                            Select all
                            Open in new window
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">You can only have one Worksheet_Change event.
                                    
                                    What you need to do is add/change the existing code to include column D.
                                    
                                    Try this, it checks if a cell in column A or D has been changed and determines which range to use based on the column.
                                    
                                    Private Sub Worksheet_Change(ByVal Target As Range)
     'Sub "autocompletes" data entered into column A using a source table on a different worksheet. If more than one match is
     '    found, the user is allowed to continue entering characters until a unique match is found. If no matches are found, the
     '    data is accepted as entered. ALT + Enter, Enter to force the macro to accept data as entered. The sub is triggered by
     '    the Enter key.
    Dim cel As Range, match1 As Range, match2 As Range, rg As Range, targ As Range
     
     '***Please adjust the next two statements before using this code!***
    Set targ = Intersect(Target, Range("A:A, D:D")) 'Watch the cells in column A
    If targ Is Nothing Then Exit Sub
    
    Select Case Target.Column
    
        Case 1
            Set rg = Worksheets("Lookups").Range("Location") 'Use named range Location for "autocomplete" info
        Case 4
            Set rg = Worksheets("Lookups").Range("ProcedureIdent") 'Use named range Location for "autocomplete" info
    End Select
    
     
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    On Error GoTo errhandler 'If code encounters an error, turn events back on
     
    For Each cel In targ
        If Not IsError(cel) Then
            If cel <> "" And Right(cel, 1) <> Chr(10) Then
                Set match1 = Nothing
                Set match1 = rg.Find(cel & "*", lookat:=xlWhole, MatchCase:=False) 'Match is case insensitive
                If Not match1 Is Nothing Then
                    Set match2 = rg.FindNext(after:=match1)
                    If match2.Address = match1.Address Then 'Code is fooled by identical strings in two cells
                        cel = match1 'Only one match found. Use it to "autocomplete" the cell
                    Else 'More than one match found. User must enter more data. Return to "Edit" mode
                        cel.Activate
                        Application.SendKeys ("{F2}") 'Begin editing after last character entered
                    End If
                Else 'No matches found. Do not change entered text
                End If
            Else 'Strip the line feed from the end of the text string
                If cel <> "" And Right(cel, 1) = Chr(10) Then cel = Left(cel, Len(cel) - 1)
            End If
        End If
    Next cel
     
errhandler:
    On Error GoTo 0
    Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">imnorie forgot to turn events back on at the end of the sub. As a result, the Worksheet_Change sub triggers only once.
                                    
                                    The following code puts the targets and lookup ranges in unions of ranges. It then loops through the areas of those unions to get the answer. The code will work as many times in a row as you like.
                                    
                                    
                                    Private Sub Worksheet_Change(ByVal Target As Range)
     'Sub "autocompletes" data entered into column A using a source table on a different worksheet. If more than one match is
     '    found, the user is allowed to continue entering characters until a unique match is found. If no matches are found, the
     '    data is accepted as entered. ALT + Enter, Enter to force the macro to accept data as entered. The sub is triggered by
     '    the Enter key.
    Dim cel As Range, match1 As Range, match2 As Range, rg As Range, targ As Range
    Dim i As Long
    Dim Targets As Range, Sources As Range
    Set Targets = Union(Range("A:A"), Range("D:D"))
    With Worksheets("Lookup")
        Set Sources = Union(.Range("Location"), .Range("ProcedureIdent"))
    End With
    
     
     '***Please adjust the next two statements before using this code!***
    For i = 1 To Targets.Areas.Count
        Set targ = Intersect(Target, Targets.Areas(i)) 'Watch these cells for user input
        Set rg = Sources.Areas(i) 'Use named range for "autocomplete" info
         
        If Not targ Is Nothing Then
            Application.ScreenUpdating = False
            Application.EnableEvents = False
            On Error GoTo errhandler 'If code encounters an error, turn events back on
             
            For Each cel In targ
                If Not IsError(cel) Then
                    If cel <> "" And Right(cel, 1) <> Chr(10) Then
                        Set match1 = Nothing
                        Set match1 = rg.Find(cel & "*", lookat:=xlWhole, MatchCase:=False) 'Match is case insensitive
                        If Not match1 Is Nothing Then
                            Set match2 = rg.FindNext(after:=match1)
                            If match2.Address = match1.Address Then 'Code is fooled by identical strings in two cells
                                cel = match1 'Only one match found. Use it to "autocomplete" the cell
                            Else 'More than one match found. User must enter more data. Return to "Edit" mode
                                cel.Activate
                                Application.SendKeys ("{F2}") 'Begin editing after last character entered
                            End If
                        Else 'No matches found. Do not change entered text
                        End If
                    Else 'Strip the line feed from the end of the text string
                        If cel <> "" And Right(cel, 1) = Chr(10) Then cel = Left(cel, Len(cel) - 1)
                    End If
                End If
            Next cel
        End If
    Next
    
errhandler:
    Application.EnableEvents = True
    On Error GoTo 0
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">byundt
                                    
                                    The original code didn't turn events back on, which I should have noticed and remedied.</pre>

<pre class="amctext">Terrific, and thanks for improving on the original code...</pre>

<pre class="amctext">Andreamary,
                                    Since imnorie and I posted similar code at close to the same time, I feel the points ought to be split. I'm hoping you agree, and have reopened the question (acting in my capacity as Topic Advisor).
                                    
                                    Brad</pre>

<pre class="amctext">Hi Brad,
                                    
                                    Thanks for the guidance...I will rectify as advised, and thanks to you both!
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel formulas meeting 2 criteria, one based on a concatenated column</h2>
<p class="amcdate">2014-09-24T08:10:33-0400</p>

<pre class="amctext">I have attached a spreadsheet with a sample range of data. Column C contains concatenated numbers from column A & B. Column D is a sign-off column. I need 2 (non-array) formulas that calculates the following:
                          
                          1. # of unique 6-digit numbers in Column C where Column D is not blank, and does not contain "N/A"
                          2. # of unique 6-digit numbers in Column C where Column D in not blank, and contains "QRY"
                          
                          There is typically about 1000 rows of data. The reason for the non-array request is that this spreadsheet will be temporarily shared (I know, not good, but beyond my control and fortunately it will be short-term!) so array formulas won't work for this situation.
                          
                          Thanks!
                          Andrea
                          Sample.xlsx</pre>

<pre class="amctext">Please find attached.
                                    Sample.xlsx</pre>

<pre class="amctext">Thanks, Phillip! Before I implement, I was wondering...is there a way to avoid using 'helper' columns in the solution?</pre>

<pre class="amctext">Thanks very much!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">If it were a less complicated question, then you could use COUNTIFS or an array formula, but given that you have to use FIND, I don't believe so - neither COUNTIFS or array formulas work with FIND well.</pre>

<pre class="amctext">Okay, good to know. Thank you...</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample.xlsx (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/09_w39/874047/Sample.xlsx">Sample.xlsx</a></p>
<p class="amcfile">Sample.xlsx (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/09_w39/874053/Sample.xlsx">Sample.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Keep time stamp but have it hidden in column view in Excel spreadsheet</h2>
<p class="amcdate">2015-05-11T13:10:59-0400</p>

<pre class="amctext">Our spreadsheet uses a lookup table, which is based on the following formulas that concatenate the staff's initials + date/time stamp:
                          ="KB–"&TEXT(NOW(),"dd mmm yy–hh:mm")
                          ="AC–"&TEXT(NOW(),"dd mmm yy–hh:mm")
                          ="MN–"&TEXT(NOW(),"dd mmm yy–hh:mm")
                          ="MC–"&TEXT(NOW(),"dd mmm yy–hh:mm")
                          
                          We have purposely included 'hh:mm' in the formulas above, but want the time stamp only show in the formula bar when the cell is highlighted, and NOT in the column within the spreadsheet (makes column too wide in an already very large spreadsheet). For the column in the spreadsheet, we want just the initials & date to show. Is this possible?
                          
                          I've included a sample spreadsheet.
                          
                          Thanks,
                          Andrea
                          Initials-Date-Time-Stamp.xlsx</pre>

<pre class="amctext">That formula will be volatile, i.e it will change. so it will not be a time stamp. To create a non volatile time stamp you would need a VBA function</pre>

<pre class="amctext">Hi Roy,
                                    In response to your note I went back to reopen my sample spreadsheet, and the entries in Column B have maintained the original date and time stamp and did not update. Any new entries, of course, will reflect the current date and time, which is the behaviour I want. Perhaps I'm not understanding what you are referring to as being volatile?
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">Initials-Date-Time-Stamp.xlsm</pre>

<pre class="amctext">The time stamp update when the sheet calculates. Try hitting Calculate Now in the formula tab</pre>

<pre class="amctext">I hit the 'Calculate Now' and the original date/time stamps held and did not update. Is my sample spreadsheet behaving differently at your end?
                                    Andrea</pre>

<pre class="amctext">Why not set the width of the column such that it just shows the part of the value that you want to see?</pre>

<pre class="amctext">Several of my macros resize columns automatically to show all the data. To avoid this particular column from auto resizing, how do I set the column width so that it defaults to the size I want? BTW, the width I would set it at would be 14.
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">At the end of those macros add
                                    
                                        Columns("B:B").Select
                                        Selection.ColumnWidth = 14</pre>

<pre class="amctext">Or better would be to just change the macro so the resizing doesn't resize column B in the first place. And if you need help doing that then please post the code for the macro.</pre>

<pre class="amctext">Thanks, Martin. On closer inspection, it appears my macro doesn't auto resize the columns, it just unhides all columns. If I could incorporate your suggested code into this existing macro, that would be great. Here is the current code:
                                    
                                    
                                    Sub UnhideALLColumn()
'
' UnhideALLColumn Macro
'

'
    Columns("A:FB").Select
    Selection.EntireColumn.Hidden = False
    Range("A1").Select
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">The Timestamps update on the downloaded example.</pre>

<pre class="amctext">Hi Roy,
                                    
                                    Just to confirm that in Column A, the lookup column, the time stamps update (which we want to happen). But in Column B, where we record the initials, date and time when a chart is received, the values remain static. When a chart is received, Column B is updated manually, pulling on Column A for the current date/time stamp.
                                    
                                    I hope this helps clarify what is updating, and what isn't, and confirms that the spreadsheet is working the same way on both our systems?
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">Sub UnhideALLColumn()
'
' UnhideALLColumn Macro
'

'
    Columns("A:FB").Select
    Selection.EntireColumn.Hidden = False
    Columns("B:B").Select
    Selection.ColumnWidth = 14
    Range("A1").Select

End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks, Martin, this will do the trick!
                                    Andrea</pre>

<pre class="amctext">You're welcome and I'm glad I was able to help.
                                    
                                    In my profile you'll find links to some articles I've written that may interest you.
                                    Marty - MVP 2009 to 2015</pre>

<pre class="amctext">Thanks, Martin, I'll check them out!
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Initials-Date-Time-Stamp.xlsx (8 KB) <a href="https://filedb.experts-exchange.com/incoming/2015/05_w20/913381/Initials-Date-Time-Stamp.xlsx">Initials-Date-Time-Stamp.xlsx</a></p>
<p class="amcfile">Initials-Date-Time-Stamp.xlsm (18 KB) <a href="https://filedb.experts-exchange.com/incoming/2015/05_w20/913390/Initials-Date-Time-Stamp.xlsm">Initials-Date-Time-Stamp.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Adding another criteria to an Excel formula</h2>
<p class="amcdate">2017-04-04T10:44:59-0400</p>

<pre class="amctext">My current formula below resides in column AE:
                          
                          =IFERROR(IF($AC2="","",IF($AC2<$AD2,"Yes","No")),"")
                          
                          I would like to incorporate the following additional criteria in the above formula:
                          
                          IF $AD2="n/a", then $AE2 should be ""
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Please try below:
                                    =IFERROR(IF(OR($AC2="",$AD2="n/a"),"",IF($AC2<$AD2,"Yes","No")),"")</pre>

<pre class="amctext">Terrific! Thanks very much, Shums. :-)</pre>

<pre class="amctext">Pleased to help Andrea! :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Convert index-match formula in workbook to VBA</h2>
<p class="amcdate">2017-07-07T21:46:50-0400</p>

<pre class="amctext">I would like to convert the following index-match formula used in the attached sample spreadsheet to VBA instead (to avoid having formulas in the cells).
                          
                          Description of formulas:
                          When the status is entered in Col E in any of the first 3 (identically structured) tabs in the workbook, if the status is listed in the named range called 'Status' located on the tab called 'Site_Details', then Col F, G and H are populated using index-match based on the values listed in the corresponding row in the 'Site_Details' table.
                          
                          Named ranges: Status, Site, State and Card
                          
                          Formulas:
                          
                          Col F
                          =IFERROR(INDEX(SITE,MATCH(E2,STATUS,0)),"")
                          
                          Col G
                          =IFERROR(INDEX(CARD,MATCH(E2,STATUS,0)),"")
                          
                          Col H
                          =IFERROR(INDEX(STATE,MATCH(E2,STATUS,0)),"")
                          
                          I would like the workbook to perform the functions using VBA instead of formulas.
                          
                          I have attached a sample spreadsheet with the following 3 tabs (3 production cycles), each populated with the same index-match formulas to replicate how this workbook is set up:
                          Planned_07-DEC-17
                          Planned_01-FEB-18
                          Planned_03-MAR-18
                          
                          Thanks!
                          Andrea
                          EE_Convert_Formulas_to_VBA.xlsm</pre>

<pre class="amctext">hi Andrea,
                                    
                                    because you will use this code for many sheets, create a new module and put this there: 
                                    Sub Lookup_Site_Details_From_Status(pTarget As Range)
'170607 s4p
   On Error GoTo Proc_Err
   
   Dim sStatus As String _
      , nRow As Long _
      , nRowLookup As Long _
      , sLookupSheetname As String
      
   Dim wsLookup As Worksheet _
      , rng As Range
   
   If pTarget.Column <> 5 Then 'if column is not E
      Exit Sub 'don't do anything
   End If
   
   sLookupSheetname = "Site_Details"
   
   Set wsLookup = Sheets(sLookupSheetname)
   
   sStatus = pTarget.Value 'value to lookup
   nRow = pTarget.Row
   
   'find complete match on Site_Details
   Set rng = wsLookup.Range("A:A").Find _
      (What:=sStatus _
      , LookIn:=xlValues _
      , LookAt:=xlWhole _
      , MatchCase:=False)
       
   With pTarget.Parent 'refer to the Sheet that the Target cell is on
      If rng Is Nothing Then
         'not found - clear values
         .Cells(nRow, 6) = "" 'F
         .Cells(nRow, 7) = "" 'G
         .Cells(nRow, 8) = "" 'H
      Else
         'found -- store row of cell that matches
         nRowLookup = rng.Row
         'fill information
         .Cells(nRow, 6) = wsLookup.Cells(nRowLookup, 2) 'F Site
         .Cells(nRow, 7) = wsLookup.Cells(nRowLookup, 3) 'G State
         .Cells(nRow, 8) = wsLookup.Cells(nRowLookup, 4) 'H Card
      End If
   End With
   
Proc_Exit:
   On Error Resume Next
   Set wsLookup = Nothing
   Exit Sub
  
Proc_Err:
   MsgBox Err.Description, , _
        "ERROR " & Err.Number _
        & "   Lookup_Site_Details_From_Status"

   Resume Proc_Exit
   Resume
End Sub

                                    
                                      Select all
                                      Open in new window
                                    I took time to write this for you -- please take time to understand it. Spend one+ minutes to comprehend each line. Ask if you have questions.
                                    
                                    I put an error handler in too ... gave you the link on a previous EE question to the first video to learn about that -- and here it is again:
                                    
                                    basic error handling code for VBA (3:48)
                                    https://www.experts-exchange.com/videos/1478/Excel-Error-Handling-Part-1-Basic-Concepts.html
                                    
                                    and the other 2 you should also watch:
                                    2. Run and Fix Code Loop through rows of an Excel spreadsheet using VBA (6:00)
                                    https://www.experts-exchange.com/videos/1498/Excel-Error-Handling-Part-2-VBA-to-Copy-Values-Down-to-Blank-Cells-in-an-Excel-Column.html
                                    
                                    3. Excel Error Handling Part 3 - Run and Fix Bugs (7:51)
                                    https://www.experts-exchange.com/videos/1518/Excel-Error-Handling-Part-3-Run-and-Fix-Bugs.html
                                    
                                    Now to make it run when you change a cell ... in the code behind each worksheet you want to do this: 
                                    Private Sub Worksheet_Change(ByVal Target As Range)
'170607 s4p
   'call procedure to fill information
   'send the cell reference that was just changed
   Call Lookup_Site_Details_From_Status(Target)
   
End Sub

                                    
                                      Select all
                                      Open in new window
                                    ~~~~~~~~~ Compile ~~~~~~~~~
                                     
                                    Whenever you change code, references, or switch versions or operating environment, or modify objects with code behind them, you should always compile and save before executing any code.
                                      
                                    from the menu in a VBE (module) window: Debug, Compile [the name of your project]
                                    (Alt-F11 to switch to the code window)
                                     
                                    Fix any errors on the highlighted lines.
                                    Add needed references, remove unnecessary references, resolve missing references 
                                    (from the menu: Tools, References...)
                                    
                                    keep compiling until nothing happens (this is good!) -- then Save
                                    
                                    also be sure, before compiling, to use Option Explicit at the very TOP of each module so variables that are not declared or are misspelled will be picked up by the compiler as well as many other errors than can be fixed before running.
                                    
                                    ~~~~~~~~~ Add Option Explicit ~~~~~~~~~
                                    
                                    if the top of your module does not have a statement that says Option Explicit, then add this: 
                                     Option Explicit  ' require variable declaration

                                    
                                      Select all
                                      Open in new window
                                     If this was not done when the code was written, you will may need to DIM some variables -- it is best to do that anyway
                                    
                                    btw, if you were using Access (database for Microsoft Office), you could easily link to the lookup information without copying the values ... want to learn? Ask and I will give you links</pre>

<pre class="amctext">Hi Crystal,
                                    
                                    Thanks SO much for your thorough solution - it works perfectly - and your exceptionally informative and patient reply. Very much appreciated. I am heading out of town shortly for the weekend, but when I'm back I will be able to take the time necessary to go through your reply carefully to gain an understanding of what you did and how it works...
                                    
                                    All the best,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of workbook with existing index-match formula (541 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w27/1180586/EE_Convert_Formulas_to_VBA.xlsm">EE_Convert_Formulas_to_VBA.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Adding additional criteria to VBA solution in Excel</h2>
<p class="amcdate">2020-03-01T12:06:00-0500</p>

<pre class="amctext">I realized that I need an additional criteria added to the great solution I received yesterday on this forum. I've been trying to solve it myself but don't have the skillset yet to solve it.
                          
                          
                          I have attached a sample spreadsheet that shows the results I am looking for once the additional criteria is added.
                          
                          The additional criteria is:
                          If Column A = "AIP_ENR" or "AIP_AD" or AIP_GEN" then Expiry Issue = ""
                          
                          The current solution's VBA code is as follows:
                          
                          
                          Function expiryIssue(rng As Range) As String
Application.Volatile
Dim dte1 As Range
Dim dte2 As Range
Dim status As String
Set dte1 = rng.Cells(1, 1)
Set dte2 = rng.Cells(1, 2)
status = rng.Cells(1, 3)
If status <> "Expired" And status <> "Cancelled" And status <> "Replaced" Then
' If there is no Proposed or Approved expiry date
    If dte2 = "" And dte1 = "" Then
        expiryIssue = "Missing expiry dates"
    Else
    'If there is no Approved Expiry date and the Proposed Expiry date is within 60 days of todays date
        If dte2 = "" Then
            If dte1 < Date + 60 Then expiryIssue = "Review proposed expiry date"
        Else
        'If the Approved Expiry date is older than today's date
            If dte1 = "" Then
                If dte2 < Date Then expiryIssue = "Issue"
            Else
                If dte2 < Date Then expiryIssue = "Issue"
            End If
        End If
    End If
End If
End Function

                          
                            Select all
                            Open in new window
                          
                          Thanks!
                          Andrea
                          EE_Expiry_Exclude_Sections.xlsm</pre>

<pre class="amctext">Function expiryIssue(rng As Range) As String
Application.Volatile
Dim dte1 As Range
Dim dte2 As Range
Dim status As String
Set dte1 = rng.Cells(1, 1)
Set dte2 = rng.Cells(1, 2)
status = rng.Cells(1, 3)
Select Case Cells(rng.Row, "A")
    Case "AIP_ENR", "AIP_AD", "AIP_GEN"
        expiryIssue = ""
        Exit Function
End Select
If status <> "Expired" And status <> "Cancelled" And status <> "Replaced" Then
' If there is no Proposed or Approved expiry date
    If dte2 = "" And dte1 = "" Then
        expiryIssue = "Missing expiry dates"
    Else
    'If there is no Approved Expiry date and the Proposed Expiry date is within 60 days of todays date
        If dte2 = "" Then
            If dte1 < Date + 60 Then expiryIssue = "Review proposed expiry date"
        Else
        'If the Approved Expiry date is older than today's date
            If dte1 = "" Then
                If dte2 < Date Then expiryIssue = "Issue"
            Else
                If dte2 < Date Then expiryIssue = "Issue"
            End If
        End If
    End If
End If
End Function

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks, Martin, for a quick and perfect solution!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You’re welcome and I’m glad I was able to help.
                                    
                                    If you expand the “Full Biography" section of my profile you’ll find links to some articles I’ve written that may interest you.
                                    
                                    Marty - Microsoft MVP 2009 to 2017
                                                  Experts Exchange Most Valuable Expert (MVE) 2015, 2017
                                                  Experts Exchange Top Expert Visual Basic Classic 2012 to 2019
                                                  Experts Exchange Top Expert VBA 2018, 2019
                                                  Experts Exchange Distinguished Expert in Excel 2018</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample spreadsheet with hoped for results shown (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/03_w10/1445481/EE_Expiry_Exclude_Sections.xlsm">EE_Expiry_Exclude_Sections.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Array formula disabled every time spreadsheet is closed</h2>
<p class="amcdate">2014-08-14T16:37:06-0400</p>

<pre class="amctext">I have an array formula in a spreadsheet that appears to be disabled every time I close and then reopen the spreadsheet. The formula in the cell is intact, but I need to reapply the curly brackets, using CTRL-SHIFT-ENTER, to the formula every time I reopen the spreadsheet for the formula to work.
                          
                          The formula is:
                          {=SUM(IF(ISNUMBER(MATCH(ROW(INDIRECT("1:10000")),IF(RIGHT(S2:S1000,3)<>"N/A",B2:B1000+0),0)),1))}
                          
                          Any thoughts on how to prevent this?
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">I assume this is Barry's array formula for the "..of-unique-book-IDs.xlsm" file. 
                                    
                                    I added that formula, saved the file locally, and re-opened without any issue.  I've never heard of this behavior before.  There's no chance the formula is in column D is there?  If so, the Worksheet_SelectionChange event might be affecting it.
                                    
                                    -Glenn</pre>

<pre class="amctext">Thanks, Glenn.
                                    
                                    While it wasn't the formula in Column D causing the issue (I am using the array formula in a different spreadsheet), your comment triggered some experimentation by placing the array formula in different locations on the spreadsheet. When I inserted a new row above the existing data and placed the array formula there, it was retained after closing, then opening the spreadsheet again. So I suspect other formulas or VBA might have been interfering...unfortunately I don't have enough background to decipher the source. 
                                    
                                    Thanks for steering me in the right direction!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">I'm glad I helped "steer you", but I don't deserve the points for that!  You're welcome to just close the question.
                                    
                                    If there are other sheets in regards to this issue, then again, I'd look for Worksheet_Change,  Worksheet_SelectionChange, or Worksheet_Activate events that might update cells in/around your array formula
                                    
                                    Regards,
                                    -Glenn</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Extracting a text date string into another column and having it convert to a 'real' date format in Excel</h2>
<p class="amcdate">2017-04-07T16:49:24-0400</p>

<pre class="amctext">Format of entries in Column A 
                          AA[en dash]DD MMM YYYY[en dash]YES
                          AA[en dash]DD MMM YYYY[en dash]NO
                          
                          Examples of Column A entries:
                          ES–06 Apr 2017–YES
                          MC–01 Mar 2017–NO
                          MC–18 Mar 2017–YES
                          KB–02 Mar 2017–NO
                          
                          When a cell in Column A is populated, I would like to have the text date string from the Column A automatically be extracted at that time into Column B and converted to a 'real' date in the format 'd-mmm-yy'.
                          
                          I have attached a sample spreadsheet to show the desired results.
                          
                          Is this possible?
                          
                          Thanks,
                          Andrea
                          Extracting-text-date-string-example.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Please try below formula in B2:
                                    =TEXT(MID(A2,4,11),"d-mmm-yy")
                                    Andread_Extracting-text-date-string.xlsx</pre>

<pre class="amctext">Thanks, Shums!! A question - is the formulated column composed of 'true' dates, or text dates? I notice the difference in the sample spreadsheet between column B and column C.</pre>

<pre class="amctext">Column B is your manual entries, Col C is formulated, If you gonna change the formula in Column B, you will get the expected result</pre>

<pre class="amctext">Thanks so much for the quick turnaround on a solution, Shums!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Pleased to help Andrea!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of desired result (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/04_w14/1155513/Extracting-text-date-string-example.xlsx">Extracting-text-date-string-example.xlsx</a></p>
<p class="amcfile">Date Format (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/04_w14/1155516/Andread_Extracting-text-date-string.xlsx">Andread_Extracting-text-date-string.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Revising an array formula to exclude blanks or cells with "0"</h2>
<p class="amcdate">2014-08-15T15:21:53-0400</p>

<pre class="amctext">I would like a count of the unique 4-digit characters in Column A where Column B contains initials + date only (excluding instances of initials + date + N/A).
                          
                          I was using this array formula below which was working well as long as Column B did not have any blanks or cells with "0":
                          
                          {=SUM(IF(ISNUMBER(MATCH(ROW(INDIRECT("1:10000")),IF(RIGHT($B$3:$B$81,3)<>"N/A",$A$3:$A$81+0),0)),1))}
                          
                          A few days into using the formula, I've realized that there will be cases when there are blanks or cells with "0" in Column B (and Column A for that matter), and the current array formula is including them in its calculation as valid. So instead of a result of 15 instances, the formula is indicating 58 instances.
                          
                          I have included a sample spreadsheet to illustrate this.
                          
                          Is there an adjustment that can be made to the formula to ensure that blanks and zeros in either column are not included in the total?
                          
                          Thanks,
                          Andrea
                          Book2.xlsm</pre>

<pre class="amctext">Here's the modified array formula that will ignore zero values in column B:
                                    =SUM(IF(ISNUMBER(MATCH(ROW(INDIRECT("1:10000")),IF(RIGHT($B$3:$B$81,3)<>"N/A",IF($B$3:$B$81<>0,$A$3:$A$81+0,0),0),0)),1,0))
                                    
                                    If there is a blank value in B, it won't be counted either.
                                    
                                    Regards,
                                    -Glenn</pre>

<pre class="amctext">Perfect...thanks very much, Glenn!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Book2.xlsm (88 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w33/866674/Book2.xlsm">Book2.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Updating Word macro to expand criteria in identifying wrongly-formatted strings</h2>
<p class="amcdate">2020-05-20T13:39:17-0400</p>

<pre class="amctext">My current macro (a solution that was provided by Experts Exchange and has been working great!) searches for the following string and pastes it into a new Word file, one string per line:
                          ####-####### (4 numbers, followed by a dash, then 7 numbers)
                          
                          
                          The macro also flags the following two instances of wrongly formatted strings, stops the macro and generates a pop-up error message so that the user can fix the string, then rerun the macro:
                          ####-###### (4 numbers, followed by a dash, then 6 numbers)
                          ####-######## (4 numbers, followed by a dash, then 8 numbers)
                          
                          I would like to macro to be updated so that it also identifies the following strings as wrongly formatted as well, generating the same pop-up error message:
                          ########## (10 numbers, no dash)
                          ########### (11 numbers, no dash)
                          ############ (12 numbers, no dash)
                          
                          
                          I've attached a sample Word file showing the the 3 examples of wrongly-formatted text strings that can occur.
                          
                          The current code is shown below:
                          
                          
                          Sub Extract_WOs()
'
' Extract_WOs Macro
'
' Keyboard Shortcut: Ctrl+y
'
    Set Activedoc = ActiveDocument
    strRes = ""
    Dim reg As Object 'VBScript_RegExp_55.regexp
    Dim Match As Object ' VBScript_RegExp_55.Match
    Dim Matches As Object 'VBScript_RegExp_55.MatchCollection

    ' instanciation
    Set reg = CreateObject("VBScript.RegExp")
    With reg
        .Global = True
        .MultiLine = True
        .Ignorecase = True
        .Pattern = "\b\d{4}-(\d{6}|\d{8})\b"
    Set Matches = .Execute(Activedoc.Range.Text)
    End With
    For Each Match In Matches
        ActiveDocument.Range(Match.firstIndex, Match.firstIndex + Match.Length).Select
        MsgBox "Value: " & Match.Value & " is wrong"
        Exit Sub
    Next Match
    reg.Pattern = "\b\d{4}-\d{7}\b"
    Set Matches = reg.Execute(Activedoc.Range.Text)
    For Each Match In Matches
        strRes = strRes & Match.Value & vbCrLf
    Next Match

    
    If strRes <> "" Then
        Set newDoc = Documents.Add
        newDoc.Range.Text = strRes
    Else
        MsgBox "No Matches"
    End If
End Sub

                          
                            Select all
                            Open in new window
                          
                          Thanks very much!
                          Andrea
                          Sample_EE_Wrong_WO_Numbers.docx</pre>

<pre class="amctext">Here you go:

Sub Extract_WOs()
'
' Extract_WOs Macro
'
' Keyboard Shortcut: Ctrl+y
'
    Set Activedoc = ActiveDocument
    strRes = ""
    Dim reg As Object 'VBScript_RegExp_55.regexp
    Dim Match As Object ' VBScript_RegExp_55.Match
    Dim Matches As Object 'VBScript_RegExp_55.MatchCollection

    ' instanciation
    Set reg = CreateObject("VBScript.RegExp")
    With reg
        .Global = True
        .MultiLine = True
        .Ignorecase = True
        .Pattern = "\b\d{4}-(\d{6}|\d{8})\b"
        Set Matches = .Execute(Activedoc.Range.Text)
    End With
    For Each Match In Matches
        ActiveDocument.Range(Match.firstIndex, Match.firstIndex + Match.Length).Select
        MsgBox "Value: " & Match.value & " is wrong"
        Exit Sub
    Next Match
    With reg
        .Pattern = "\b(\d{10}|\d{11}|\d{12})\b"
        Set Matches = .Execute(Activedoc.Range.Text)
    End With
    For Each Match In Matches
        ActiveDocument.Range(Match.firstIndex, Match.firstIndex + Match.Length).Select
        MsgBox "Value: " & Match.value & " is wrong"
        Exit Sub
    Next Match
    reg.Pattern = "\b\d{4}-\d{7}\b"
    Set Matches = reg.Execute(Activedoc.Range.Text)
    For Each Match In Matches
        strRes = strRes & Match.value & vbCrLf
    Next Match
    
    If strRes <> "" Then
        Set NewDoc = Documents.Add
        NewDoc.Range.Text = strRes
    Else
        MsgBox "No Matches"
    End If
End Sub
Select allOpen in new window
                                    
                                      formatCodeSnippets('wysiwyg-content','code-20-43090153',true,true,false);</pre>

<pre class="amctext">Great solution - thanks, John!

Andrea</pre>

<pre class="amctext">Glad to help. Thanks for the testimonial!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample WO file with examples of wrong work order numbers (18 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/05_w21/1458641/Sample_EE_Wrong_WO_Numbers.docx">Sample_EE_Wrong_WO_Numbers.docx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Truncate all numbers with 3 decimal places to 2 decimal places & highlight changed numbers in colour</h2>
<p class="amcdate">2014-03-25T10:49:58-0400</p>

<pre class="amctext">I've inherited a large, somewhat poorly formatted, spreadsheet of communication frequencies. I am looking for a macro that will:
                          
                          1. Truncate (not round) all numbers that have 3 decimal places down to 2 decimal places
                          2. If the 3-decimal number ends in "00", then number to be truncated down to 1 decimal place (ie., 135.100 becomes 135.1)
                          3. All numbers that change to turn the color red.
                          
                          The cells can contain an alpha numeric mix and often have multiple entries in one cell using line breaks. The line breaks need to be maintained. 
                          
                          Here is a current and revised cell example:
                          
                          Current cell format:
                          YYYYY Townname 126.425
                          250.156
                          98.100
                          
                          Revised cell format:
                          YYYYY Townname 126.42
                          250.15
                          98.1
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Here's the code for that, minus the red font part:
                                    
                                    
                                    Sub Cleanup()

Dim lLastRow As Long, lRowLoop As Long, dbTemp As Double, sTemp As String
Dim sFound As String, lPos As Long, lNumChar As Long

lLastRow = Cells(Rows.Count, 1).End(xlUp).Row

For lRowLoop = 1 To lLastRow
    Do While RegExpFind(Cells(lRowLoop, 1), "\d+\.\d\d\d+", 1) <> ""
        sFound = RegExpFind(Cells(lRowLoop, 1), "\d+\.\d\d\d+", lLoop)
        dbTemp = Application.WorksheetFunction.RoundDown(CDbl(sFound), 2)
        
        sTemp = Format(dbTemp, "0.00")
        sTemp = IIf(Right(sTemp, 1) = 0, Left(sTemp, Len(sTemp) - 1), sTemp)
        
        lPos = InStr(Cells(lRowLoop, 1), sFound)
        lNumChar = Len(sTemp)
        
        Cells(lRowLoop, 1).Value = Replace(Cells(lRowLoop, 1).Value, sFound, sTemp)
    
      '  Cells(lRowLoop, 1).Characters(Start:=lPos, Length:=lNumChar).Font.Color = -16776961
            
    Loop
Next lRowLoop
    

End Sub

Function RegExpFind(LookIn As String, PatternStr As String, Optional Pos, _
    Optional MatchCase As Boolean = True, Optional ReturnType As Long = 0, _
    Optional MultiLine As Boolean = False)
    
    ' Function written by Patrick G. Matthews.  You may use and distribute this code freely,
    ' as long as you properly credit and attribute authorship and the URL of where you
    ' found the code
    
    ' This function relies on the VBScript version of Regular Expressions, and thus some of
    ' the functionality available in Perl and/or .Net may not be available.  The full extent
    ' of what functionality will be available on any given computer is based on which version
    ' of the VBScript runtime is installed on that computer
    
    ' This function uses Regular Expressions to parse a string (LookIn), and return matches to a
    ' pattern (PatternStr).  Use Pos to indicate which match you want:
    ' Pos omitted               : function returns a zero-based array of all matches
    ' Pos = 1                   : the first match
    ' Pos = 2                   : the second match
    ' Pos = <positive integer>  : the Nth match
    ' Pos = 0                   : the last match
    ' Pos = -1                  : the last match
    ' Pos = -2                  : the 2nd to last match
    ' Pos = <negative integer>  : the Nth to last match
    ' If Pos is non-numeric, or if the absolute value of Pos is greater than the number of
    ' matches, the function returns an empty string.  If no match is found, the function returns
    ' an empty string.  (Earlier versions of this code used zero for the last match; this is
    ' retained for backward compatibility)
    
    ' If MatchCase is omitted or True (default for RegExp) then the Pattern must match case (and
    ' thus you may have to use [a-zA-Z] instead of just [a-z] or [A-Z]).
    
    ' ReturnType indicates what information you want to return:
    ' ReturnType = 0            : the matched values
    ' ReturnType = 1            : the starting character positions for the matched values
    ' ReturnType = 2            : the lengths of the matched values
    
    ' If MultiLine = False, the ^ and $ match the beginning and end of input, respectively.  If
    ' MultiLine = True, then ^ and $ match the beginning and end of each line (as demarcated by
    ' new line characters) in the input string
    
    ' If you use this function in Excel, you can use range references for any of the arguments.
    ' If you use this in Excel and return the full array, make sure to set up the formula as an
    ' array formula.  If you need the array formula to go down a column, use TRANSPOSE()
    
    ' Note: RegExp counts the character positions for the Match.FirstIndex property as starting
    ' at zero.  Since VB6 and VBA has strings starting at position 1, I have added one to make
    ' the character positions conform to VBA/VB6 expectations
    
    ' Normally as an object variable I would set the RegX variable to Nothing; however, in cases
    ' where a large number of calls to this function are made, making RegX a static variable that
    ' preserves its state in between calls significantly improves performance
    
    Static RegX As Object
    Dim TheMatches As Object
    Dim Answer()
    Dim Counter As Long
    
    ' Evaluate Pos.  If it is there, it must be numeric and converted to Long
    
    If Not IsMissing(Pos) Then
        If Not IsNumeric(Pos) Then
            RegExpFind = ""
            Exit Function
        Else
            Pos = CLng(Pos)
        End If
    End If
    
    ' Evaluate ReturnType
    
    If ReturnType < 0 Or ReturnType > 2 Then
        RegExpFind = ""
        Exit Function
    End If
    
    ' Create instance of RegExp object if needed, and set properties
    
    If RegX Is Nothing Then Set RegX = CreateObject("VBScript.RegExp")
    With RegX
        .Pattern = PatternStr
        .Global = True
        .IgnoreCase = Not MatchCase
        .MultiLine = MultiLine
    End With
        
    ' Test to see if there are any matches
    
    If RegX.Test(LookIn) Then
        
        ' Run RegExp to get the matches, which are returned as a zero-based collection
        
        Set TheMatches = RegX.Execute(LookIn)
        
        ' Test to see if Pos is negative, which indicates the user wants the Nth to last
        ' match.  If it is, then based on the number of matches convert Pos to a positive
        ' number, or zero for the last match
        
        If Not IsMissing(Pos) Then
            If Pos < 0 Then
                If Pos = -1 Then
                    Pos = 0
                Else
                    
                    ' If Abs(Pos) > number of matches, then the Nth to last match does not
                    ' exist.  Return a zero-length string
                    
                    If Abs(Pos) <= TheMatches.Count Then
                        Pos = TheMatches.Count + Pos + 1
                    Else
                        RegExpFind = ""
                        GoTo Cleanup
                    End If
                End If
            End If
        End If
        
        ' If Pos is missing, user wants array of all matches.  Build it and assign it as the
        ' function's return value
        
        If IsMissing(Pos) Then
            ReDim Answer(0 To TheMatches.Count - 1)
            For Counter = 0 To UBound(Answer)
                Select Case ReturnType
                    Case 0: Answer(Counter) = TheMatches(Counter)
                    Case 1: Answer(Counter) = TheMatches(Counter).FirstIndex + 1
                    Case 2: Answer(Counter) = TheMatches(Counter).Length
                End Select
            Next
            RegExpFind = Answer
        
        ' User wanted the Nth match (or last match, if Pos = 0).  Get the Nth value, if possible
        
        Else
            Select Case Pos
                Case 0                          ' Last match
                    Select Case ReturnType
                        Case 0: RegExpFind = TheMatches(TheMatches.Count - 1)
                        Case 1: RegExpFind = TheMatches(TheMatches.Count - 1).FirstIndex + 1
                        Case 2: RegExpFind = TheMatches(TheMatches.Count - 1).Length
                    End Select
                Case 1 To TheMatches.Count      ' Nth match
                    Select Case ReturnType
                        Case 0: RegExpFind = TheMatches(Pos - 1)
                        Case 1: RegExpFind = TheMatches(Pos - 1).FirstIndex + 1
                        Case 2: RegExpFind = TheMatches(Pos - 1).Length
                    End Select
                Case Else                       ' Invalid item number
                    RegExpFind = ""
            End Select
        End If
    
    ' If there are no matches, return empty string
    
    Else
        RegExpFind = ""
    End If
    
Cleanup:
    ' Release object variables
    
    Set TheMatches = Nothing
    
End Function

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">I don't have a lot of macro experience so if you can just let me know if I create one macro for the above and paste the code into it, or do I create more than one macro?
                                    
                                    Thanks for your patience!
                                    Andrea</pre>

<pre class="amctext">Hi,
                                    
                                    my version without the red formatting
                                    
                                    Sub Macro()
Dim c As Range
For Each c In ActiveSheet.UsedRange
    arrLines = Split(c, vbLf)
     For Each Ln In arrLines
        arrWrds = Split(Ln, " ")
        For Each wrd In arrWrds
            If IsNumeric(wrd) Then
                dblWrd = CDbl(wrd)
                Rest = dblWrd - Int(dblWrd)
                If Rest <> 0 Then ' not integer
                    Number = Fix(dblWrd * 100) / 100
                    NewWrd = Format(Number, "#.0#")
                    MsgBox NewWrd
                Else
                    NewWrd = wrd
                End If
            Else
                NewWrd = wrd
            End If
        NewLine = NewLine & NewWrd & " "
        Next
    NewLine = Left(NewLine, Len(NewLine) - 1)
    Result = Result & NewLine & vbLf
    NewLine = ""
    Next
c.Value = Left(Result, Len(Result) - 1)
Result = ""
Next
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">Go into the visual basic editor (alt+F11), select your workbook and choose Insert \ Module from the top menu bar.
                                    
                                    Copy all the code in the module. 
                                    
                                    Run by using Alt+F8 from your worksheet, or F5 from VB Editor.
                                    
                                    The code will run on all cells in column A.
                                    
                                    I'd recommend saving a backup copy of your workbook before launching the macro, macros cannot be undone generally.
                                    
                                    Thomas</pre>

<pre class="amctext">Hi,
                                    
                                    The code here Format in red the numbers that have been changed
                                    EDITED$
                                    corrected code
                                    Format in red only the numbers that have been changed
                                    
                                    Sub Macro()
Dim c As Range
For Each c In ActiveSheet.UsedRange
    arrLines = Split(c, vbLf)
     For Each Ln In arrLines
        arrWrds = Split(Ln, " ")
        For Each wrd In arrWrds
            If IsNumeric(wrd) Then
                dblWrd = CDbl(wrd)
                Rest = dblWrd - Int(dblWrd)
                If Rest <> 0 Then ' not integer
                    Number = Fix(dblWrd * 100) / 100
                    FormattedWrd = Format(Number, "#.0#")
                    If FormattedWrd <> wrd Then
                        NewWrd = "[r]" & FormattedWrd & "[r]"
                    Else
                        NewWrd = wrd
                    End If
                Else
                    NewWrd = wrd
                
                End If
            Else
                NewWrd = wrd
            End If
        NewLine = NewLine & NewWrd & " "
        Next
    NewLine = Left(NewLine, Len(NewLine) - 1)
    Result = Result & NewLine & vbLf
    NewLine = ""
    Next
    If InStr(1, Result, "[r]") Then
        FormatedString = Left(Result, Len(Result) - 1)
        Result = ""
        ArrWords = Split(FormatedString, "[r]")
        c.Value = Replace(FormatedString, "[r]", "")
        TextStart = 1
        For Idx = 0 To UBound(ArrWords)
            WrdLength = Len(ArrWords(Idx))
            If Idx Mod 2 = 0 Then
                
                With c.Characters(Start:=TextStart, Length:=WrdLength).Font
                    .Color = vbBlack
                End With
            Else ' Idx Mod 2 = 1
                With c.Characters(Start:=TextStart, Length:=WrdLength).Font
                    .Color = vbRed
                End With
            End If
            TextStart = TextStart + WrdLength
        Next
    End If
Next
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">Thanks Rgonzo, your second formula worked perfectly across all columns (there were 24+ columns). Thanks, Thomas, for your answer and step-by-step on how to insert the code. Because the code needed to work across 24+ columns and the red formatting was a critical component I selected Rgonzo's formula as the best solution, but appreciated your input.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Update cell in date column to a new date based on data in other cells</h2>
<p class="amcdate">2014-08-11T14:57:05-0400</p>

<pre class="amctext">Column G is a date column that show the last time a chapter was updated.
                          
                          I would like the date in Column G to be automatically updated to a static date (example of format: "15 NOV 14") if the following criteria is met:
                          If Column I, Column N, Column S, Column X, Column AC OR Column AH = "NEW" or "REVISED"
                          Otherwise, the pre-existing date in Column G is to remain intact and unchanged.
                          
                          I've attached a sample spreadsheet.
                          
                          Thanks,
                          Andrea
                          LastRevisionDateUpdate-sample.xlsm</pre>

<pre class="amctext">The dates in your example workbook are static dates (i.e, constants) right now.  Would these be formulas usually?  If not, what should the new date be converted to?  Today's date?  Another calculated date based on other data?
                                    
                                    A Worksheet_Change event should handle this, but will wait to hear clarification from you.
                                    
                                    Regards,
                                    -Glenn</pre>

<pre class="amctext">Just as an example, here is a Worksheet_Change event that would change the Last Revision Date value in column G to today's date if any of the above-mentioned columns were to be changed.  
                                    
                                    Option Explicit
Dim rng As Range
Dim cl As Object
Dim boolChange As Boolean
Dim x As Integer
Private Sub Worksheet_Change(ByVal Target As Range)
    If boolChange Then
        boolChange = False
        Exit Sub
    End If
    Set rng = Range("G2", Range("G2").End(xlDown))
    For Each cl In rng
        For x = 2 To 27 Step 5
            If cl.Offset(0, x) = "New" Or cl.Offset(0, x) = "Revised" Then
                boolChange = True
                cl.Value = Format(Now(), "dd-mmm-yy")
                Exit For
            End If
        Next x
    Next cl
    boolChange = False
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    This code would be inserted into the "Book_Prod_Sept2014" sheet object in the VBA Project.  I've attached a modified version of your file that shows this.  I had to replicate your Data Validation range (TypeChange1) on another sheet to test.
                                    
                                    Regards,
                                    -Glenn
                                    EE-LastRevisionDateUpdate-sample.xlsm</pre>

<pre class="amctext">Terrific, Glenn...the only modification I made was to line 16 (as shown below) since we use the same date for all changes within a cycle (and not the actual date the change is done on). So for each cycle, I'll update the code with the new 'static' date to be used.
                                    
                                    cl.Value = Format("15-Nov-14", "dd-mmm-yy")
                                    
                                    Thanks so much!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're welcome.  
                                    -Glenn</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">LastRevisionDateUpdate-sample.xlsm (105 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w33/865740/LastRevisionDateUpdate-sample.xlsm">LastRevisionDateUpdate-sample.xlsm</a></p>
<p class="amcfile">modified macro-enabled workbook with Worksheet_Change event (101 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w33/865756/EE-LastRevisionDateUpdate-sample.xlsm">EE-LastRevisionDateUpdate-sample.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Resetting user form in Excel when 'Save' button is clicked</h2>
<p class="amcdate">2017-11-27T22:35:16-0500</p>

<pre class="amctext">I have created a user form called Time Tracker. The date in the user form is autopopulated with the current date when the form is opened. When the Save button is clicked, the data from the user form populates the next available row in columns A to G in a sheet called 'TrackingSheet'. All fields in the user form must be completed for the form to save, otherwise an error message pops up.
                          
                          I would like the user form to reset once the Save button is clicked so users can add additional records in the same session. When reset, all fields except the date field, which is autopopulated, would be blank.
                          
                          I have included the spreadsheet to assist with this question.
                          
                          Thanks,
                          Andrea
                          ProdMainTimeTracker_EE.xlsm</pre>

<pre class="amctext">try update the Sub cmdSave_Click to:
                                    
                                    
                                    Private Sub cmdSave_Click()
Dim NextRow As Long

    With Me

        If .cboIDList.Value = "" _
           Or .txtDesc.Value = "" _
           Or .txtPA_Unit.Value = "" _
           Or .txtDate = "" _
           Or .cboInitials = "" _
           Or txtMinutes = "" _
           Or cboStatus = "" Then

            MsgBox "Form not completed!", vbCritical, "Incomplete"
            Exit Sub
        End If

        NextRow = Sheets("TrackingSheet").Range("A" & Rows.Count).End(xlUp).Row + 1
        Sheets("TrackingSheet").Range("A" & NextRow).Value = .cboIDList.Value
        Sheets("TrackingSheet").Range("B" & NextRow).Value = .txtPA_Unit.Value
        Sheets("TrackingSheet").Range("C" & NextRow).Value = .txtDesc.Value
        Sheets("TrackingSheet").Range("D" & NextRow).Value = .txtDate.Value
        Sheets("TrackingSheet").Range("E" & NextRow).Value = .txtMinutes.Value
        Sheets("TrackingSheet").Range("F" & NextRow).Value = .cboInitials.Value
        Sheets("TrackingSheet").Range("G" & NextRow).Value = .cboStatus.Value
        
        .cboIDList.Value = ""
        .txtPA_Unit.Value = ""
        .txtDesc.Value = ""
        .txtDate.Value = ""
        .txtMinutes.Value = ""
        .cboInitials.Value = ""
        .cboStatus.Value = ""
    End With

End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    remove line:
                                    
                                    
                                    .txtDate.Value = ""

                                    
                                      Select all
                                      Open in new window
                                    
                                    in case you want to retain Date value after the Save button was clicked.</pre>

<pre class="amctext">I use UserForms in many applications. To save repeating lines of code I wrote a UDF to reset controls. Place it in a Standard module
                                    
                                    
                                    
                                    
                                    '---------------------------------------------------------------------------------------
' DateTime  : 09/05/2007 08:43
' DateTime  : 09/05/2007 08:43
' Author    : Roy Cox (royUK)
' Website   : [URL="http://www.excel-it.com"]click here for more examples and Excel Consulting[/URL]
' Purpose   : Loops through controls of UserForm & clears setting
'
' Disclaimer; This code is offered as is with no guarantees. You may use it in your
'             projects but please leave this header intact.

'---------------------------------------------------------------------------------------
Option Explicit

Public Function ClearAll(frm As MSForms.UserForm) As Boolean
    ' clear out all controls
    Dim Octrl    As Control
    ' if any error occurs, just exit
    On Error GoTo ExitFunc

    ' loop through controls, figure out type and
    ' use appropriate method to clear it
    For Each Octrl In frm.Controls
        Select Case TypeName(Octrl)
            Case "TextBox":  Octrl = Empty
            Case "CheckBox", "OptionButton": Octrl.Value = False
            Case "ComboBox", "ListBox": Octrl.ListIndex = -1
            Case Else:
        End Select
    Next Octrl

ExitFunc:advan
    Set Octrl = Nothing
End Function

                                    
                                      Select all
                                      Open in new window
                                    
                                    At the end of the save code just add, this will work on any userform in the workbook
                                    
                                    
                                    ClearAll Me

                                    
                                      Select all
                                      Open in new window
                                    
                                    
                                    Private Sub cmdSave_Click()
    Dim NextRow As Long

    With Me

        If .cboIDList.Value = "" _
           Or .txtDesc.Value = "" _
           Or .txtPA_Unit.Value = "" _
           Or .txtDate = "" _
           Or .cboInitials = "" _
           Or txtMinutes = "" _
           Or cboStatus = "" Then

            MsgBox "Form not completed!", vbCritical, "Incomplete"
            Exit Sub
        End If

        NextRow = Sheets("TrackingSheet").Range("A" & Rows.Count).End(xlUp).Row + 1
        Sheets("TrackingSheet").Range("A" & NextRow).Value = .cboIDList.Value
        Sheets("TrackingSheet").Range("B" & NextRow).Value = .txtPA_Unit.Value
        Sheets("TrackingSheet").Range("C" & NextRow).Value = .txtDesc.Value
        Sheets("TrackingSheet").Range("D" & NextRow).Value = .txtDate.Value
        Sheets("TrackingSheet").Range("E" & NextRow).Value = .txtMinutes.Value
        Sheets("TrackingSheet").Range("F" & NextRow).Value = .cboInitials.Value
        Sheets("TrackingSheet").Range("G" & NextRow).Value = .cboStatus.Value

    End With
''/// reset controls
    ClearAll Me
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks to you both for providing solutions. I am testing both of them. 
                                    
                                    Roy, I am getting an error message as follows:
                                    
                                    
                                      Compile error: Sub or Function not defined
                                      
                                      Module: Public Function ClearAll(frm As MSForms.UserForm) As Boolean
                                      ExitFunc: advan
                                    
                                    
                                    I've attached the updated spreadsheet for your review in case I've applied your code incorrectly.
                                    
                                    Thanks,
                                    Andrea
                                    ProdMainTimeTracker_CoxSolution.xlsm</pre>

<pre class="amctext">in your module, change:
                                    
                                    
                                    ExitFunc: advan

                                    
                                      Select all
                                      Open in new window
                                    
                                    to:
                                    
                                    
                                    ExitFunc:

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Sorry, I don't know how that typo happened.
                                    
                                    See attached
                                    ProdMainTimeTracker_CoxSolution.xlsm</pre>

<pre class="amctext">Thanks to you both. Ryan, I appreciated your timely response with a working solution, and assistance on another solution!
                                    
                                    Roy, thanks for your solution which is now working with that minor tweak. I did want the date field to be retained, which did not seem to be the case with your code, so if you are able to let me know how to address that, that would be great.
                                    
                                    I've tried to award the points as fairly as possible. :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">It's quite simple and the Function remains dynamic. Just use the controls' Tag Property/ Any control that is not to be cleared simply put a character, e.g. an asterisk, in the control's Tag property at design time. The amended code will ignore any controls that are marked that way.
                                    
                                    
                                    Option Explicit



'---------------------------------------------------------------------------------------
' DateTime  : 09/05/2007 08:43
' DateTime  : 09/05/2007 08:43
' Author    : Roy Cox (royUK)
' Website   : [URL="http://www.excel-it.com"]click here for more examples and Excel Consulting[/URL]
' Purpose   : Loops through controls of UserForm & clears setting
'
' Disclaimer; This code is offered as is with no guarantees. You may use it in your
'             projects but please leave this header intact.

'---------------------------------------------------------------------------------------
Option Explicit

Public Function ClearAll(frm As MSForms.UserForm) As Boolean
''/// clear out all controls
    Dim Octrl As Control
    ''/// if any error occurs, just exit
    On Error GoTo ExitFunc

    ''/// loop through controls, figure out type and
    ''/// use appropriate method to clear it
    For Each Octrl In frm.Controls
    ''/// check the control's Tag Property
        If octl.Tag = "" Then
            Select Case TypeName(Octrl)
            Case "TextBox": Octrl = Empty
            Case "CheckBox", "OptionButton": Octrl.Value = False
            Case "ComboBox", "ListBox": Octrl.ListIndex = -1
            Case Else:
            End Select
        Next Octrl
    End If
ExitFunc:
    Set Octrl = Nothing
End Function

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks, Roy, for your instructions on this!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of user form (24 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w48/1212836/ProdMainTimeTracker_EE.xlsm">ProdMainTimeTracker_EE.xlsm</a></p>
<p class="amcfile">Updated spreadsheet with Roy's code for review (26 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w48/1212961/ProdMainTimeTracker_CoxSolution.xlsm">ProdMainTimeTracker_CoxSolution.xlsm</a></p>
<p class="amcfile">ProdMainTimeTracker_CoxSolution.xlsm (25 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w48/1213000/ProdMainTimeTracker_CoxSolution.xlsm">ProdMainTimeTracker_CoxSolution.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel formula based on specific entries in another column</h2>
<p class="amcdate">2015-08-20T14:40:57-0400</p>

<pre class="amctext">I would like a formula for Column C, based on Column B data, as follows:
                          If Column B = LINK to #### (ie., LINK to 4566), return a blank cell in Column C
                          If Column B = Yes, return the word 'Mail' in Column C
                          If Column B = No, return the word 'Hold' in Column C
                          
                          I have attached a sample spreadsheet as well, illustrating what I am looking for.
                          
                          Thanks!
                          Andrea
                          EE-sample.xlsx</pre>

<pre class="amctext">Try this formula'  
                                    
                                    
                                    =IF(B2="####","",IF(B2="Yes","Mail",IF(B2="No","Hold","")))

                                    
                                      Select all
                                      Open in new window
                                    
                                    Just put your desired link where I have ####
                                    EE-sample.xlsx</pre>

<pre class="amctext">Try this....
                                    
                                    In C2
                                    
                                    =IF(AND(LEFT(B2,4)="LINK",ISNUMBER(RIGHT(B2,4))),"",IF(B2="Yes","Mail",IF(B2="No","HOLD","")))

                                    
                                      Select all
                                      Open in new window
                                    And copy down.</pre>

<pre class="amctext">@Takunda Jora
                                    
                                    I don't think that this is the case. OP wants to show blank only if the B2 contains LINK to <four digits> i.e. #### in his example could be any number if I am not wrong.
                                    
                                    Your formula will show the desired output but not because B2 meets the criteria but only because no criteria is met and it shows a blank. Evaluate your formula and you will know this.</pre>

<pre class="amctext">Ah, I see what you mean sktneer. In that case, your formula is what I'd go with.
                                    
                                    Sorry about that. :)</pre>

<pre class="amctext">No need to say sorry. It happens with all of us later or sooner that we get confused by the description. No issues. Cool...</pre>

<pre class="amctext">Thanks very much, sktneer, for both your solution and feedback on the other formula suggested, as I wouldn't have realized it may not work...most helpful!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're welcome Andrea! Glad I could help. :)
                                    I only analyzed the other formula because it was returning the desired output while the formula was not correct and you could easily misguided because of the results returned.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example showing desired results (8 KB) <a href="https://filedb.experts-exchange.com/incoming/2015/08_w34/930649/EE-sample.xlsx">EE-sample.xlsx</a></p>
<p class="amcfile">formula added (9 KB) <a href="https://filedb.experts-exchange.com/incoming/2015/08_w34/930650/EE-sample.xlsx">EE-sample.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Macro for changing structure of data in Excel</h2>
<p class="amcdate">2017-10-28T18:10:19-0400</p>

<pre class="amctext">I have a spreadsheet that contains extracted data from another source, and I need to change the structure of the data to a more usable format for output to a pivot table. As I will be receiving the data in this format on a regular basis and need to perform this restructuring task every time, I would like to automate this task with a macro.
                          
                          Spreadsheet description:
                          Each WO task has same 5 column headings: WO#, WO_Type, Date, Min, and Min_Type, and the WO numbers are repeated in each 5-column section across the spreadsheet:
                          Column A to E: WO task 1
                          Column F to J: WO task 2
                          Column K to O: WO task 3
                          Column P to T: WO task 4
                          
                          While the current spreadsheet has 455 rows, the number of rows will vary each time.
                          
                          I would like a macro that does the following:
                          
                          
                            Copies data from A2 to E2 and down to last row containing data, and pastes this data into B2 of table in "Tasks" tab.
                          
                          
                            Copies data from F2 to J2 down to last row containing data, and pastes this date into next available blank row in Column B of table in "Tasks" tab
                          
                          
                            Copies data from K2 to O2 down to last row containing data, and pastes this date into next available blank row in Column B of table in "Tasks" tab
                          
                          
                            Copies data from P2 to T2 down to last row containing data, and pastes this date into next available blank row in Column B of table in "Tasks" tab
                          
                          
                          I have attached the spreadsheet with sample data.
                          
                          Thanks,
                          Andrea
                          EE_RestructureData.xlsm</pre>

<pre class="amctext">I think this does what you want, please check and let me know if it needs any revision.
                                    
                                    Note I have removed all the unused rows in the destination table as this makes it extremely difficult to calculate where to paste the data. I have replaced CFS with ="CFS" to ensure this is copied down as data is added.
                                    EE_RestructureData.xlsm</pre>

<pre class="amctext">Hi Roy,
                                    
                                    Thanks very much for improving the process as outlined. I ran the macro, and it transferred all the records from Column A to E (WO task 1), which was good, but it did not appear to transfer the remaining records for WO task 2 (Column F to J), etc. through to WO task 4. Sheet 1 should end up with 1816 rows of data, I believe. 
                                    
                                    Can the macro be revised to do this?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try attached...
                                    AndreaMary_RestructureData.xlsm</pre>

<pre class="amctext">Hi Andrea
                                    
                                    Sorry
                                    
                                    I've adjusted the code. Try this
                                    
                                    
                                    Option Explicit

Sub TransferData()
    Dim oTblSource As ListObject, oTblMain As ListObject
    Dim iX As Integer
    Dim lRw As Long
    Set oTblSource = Sheets("Sheet1").ListObjects(1)
    Set oTblMain = Sheets("Tasks").ListObjects(1)

    With oTblMain
        For iX = 1 To oTblSource.ListColumns.Count Step 5    '
            lRw = .ListRows.Count + 1
            oTblSource.ListColumns(iX).DataBodyRange.Resize(, 5).Copy
            oTblMain.ListRows(1).Range.Cells(lRw, 2).PasteSpecial xlValues
        Next iX
    End With
    Application.CutCopyMode = False
End Sub

                                    
                                      Select all
                                      Open in new window
                                    EE_RestructureData.xlsm</pre>

<pre class="amctext">Thanks to you both! 
                                    
                                    Roy, thanks for the revised macro, it worked well with a couple of minor issues - the first row was blank, for some reason, and the date field came in numerically as opposed to formatted as a date.
                                    
                                    Shums, your solution worked perfectly.
                                    
                                    I did my best to award the points fairly, balancing Roy's quick response time and willingness to revise the first iteration vs. Shum's solution working right out of the gate. :-)
                                    
                                    Best regards,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of spreadsheet (136 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201930/EE_RestructureData.xlsm">EE_RestructureData.xlsm</a></p>
<p class="amcfile">EE_RestructureData.xlsm (129 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w44/1201955/EE_RestructureData.xlsm">EE_RestructureData.xlsm</a></p>
<p class="amcfile">Consolidate Columns (135 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w44/1202034/AndreaMary_RestructureData.xlsm">AndreaMary_RestructureData.xlsm</a></p>
<p class="amcfile">EE_RestructureData.xlsm (129 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w44/1202038/EE_RestructureData.xlsm">EE_RestructureData.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel file links to two spreadsheets yet linking not behaving consistently (based on source spreadsheets being open vs closed)</h2>
<p class="amcdate">2017-10-25T16:01:06-0400</p>

<pre class="amctext">I have a Summary spreadsheet called "PA_Summary_KPI_07DEC2017.xlsm" that is linked to two other spreadsheets, but the linked files are behaving differently.
                          
                          Description of links in  "PA_Summary_KPI_07DEC2017.xlsm" spreadsheet: 
                          Column B, C, D and E:
                          
                          
                            linked to spreadsheet called "Metrics_UnitWOs_07DEC2017.xlsm"
                            links only work when linked spreadsheet is open; otherwise, no data visible in Columns B, C, D and E of Summary spreadsheet
                          
                          Column F, G and H
                          
                          
                            linked to spreadsheet called "Metrics_CAP_ADDWOs_07DEC2017.xlsm"
                            links always work and data always visible, whether linked spreadsheet is open or closed
                          
                          
                          I would like to understand what is causing the different linking behavior between the two spreadsheets, and how I can fix it so that no linked spreadsheets need to be open when I open the Summary spreadsheet.
                          
                          I have attached all 3 spreadsheets to illustrate the issue.
                          
                          Thanks,
                          Andrea
                          Metrics_CAP_ADDWOs_07DEC2017.xlsm
                          Metrics_UnitWOs_07DEC2017.xlsm
                          PA_Summary_KPI_07DEC2017_EE.xlsm</pre>

<pre class="amctext">F, G and H retrieve from ranges, and B, C, D and E retrieve from a table, and for some strange reason that is not possible.
                                    A workaround could be to import the entire table to a sheet, and then use that.
                                    See attached.
                                    It is set to update on open.
                                    Typically it will work when the workbooks are in the same folder, as when I made it, but perhaps you must change the connection link on the Data tab.
                                    PA_Summary_KPI_07DEC2017_EE.xlsm</pre>

<pre class="amctext">Thanks very much, Ejgil...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of file linking issue - 1 (392 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201383/Metrics_CAP_ADDWOs_07DEC2017.xlsm">Metrics_CAP_ADDWOs_07DEC2017.xlsm</a></p>
<p class="amcfile">Example of file linking issue - 2 (231 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201385/Metrics_UnitWOs_07DEC2017.xlsm">Metrics_UnitWOs_07DEC2017.xlsm</a></p>
<p class="amcfile">Example of file linking issue - 3 (134 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201386/PA_Summary_KPI_07DEC2017_EE.xlsm">PA_Summary_KPI_07DEC2017_EE.xlsm</a></p>
<p class="amcfile">With table import (227 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201401/PA_Summary_KPI_07DEC2017_EE.xlsm">PA_Summary_KPI_07DEC2017_EE.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Update concatenated excel formula to include additional criteria</h2>
<p class="amcdate">2014-10-08T15:45:16-0400</p>

<pre class="amctext">Attached is a sample spreadsheet implementing a formula (in Column G). I would like this formula revised. Column I shows the desired results I am looking for. I've outlined the background details of the existing formula and included the updated criteria change at the end.
                          
                          CRITERIA OF EXISTING FORMULA:
                          I would like Column G to concatenate different columns, including a specific string within one column, based on various criteria outlined below:
                          
                           If D = "CAD" or "TREP", AND H = "VOL 1" then Column G to concatenate as follows:
                           G = B + D + C [first word after closing bracket OR first second word in string if no closing bracket] + F
                           Otherwise, Column G to concatenate as follows:
                           G = B + D + E + F
                          
                          CURRENT FORMULA:
                          =IF(AND(H2="VOL 1",OR(D2="CAD",D2="TREP")),B2&"-"&D2&"-"&LEFT(TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))),FIND(" ",TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))))-1)&IF(F2<>"","-"&F2,""),B2&"-"&D2&IF(E2&F2="","","-"&E2&F2))
                          
                          CRITERIA OF UPDATED FORMULA:
                          As above, except that H = "VOL 1" or "VOL 7" or "VOL 12" (formerly H = "VOL 1")
                          
                          Thanks,
                          Andrea
                          EE-Sample-Concat-2Part-Updated.xlsx</pre>

<pre class="amctext">Hi, 
                                    
                                    Try this (inserted in G2 and copied down):
                                    =IF(AND(OR(H2="VOL 1",H2="VOL 7",H2="VOL 12"),OR(D2="CAD",D2="TREP")),B2&"-"&D2&"-"&LEFT(TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))),FIND(" ",TRIM(IF(FIND(")",C2)<>LEN(C2),MID(C2,FIND(")",C2)+1,100),MID(C2,FIND(" ",C2)+1,100))))-1)&IF(F2<>"","-"&F2,""),B2&"-"&D2&IF(E2&F2="","","-"&E2&F2))
                                    
                                    I've bolded the key change to your formula.
                                    
                                    Regards,
                                    -Glenn</pre>

<pre class="amctext">Thanks very much, Glenn!</pre>

<pre class="amctext">You are welcome.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">EE-Sample-Concat-2Part-Updated.xlsx (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/10_w41/876465/EE-Sample-Concat-2Part-Updated.xlsx">EE-Sample-Concat-2Part-Updated.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Revise Excel macro to reference a specific workbook tab name</h2>
<p class="amcdate">2015-10-21T15:14:23-0400</p>

<pre class="amctext">I would like to revise the macro below so that it only runs in workbooks that have a tab called 'ncRptChangeForm'.
                          
                          
                          Sub Long_Form_Export()
'
' Long_Form_Export Macro
'

'
    Application.ActiveProtectedViewWindow.Edit
    Range("A10:A15").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Selection.Copy
    Sheets.Add After:=Sheets(Sheets.Count)
    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
    Application.CutCopyMode = False
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlTop
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("A:A").Select
    Columns("A:A").EntireColumn.AutoFit
    Columns("B:B").Select
    Selection.ColumnWidth = 50
    Cells.Select
    Selection.AutoFilter
    Range("B2").Select
    Range(Selection, Selection.End(xlDown)).Select
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlTop
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("A1").Select
End Sub

                          
                            Select all
                            Open in new window
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Add this at the beginning of the sub
                                    
                                    
                                        Dim tmp As Worksheet
    On Error Resume Next
    Set tmp = ActiveSheet
    Sheets("ncRptChangeForm").Select
    tmp.Select
    If Err Then
        Stop
        If Err.Number = 9 Then Exit Sub
    End If
    On Error GoTo 0

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">You could try this (pasted between lines 1 and 7 of your code):
                                    
                                    Dim booRun As Boolean
Dim ws As Worksheet

booRun = False

For Each ws In ActiveWorkbook.Sheets
    If ws.Name = "ncRptChangeForm" Then
        booRun = True
        Exit For
    End If
Next ws

If Not booRun = True Then Exit Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks to you both for your solutions. Both appeared to work.
                                    
                                    I did like the fact that Bugdrown's solution prevented the macro from running at all if the tab name didn't match 'ncRptChangeForm', whereas Syed's solution gave me a VBA error. Since many of our Excel users are novices, and may be confused by seeing the VBA window pop up, I prefer the former. That being said, I am not a programmer, so I don't know if there any other advantages / disadvantages between the two solutions? Is there someone that can outline this for me? It will also help me award points...
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">Andrea,
                                    It sounds like you are looking for a moderator. You can request attention at the bottom of your original question.
                                    
                                    I will say that one drawback from the code that I wrote is that the user has no feedback about why the code didn't run, if they were expecting it to. That could easily be changed with a friendly message (another line of code). 
                                    
                                    I'll step back until a moderator intervenes or until you or someone else has a question.</pre>

<pre class="amctext">Thanks, Bugdrown, good to know...I'll follow up with the moderator.</pre>

<pre class="amctext">You do not need to request attention. You should select the one which better suits you.</pre>

<pre class="amctext">Thanks Syed.
                                    
                                    Andrea, 
                                    I have to sign off but if my code works for you and you need a message with it, try pasting the following between lines 1 and 7 of your original code:
                                    
                                    
                                    Dim booRun As Boolean
Dim ws As Worksheet

booRun = False

For Each ws In ActiveWorkbook.Sheets
    If ws.Name = "ncRptChangeForm" Then
        booRun = True
        Exit For
    End If
Next ws

If Not booRun = True Then
    MsgBox "The macro will run only in workbooks with a sheet named 'ncRptChangeForm'", vbOKOnly + vbInformation, "Attention"
    Exit Sub
Else
End If

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks again to you both. Doug, I appreciate you adding a message feature to the code!</pre>

<pre class="amctext">Glad I could help.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Nested IF/AND/OR? Excel formula to determine results based on comparing 'cut-off date'with 'work order complete' date for each of 3 departments</h2>
<p class="amcdate">2017-12-31T13:07:13-0500</p>

<pre class="amctext">I have tried unsuccessfully to create a nested IF/AND formula whereby if two conditions are met, then the work order is 'On Time', otherwise it is 'Late'.
                          
                          Unit_Timeliness:
                          IF UDS![Unit]="DC", AND (UDS![Date_WO_Completed] > Schedule![DC_Cut_Off], THEN "Late" OR
                          IF UDS![Unit]="IFP", AND (UDS![Date_WO_Completed] > Schedule![IFP_Cut_Off], THEN "Late" OR
                          IF UDS![Unit]="PA", AND (UDS![Date_WO_Completed] > Schedule[PA_Cut_Off], THEN "Late"
                          ELSE "On Time"
                          If error, then leave cell BLANK
                          
                          The following formula I came up with is not working properly, in that all the results are indicating that the work orders were completed 'Late', which is not the case:
                          
                          =IF(AND(OR([@Unit]="DC",[@[Date_WO_Completed]]-Schedule.xlsx!AIM_Schedule[DC_Cut_Off]>"0",[@Unit]="PA",[@[Date_WO_Completed]]-Schedule.xlsx!AIM_Schedule[PA_Cut_Off]>"0",[@Unit]="IFP",([@[Date_WO_Completed]]-Schedule.xlsx!AIM_Schedule[IFP_Cut_Off]>"0"))),"Late","On Time")
                          
                          Details of attached files:
                          UDS.xlsx
                          Column name: [Unit]
                          Contains one of the following 3 variables, which are acronyms for 3 different departments:
                          DC
                          PA
                          IFP
                          
                          Column name: [Date_WO_Completed]
                          Contains date that work order was completed by the department
                          
                          Schedule.xlsx
                          Column names:
                          [DC_Cut_Off]*
                          [IFP_Cut_Off]*
                          [PA_Cut_Off]*
                          *Contains 'Cut-off' date for each department against which the work order's completion date is measured against to determine if they delivered the work order 'On Time' or 'Late'.
                          
                          Files as attached.
                          
                          I hope I have provided enough clarity and background...
                          
                          Thanks,
                          Andrea
                          UDS.xlsx
                          Schedule.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    I move Schedule.xlsx Sheet1 to UDS.xlsx and applied below formula:
                                    =IFERROR(IF(OR([@Unit]={"DC","IFP","PA"},[@[Date_WO_Completed]]>AIM_Schedule[DC_Cut_Off],[@[Date_WO_Completed]]>AIM_Schedule[IFP_Cut_Off],[@[Date_WO_Completed]]>AIM_Schedule[PA_Cut_Off]),"Late","On Time"),"")
                                    I changed few cells in Unit to "Open" to check if formula works. As you have "DC", IFP" & "PA" in all your cells.
                                    Is this what you want?
                                    Andrea_UDS.xlsx</pre>

<pre class="amctext">Hi Shums,
                                    
                                    Thanks for the quick response! :-)
                                    
                                    I reviewed the spreadsheet, and noticed that some of the results were not correct. Perhaps I wasn't clear enough in my original post, and if so, my apologies! For instance:
                                    
                                    
                                      The Cut-off date for DC is 13-Sep-2017 (as listed in the Schedule spreadsheet), so any 'DC' work orders that have a 'Date_WO_Complete' (Column D of UDS spreadsheet) that is later than 13-Sep-2017 should be showing as 'Late', but they are showing as 'On Time'. 
                                    
                                    
                                      There are instances where the ''Date_WO_Complete' (Column D of UDS spreadsheet) is blank, in which case I would like the 'Unit_Timeliness' column to remain blank (handling it as an error).
                                    
                                    
                                      The Unit column will always be populated, so I don't need error-handling for blanks in that column.
                                    
                                    
                                    Let me know if you have any questions or need any clarification...
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">Actually, I think I figured this one out! This formula appears to be giving me the results I'm after:
                                    
                                    =IFERROR(IF(AND([@Unit]="DC",[@[Date_WO_Completed]]-AIM_Schedule[DC_Cut_Off]>0),"Late",IF(AND([@Unit]="IFP",[@[Date_WO_Completed]]-AIM_Schedule[IFP_Cut_Off]>0),"Late",IF(AND([@Unit]="PA",[@[Date_WO_Completed]]-AIM_Schedule[PA_Cut_Off]>0),"Late","On Time"))),"")
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">I continued working on this after I posted the question, and eventually landed a formula that worked...</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Spreadsheet that I want the formula to reside (119 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w01/1217190/UDS.xlsx">UDS.xlsx</a></p>
<p class="amcfile">Spreadsheet containing cut-off dates for each department that is referenced by formula (9 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w01/1217191/Schedule.xlsx">Schedule.xlsx</a></p>
<p class="amcfile">Multiple IFS (119 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w01/1217198/Andrea_UDS.xlsx">Andrea_UDS.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Automating a process for consolidating rows of data from several tabs into one summary tab in an Excel workbook on an ongoing basis</h2>
<p class="amcdate">2017-05-11T15:39:38-0400</p>

<pre class="amctext">My spreadsheet has multiple identical tabs, one for each of 10 users. Each user is to populate each row of their tab (Columns A through G) with their own (unique) work orders, in the order they are received. All tabs are identical in terms of the number of columns and the column headings.
                          
                          I need to find the best, most automated process, to:
                          
                          
                            Copy the populated rows from each of the 10 user tabs into a summary tab called "LU_Workflow" that resides in the same workbook
                            For Column H in each user tab to automatically populate with the date that the work order was copied into the summary tab
                          
                          
                          These user tabs would have new entries every day on an ongoing basis. I would like to be able to control the timing of when this automated process occurs.
                          
                          I have included a sample spreadsheet to illustrate what I am looking for.
                          
                          I hope I have explained this clearly enough. Please let me know if you have any questions. 
                          
                          Thanks!
                          Andrea
                          EE_MergingRows.xlsx</pre>

<pre class="amctext">Here's a small routine that should do what you want, give it a test there...
                                    
                                    
                                    Sub MergeSheets()

    Dim i As Integer

    For i = 2 To ActiveWorkbook.Worksheets.Count
        ProcessSheet ActiveWorkbook.Worksheets(i), ActiveWorkbook.Worksheets(1)
    Next i

End Sub

Sub ProcessSheet(shtSource As Worksheet, shtDest As Worksheet)
    
    Dim i As Integer
    Dim lngRowStart As Long
    Dim lngRowEnd As Long
    Dim lngRowDest As Long

    lngRowStart = shtSource.Cells(Rows.Count, 8).End(xlUp).Row + 1
    lngRowEnd = shtSource.Cells(Rows.Count, 1).End(xlUp).Row
    lngRowDest = shtDest.Cells(Rows.Count, 1).End(xlUp).Row
    
    For i = lngRowStart To lngRowEnd
        lngRowDest = lngRowDest + 1
        shtSource.Range(shtSource.Cells(i, 1), shtSource.Cells(i, 7)).Copy Destination:=shtDest.Range(shtDest.Cells(lngRowDest, 1), shtDest.Cells(lngRowDest, 7))
        shtSource.Cells(i, 8) = Date
    Next
    
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    »bp</pre>

<pre class="amctext">Thanks so much, Bill, works like a charm!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example spreadsheet (546 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/05_w19/1161873/EE_MergingRows.xlsx">EE_MergingRows.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Adding a text string to a formula result in Excel</h2>
<p class="amcdate">2017-04-03T17:03:11-0400</p>

<pre class="amctext">My current formula below gives me a numeric value (# of business days):
                          
                          =IF($AH2="","",IFERROR(NETWORKDAYS($I2,$AH2,Holidays),""))
                          
                          I would like to revise this formula so that instead of just showing the number, I would like the result to include the word "day" as follows:
                          
                          If result is 1 day, then "1 day"
                          If result is > than 1 day, then "# days" (ie., "3 days")
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Will shorten but it will be something like
                                    
                                    =IF(IF($AH2="","",IFERROR(NETWORKDAYS($I2,$AH2,Holidays),""))>1,IF($AH2="","",IFERROR(NETWORKDAYS($I2,$AH2,Holidays),"")) & " days",IF($AH2="","",IFERROR(NETWORKDAYS($I2,$AH2,Holidays),"")) & " day")

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks for the quick response, Shaun! Sorry, but I just need it tweaked so that if Column AH is blank, then the results column is blank. It's currently showing 'days'.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try below:
                                    =IF($AH2="","",IF(IFERROR(NETWORKDAYS($I2,$AH2,Holidays),"")=1,IFERROR(NETWORKDAYS($I2,$AH2,Holidays),"")&" Day",IFERROR(NETWORKDAYS($I2,$AH2,Holidays),"")&" Days"))</pre>

<pre class="amctext">Thanks so much, Shaun & Shums!</pre>

<pre class="amctext">You're Welcome Andrea! Glad we're able to help you :)</pre>

<pre class="amctext">Glad we could help.
                                    Please remember to endorse my, or any other expert's comments that you found helpful by clicking on the "Thumb's Up" button</pre>

<pre class="amctext">Thanks, Shaun, for letting me know...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel 2010, copy & paste cells into another sheet based on non-blank cell</h2>
<p class="amcdate">2013-08-28T14:52:24-0400</p>

<pre class="amctext">I want to develop a formula that automates and updates this process on the fly: In Worksheet 1, if and when there is a value entered into cell V2, then the values in D2, L2, M2 and V2 are copied and pasted (paste special - values) into Worksheet 2 in the following order: V2 into A2, D2 into B2, L2 into C2, and M2 into D2. The workbook is shared. What is the most efficient way to do this?
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Please see the attached workbook and let me know if you have any questions.
                                    
                                    Here is the code I used in the ThisWorkbook object
                                    
                                    
                                    Private Sub Worksheet_Change(ByVal Target As Range)
    If Not Intersect(Range("V2"), Target) Is Nothing Then
        Application.ScreenUpdating = False
        Sheet2.Range("A2").Value = Range("V2").Text
        
        Sheet2.Range("B2").Value = Range("D2").Text
        
        Sheet2.Range("C2").Value = Range("L2").Text
        
        Sheet2.Range("D2").Value = Range("M2").Text
        Application.ScreenUpdating = True
    End If
End Sub

                                    
                                      Select all
                                      Open in new window
                                    test.xlsm</pre>

<pre class="amctext">Hi,
                                    Thanks very much for the quick response! My apologies, but I'm new to inserting code - would you be able to outline how get this into my own spreadsheet. Worksheet 1 in my spreadsheet is called "IAP_Charts_Pub" and Worksheet 2 is called "Cartography". Thanks in advance for your patience.
                                    
                                    Andrea</pre>

<pre class="amctext">Sure no problem.
                                    
                                    Hold ALT and hit F11.  This will bring up the VBA window.
                                    
                                    On the left you should see the project explorer which shows each sheet and a ThisWorkbook object for every workbook you have open.  If not Hold CTRL and hit R.
                                    
                                    Double-click Sheet# (IAP_Charts_Pub) under the workbook in question.  A code window will appear on the right.
                                    
                                    Copy and paste my code below into the window and test it out.
                                    
                                    Make sure that you save it as an *.xlsm file (xlsx will not save code) if using Excel 2007+
                                    
                                    
                                    Private Sub Worksheet_Change(ByVal Target As Range)
    If Not Intersect(Range("V2"), Target) Is Nothing Then
        Application.ScreenUpdating = False

        Sheets("Cartography").Range("A2").Value = Range("V2").Text
        Sheets("Cartography").Range("B2").Value = Range("D2").Text
        Sheets("Cartography").Range("C2").Value = Range("L2").Text        
        Sheets("Cartography").Range("D2").Value = Range("M2").Text

        Application.ScreenUpdating = True
    End If
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Let me know how it goes.
                                    
                                    -FM</pre>

<pre class="amctext">Hi FM,
                                    
                                    I haven't been able to replicate your success at my end. I went back to basics, started with a new file, and tried to recreate your test.xlsm file, but find that mine doesn't work. I am making sure that macros are enabled, etc. and have tried this on 2 different computers. I've attached my attempt, and wondered if you could have a look at it to see where I'm going wrong...
                                    
                                    Thanks!
                                    Andrea
                                    RecreatedTest.xlsm</pre>

<pre class="amctext">Finally had success...I'm not sure what I was doing wrong. In the end, I copied the text in row 2 on the IAP_Charts_Pub sheet to row 3, deleted row 2, and the Cartography sheet was populated. Thanks very much!</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Sorry I didn't get back to you as I was on a mini vacation.  I am glad you were able to get it to work!  Thanks for the grade!
                                    
                                    -FM</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">example (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/08_w35/674156/test.xlsm">test.xlsm</a></p>
<p class="amcfile">My attempt to recreate your test file... (13 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/08_w35/674527/RecreatedTest.xlsm">RecreatedTest.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Write batch file that creates a destination folder with current date and copies files from one network drive folder to another</h2>
<p class="amcdate">2018-10-07T11:18:55-0400</p>

<pre class="amctext">I would like to create a batch file to use in Windows 10 Task Scheduler for the purpose of doing a daily backup of spreadsheets from one network drive folder to another network folder. I would like the batch file to include the step of creating a sub-folder in the destination 'CAP Spreadsheet Backups' folder, named with the current date (YYYY - MMM- DD), where the spreadsheets would be backed up to.
                          
                          I have created the copy action:
                          
                          Copy "\\ncxxx3.corp.xxxx.ca\productiongraphics$\XXX Spreadsheets\*.xls*" "\\ncxxx1\xxx_development$\Publishing\XXX\_XXX Spreadsheet Backups\
                          
                          But I do not know how to add the action to create the sub-folder with the current date to the batch file.
                          
                          Also, do I need to include an action in the batch file to 'End' the task?
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">I'll come up shortly to answer your question.
                                    
                                    
                                    $SourceFolder = "\\ncxxx3.corp.xxxx.ca\productiongraphics$\XXX Spreadsheets\" 
$TargetRoot = "\\ncxxx1\xxx_development$\Publishing\XXX\_XXX Spreadsheet Backups\CAP Spreadsheet Backups"

$CurrentDate = Get-Date -Format yyyy-MM-dd


#Step0: Check if the TargetRootFolder exists, if it doesn't exists create it
if(!(Test-Path $TargetRoot)){
    Write-Host -ForegroundColor Cyan "Creating new folder $TargetRoot"
    New-Item -Path $TargetRoot -ItemType directory| Out-Null #do not say anything on console that you create the folder
}

#Step1: GEt All the excel files on the SourceFolder
$AllFiles = Get-ChildItem -Filter *.xls* -Path $SourceFolder -Recurse

#Now For each file we will get the Current
foreach($file in $AllFiles){
    $FinalTarget ="$TargetRoot\\$CurrentDate"
    #if target folder doesn't exists create it
    if(!(Test-Path $FinalTarget)){
        Write-Host -ForegroundColor Magenta "Creating new folder $FinalTarget"
        New-Item -Path $FinalTarget  -ItemType directory| Out-Null #do not say anything on console that you create the folder
    }
    #And copy the item with the same name on the finaltargetfodler.
    Copy-Item -LiteralPath $file.FullName -Destination "$FinalTarget\\$($file.Name)"
}

                                    
                                      Select all
                                      Open in new window
                                    
                                    This will create the folder CAP Spreadsheet backups, (even if it doesn't exists).
                                    Then will get all the excel files on the source path.
                                    and then will create a folder with the today's date under the (Cap spreadsheet backups\yyyy-MM-dd\)
                                    and finally will copy all the files from source to this latest target. if there is a need to correct something let me know since the "date" and the CAP weren't too clear for me.</pre>

<pre class="amctext">Jose's Powershell should work fine but I haven't tested it. Since you said 'batch', I presume you'd like either .bat or .cmd file...
                                    
                                    > But I do not know how to add the action to create the sub-folder with the current date to the batch file.
                                    
                                    Make file named DateTime-YYYYMMDDHHMMSS_wmic.bat. This sets your date vars:
                                    
                                    
                                    :: Use WMIC to retrieve date and time
FOR /F "skip=1 tokens=1-6" %%G IN ('WMIC Path Win32_LocalTime Get Day^,Hour^,Minute^,Month^,Second^,Year /Format:table') DO (
   IF "%%~L"=="" goto s_done
      Set _yyyy=%%L
      Set _mm=00%%J
      Set _dd=00%%G
      Set _hour=00%%H
      Set _minute=00%%I
      Set _seconds=00%%K
)
:s_done
:: Pad digits with leading zeros
Set _mm=%_mm:~-2%
Set _dd=%_dd:~-2%
Set _hour=%_hour:~-2%
Set _minute=%_minute:~-2%
Set _seconds=%_seconds:~-2%

:: Display the date/time in ISO 8601 format:
Set _isodate=%_yyyy%-%_mm%-%_dd% %_hour%:%_minute%:%_seconds%
REM Echo %_isodate%
set DateTimeNow=%_yyyy%%_mm%%_dd%%_hour%%_minute%%_seconds%
REM echo DateTimeNow=%DateTimeNow%

GOTO:EOF

                                    
                                      Select all
                                      Open in new window
                                    
                                    Revise your main code accordingly. Note: This is currently in debug mode for visual reasons. When you've confirmed it looks correct, remove the ECHO prefixes.
                                    
                                    Open a Command Window to run it.
                                    
                                    
                                    @echo off
setlocal enabledelayedexpansion

call DateTime-YYYYMMDDHHMMSS_wmic.bat

set destdir=\\ncxxx1\xxx_development$\Publishing\XXX\_XXX Spreadsheet Backups\%_yyyy%-%_mm%-%_dd%

ECHO if not exist "%destdir%" md "%destdir%"
ECHO Copy "\\ncxxx3.corp.xxxx.ca\productiongraphics$\XXX Spreadsheets\*.xls*" "%destdir%"

                                    
                                      Select all
                                      Open in new window
                                    
                                    > Also, do I need to include an action in the batch file to 'End' the task?
                                    
                                    No.</pre>

<pre class="amctext">Thanks to you both for your quick responses. 
                                    
                                    Yes, you're right, NVIT, I do need a .bat file. I want to be able to run this within Windows 10 Task Scheduler at a specific time of day.
                                    
                                    As I am not experienced in this area, I thought perhaps I could save Jose's solution as a .bat file, but received error messages so suspect it is not a .bat file...?
                                    
                                    I had success with NVIT's solution when I ran it as outlined - thank you very much! I ran into a challenge when I tried running it in Windows 10 Task Scheduler. For the Task Scheduler, I wasn't sure what to do so I added both .bat files. When I ran the main code, the Excel files did get copied into a newly created folder, but the folder name was "--" and not named with the current date (as it was when run from the CMD line). Would you be able to guide me as to how I get these two .bat files to work together in Task Scheduler (ie., for the main .bat file to reference the DateTime-YYYYMMDDHHMMSS_wmic.bat file so the new folder is correctly named with the current date)?
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">Give this BAT file a try.  I used YYYYMMDD as the date format, I'd recommend that easier sorting / ordering of the subfolders.
                                    
                                    
                                    @echo off
setlocal

REM Get current date in YYYYMMDD
set DateStamp=
for /f "tokens=* skip=1" %%A in ('wmic os get LocalDateTime') do (
    if not defined DateStamp set DateStamp=%%A
)
set DateStamp=%DateStamp:~0,8%

set DestDir=\\ncxxx1\xxx_development$\Publishing\XXX\_XXX Spreadsheet Backups\%DateStamp%\

if not exist "%DestDir%" md "%DestDir%"

copy "\\ncxxx3.corp.xxxx.ca\productiongraphics$\XXX Spreadsheets\*.xls*" "%DestDir%"

                                    
                                      Select all
                                      Open in new window
                                    
                                    (EDIT: Corrected typo of DataStamp to DataStamp)
                                    
                                    
                                    »bp</pre>

<pre class="amctext">DateTime-YYYYMMDDHHMMSS_wmic.bat  must either be in the same folder as the main bat, or somewhere in the PATH. I put my bat files in a c:\utils folder</pre>

<pre class="amctext">Thanks very much for your help, everyone! I was able to run Bill's solution successfully through Windows 10 Task Scheduler. :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Sorry, I meant to mention (for future reference to others who may view this question) that I had to make one tweak to your code, Bill - Line 11 - change the word 'datastamp' to datestamp'...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Hi NVIT,
                                    
                                    Just to confirm that I do have both .bat files in the same folder, but for some reason the folder name is showing as "--" instead of the date...
                                    
                                    Andrea</pre>

<pre class="amctext">Lol</pre>

<pre class="amctext">Andrea. you can safely use powershell or cmd files with task scheduler 
                                    
                                    https://social.technet.microsoft.com/wiki/contents/articles/38580.configure-to-run-a-powershell-script-into-task-scheduler.aspx
                                    
                                    So....
                                    
                                    
                                    You don't need to have both files. With a bat file is enough, and you can use any file (of the answers)... of course, you need to use the real path on the answers.
                                    
                                    @NVIT a batch file is a synonym to say a script, on Task scheduler works any of the 3 files, regular Command (.bat, .cmd) or PowerShell (.ps1).</pre>

<pre class="amctext">@Jose
                                    
                                    Fine. Still, Andrea wasn't specific, so...</pre>

<pre class="amctext">NVIT - I apologize for not being more specific, which is due to my lack of knowledge/experience in this area...with the helpful answers/information you have all provided, I now have a better understanding and can (hopefully) pose my future questions more succinctly. :-)
                                    
                                    Jose - thanks very much for sharing additional knowledge/insights.
                                    
                                    Great forum!
                                    
                                    Andrea</pre>

<pre class="amctext">All good np.
                                    @NVIT, it was not specific so I could answer whatever I don't see the need for you to be picky about my answer.  I did answer to the author not to you or for you specifically.</pre>

<pre class="amctext">Who's being picky?</pre>

<pre class="amctext">Have you enabled Volume Shadow Copy on the server?  Too many people don't even know about this and while if you need long term archive copies of these sheets, Volume Shadow Copy can provide more granular and automated backups.</pre>

<pre class="amctext">Thanks, Lee, for this information...I’ll look into it.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">See my article - it explains it in depth
                                    https://www.experts-exchange.com/articles/30742/A-Guide-to-Volume-Shadow-Copy.html</pre>

<pre class="amctext">Thanks, Lee!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Need dates in column to be real dates not text dates (currently a mixture)</h2>
<p class="amcdate">2017-05-03T18:16:43-0400</p>

<pre class="amctext">Column E is formatted as follows
                          
                          AA-dd mmm yyyy-YES
                          AA-dd mmm yyyy-NO
                          
                          If Column E has a text string = NO, it indicates that the work order is not valid, and Column J is auto-populated with the text date string from Column E.  The formula in Column J is:
                          
                          =IFERROR(IF($E2="","",IF(RIGHT($E2,3)="YES","",TEXT(NOW(),"dd mmm yyyy"))),"")
                          
                          If Column E has a text string = YES, this indicates that the work order is valid, and the processing of the work order takes several weeks, in which case Column J is manually populated with a real date (using data validation) in the format dd-mmm-yy.
                          
                          As a result, Column J has a mixture of 'text' dates and 'real' dates. I need Column J to only have 'real' dates, but don't want to lose the auto-populating feature as outlined above when Column E has a text string = NO.
                          
                          What would be the best solution to achieve only real dates for Column J?
                          
                          I have included an example of the spreadsheet.
                          
                          Thanks!
                          Andrea
                          EE_Date_Issue.xlsm</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    I am not sure why you need Data Validation,
                                    
                                    Try below formula in J:
                                    
                                    =IF($E2="","",IF(AND(RIGHT($E2,3)="YES",$G2="YES"),TEXT(MID($E2,4,11),"dd mmm yyyy"),IF(RIGHT($E2,2)="NO",TEXT(NOW(),"dd mmm yyyy"),"")))

                                    
                                      Select all
                                      Open in new window
                                    Andrea_EE_Date_Issue.xlsm</pre>

<pre class="amctext">Thanks very much, Shums, for the quick response! I was using data validation so that when the users manually populate that column for valid WOs, they would enter the date in a consistent manner. Does that make sense? Also, when I use your formula above, do I change the data validation so that the manually entered date will match the same format as the one resulting from your formula?</pre>

<pre class="amctext">Andrea,
                                    
                                    You don't need to change Data Validation Date Format, just change Col J Format cell to desired format, already changed in attached.
                                    Andrea_EE_Date_Issue_v2.xlsm</pre>

<pre class="amctext">Here is a macro that converts the dates that are text:
                                    
                                    Sub RealDates()
Dim cel As Range, rg As Range
Application.ScreenUpdating = False
With ActiveSheet
    Set rg = .Range("J2")
    Set rg = Range(rg, .Cells(.Rows.Count, rg.Column).End(xlUp))
    For Each cel In rg.Cells
        If Application.IsText(cel.Value) Then
            If IsDate(cel.Value) Then cel.Value = CDate(cel.Value)
        End If
    Next
End With
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">OK perfect. Please bear with me as I have another question to help me understand your solution. :-) I am curious as to why the formula references Column G, as Column G does not have any bearing on Column J. Can you explain the solution in this regard...thanks!
                                    Andrea</pre>

<pre class="amctext">LOL.
                                    
                                    My bad, I thought you are considering "Yes" in Col G as well.
                                    
                                    You can keep your initial formula in Col J and use Brad's VBA, which will convert formulated date to real date and your formula is intact for blank cells.</pre>

<pre class="amctext">Thanks very much, Shums and Brad...much appreciated!</pre>

<pre class="amctext">Thanks!!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of issue (26 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/05_w18/1160187/EE_Date_Issue.xlsm">EE_Date_Issue.xlsm</a></p>
<p class="amcfile">Update J (25 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/05_w18/1160193/Andrea_EE_Date_Issue.xlsm">Andrea_EE_Date_Issue.xlsm</a></p>
<p class="amcfile">Data Validation (25 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/05_w18/1160199/Andrea_EE_Date_Issue_v2.xlsm">Andrea_EE_Date_Issue_v2.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Adding another condition/outcome to a formula</h2>
<p class="amcdate">2014-02-27T19:11:47-0500</p>

<pre class="amctext">In column AF, the cells are automatically populated with "ERR" if the criteria in this formula is met:
                          
                          =IF(OR($AS2="ERR",$BB2="ERR",$BE2="ERR"),"ERR","")
                          
                          I need to revise the formula to include the following criteria and outcome below:
                          
                          If AS2 and/or BB2 and/or BE2 is equal to "CORR" and AS2 and/or BB2 and/or BE2 is not equal to "ERR", then populate AF2 with "CORR".
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">Hello Andrea, try adding another OR
                                    
                                    =IF(OR($AS2="ERR",$BB2="ERR",$BE2="ERR"),"ERR",IF(OR($AS2="CORR",$BB2="CORR",$BE2="CORR"),"CORR",""))
                                    
                                    regards, barry</pre>

<pre class="amctext">Perfect! Thanks so much...</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Automate extracting, cropping, outputting individual .pngs from large PDF documents</h2>
<p class="amcdate">2013-09-09T21:41:09-0400</p>

<pre class="amctext">I have multiple 300+ page PDFs that are published every 2 months.  About 80% of the pages do not change between publication cycles. The 20% of the pages that do change need to be extracted, cropped and output to individual .png files. Every page includes the month and year that the page was last revised in the lower left corner of the page, so it is easy to identify the changed pages by searching for pages that have the latest month/year on the page (ie., a single search for August 2013 would bring up all the changed pages for the August print cycle). In terms of cropping, all pages would be cropped identically.
                          
                          I am looking for a way to automate this process in either Acrobat Pro or Enfocus Pitstop: searching for changed pages using search term "month year", crop, extract pages into individual pdf files, export as .png. Would this be possible?</pre>

<pre class="amctext">I'm not sure what's possible in Pitstop, but in acrobat pro you can set up actions (Tools Palette -> Action Wizard) which will automate some tasks. One of the options is to include javascript, which would be the only potential way to find the pages you are after. I have not done this myself, but this would be a good place to start -
                                    
                                    http://acrobatusers.com/actions-exchange
                                    
                                    The other things you want to do, cropping, extracting and exporting as PNG are all available as action steps, so only the searching for pages which meet your criteria part might need to be done with Javascript.</pre>

<pre class="amctext">I purchased a scripting solution on the pdfscripting.com website.</pre>

<pre class="amctext">The script I purchased from another website provided the solution I was looking for.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Need a Excel formula to remove numbers at end of lines of text that are of varying lengths & # of digits</h2>
<p class="amcdate">2014-07-25T08:47:26-0400</p>

<pre class="amctext">I was able to figure out the TRIM formula to extract the numbers at the end of each line of the SAMPLE TEXT (below) into column C:
                          =TRIM(RIGHT(SUBSTITUTE(A2," ",REPT(" ",LEN(A2))),LEN(A2)))
                          
                          Next I would like to extract just the text strings, without the numbers (or space in front of the numbers), into column B from the SAMPLE TEXT below. I've taken a few stabs at it but have only managed to extract the first word in each line and not the entire text string.
                          
                          SAMPLE TEXT:
                          Documents (in Book) Total 239
                          Frame generatable file(Skipped, Unprocessed) 0
                          Unable to generate due to Errors 0
                          Generated OK 239
                          Generated containing Warnings or Errors 0
                          Text Amendments (Insertions/Deletions) Total 40
                          Activated 40
                          Warnings or Errors 0
                          DataLinks (Links to Database) Total 3730
                          New 23
                          Changed 45
                          Warnings or Errors 0
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">use this formula (I assume your data ar in A column)
                                    note that based on your regional settings you may need to replace semicolon (;) sign in formula by comma (,)
                                    =LEFT(A1;LEN(A1)-LEN(MID(A1;FIND(CHAR(22);SUBSTITUTE(A1;" ";CHAR(22);LEN(A1)-LEN(SUBSTITUTE(A1;" ";""))))+1;255))-1)
                                    
                                    see also attached sample
                                    sample.xlsx</pre>

<pre class="amctext">Thanks for your quick response, helpfinder! I converted the semi-colons to commas and the formula worked perfectly.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">sample (8 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/07_w30/862658/sample.xlsx">sample.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Referencing date string in worksheet tab as part of formula to determine if deadline met</h2>
<p class="amcdate">2017-06-26T17:05:10-0400</p>

<pre class="amctext">I am hoping that it is possible to reference a date string in the worksheet tab name in a formula. 
                          
                          Production worksheet tab name format:
                          Planning_DD-MMM-YY
                          
                          Number of production worksheet tabs per workbook:
                          3
                          
                          Deadline lookup table:
                          Deadline_Dates tab
                          
                          Formula I am looking for to determine if a WO is completed on time or not:
                          Based on date in production worksheet tab (ie., Planning_12-Oct-17), the formula would check the 'Deadline_Dates' lookup table for the deadline listed for 12-Oct-17 (in this case 05-Apr_17) and determine if the deadline has been met by comparing it against the date listed in Col G (Date_WO_Completed), and then populate Col H as follows:
                          
                          
                            If date in Col G is < or = to deadline date, then Col H = 'Yes'
                          
                          
                            If date in Col G is > than deadline date, then Col H = 'No'
                          
                          
                            If Col G is blank, then Col H is blank.
                          
                          
                          I have included a sample spreadsheet with the 3 production tabs and the desired results listed in red.
                          
                          Thanks,
                          Andrea
                          Index_Match_Date_Deadline_Worksheet.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    I tried many ways to lookup referencing partial sheet name, but unsuccessful. Eventually VBA solution worked. Below is the code:
                                    
                                    Sub UpdatePlanningSheets()
Dim Ws As Worksheet, Ws1 As Worksheet, Ws2 As Worksheet
Dim LR As Long, LR1 As Long

'Disable Events
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
    .Calculation = xlManual
End With

'Set Variables
Set Ws1 = Worksheets("Deadline_Dates")
Set Ws2 = Worksheets("Lookups")
LR1 = Ws1.Range("A" & Rows.Count).End(xlUp).Row

'Get Sheet Names of Every Worksheet & Update Column H
For Each Ws In ThisWorkbook.Worksheets
    If Ws.Name <> Ws1.Name And Ws.Name <> Ws2.Name Then
        LR = Ws.Range("G" & Rows.Count).End(xlUp).Row
        If IsEmpty(Ws.Range("H2:H" & LR + 1)) = False Then
            Ws.Range("H2:H" & LR + 1).ClearContents
        End If
        Ws.Range("K2").FormulaR1C1 = "=RIGHT(CELL(""filename"",R[-1]C1),9)"
        Ws.Range("K2").Value = Ws.Range("K2").Value
        Ws.Range("H2:H" & LR).FormulaR1C1 = "=IF(RC7="""","""",IF(RC7<=VLOOKUP(R2C11,Deadline_Dates!C1:C2,2,0),""Yes"",""No""))"
        Ws.Range("H2:H" & LR).Value = Ws.Range("H2:H" & LR).Value
    End If
Next Ws

'Enable Events
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                                    
                                      Select all
                                      Open in new window
                                    In attached, run macro UpdatePlanningSheets, which will update all three tab's Col H with desired result.
                                    Andrea_Index_Match_Date_Deadline_Wo.xlsm</pre>

<pre class="amctext">Terrific! Thanks so much, Shums! :-)
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w26/1178174/Index_Match_Date_Deadline_Worksheet.xlsx">Index_Match_Date_Deadline_Worksheet.xlsx</a></p>
<p class="amcfile">Reference Sheet Names (24 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w26/1178193/Andrea_Index_Match_Date_Deadline_Wo.xlsm">Andrea_Index_Match_Date_Deadline_Wo.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Unable to get Excel pivot table to show # of WOs with errors</h2>
<p class="amcdate">2017-04-10T16:21:03-0400</p>

<pre class="amctext">My production spreadsheet lists WOs in column A, and tracks, among other things, the number of times over the course of the production cycle that 'rework' (corrections) had to be made to a WO. In the sample spreadsheet attached:
                          
                          Sheet 1, Column M (Total_RWK_Count) = sum of the # of times a completed WO was reworked (corrected) during production (as it can happen more than once)
                          So based on Sheet 1, Column M:
                          Sum of total # of reworks of completed WOs (by type) = 13
                          Count of completed WOs that required rework = 7
                          
                          My problem is with the Pivot Table tab. In Column D (Sum_Total_RWK_Count) shows the sum of the total # of reworks (13). But I also want to have a pivot table column showing the 'Count of WOs# that required rework by type (),which is 7 for 'Type 2') but I haven't had any success with this. When I've tried, the results have been a count of all WOs for each type, not just a count of the WOs that had rework. Please see the attached spreadsheet's Pivot tab, Column H for the desired results (highlighted in red).
                          
                          Thanks!
                          Andrea
                          Tracker_EE.xlsm</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Sometime when you upload data from csv or sql query, excel reads blank cells as constants, filter Column M with blanks, select whole range and delete, then change in pivot from Sum to Count of Rework.
                                    Andrea_Tracker_EE.xlsm</pre>

<pre class="amctext">Super...thanks so much, Shums!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Pleased to help :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of pivot table with desired solution (46 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/04_w15/1155960/Tracker_EE.xlsm">Tracker_EE.xlsm</a></p>
<p class="amcfile">Pivot (38 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/04_w15/1155963/Andrea_Tracker_EE.xlsm">Andrea_Tracker_EE.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel macro to filter rows based on case sensitivity & font color</h2>
<p class="amcdate">2014-08-21T09:57:56-0400</p>

<pre class="amctext">I need to create a macro that filters a large spreadsheet for all rows that meet all of the following criteria:
                          
                          
                            Red font color only (exclude rows that mixed font colors, ie., red and black)
                          
                          
                            First word in string is in all capital letters
                          
                          
                            Row ends with a minimum of 5 spaces preceding a 4-character string in all capital letters that starts with "C"
                          
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Example data, please, or provide more-specific information on size of data table (ex., number of columns, examples of data that would pass the filter criteria).  
                                    
                                    Also:  I presume in the second criteria you mean the first word in the first cell must be all caps.  If different, please clarify.
                                    Same for third criteria; is this the last cell in the row?
                                    
                                    Regards,
                                    -Glenn</pre>

<pre class="amctext">Hi Glenn,
                                    
                                    I created a sample workbook. The first tab is sample data, and the second tab shows the results I want to extract from the data. If it's possible to include having the desired results copied into a blank worksheet as part of the solution to my question, that would be great!
                                    
                                    Thanks,
                                    Andrea
                                    EE-SampleData-Results.xlsx</pre>

<pre class="amctext">The following workbook will add a sheet called "Results" and copy the values that meet your criteria from the source sheet to it.  The macro name is "Move_Select_Data".
                                    
                                    Notes:
                                    1) You must be viewing the source sheet to run.
                                    2) It is looking for a color IDENTICAL to that given in your example (RGB values 238,46,41).  If it is any other variation of red - including pure red (255,0,0), it will not pick that result as a possible match.
                                    
                                    The results are not formatted; just the values are added to the Results sheet.  You can run this over again and the code will replace any existing Results with new ones.
                                    
                                    Regards,
                                    -Glenn
                                    EE-SampleData-Results.xlsm</pre>

<pre class="amctext">Hi Glenn,
                                    
                                    Thanks so much!! 
                                    
                                    Unfortunately there is a weird thing that is happening, which is to do with my data since the sample data I sent is not a problem, and I'm not sure what is causing it:
                                    
                                    When I ran the macro, it created the Results sheet but there were no results listed. Thinking that maybe the red font color in the values wasn't identical to the RGB values in the macro, I checked the first value and the RGB values were correct. When I ran the macro again, the single value that I double-clicked on was successfully transferred to the Results spreadsheet. I continued to experiment, and for every value I double-clicked on, that value was transferred across when re-running the macro. Any value I didn't double-click on was not transferred. So somehow the RGB values are not recognized until that row is double-clicked.
                                    
                                    The reason my sample data spreadsheet didn't cause any issues is that I had to edit each row (for confidentiality reasons).
                                    
                                    Background on the data, in case it sheds some light:
                                    The original source of this data is a PDF that was opened in Acrobat Pro and saved as a Microsoft Excel spreadsheet. 
                                    
                                    Any thoughts on this strangeness? Or perhaps the best bet is to adjust the macro so it emulates the double-clicking action I am doing for all rows before it runs through the main event?
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">I have a macro that I run that "refreshes" large, selected ranges of data.  It essentially does something like you did - double-clicking and re-entering each cell (like [F2] and [Enter]).
                                    
                                    Add this macro to your workbook (or better yet, your Personal Macro Workbook).  Then select all the data to update and run this macro.  THEN, run my previously-submitted macro.  Let me know if this works.
                                    
                                    -Glenn
                                    
                                    
                                    Sub ReEnter()
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Dim x, tCells As Long
    tCells = Selection.Count
    For x = 1 To tCells
        Selection.Item(x).Formula = Trim(Selection.Item(x).Formula)
    Next x
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Glenn,
                                    
                                    Unfortunately running the above macro doesn't seem to make a difference. I tried it a couple of times, and then went back again and manually double-clicked on a row that had one of the values, saved and ran the macro again, and that one value transferred over to the results sheet.
                                    
                                    Interestingly, when I copied the spreadsheet into Microsoft OneNote, then re-pasted it back into Excel, the Move_Select_Data then worked. I noticed when the PDF is running through it's conversion into an Excel format, the progress bar at one point refers to OCR, which is why I tried the OneNote process as it has OCR capabilities. I don't know if that has anything to do with the issue here...curious.
                                    
                                    Any other thoughts?
                                    
                                    Andrea</pre>

<pre class="amctext">Hi Glenn,
                                    
                                    I'm very pleased...thanks so much!
                                    
                                    Cheers,
                                    Andrae</pre>

<pre class="amctext">I'm sorry I didn't get a chance to follow up on your issue with my "Re-Enter" macro.  It only works on a selected range of cells (i.e., you have to highlight/select them all before running the macro), but it still should have refreshed even a single cell like the red ones in your data.
                                    
                                    I'm glad I was able to help some.
                                    
                                    Regards,
                                    -Glenn</pre>

<pre class="amctext">Hi Glenn,
                                    
                                    Thanks for your follow-up. I ran the "ReEnter" macro after selecting the range of cells as suggested, and unfortunately it removed the font formatting, including the red font so the "Move_Select_Data" macro doesn't work. 
                                    
                                    If it's possible to get the "ReEnter" macro to run and refresh the data without removing font color, that would be great. Since this thread is closed, should I be posting this as a new question?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">No; since the issue you're having is a result of code I offered here, I think we should try and resolve it within this question.
                                    
                                    Is it possible to attach a copy of the file with the PDF data - redacted, if necessary?  I'd like to see the behavior you're talking about and maybe provide another automated solution.
                                    
                                    -Glenn</pre>

<pre class="amctext">Hi Glenn,
                                    
                                    Thanks for offering to pursue this.
                                    
                                    I've created a sample Excel file as attached that demonstrates the behavior. In the results sheet, you'll notice there are two results — these results are coming from the rows in Table 1 which I double-clicked. The remaining rows that meet the criteria, row 7 and 10, did not transfer over. If I double-click them, however, then save the file and run the macro, they will be included in the results.
                                    
                                    I'll be interested to hear if you find the same behavior occurs at your end, and if so, what your take is on this!
                                    
                                    Cheers,
                                    Andrea
                                    TestPDFToExcel.xlsm</pre>

<pre class="amctext">Very interesting.  I can duplicate your scenario and see that although the cells appear red with an Arial font, the formatting underneath is different (Times New Roman, "Automatic" - black -  font color).
                                    
                                    I've created a new updating subroutine ("F2_It") and if your select your data in column A and run this, it will actually execute the [F2] and [Enter] keystrokes on all cells in the range.  I tried to incorporate this code into the original subroutine ("Move_Select_Data") and was not able to get the code to work (still not sure why; the SendKeys command is tempermental in this regard).
                                    
                                    So, going forward you need to do the following:
                                    1) upload your PDF data into column A of the sheet
                                    2) Select the data in column A and run "F2_It" macro on it to clean up.
                                    3) Run "Move_Select_Data" macro to move.
                                    
                                    The attached workbook has the updated code.
                                    
                                    -Glenn
                                    EE-TestPDFToExcel.xlsm</pre>

<pre class="amctext">Hi Glenn,
                                    
                                    Thanks very much for the new macro.
                                    
                                    There is a line containing the following text that is causing the macro to hang up:
                                    
                                    -H.  ·-
                                    
                                    I don't know how often this particular string will recur (the PDF I will be converting  into Excel contains over 1000 pages).
                                    
                                    Any thoughts on how best to deal with this in an automated way?
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">The reason the macro is hanging up on
                                    -H.  ·-
                                    
                                    is because it begins with a hyphen, or as Excel considers it, a minus sign.  As such, Excel is trying to determine the result of the formula and, of course, there is no formula here.  Normally, Excel wouldn't even allow the existence of a cell like this, but since you're getting the data from a PDF file, I guess all bets are off.
                                    
                                    I tweaked the F2_It subroutine to change all cells to "Text" format from "General" so that this possibility will be overlooked.  The method is the same as before: Highlight the whole range in column A to update, run F2_It, then run Move_Select_Data.  Updated workbook attached.
                                    
                                    -Glenn
                                    EE-TestPDFToExcel.xlsm</pre>

<pre class="amctext">Terrific, Glenn...works perfectly!! Thank you SO much for all your help!
                                    
                                    Best,
                                    Andrea</pre>

<pre class="amctext">You're Welcome.  This was an interesting challenge.  Just wish I'd been able to combine the two subroutines (still scratching my head on that part).
                                    
                                    -Glenn</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">EE-SampleData-Results.xlsx (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w34/867928/EE-SampleData-Results.xlsx">EE-SampleData-Results.xlsx</a></p>
<p class="amcfile">macro-enabled workbook to copy selected string types (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w34/867956/EE-SampleData-Results.xlsm">EE-SampleData-Results.xlsm</a></p>
<p class="amcfile">TestPDFToExcel.xlsm (18 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w35/868719/TestPDFToExcel.xlsm">TestPDFToExcel.xlsm</a></p>
<p class="amcfile">updated subroutines (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w35/868759/EE-TestPDFToExcel.xlsm">EE-TestPDFToExcel.xlsm</a></p>
<p class="amcfile">updated code (22 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w35/869065/EE-TestPDFToExcel.xlsm">EE-TestPDFToExcel.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Find instances of specific strings in a Word file and paste them into a new document</h2>
<p class="amcdate">2015-11-27T11:28:19-0500</p>

<pre class="amctext">I would like to be able to find all instances of the following two string formats in a Word 2010 file (can be anywhere from 10 to 100 pages) and paste them into a new Word file, one string per line:
                          AAA-#### (where AAA could be any letter from A – Z, followed by a dash, then 4 numbers)
                          ####-####### (4 numbers, followed by a dash, then 7 numbers)
                          
                          Is this possible with a macro?
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Yes, it is possible.  Could you post a sample document so we don't have to make up sample information to test this? 
                                    
                                    thanks
                                    
                                    warm regards,
                                    crystal
                                    
                                    ~ have an awesome day ~</pre>

<pre class="amctext">Hi Crystal,
                                    
                                    For sure...I will be able to follow up on Monday...
                                    
                                    Andrea</pre>

<pre class="amctext">Hi,
                                    
                                    pls try
                                    
                                    
                                    Sub Macro()
    Set Activedoc = ActiveDocument
    strRes = ""
    Dim reg As Object 'VBScript_RegExp_55.regexp
    Dim Match As Object ' VBScript_RegExp_55.Match
    Dim Matches As Object 'VBScript_RegExp_55.MatchCollection

    ' instanciation
    Set reg = CreateObject("VBScript.RegExp")
    With reg
        .Global = True
        .MultiLine = True
        .Ignorecase = True
        .Pattern = "\b([A-Z]{3}-\d{4}|\d{4}-\d{7})\b"
    Set Matches = .Execute(Activedoc.Range.Text)
    End With
    For Each Match In Matches
        strRes = strRes & Match.Value & vbCrLf
    Next Match
    
    If strRes <> "" Then
        Set newDoc = Documents.Add
        newDoc.Range.Text = strRes
    Else
        MsgBox "No Matches"
    End If
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">Works beautifully. Thanks very much, Rgonzo!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Changing array formula so all cell references relative</h2>
<p class="amcdate">2014-03-05T12:27:13-0500</p>

<pre class="amctext">I am using the following array formula in BJ2 using relative references:
                          
                          =SUM(IF(ISERROR(Y2:BI2)+NOT(ISERROR(FIND((ADDRESS(ROW(Y2:BI2),COLUMN(Y2:BI2))),"AB2,AC2,AD2,BE2,BF2,BG2"))),"",Y2:BI2))
                          
                          When I copy the formula down the rest of the column, the cell references within the quotation marks are not changing and I need them to:
                          
                          "AB2,AC2,AD2,BE2,BF2,BG2"
                          
                          Can the array formula be modified so that all the cell references in the formula are relative, allowing me to copy and paste the formula down the column with references updating as required? 
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">Hi,
                                    
                                    if you only want to change the row
                                    
                                    pls try
                                    
                                    
                                    =SUM(IF(ISERROR(Y2:AE2)+NOT(ISERROR(FIND((ADDRESS(ROW(Y2:AE2),COLUMN(Y2:AE2),4)),SUBSTITUTE("AB2,AC2,AD2,BE2,BF2,BG2","2",ROW(Y2))))),"",Y2:AE2))

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">try
                                    
                                    replacing
                                    "AB2,AC2,AD2,BE2,BF2,BG2"
                                    
                                    with addresses formula
                                    "AB"&ROW()&",AC"&ROW()&",AD"&ROW()&",BE"&ROW()&",BF"&ROW()&",BG"&ROW()&""
                                    
                                    should handle copying down a column</pre>

<pre class="amctext">Rgonzo, when trying your solution all the column totals disappeared. Steveo, in trying your solution the columns that were to be excluded from the final total were being included. 
                                    
                                    Just to summarize the goal of the formula, in case that makes things a little clearer:
                                    
                                    Column BJ = Sum of numbers only from Y to BI, excluding AB, AC, AD, BE, BF & BG (the excluded columns have numbers in them but they should not be counted)
                                    
                                    Thanks,
                                    Andrae</pre>

<pre class="amctext">Rgonzo, just to add that when using your formula, when I copied and pasted it down several rows the following cell references did not change:
                                    
                                    "AB2,AC2,AD2,BE2,BF2,BG2"
                                    
                                    So for instance, for row 3 the above references should change to:
                                    
                                    "AB3,AC3,AD3,BE3,BF3,BG3"
                                    
                                    All the other cell references worked as they should, as they did in the original formula I posted.
                                    
                                    Hope that helps...
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">Formula is 'deep' w/o building a sheet to debug...
                                    
                                    the Sum function is using an If statement? It seems that an a 'false' IF statement in SUM statement will generate the Y2:BI2 address range which would include columns you don't want. 
                                    
                                    I must ask... if you manually copy / change a couple of rows using your text (manual) method does tallying give you results you expect?
                                    
                                    I extracted only the portion of the formula that needed work for relative referencing as your question asked... 
                                    
                                    I feel both solutions offered should be giving your the relative addressing you are looking for... 
                                    
                                    I am wondering about formula?  
                                    
                                    Please confirm you have verified formula to be giving you what you expect - if manually entered?</pre>

<pre class="amctext">Hello Andrea,
                                    
                                    as written your formula isn't excluding those cells because the ADDRESS function is returning addresses like $AB$2 so those don't match the exclusion list because of the $ signs.
                                    
                                    To fix that you need to include a 4 as final argument in the ADDRESS function as per Rgonzo's reply, i.e.
                                    
                                    =SUM(IF(ISERROR(Y2:BI2)+NOT(ISERROR(FIND((ADDRESS(ROW(Y2:BI2),COLUMN(Y2:BI2),4)),"AB2,AC2,AD2,BE2,BF2,BG2"))),"",Y2:BI2))
                                    
                                    but assuming you have no errors in those cells you can get the same result with simple SUM functions like this:
                                    
                                    =SUM(Y2:BI2)-SUM(AB2:AD2)-SUM(BE2:BG2)
                                    
                                    that can be copied down so that the references change. If you might have errors in those cell ranges try this version
                                    
                                    =SUMIF(Y2:BI2,"<9.99E+307")-SUMIF(AB2:AD2,"<9.99E+307")-SUMIF(BE2:BG2,"<9.99E+307")
                                    
                                    regards, barry</pre>

<pre class="amctext">I've attached a sample spreadsheet with an example of my original working array formula to demontrate what is happening. The formula in the spreadsheet is as follows:
                                    
                                    {=SUM(IF(ISERROR(Y2:BI2)+NOT(ISERROR(FIND((ADDRESS(ROW(Y2:BI2),COLUMN(Y2:BI2))),"$AV$2,$AY$2,$BB$2"))),"",Y2:BI2))}
                                    
                                    With the above formula, I get the correct answer of "58" in BJ2, but in BJ3, I get the wrong answer of "88" as in that row, as the array formula is not excluding AV3, AY3 or BB3.
                                    
                                    I need the following:
                                    The formula to work in all rows in the BJ column, not just in the first row
                                    The excluded columns to be changed from the original "AV, AY, BB" to "AB,AC,AD,BE,BF,BG" (for all rows)
                                    
                                    I have tried both solutions offered again, and did not find that they worked for me. Thanks for your patience...hopefully the sample spreadsheet will illustrate the issue more clearly...
                                    
                                    Thanks,
                                    Andrea
                                    Array-excludesCells.xlsm</pre>

<pre class="amctext">Hi Barry,
                                    
                                    I saw your comment right after I posted my sample file. I tried the first formula in your post based on Rgonzo's formula, and while it worked for BJ2, when I copied and pasted the formula down the column it did not work for the subsequent rows. Since I might have errors in the cells, I then tried your last formula, and it worked perfectly, both in BJ2 and in the subsequent rows after I copied the formula down the BJ2 column. Thanks very much!!
                                    
                                     BTW, I want to be fair on points distribution here. From my vantage point, the formula that worked for me was the last one supplied, but I'm not an expert and want to make sure I'm not overlooking the usability of the other solutions provided...
                                    
                                    Please advise....thanks again!
                                    Andrea</pre>

<pre class="amctext">Thanks Andrea - the formula in your question won't work as intended, it will sum all the values in Y2:BI2, for the reasons I gave in my answer above.
                                    
                                    The first formula I suggested fixes that problem but doesn't fix the dragging down issue, hence my other suggestions.
                                    
                                    Objectively I'd say that's the best approach, because of its simplicity, so you should accept my answer!
                                    
                                    However I think that the approaches suggested by both Rgonzo1971 and Steveo are also valid. Rgonzo's didn't work for you because the ranges were wrong, all references to Y2:AE2 should be Y2:BI2. Rgonzo also fixed the ADDRESS function problem by adding 4 as 3rd parameter.
                                    
                                    Steve's suggestion didn't work because of the flaw in your initial formula - fix that and it works OK too
                                    
                                    .......so I would suggest you also award points to both of those experts, the exact split is up to you (and feel free to ignore my advice if you wish!)
                                    
                                    regards, barry</pre>

<pre class="amctext">Many aspects of this question and it's final resolution...
                                    
                                    I agree w/ Barry splitting (somehow) seems fairest...
                                    
                                    bottom line... is you should have information to resolve your initial problems.
                                    
                                    Congrats and happy coding...</pre>

<pre class="amctext">Thanks, Barry, for your explanation on the problem with my original formula and the impact of that on potential solutions, as well as the guidance on awarding points, and last but not least, your elegant solution! And thanks, Rgonzo, for your generous note and solution, and to Steveo for your solution too.
                                    
                                    I'm very pleased...
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of array formula (291 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/03_w10/838374/Array-excludesCells.xlsm">Array-excludesCells.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Modifying DATEDIF formula if Column A is blank</h2>
<p class="amcdate">2014-03-25T12:36:57-0400</p>

<pre class="amctext">I am using the following DATEDIF formula to get the number of days in Column D:
                          
                          =IFERROR(DATEDIF(B2,C2,"D"),"")
                          
                          But sometimes there are blank cells in Column A and so it's causing errors in my calculations for those rows (1000's of days).
                          
                          I'd like to be able to modify the above formula to include:
                          
                          If A2 is blank, then D2 to be blank as well.
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Try
                                    
                                    =IF(A2="","",ERROR(DATEDIF(B2,C2,"D"),""))
                                    
                                    Thomas</pre>

<pre class="amctext">Hi Thomas,
                                    
                                    I'm getting an error message that highlights the word "ERROR" in the formula and says "that function not valid"...
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">My bad, should be iferror
                                    
                                    =IF(A2="","",IFERROR(DATEDIF(B2,C2,"D"),""))</pre>

<pre class="amctext">Change to IFERROR
                                    
                                    
                                    Thanks</pre>

<pre class="amctext">That did the trick...thanks very much!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Cleaning up variations on a specific string to make it consistent throughout a large worksheet</h2>
<p class="amcdate">2014-08-20T17:17:29-0400</p>

<pre class="amctext">I need to clean up the placement of a specific 4-character acronym ("XXXX") in a large spreadsheet. Specifically, all instances of "XXXX" that occur at the beginning of a string only need to be moved to the last place in the string, preceded by a single space, and any extra spaces, dashes remaining at the beginning of the string after "XXXX" is moved is to be removed so that the row starts with the first complete word in that row. Any instances of "XXXX" that occur in any other position in the string except at the beginning are to be ignored.
                          
                          Various examples of current format (does not include all possibilities):
                          1. XXXX - CITY TYPE
                          2. XXXX_CITY
                          3. XXXX-CITY-TYPE PROCEDURE HERE
                          
                          Desired results:
                          1. CITY TYPE XXXX
                          2. CITY XXXX
                          3. CITY-TYPE PROCEDURE HERE XXXX
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Hi,
                                    
                                    Does this work for you?
                                    
                                    
                                    Sub CleanUpCity()
    Dim MySheet As Worksheet
    Dim iRow As Long, lastRow As Long, iCol As Long, lastCol As Long
    Dim strCity As String
    
    Set MySheet = Worksheets("YourWorksheetName")
    
    lastRow = MySheet.Range("A1").CurrentRegion.Rows.Count
    lastCol = MySheet.Range("A1").CurrentRegion.Columns.Count
    
    For iRow = 1 To lastRow
        For iCol = 1 To lastCol
            strCity = MySheet.Cells(iRow, iCol).Value
            If Left(strCity, 4) = "XXXX" Then
                strCity = Trim(Right(strCity, Len(strCity) - 4))
                If Left(strCity, 1) = "-" Or Left(strCity, 1) = "_" Then
                    strCity = Trim(Right(strCity, Len(strCity) - 1))
                End If
            End If
            MySheet.Cells(iRow, iCol).Value = strCity & " XXXX"
        Next iCol
    Next iRow
    
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Andrew,
                                    
                                    I tried the code and it appeared to add "XXXX" at the end of every row in the spreadsheet, regardless of whether the row contained XXXX or not.
                                    
                                    Andrea</pre>

<pre class="amctext">Sorry Andrea, I've moved the XXXX add to the If statement where it belongs.
                                    
                                    
                                    Sub CleanUpCity()
    Dim MySheet As Worksheet
    Dim iRow As Long, lastRow As Long, iCol As Long, lastCol As Long
    Dim strCity As String
    
    Set MySheet = Worksheets("YourWorksheetName")
    
    lastRow = MySheet.Range("A1").CurrentRegion.Rows.Count
    lastCol = MySheet.Range("A1").CurrentRegion.Columns.Count
    
    For iRow = 1 To lastRow
        For iCol = 1 To lastCol
            strCity = MySheet.Cells(iRow, iCol).Value
            If Left(strCity, 4) = "XXXX" Then
                strCity = Trim(Right(strCity, Len(strCity) - 4))
                If Left(strCity, 1) = "-" Or Left(strCity, 1) = "_" Then
                    strCity = Trim(Right(strCity, Len(strCity) - 1)) & "XXXX"
                End If
            End If
            MySheet.Cells(iRow, iCol).Value = strCity
        Next iCol
    Next iRow
    
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Oh, you will need to add a space in front: " XXXX".  Sorry, I'm my phone and can't edit my comments.
                                    
                                    Again, I apologize for the mix up on the original code.</pre>

<pre class="amctext">Thanks for the quick response, Andrew. I updated the code, including adding the space, and I am getting a "Type mismatch" error when I try and run the macro...
                                    
                                    Andrea</pre>

<pre class="amctext">Sorry about that, my phone isn't very condusive to editing code:
                                    
                                    Try this:
                                    
                                    Sub CleanUpCity()
    Dim MySheet As Worksheet
    Dim iRow As Long, lastRow As Long, iCol As Long, lastCol As Long
    Dim strCity As String
    
    Set MySheet = Worksheets("YourWorksheetName")
    
    lastRow = MySheet.Range("A1").CurrentRegion.Rows.Count
    lastCol = MySheet.Range("A1").CurrentRegion.Columns.Count
    
    For iRow = 1 To lastRow
        For iCol = 1 To lastCol
            strCity = MySheet.Cells(iRow, iCol).Value
            If Left(strCity, 4) = "XXXX" Then
                strCity = Trim(Right(strCity, Len(strCity) - 4))
                If Left(strCity, 1) = "-" Or Left(strCity, 1) = "_" Then
                    strCity = Trim(Right(strCity, Len(strCity) - 1))
                End If
                 strCity=strCity & "XXXX"
            End If
            MySheet.Cells(iRow, iCol).Value = strCity
        Next iCol
    Next iRow
    
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Andrew,
                                    
                                    I seem to still be getting "Type mismatch" with the latest code...
                                    
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    I just tested on my machine using sample data and it ran through fine. Can you hit Debug and see if it is hitting the error on a specific cell value?</pre>

<pre class="amctext">Hi Andrew,
                                    
                                    Thanks for this direction. I found 3 lines in my spreadsheet that has "#NAME?" so removed them and the macro ran. :-)
                                    
                                    The macro is almost perfect...it just needs a couple of tweaks. I've noted the cross-section of results that have issues below:
                                    
                                    Current macro's results:
                                    1. CITY TYPEXXXX (needs a space before "XXXX")
                                    2. .XXXX (there's a period before "XXXX"; should be no punctuation before "XXXX")
                                    3. CITYXXXX (same issue as #1)
                                    4. CITY-TYPE PROCEDURE HEREXXXX (same issue as #1)
                                    
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    These should all be able to be fixed by adding a space to the "XXXX" string in line 19 of the sample code.
                                    
                                    
                                    strCity = strCity & " XXXX"

                                    
                                      Select all
                                      Open in new window
                                    
                                    Specifically on #2 - do you want the period to remain, just not directly in front of the acronym? (i.e. CITY. XXXX).  If so, then the above will fix that.
                                    
                                    or would you rather have it completely removed? (i.e. CITY XXXX).  If not, let me know, and we should be able to make some adjustments.</pre>

<pre class="amctext">Thanks for the fix on how to add a space. On # 2, I would like the period completely removed if possible. 
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    I've added code to catch any NON-LETTER at the end of your string (prior to re-adding XXXX to the end).  This will take care of any punctuation, including periods.
                                    
                                    I've also added comments to the code to help explain what each line is doing.
                                    
                                    
                                    Sub CleanUpCity()
    Dim MySheet As Worksheet
    Dim iRow As Long, lastRow As Long, iCol As Long, lastCol As Long
    Dim blnStopLoop As Boolean
    Dim strCity As String
    
    Set MySheet = Worksheets("YourWorksheetName") 'Assign worksheet to the Worksheet Object MySheet
    
    lastRow = MySheet.Range("A1").CurrentRegion.Rows.Count 'Gets last row of data
    lastCol = MySheet.Range("A1").CurrentRegion.Columns.Count 'Gets last column of data
    
    For iRow = 1 To lastRow 'Starts a loop to cycle through every row of data
        For iCol = 1 To lastCol 'Starts a loop to cycle through every column of data (NOTE: since this is inside of the row loop, it will run for every row)
            strCity = MySheet.Cells(iRow, iCol).Value 'Makes strCity = the current cell value
            If Left(strCity, 4) = "XXXX" Then 'Checks for "XXXX" at the start of the value - if not then the it repastes the value and moves to the next column in the loop
                strCity = Trim(Right(strCity, Len(strCity) - 4)) 'Trim removes leading and following spaces - the right function gets everything to the right of the first 4 characters (XXXX)
                If Left(strCity, 1) = "-" Or Left(strCity, 1) = "_" Then 'Checks for hyphon and underscore at beginning of new string value (witout the XXXX)
                    strCity = Trim(Right(strCity, Len(strCity) - 1)) 'removes the hyphon or underscore if found
                End If
                
                blnStopLoop = False 'Boolean variable for ending the below Do Loop if entered
                
                If Not strCity = "" Then 'Checks if strCity is empty from previous Trims and removals
                    If Asc(Right(strCity, 1)) >= 65 And Asc(Right(strCity, 1)) <= 90 Then blnStopLoop = True 'If the last character of strCity is a lower case letter then loopStop is True
                    If Asc(Right(strCity, 1)) >= 97 And Asc(Right(strCity, 1)) <= 122 Then blnStopLoop = True 'If the last character of strCity is a upper case letter then loopStop is True
                Else
                    blnStopLoop = True 'If strCity is empty then loopStop is True
                End If
                
                Do Until blnStopLoop = True
                    strCity = Trim(Left(strCity, Len(strCity) - 1)) 'removes last character of strCity (previous checks for a letter as the last character failed
                    If Not strCity = "" Then
                        If Asc(Right(strCity, 1)) >= 65 And Asc(Right(strCity, 1)) <= 90 Then blnStopLoop = True 'If the last character of strCity is a lower case letter then loopStop is True
                        If Asc(Right(strCity, 1)) >= 97 And Asc(Right(strCity, 1)) <= 122 Then blnStopLoop = True 'If the last character of strCity is a upper case letter then loopStop is True
                    End If
                Loop
                
                 strCity = Trim(strCity & " XXXX") 'adds " XXXX" to the end of strCity
            End If
            MySheet.Cells(iRow, iCol).Value = strCity 'Makes the current cell = strCity
        Next iCol 'goes to next column in loop
    Next iRow 'goes to next row in loop
    
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    Let me know if you have any more questions.
                                    
                                    Thanks,
                                    
                                    Andrew</pre>

<pre class="amctext">Hi Andrew,
                                    
                                    Thanks for taking the time to add explanatory notes...much appreciated! I tried running the macro and unfortunately I am receiving the following error:
                                    
                                    Run-time error '5':
                                    Invalid procedure call or argument
                                    
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Can you hit debug and tell me what line is giving the error and what the cell value is?
                                    It ran fine during testing yesterday with sample data.</pre>

<pre class="amctext">Hi Andrew,
                                    
                                    I've created a sample spreadsheet and inserted the latest macro code, as I thought that might be easier for troubleshooting. With this sample spreadsheet when I click on the macro, it doesn't appear to run. I tried inserting the code in the worksheet, and as a module with the same outcome.
                                    
                                    Thanks in advance for your assistance on this!
                                    
                                    Cheers,
                                    Andrea
                                    EE-Sample-XXXXMacro.xlsm</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Looks like we needed an empty string handler inside of the loop (Line 36 of the code).  Also, I did notice the sample sheet you provided me had empty rows (24-28).  This might be you removing data that was proprietary, but I did want to caution that the "CurrentRegion" properties used in Lines 9 & 10 to get last row and column rely on continuous set of data.  Similar to clicking in Cell A1 and doing a Select All.
                                    
                                    Let me know if I can help any further.  :)
                                    
                                    Andrew
                                    
                                    
                                    Sub CleanUpCity()
    Dim MySheet As Worksheet
    Dim iRow As Long, lastRow As Long, iCol As Long, lastCol As Long
    Dim blnStopLoop As Boolean
    Dim strCity As String
    
    Set MySheet = Worksheets("CityData") 'Assign worksheet to the Worksheet Object MySheet
    
    lastRow = MySheet.Range("A1").CurrentRegion.Rows.Count 'Gets last row of data
    lastCol = MySheet.Range("A1").CurrentRegion.Columns.Count 'Gets last column of data
    
    For iRow = 1 To lastRow 'Starts a loop to cycle through every row of data
        For iCol = 1 To lastCol 'Starts a loop to cycle through every column of data (NOTE: since this is inside of the row loop, it will run for every row)
            strCity = MySheet.Cells(iRow, iCol).Value 'Makes strCity = the current cell value
            If Left(strCity, 4) = "XXXX" Then 'Checks for "XXXX" at the start of the value - if not then the it repastes the value and moves to the next column in the loop
                strCity = Trim(Right(strCity, Len(strCity) - 4)) 'Trim removes leading and following spaces - the right function gets everything to the right of the first 4 characters (XXXX)
                If Left(strCity, 1) = "-" Or Left(strCity, 1) = "_" Then 'Checks for hyphon and underscore at beginning of new string value (witout the XXXX)
                    strCity = Trim(Right(strCity, Len(strCity) - 1)) 'removes the hyphon or underscore if found
                End If
                
                blnStopLoop = False 'Boolean variable for ending the below Do Loop if entered
                
                If Not strCity = "" Then 'Checks if strCity is empty from previous Trims and removals
                    If Asc(Right(strCity, 1)) >= 65 And Asc(Right(strCity, 1)) <= 90 Then blnStopLoop = True 'If the last character of strCity is a lower case letter then loopStop is True
                    If Asc(Right(strCity, 1)) >= 97 And Asc(Right(strCity, 1)) <= 122 Then blnStopLoop = True 'If the last character of strCity is a upper case letter then loopStop is True
                Else
                    blnStopLoop = True 'If strCity is empty then loopStop is True
                End If
                
                Do Until blnStopLoop = True
                    strCity = Trim(Left(strCity, Len(strCity) - 1)) 'removes last character of strCity (previous checks for a letter as the last character failed
                    If Not strCity = "" Then
                        If Asc(Right(strCity, 1)) >= 65 And Asc(Right(strCity, 1)) <= 90 Then blnStopLoop = True 'If the last character of strCity is a lower case letter then loopStop is True
                        If Asc(Right(strCity, 1)) >= 97 And Asc(Right(strCity, 1)) <= 122 Then blnStopLoop = True 'If the last character of strCity is a upper case letter then loopStop is True
                    Else
                        blnStopLoop = True 'If strCity is empty (following start of loop), loopStop is True
                    End If
                Loop
                
                 strCity = Trim(strCity & " XXXX") 'adds " XXXX" to the end of strCity
            End If
            MySheet.Cells(iRow, iCol).Value = strCity 'Makes the current cell = strCity
        Next iCol 'goes to next column in loop
    Next iRow 'goes to next row in loop
    
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Excellent! Works perfectly. And I'll make sure there are no blank rows.
                                    
                                    Thanks very much for your patience and tenacity, Andrew...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">no problem Andrea - glad i could help! :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">EE-Sample-XXXXMacro.xlsm (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2014/08_w34/868091/EE-Sample-XXXXMacro.xlsm">EE-Sample-XXXXMacro.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Change font color in columns A, B, & C based on first instance of text in column E</h2>
<p class="amcdate">2013-10-23T16:10:29-0400</p>

<pre class="amctext">I have a list of inventory items. I would like to find out the most efficient way to trigger a font color change (to blue) of the text in columns A, B & C based on every first instance of a phrase in column E. I've attached a sample file called "Changing font color.xlsx" to help illustrate what I'm looking for.
                          Thanks,
                          Andrea
                          Changing-font-color.xlsx</pre>

<pre class="amctext">Select A2:C16 and invoke Conditional Formatting from Home tab.
                                    
                                    Then select New Rule, and then 'use a formula to determine which cells to format"
                                    
                                    enter formula:
                                    
                                    =$E2<>$E1
                                    
                                    click format and choose from Font tab.</pre>

<pre class="amctext">Works perfectly...and many thanks for the quick response!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of results I am looking for (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/10_w43/684331/Changing-font-color.xlsx">Changing-font-color.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Finding correct regular expression to batch rename 130 files</h2>
<p class="amcdate">2017-12-16T11:58:34-0500</p>

<pre class="amctext">I am using Adobe Bridge to batch rename 130 files in a folder. It can handle regular expressions, so I am looking for the correct expression to achieve the following:
                          
                          Original filename formats:
                          127155aaaa_58_Road to Cottage Lake Black.jpg
                          001000_Cottage Map.jpg
                          
                          Description of revised filename:
                          Starting from left of entire filename -- Retain first 3 numbers of original filename
                          Starting from the left of '.jpg' file extension -- retain all text and spaces to left, up to and including the first instance of "_"
                          Retain ".jpg" file extension
                          
                          Desired filename after batch renaming:
                          127_Road to Cottage Lake Black.jpg
                          001_Cottage Map.jpg
                          
                          I hope I've provided enough details.
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">This is a fairly complex regular expression.
                                    
                                    Easy to do in PERL.
                                    
                                    In Adobe... Whew... Likely best to rename each file with a set of regular expressions, each rename pruning cruft, till only your desired text remains in each file.
                                    
                                    Complex.
                                    
                                    I'd personally use PERL + have it work the first time.</pre>

<pre class="amctext">I have no idea what Regex engine uses Adobe Bridge.
                                    
                                    This *should* work:
                                    
                                    Search: 
(\d{3})(.*_)(.*\.jpg)

Replace: 
$1_$3

                                    
                                      Select all
                                      Open in new window
                                    
                                    HTH,
                                    Dan</pre>

<pre class="amctext">For some reason my comment didn’t show up, so I’ll write it again...
                                    
                                    You’re solution works perfectly, Dan - thanks very much!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Remove thousands of rows in Excel 2010 & set maximum row limit in spreadsheet</h2>
<p class="amcdate">2015-09-15T15:40:45-0400</p>

<pre class="amctext">We have a spreadsheet of 3922 rows that has somehow expanded to include thousands of blank, unused rows with formulas, rendering the spreadsheet almost unusable. The active spreadsheet is from A1 to FA3922, but when I hit CTRL-END, the last cell is now FA1048576. Due to the complexity of conditional formatting, formulas, etc. I don't want to risk copying the data to a new spreadsheet. Instead, I wondered if:
                          1. Is there a macro or VBA that can be implemented to delete rows 3923 to 1048576.
                          2. Is there a way to set the maximum number of rows in a spreadsheet to 5000?
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">Andrea,
                                    The number of rows in a spreadsheet is fixed by Microsoft. With the .xlsx file format, there will be 1,048,576 rows. With the previous .xls file format, there are 65,536 rows.
                                    
                                    If you want to delete rows 3923 and beyond, you might use code like:
                                    
                                    Sub DeleteMe()
Range(Cells(3923,1), Cells(Rows.Count, 1)).EntireRow.Delete
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks for the quick response. I tried the macro, and after a couple of minutes got a message saying 'Excel cannot complete this task with available resources...'. Any suggestions on how to best break down the task?
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">You could try modifying byundt's code to do it in blocks. (Untested)
                                    
                                    
                                    Sub DeleteMe()
Cont ROWS = 53000
Dim lngCnt As Long
For lngCnt = 1 To 20
    Range(Cells(3923,1), Cells(ROWS, 1)).EntireRow.Delete
Next
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Andrea,
                                    
                                    Martin Liss' code ought to address the problem with insufficient resources. If it does not, we really need to see your actual workbook, so we can test our code on your real problem. 
                                    
                                    Is it possible to post your workbook?
                                    
                                    Brad</pre>

<pre class="amctext">You may also like to try switching the MS-Excel Application (Workbook) Calculation Mode to 'Manual' before starting the deletion, & then reverting to 'Automatic' (if that was the previous setting) when the deletion has completed, as this will speed up the removal of the rows considerably.
                                    
                                    This may also help with the lack of resources with the code provided by Brad or, indeed, simply deleting the rows manually (as you attempted initially).</pre>

<pre class="amctext">Another thing you might try is saving the file as .xls. Those files have only 65,536 rows.
                                    
                                    If the save to .xls format succeeds, you would then relaunch Excel, open the .xls file and save it as .xlsx (or .xlsm). You may then be able to delete the extra rows of formulas without getting a lack of resources warning message.</pre>

<pre class="amctext">^ Plus saving in Excel Binary workbook (*.xlsb) format may* reduce the overall size of the file &, as a consequence, the amount of resources (Random Access Memory [RAM]) required to process the deletion of the rows.
                                    
                                    * In some cases, saving in ".xlsb" format could increase the size of the workbook so always make a copy of the workbook (& store separately) so that if you re-save in a different format you can return to the previously saved format, if desired.</pre>

<pre class="amctext">Thanks for all your suggestions (sorry not to have responded sooner, but I've been away).
                                    
                                    I tried Martin Liss' formula, but got an error message as follows: "Compile error: Sub or function not defined", and in the macro, the word "Rows' in line 2 is highlighted.
                                    
                                    I tried changing the formula calculation mode from automatic to manual, but it did not resolve it.
                                    
                                    I also tried saving as an .xls, but it still did not have the resources to delete to rows 65,536.
                                    
                                    I'm hoping that Martin's formula could be a solution once the compile error can be resolved...
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">I also tried saving as an .xls, but it still did not have the resources to delete to rows 65,536.
                                    
                                    
                                    How about Excel Binary workbook (*.xlsb) format; did you look at that?</pre>

<pre class="amctext">Andrea,
                                    There was a typo in line 2 of Martin Liss' code. It should have been Const rather than Cont.
                                    
                                    Since saving as .xls didn't work, you may need to delete smaller blocks of code. I modified his code accordingly:
                                    
                                    Sub DeleteMe()
Const Rows = 3000      'If not enough resources, try a smaller number
Dim lngCnt As Long, n As Long
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual
n = (ActiveSheet.Rows.Count - 3923) / Rows + 1
For lngCnt = 1 To n
    Range(Cells(3923, 1), Cells(3923 + Rows, 1)).EntireRow.Delete
Next
Application.Calculation = xlCalculationAutomatic
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks, byundt, the revised macro worked!
                                    
                                    Fanpages, I tried saving as a binary workbook and it didn't reduce the file size or resolve the resources issue, unfortunately.
                                    
                                    Thanks again to everyone for their contributions. :-)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Revise current Excel lookup formula to change source of lookup based on whether a specific column contains a date or not</h2>
<p class="amcdate">2018-10-08T13:10:50-0400</p>

<pre class="amctext">I am currently using the following LOOKUP formula in spreadsheet EE_Pub (columns N, O and P) to find 'last match' values in spreadsheet EE_Cat (columns J, K and L), unless the value in column K of EE_Cat spreadsheet = "No Change" or "CX'd" in which case it ignores these rows.
                          
                          =IFERROR(LOOKUP(2,1/('C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$I$2:$I$1200=$M2)/('C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$K$2:$K$1200<>"CX'd")/('C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$K$2:$K$1200<>"No Change"),'C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$J$2:$J$1200),"")
                          
                          I need to update the lookup formula to incorporate additional conditions:
                          
                          If Column L of EE_Cat spreadsheet (Stage_4) column is blank, use the current lookup formula that finds last match:
                          
                          =IFERROR(LOOKUP(2,1/('C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$I$2:$I$1200=$M2)/('C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$K$2:$K$1200<>"CX'd")/('C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$K$2:$K$1200<>"No Change"),'C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$J$2:$J$1200),"")
                          
                          If Column L of EE_Cat spreadsheet (Stage_4) column contains a date, then lookup formula needs to change from last match, to row that has the latest date in EE_Cat spreadsheet (Stage_4) column (based on Column M value in EE_Pub-Test spreadsheet as per the current lookup formula).
                          
                          Note that Column L is always formatted as: AA–08 Jan 16  13:02
                          
                          I have provided the two sample spreadsheets. I have highlighted the cells and included comments on the EE_Pub spreadsheet containing the results I am looking for with the updated formula.
                          
                          I hope I have provided sufficient information, and that it is clear enough...
                          
                          Thanks!
                          Andrea
                          EE_Cat.xlsx
                          EE_Pub-Test.xlsx</pre>

<pre class="amctext">Try this
                                    Formulas in columns R, S and T.
                                    It is array formulas.
                                    EE_Pub-Test.xlsx</pre>

<pre class="amctext">Hi Ejgil,
                                    
                                    Thanks very much for providing this solution. All the results in columns R, S and T looked good except, for some reason, in Row 8. I've added comments to the specific cells in Row 8 showing the desired result (as attached).
                                    
                                    BTW, can array formulas work in linked workbooks that are also shared? I know that shared spreadsheets are not recommended by this forum for good reason, and I apologize for this, but unfortunately our corporate environment use them (and I am not high enough up the food chain to change that policy). That being said, if the result in Row 8 is resolved using the array formulas you have provided, then I feel I should proceed to accept it as the solution for this question even if I can't use it, since I forgot to mention the shared, linked workbooks in my original question. If you can let me know if there is another solution that doesn't use array formulas, then I can post that as a separate question.
                                    
                                    I look forward to your feedback...
                                    
                                    Thanks,
                                    Andrea
                                    EE_Pub-Test_Solution.xlsx</pre>

<pre class="amctext">I don't know what the problem is with the values.
                                    On open the workbook show  this in row 8 "Unique_7 | CLR |CF–21 Dec 15  13:46"
                                    Changing links to the "EE-Cat.xlsx" file,  the values change to "Unique_89 |CLR | CF–06 Jan 16  13:02"
                                    That is the correct result.
                                    Do you link to another file?
                                    The file is not opened, so the array formulas work as link to the closed workbook.
                                    
                                    I have never used a shared workbook, so don't know how it will work.
                                    You have to try.
                                    
                                    The array formulas are because the dates are found in a text with the Datevalue formula, and that lead to error if the argument is not a datevalue.
                                    And blank cells are not a datevalue, so with If and Iserror statements errors are set to 0, and that require array formulas.
                                    If the values in column L in Cat file was real dates, the formula can be normal.
                                    See attached where the dates are in column M in Cat file, and the normal formula in column U in Pub file.
                                    The search is done on column M, but the results are from column L.
                                    
                                    Save both files in the same folder before opening, then the links should work.
                                    EE_Pub-Test_Solution-A.xlsx
                                    EE_Cat-A.xlsx</pre>

<pre class="amctext">Thanks very much, Ejgil, for your very helpful, detailed explanation, plus providing an alternative solution if the array formula isn't an option with a shared, linked spreadsheet...much appreciated!
                                    
                                    I will have my first opportunity tomorrow to go over your answer/Excel files in detail so I can respond...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Source file (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/10_w41/1391575/EE_Cat.xlsx">EE_Cat.xlsx</a></p>
<p class="amcfile">File with links to EE_Cat file (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/10_w41/1391576/EE_Pub-Test.xlsx">EE_Pub-Test.xlsx</a></p>
<p class="amcfile">Formulas (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/10_w41/1392026/EE_Pub-Test.xlsx">EE_Pub-Test.xlsx</a></p>
<p class="amcfile">Solution reviewed and comments added (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/10_w41/1392093/EE_Pub-Test_Solution.xlsx">EE_Pub-Test_Solution.xlsx</a></p>
<p class="amcfile">Normal formula (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/10_w41/1392339/EE_Pub-Test_Solution-A.xlsx">EE_Pub-Test_Solution-A.xlsx</a></p>
<p class="amcfile">Real dates (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/10_w41/1392340/EE_Cat-A.xlsx">EE_Cat-A.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Summing multiple columns into a 'Total Minutes' column based on two text string criteria</h2>
<p class="amcdate">2017-07-29T08:12:53-0400</p>

<pre class="amctext">I need to add a summary column in a spreadsheet called "Linked", summing minutes from multiple columns with the following criteria:
                          If [WO_Change] column does not contain text string "Cancelled" or "Deferred", then in [Total_Minutes] column, sum minutes from [Minutes], [Minutes2] and [Minutes3]: otherwise, [Total_Minutes] column to be blank.
                          
                          In attempting to solve this I came up with the following formula in the [Total_Minutes] column, but got some whacky results:
                          
                          =SUM(SUMIF([WO_Change],{"<>*Cancelled*","<>*Deferred*"},([@Minutes]:[@Minutes3])))
                          
                          I  have attached a sample spreadsheet with the "Linked" tab as outlined above.
                          
                          Thanks,
                          Andrea
                          Sum_if_or_EE.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try below  in H2
                                    
                                    =IF(OR(ISNUMBER(SEARCH("*Cancelled",[@[WO_Change]])),ISNUMBER(SEARCH("*Deferred*",[@[WO_Change]]))),"",SUM([@Minutes]+[@Minutes2]+[@Minutes3]))

                                    
                                      Select all
                                      Open in new window
                                    Andrea_Sum_if_or_EE.xlsx</pre>

<pre class="amctext">Terrific! Thanks again, Shums - much appreciated!</pre>

<pre class="amctext">You're Welcome again Andrea! Its always a pleasure to help you :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of spreadsheet plus attempted solution (13 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w30/1184631/Sum_if_or_EE.xlsx">Sum_if_or_EE.xlsx</a></p>
<p class="amcfile">SumIF (13 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w30/1184636/Andrea_Sum_if_or_EE.xlsx">Andrea_Sum_if_or_EE.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Revising a LOOKUP formula finding last match to ignore rows where criteria not met</h2>
<p class="amcdate">2016-02-29T10:58:07-0500</p>

<pre class="amctext">I am using the following LOOKUP formula in spreadsheet EE_Pub (columns N, O and P) to find 'last match' values in spreadsheet EE_Cat (columns J, K and L):
                          =IFERROR(LOOKUP(2,1/([EE_Cat.xlsx]Sheet1!$I$2:$I$1200=$M2),[EE_Cat.xlsx]Sheet1!$J$2:$J$1200),"")
                          
                          I need to refine this formula so that it ignores all rows where column K in EE_Cat spreadsheet = NO CHANGE.
                          
                          I have provided the two sample spreadsheets. I have highlighted the cell and included a comment on the EE_Pub spreadsheet containing the result I am looking for with the updated formula.
                          
                          I hope I have provided sufficient information, and that it is clear enough...
                          
                          Thanks!
                          Andrea
                          EE_Cat.xlsx
                          EE_Pub.xlsx</pre>

<pre class="amctext">I got following message when I tried to download your files.
                                    
                                    
                                      
                                      
                                      Not Found The page you're looking for cannot be found
                                      404
                                      
                                      Whoops-we couldn't find the page you were looking for. Try checking the URL for errors and refreshing the page. If that doesn't work, contact us and we'll help you as best as we can.</pre>

<pre class="amctext">apparently any attachment in the EE does not work.  similar problem in all posts.</pre>

<pre class="amctext">Hope tech team is aware of this issue.</pre>

<pre class="amctext">Thanks for letting me know about this issue. EE suggested that I try using Dropbox instead while they work to resolve the problem. 
                                    
                                    Here is the link to a folder called Experts Exchange in my Dropbox containing both files (EE_Pub.xlsx; EE_Cat.xlsx):
                                    
                                    https://www.dropbox.com/sh/t7itc1ew4432c2h/AAAKIf_kLxyk-K2kd7CtJ9REa?dl=0
                                    
                                    I hope this works...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">here you go.
                                    
                                    in the workbook EE pub Sheet1
                                    
                                    N2  PUT AND DRAG DOWN =IFERROR(LOOKUP(2,1/([EE_Cat.xlsx]Sheet1!$I$2:$I$1200=$M2)/([EE_Cat.xlsx]Sheet1!$K$2:$K$1200<>"No Change"),[EE_Cat.xlsx]Sheet1!$J$2:$J$1200),"")
                                    
                                    O2 PUT AND DRAG DOWN =IFERROR(LOOKUP(2,1/([EE_Cat.xlsx]Sheet1!$I$2:$I$1200=$M2)/([EE_Cat.xlsx]Sheet1!$K$2:$K$1200<>"No Change"),[EE_Cat.xlsx]Sheet1!$K$2:$K$1200),"")
                                    
                                    
                                    P2 PUT AND DRAG DOWN  =IFERROR(LOOKUP(2,1/([EE_Cat.xlsx]Sheet1!$I$2:$I$1200=$M2)/([EE_Cat.xlsx]Sheet1!$K$2:$K$1200<>"No Change"),[EE_Cat.xlsx]Sheet1!$L$2:$L$1200),"")</pre>

<pre class="amctext">Terrific! Thanks so much, Professor JimJam... :-)</pre>

<pre class="amctext">You are welcome :-)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample 1 of 2 files (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/02_w10/1083927/EE_Cat.xlsx">EE_Cat.xlsx</a></p>
<p class="amcfile">Sample 2 of 2 files (14 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/02_w10/1083928/EE_Pub.xlsx">EE_Pub.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Copying partial row in Excel to new sheet automatically when 2 specific conditions are met</h2>
<p class="amcdate">2013-09-03T22:18:37-0400</p>

<pre class="amctext">I am working in Excel 2010. I would like to automate the following process: if the following 2 conditions are met within the same row, then it will automatically trigger a copy and "paste values" of part of that row into the first empty row of another sheet:
                          
                          If, in worksheet called "Worksheet 1":
                          A cell in any row in Column V: is not blank
                          A cell in the same row as above in Column X: = "Yes"
                          Then the following cells from that row are copied and pasted, as values, into same row to "Worksheet 2", mapped as follows:
                          Column V value to Column A
                          Column W value to Column B
                          Column A value to Column C
                          Column B value to Column D
                          Column L value to Column E
                          Column M value to Column F
                          
                          Further details:
                          If there are blank values in any of the cells being copied from Worksheet 1, then the cell in Worksheet 2 would also show as blank.
                          The values are to be copied over just once into Worksheet 2.
                          The process would happen automatically anytime the above two conditions are met.
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">Please try the attached.
                                    Temp.xlsm</pre>

<pre class="amctext">Have you looked at the Advanced Filter function?
                                    
                                    This allows you to specify selection criteria for a data table and it will filter the table either in place or copy the matching rows to another location. This can copy only specific columns if so required, based on the headers of the columns.
                                    
                                    If you need more information for this let us know.
                                    
                                    Thanks
                                    Rob H</pre>

<pre class="amctext">Thanks for the temp.xlsm file...it is almost working exactly as I want it to, except that the values are not being copied into the next available empty row on Worksheet 2, resulting in unwanted blank rows. So if there are 10 rows in Worksheet 1, and rows 2, 3, 5, 7, 9, and 10 meet the criteria to be copied over, these 6 rows would be copied over to rows 1 through 6 on Worksheet 2. If the code can be fixed to do that, that would be great.
                                    
                                    Thanks, Rob H, for the advanced filter suggestion. I'd like to go the VBA route for this particular situation.
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">Andrea, it would be easy to modify the program, but would you please clarify the following first?
                                    
                                    If there are 10 rows in Worksheet 1 and row 2,3,5,7,9,10 meets the criteria.
                                    1) If row 4 updates the data to meet the criteria, then where in Worksheet 2 should the row be copied to? The end or insert between 3 and 5?
                                    2) Will there be a case that column A, B, L, M, V, W are all empty for a row in Worksheet 1 that meets the criteria?</pre>

<pre class="amctext">The AF can be initiated through vba if so required. 
                                    
                                    Thanks
                                    Rob</pre>

<pre class="amctext">Thanks for letting me know that, Rob. My workbook is shared, which appears to make the AF option unavailable.
                                    
                                    Pkwan, in answer to your questions:
                                    #1 - If row 4 meets the criteria, then it would insert at the end. The plan is that Worksheet 2 will have column filters allowing me to sort the data (assuming that feature won't interfere with what you are proposing?)
                                    
                                    #2 - No
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">Shared!!!
                                    
                                    The general consensus of opinion on Experts Exchange regarding Shared Workbooks is to avoid them wherever possible!! They will end up corrupt in some way or other.
                                    
                                    Thanks
                                    Rob H</pre>

<pre class="amctext">Please try the attached. Thanks.
                                    Temp.xlsm</pre>

<pre class="amctext">Yes, Rob, I agree...unfortunately the decision to use shared Excel files is beyond my control so I'm making daily backups of the file while also taking every opportunity to encourage the organization to switch to Access!!
                                    
                                    Andrea</pre>

<pre class="amctext">Works perfectly. Thanks so much!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Testing (17 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/09_w36/675296/Temp.xlsm">Temp.xlsm</a></p>
<p class="amcfile">Revised Excel (18 KB) <a href="https://filedb.experts-exchange.com/incoming/2013/09_w36/675742/Temp.xlsm">Temp.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Sum number of minutes (process vs rework minutes) by work order between specific date ranges</h2>
<p class="amcdate">2017-07-15T14:41:14-0400</p>

<pre class="amctext">I have a Summary Excel Table in a spreadsheet that is linked to a production tracking spreadsheet that needs to update in real-time as data in entered the production tracking spreadsheet. 
                          
                          Description of the Summary Excel Table spreadsheet:
                          Sheet 1:
                          NOTE: Sheet1 has a number of columns that are not relevant for this specific question, but I left them in to replicate the spreadsheet I will be using to implement this solution.
                          Col A is a list of WO#s pulled from the production tracking spreadsheet
                          Column headings labelled Date1, Date2, etc. through to Date12 = date that process or rework minutes were entered into the spreadsheet. Note that the minutes associated with the date entry are always in the column to the immediate right of the date column (Col D minutes (whether process or rework minutes) are for Col C date entries, etc.).
                          Column headings labelled Min1, Min2, Min3, Min4, Min5, Min6, Min7 = process minutes
                          Columnn headings labelled RWK_Min1, RWK_Min2, etc. .through to RWK_Min6 = rework minutes
                          
                          Sheet2: I would like to be able to...
                          Sum the number of process minutes (in one column) and rework minutes (in another column) by work order # between specific date ranges listed in Sheet2, Rows 2 and 3.
                          
                          I have included a sample spreadsheet as described above, containing Sheet1 and Sheet2, with a description on Sheet2 of the solutions I am hoping for.
                          
                          Lastly, can you let me know if the formulas required for this solution will be a concern in terms of significantly impacting its performance?
                          
                          Thanks!
                          Andrea
                          Summary_Excel_Table.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Please find attached, I have used multiple SUMIFS to provide expected result.
                                    
                                    Kindly note as you have 5k+ rows in both sheets, processing takes longer. I have also deleted some rows which has 0 in WO Col in both the sheets.
                                    
                                    Let me know if it works for you...
                                    Andrea_Summary_Excel_Table.xlsx</pre>

<pre class="amctext">Below is a VBA approach which takes 23 seconds to apply formula in 5k plus rows and won't impact on its performance:
                                    
                                    Sub AddSumifs()
Dim Ws1 As Worksheet, Ws2 As Worksheet
Dim LRow As Long, LR As Long, FinalRow As Long
Dim StartTimer, EndTimer, UsedTime

'Set Variables
Set Ws1 = Worksheets("Sheet1")
Set Ws2 = Worksheets("Sheet2")
LR = Ws1.Range("A" & Rows.Count).End(xlUp).Row
LRow = Ws2.Range("A" & Rows.Count).End(xlUp).Row

StartTimer = Now()

'Disable Events
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
End With

'Clear Old Data
Ws2.Range("A4:E" & LRow).ClearContents

'Add Updated WO from Sheet1 to Sheet2
Ws1.Range("A2:A" & LR).AdvancedFilter xlFilterCopy, CopyToRange:=Ws2.Range("A4"), Unique:=True

'Add Formulas
FinalRow = Ws2.Range("A" & Rows.Count).End(xlUp).Row
Ws2.Range("B4:B" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[Min1],Table1[WO],RC1,Table1[Date2],"">=""&R2C2,Table1[Date2],""<=""&R3C2)+SUMIFS(Table1[Min2],Table1[WO],RC1,Table1[Date3],"">=""&R2C2,Table1[Date3],""<=""&R3C2)+SUMIFS(Table1[Min3],Table1[WO],RC1,Table1[Date4],"">=""&R2C2,Table1[Date4],""<=""&R3C2)+SUMIFS(Table1[Min4],Table1[WO],RC1,Table1[Date5],"">=""&R2C2,Table1[Date5],""<=""&R3C2)+SUMIFS(Table1[Min5],Table1[WO],RC1,Table1[Date6],"">=""&R2C2,Table1[Date6],""<=""&R3C2)+SUMIFS(Table1[Min6],Table1[WO],RC1,Table1[Date8],"">=""&R2C2,Table1[Date8],""<=""&R3C2)+SUMIFS(Table1[Min7],Table1[WO],RC1,Table1[Date12],"">=""&R2C2,Table1[Date12],""<=""&R3C2)"
Ws2.Range("C4:C" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[RWK_Min1],Table1[WO],RC1,Table1[Date1],"">=""&R2C3,Table1[Date1],""<=""&R3C3)+SUMIFS(Table1[RWK_Min2],Table1[WO],RC1,Table1[Date7],"">=""&R2C3,Table1[Date7],""<=""&R3C3)+SUMIFS(Table1[RWK_Min3],Table1[WO],RC1,Table1[Date7],"">=""&R2C3,Table1[Date7],""<=""&R3C3)+SUMIFS(Table1[RWK_Min4],Table1[WO],RC1,Table1[Date9],"">=""&R2C3,Table1[Date9],""<=""&R3C3)+SUMIFS(Table1[RWK_Min5],Table1[WO],RC1,Table1[Date10],"">=""&R2C3,Table1[Date10],""<=""&R3C3)+SUMIFS(Table1[RWK_Min6],Table1[WO],RC1,Table1[Date11],"">=""&R2C3,Table1[Date11],""<=""&R3C3)"
Ws2.Range("D4:D" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[Min1],Table1[WO],RC1,Table1[Date2],"">=""&R2C4,Table1[Date2],""<=""&R3C4)+SUMIFS(Table1[Min2],Table1[WO],RC1,Table1[Date3],"">=""&R2C4,Table1[Date3],""<=""&R3C4)+SUMIFS(Table1[Min3],Table1[WO],RC1,Table1[Date4],"">=""&R2C4,Table1[Date4],""<=""&R3C4)+SUMIFS(Table1[Min4],Table1[WO],RC1,Table1[Date5],"">=""&R2C4,Table1[Date5],""<=""&R3C4)+SUMIFS(Table1[Min5],Table1[WO],RC1,Table1[Date6],"">=""&R2C4,Table1[Date6],""<=""&R3C4)+SUMIFS(Table1[Min6],Table1[WO],RC1,Table1[Date8],"">=""&R2C4,Table1[Date8],""<=""&R3C4)+SUMIFS(Table1[Min7],Table1[WO],RC1,Table1[Date12],"">=""&R2C4,Table1[Date12],""<=""&R3C4)"
Ws2.Range("E4:E" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[RWK_Min1],Table1[WO],RC1,Table1[Date1],"">=""&R2C5,Table1[Date1],""<=""&R3C5)+SUMIFS(Table1[RWK_Min2],Table1[WO],RC1,Table1[Date7],"">=""&R2C5,Table1[Date7],""<=""&R3C5)+SUMIFS(Table1[RWK_Min3],Table1[WO],RC1,Table1[Date7],"">=""&R2C5,Table1[Date7],""<=""&R3C5)+SUMIFS(Table1[RWK_Min4],Table1[WO],RC1,Table1[Date9],"">=""&R2C5,Table1[Date9],""<=""&R3C5)+SUMIFS(Table1[RWK_Min5],Table1[WO],RC1,Table1[Date10],"">=""&R2C5,Table1[Date10],""<=""&R3C5)+SUMIFS(Table1[RWK_Min6],Table1[WO],RC1,Table1[Date11],"">=""&R2C5,Table1[Date11],""<=""&R3C5)"
Ws2.Range("B4:E" & FinalRow).Value = Ws2.Range("B4:E" & FinalRow).Value

EndTimer = Now()
MsgBox (DateDiff("s", StartTimer, EndTimer))

'Enable Events
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Once you upload real time data in Sheet1, just click Add Formulas Button in Sheet2.
                                    Hope this helps...
                                    Andrea_Summary_Excel_Table_v1.xlsm</pre>

<pre class="amctext">This is terrific! Thanks so much, Shums, for taking the time to provide both solutions — very much appreciated. As you can see, I'm opting for the VBA. BTW, I noticed on the VBA solution that Sheet1 no longer has column filters, and the option for them is greyed out. Is this an impact of the VBA, and is Sheet1 still considered a 'table' format that locks down the data structure to maintain column and row integrity?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're Welcome Andrea! Glad I was able to provide both the options :)
                                    
                                    Just add
                                    
                                    Ws1.Range("A1").AutoFilter

                                    
                                      Select all
                                      Open in new window
                                    Before
                                    
                                    EndTimer = Now()

                                    
                                      Select all
                                      Open in new window
                                    Below is full code including one extra line:
                                    
                                    Sub AddSumifs()
Dim Ws1 As Worksheet, Ws2 As Worksheet
Dim LRow As Long, LR As Long, FinalRow As Long
Dim StartTimer, EndTimer

'Set Variables
Set Ws1 = Worksheets("Sheet1")
Set Ws2 = Worksheets("Sheet2")
LR = Ws1.Range("A" & Rows.Count).End(xlUp).Row
LRow = Ws2.Range("A" & Rows.Count).End(xlUp).Row

StartTimer = Now()

'Disable Events
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
End With

'Clear Old Data
Ws2.Range("A4:E" & LRow + 1).ClearContents

'Add Updated WO from Sheet1 to Sheet2
Ws1.Range("A2:A" & LR).AdvancedFilter xlFilterCopy, CopyToRange:=Ws2.Range("A4"), Unique:=True

'Add Formulas
FinalRow = Ws2.Range("A" & Rows.Count).End(xlUp).Row
Ws2.Range("B4:B" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[Min1],Table1[WO],RC1,Table1[Date2],"">=""&R2C2,Table1[Date2],""<=""&R3C2)+SUMIFS(Table1[Min2],Table1[WO],RC1,Table1[Date3],"">=""&R2C2,Table1[Date3],""<=""&R3C2)+SUMIFS(Table1[Min3],Table1[WO],RC1,Table1[Date4],"">=""&R2C2,Table1[Date4],""<=""&R3C2)+SUMIFS(Table1[Min4],Table1[WO],RC1,Table1[Date5],"">=""&R2C2,Table1[Date5],""<=""&R3C2)+SUMIFS(Table1[Min5],Table1[WO],RC1,Table1[Date6],"">=""&R2C2,Table1[Date6],""<=""&R3C2)+SUMIFS(Table1[Min6],Table1[WO],RC1,Table1[Date8],"">=""&R2C2,Table1[Date8],""<=""&R3C2)+SUMIFS(Table1[Min7],Table1[WO],RC1,Table1[Date12],"">=""&R2C2,Table1[Date12],""<=""&R3C2)"
Ws2.Range("C4:C" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[RWK_Min1],Table1[WO],RC1,Table1[Date1],"">=""&R2C3,Table1[Date1],""<=""&R3C3)+SUMIFS(Table1[RWK_Min2],Table1[WO],RC1,Table1[Date7],"">=""&R2C3,Table1[Date7],""<=""&R3C3)+SUMIFS(Table1[RWK_Min3],Table1[WO],RC1,Table1[Date7],"">=""&R2C3,Table1[Date7],""<=""&R3C3)+SUMIFS(Table1[RWK_Min4],Table1[WO],RC1,Table1[Date9],"">=""&R2C3,Table1[Date9],""<=""&R3C3)+SUMIFS(Table1[RWK_Min5],Table1[WO],RC1,Table1[Date10],"">=""&R2C3,Table1[Date10],""<=""&R3C3)+SUMIFS(Table1[RWK_Min6],Table1[WO],RC1,Table1[Date11],"">=""&R2C3,Table1[Date11],""<=""&R3C3)"
Ws2.Range("D4:D" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[Min1],Table1[WO],RC1,Table1[Date2],"">=""&R2C4,Table1[Date2],""<=""&R3C4)+SUMIFS(Table1[Min2],Table1[WO],RC1,Table1[Date3],"">=""&R2C4,Table1[Date3],""<=""&R3C4)+SUMIFS(Table1[Min3],Table1[WO],RC1,Table1[Date4],"">=""&R2C4,Table1[Date4],""<=""&R3C4)+SUMIFS(Table1[Min4],Table1[WO],RC1,Table1[Date5],"">=""&R2C4,Table1[Date5],""<=""&R3C4)+SUMIFS(Table1[Min5],Table1[WO],RC1,Table1[Date6],"">=""&R2C4,Table1[Date6],""<=""&R3C4)+SUMIFS(Table1[Min6],Table1[WO],RC1,Table1[Date8],"">=""&R2C4,Table1[Date8],""<=""&R3C4)+SUMIFS(Table1[Min7],Table1[WO],RC1,Table1[Date12],"">=""&R2C4,Table1[Date12],""<=""&R3C4)"
Ws2.Range("E4:E" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[RWK_Min1],Table1[WO],RC1,Table1[Date1],"">=""&R2C5,Table1[Date1],""<=""&R3C5)+SUMIFS(Table1[RWK_Min2],Table1[WO],RC1,Table1[Date7],"">=""&R2C5,Table1[Date7],""<=""&R3C5)+SUMIFS(Table1[RWK_Min3],Table1[WO],RC1,Table1[Date7],"">=""&R2C5,Table1[Date7],""<=""&R3C5)+SUMIFS(Table1[RWK_Min4],Table1[WO],RC1,Table1[Date9],"">=""&R2C5,Table1[Date9],""<=""&R3C5)+SUMIFS(Table1[RWK_Min5],Table1[WO],RC1,Table1[Date10],"">=""&R2C5,Table1[Date10],""<=""&R3C5)+SUMIFS(Table1[RWK_Min6],Table1[WO],RC1,Table1[Date11],"">=""&R2C5,Table1[Date11],""<=""&R3C5)"
Ws2.Range("B4:E" & FinalRow).Value = Ws2.Range("B4:E" & FinalRow).Value
Ws1.Range("A1").AutoFilter
EndTimer = Now()
MsgBox (DateDiff("s", StartTimer, EndTimer))

'Enable Events
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Andrea_Summary_Excel_Table_v2.xlsm</pre>

<pre class="amctext">Thanks, Shums, I'll follow up!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example spreadsheet (1.2 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w28/1182168/Summary_Excel_Table.xlsx">Summary_Excel_Table.xlsx</a></p>
<p class="amcfile">Multiple SUMIFS (3.4 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w28/1182182/Andrea_Summary_Excel_Table.xlsx">Andrea_Summary_Excel_Table.xlsx</a></p>
<p class="amcfile">MultipleSumifs (2.1 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w28/1182186/Andrea_Summary_Excel_Table_v1.xlsm">Andrea_Summary_Excel_Table_v1.xlsm</a></p>
<p class="amcfile">Sumifs (1.0 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w29/1182234/Andrea_Summary_Excel_Table_v2.xlsm">Andrea_Summary_Excel_Table_v2.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel formula to count number of cells with fill color that contain text, and number of cells with no fill that do not contain text</h2>
<p class="amcdate">2018-02-08T18:02:30-0500</p>

<pre class="amctext">The attached spreadsheet uses conditional formatting to guide the data entry clerk in filling it out properly. 
                          
                          Column H and Column I have conditional formatting as follows:
                          
                          If Column F includes the word 'YES', then all subsequent columns should be completed (cells have no fill color)
                          If Column F includes the word 'NO', then conditional formatting then changes cell color in Col H and I to orange, indicating to the user that these cells should not be filled out.
                          
                          At the end of the production cycle, I would like to review the data entry for errrors. Specifically:
                          
                          Col H and Col I:
                          # of cells with no fill color that are blank (formula result should be 4 cells in Col H, 3 cells in Col I)
                          # of cells with fill color that are not blank (formula result should be 2 cells in Col H, 1 cell in Col I)
                          
                          Thanks,
                          Andrea
                          EE_ColorCells.xlsx</pre>

<pre class="amctext"># of cells with no fill color that are blank (formula result should be 4 cells in Col H, 3 cells in Col I)
                                    
                                    H: =SUMPRODUCT((RIGHT($F$2:$F$24,3)="YES")*(H$2:H$24=""))
                                    I: =SUMPRODUCT((RIGHT($F$2:$F$24,3)="YES")*(I$2:I$24=""))
                                    
                                    
                                      # of cells with fill color that are not blank (formula result should be 2 cells in Col H, 1 cell in Col I)
                                    
                                    H: =SUMPRODUCT((RIGHT($F$2:$F$24,2)="NO")*(H$2:H$24<>""))
                                    i: =SUMPRODUCT((RIGHT($F$2:$F$24,2)="NO")*(I$2:I$24<>""))</pre>

<pre class="amctext">Perfect! Thanks very much, Ejgil...
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/02_w06/1271485/EE_ColorCells.xlsx">EE_ColorCells.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Conditional formatting based on comparing today's date to date string in cell</h2>
<p class="amcdate">2014-08-11T13:09:52-0400</p>

<pre class="amctext">Column W is formatted as shown below (initials & date):
                          AC–8 Aug 14
                          MN-14 Jul 14
                          MC-2 Aug 14
                          
                          I would like to apply conditional formatting to the cells in Column W based on the following criteria:
                          Cell background = red if today's date is > 5 working days than date string in Column W cell
                          
                          Below is my attempt, but it doesn't factor in working days, and more to the point, doesn't work:
                          =TODAY()-RIGHT($W2,9)>5
                          
                          If you need any further information, just let me know...
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Hi, you're on the right track; just need to change your conditional formula to this:
                                    =TODAY()-DATEVALUE(MID($W2,4,10))>5
                                    
                                    It assumes that there are two (2) initials, a dash (or other single separating character), then the date.
                                    
                                    Regards,
                                    -Glenn</pre>

<pre class="amctext">You can use REPLACE to remove the first 3 characters.....and then use NETWORKDAYS to count working days between that date and TODAY, i.e.
                                    
                                    =NETWORKDAYS(REPLACE($W2,1,3,""),TODAY())>5
                                    
                                    Note that NETWORKDAYS counts both start date and end date so you may need to experiment to see whether you may need >6 rather than >5 depending on your exact requirements
                                    
                                    regards, barry</pre>

<pre class="amctext">Thanks to you both for the quick response! The first solution seemed to include all days of the week. As I was looking for a formula based on working days, the second solution, which included that criteria, did the trick.</pre>

<pre class="amctext">Thanks very much, Barry! I did experiment and using > 6 worked perfectly...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Counting number of work orders in process and completed by work week in Excel</h2>
<p class="amcdate">2016-02-23T17:57:04-0500</p>

<pre class="amctext">I need to count the number of work orders in process, and the number of work orders completed, by work week. 
                          
                          Background:
                          Column AK and AM are populated using the following format: Initials–DD MMM YY (i.e., MN–20 Jan 16)
                          Column AT is populated with the work order status (i.e., "Job not started", Layout in progress (compiler)", etc.)
                          
                          Criteria for work orders in progress:
                          Count work orders between Monday and Friday over a number of weeks, where:
                          Column AK is not blank AND
                          where column AT is not blank AND = the following criteria:
                          "Awaiting monitor verification" OR 
                          "Job not started" OR 
                          "Layout in progress (compiler)" OR
                          "Layout ready for QC by verifier" OR
                          "QC in progress (verifier)" OR
                          "Corrections with compiler" OR
                          "Corrections with verifier" OR
                          "IPDU proof-for QC" OR
                          "IPDU-corrections required (compiler)" OR
                          "IPDU-corrections-for QC (verifier)
                          
                          Criteria for work orders completed:
                          Count work orders between Monday and Friday over a number of weeks, where:
                          Column AM is not blank AND
                          where column AT is not blank AND = the following criteria:
                          "QC-complete/revoked procedure" OR
                          "QC-complete/ready to generate" OR
                          "See next ADC (this ADC complete)" OR
                          "See next ADC (done in conjunction)" OR
                          "See previous ADC (done in conjunction)"
                          
                          I've attached a sample spreadsheet that includes the following tabs:
                          Charts_Pub: Sample data
                          Metrics: Outline of report structure by work weeks and expected results
                          Charts_Pub_Metrics_EE_Sample.xlsx</pre>

<pre class="amctext">I added four columns of formulas you your data on worksheet Charts_Pub:
                                    In progress
                                    =AND(AK2<>"",OR(AT2={"QC-complete/revoked procedure","QC-complete/ready to generate","See next ADC (this ADC complete)","See next ADC (done in conjunction)","See previous ADC (done in conjunction)"}))
                                    
                                    Completed
                                    =AND(AM2<>"",OR(AT2={"QC-complete/revoked procedure","QC-complete/ready to generate","See next ADC (this ADC complete)","See next ADC (done in conjunction)","See previous ADC (done in conjunction)"}))
                                    
                                    AK date      =IF(AK2="","",--MID(AK2,4,20))
                                    AM date      =IF(AM2="","",--MID(AM2,4,20))
                                    
                                    I then put all that data in a Table using the Insert...Table menu item.
                                    
                                    On worksheet Metrics, I reorganized your report into a four column list using these header labels:
                                    StartDate      EndDate      Work orders in progress      Work orders completed
                                    
                                    I then copied and Paste Special...Transpose the dates into the StartDate & EndDate columns. The formulas for your counts (which may be copied down) were:
                                    Work orders in progress
                                    =COUNTIFS(Table1[AK date],">=" & A2,Table1[AK date],"<=" & B2,Table1[In progress],TRUE)
                                    
                                    Work orders completed
                                    =COUNTIFS(Table1[AM date],">=" & A2,Table1[AM date],"<=" & B2,Table1[Completed],TRUE)
                                    Charts_Pub_Metrics_EE_SampleQ289284.xlsx</pre>

<pre class="amctext">Wow, this is great!! The only minor issue I came across were the results for the WOs in progress weren't correct, but I realized it was just a matter of the statuses listed under "In progress" were a duplicate of the ones for "WOs completed" -- once I changed the statuses to the 'In progress' ones, the results were perfect.
                                    
                                    Byundt, thanks so much for a quick and excellent solution! I'm delighted. :-)</pre>

<pre class="amctext">Oops!
                                    
                                    Thanks for being so gracious about my mistake.
                                    
                                    Brad</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of data and expected results (105 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/02_w09/1083131/Charts_Pub_Metrics_EE_Sample.xlsx">Charts_Pub_Metrics_EE_Sample.xlsx</a></p>
<p class="amcfile">Sample file with revised layout and suggested formulas (112 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/02_w09/1083141/Charts_Pub_Metrics_EE_SampleQ289284.xlsx">Charts_Pub_Metrics_EE_SampleQ289284.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Trim formula based on first dash in text string</h2>
<p class="amcdate">2015-06-09T17:09:07-0400</p>

<pre class="amctext">Column A has the following formats:
                          A1: XXXX-XX
                          A2: XXXX
                          A3: XXXX-XX-XXX
                          A4: XXXX-XX-X
                          
                          I need a formula in Column B that trims Column A after the first dash, so the results of the above rows would be:
                          B1: XX
                          B2: 
                          B3: XXX
                          B4: X
                          
                          I have been using the following formula to date, which worked as there was always just one dash in the text string, but now that there can be more than one dash, I am not getting the results I need:
                          =TRIM(RIGHT(SUBSTITUTE(A1,"-",REPT(" ",LEN(A1))),LEN(A1)))
                          
                          I have attached a sample file. Column C shows the desired results.
                          
                          Thanks!
                          Andrea
                          Trim-EE.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    I am not sure your first set of requirements in the question are correct:
                                    
                                    Column A has the following formats:
                                    A1: XXXX-XX
                                    A2: XXXX
                                    A3: XXXX-XX-XXX
                                    A4: XXXX-XX-X
                                    
                                    I need a formula in Column B that trims Column A after the first dash, so the results of the above rows would be:
                                    B1: XX
                                    B2:
                                    B3: XXX <- Should this be XX-XXX ?
                                    B4: X <- Should this be XX-X ?
                                    
                                    However, reading the requirements within the attached file, "Trim-EE.xls", I suggest you place the following formula in cell [B2], or [C2] (or any column in row 2):
                                    
                                    =MID(A2,FIND("-",A2&"-")+1,LEN(A2))
                                    
                                    Then copy this down the column to the extent of your data.
                                    
                                    I have updated your workbook, as attached.
                                    Q-28688136.xlsx</pre>

<pre class="amctext">You need the MID function to get a substring. The num_chars argument is set to an obligatory 9999 to ensure it definitely reaches the end of the string...
                                    
                                        =IFERROR(MID(A1, FIND("-", A1)+1, 9999), "")
                                    
                                    Wayne</pre>

<pre class="amctext">I would try:
                                    
                                    =SUBSTITUTE(A2,LEFT(A2,FIND("-",A2)),"")
                                    
                                    This will just knock off whatever is up to the first "-".
                                    
                                    In case of errors:
                                    =IFERRROR(SUBSTITUTE(A2,LEFT(A2,FIND("-",A2)),""),"")</pre>

<pre class="amctext">Thanks for all your responses...much appreciated. All solutions worked with the exception of Steve's 'iferror' formula, but in drilling down realized that it was just due to a spelling issue (an extra 'R' in error) and once that was fixed, it worked too. I awarded the best solution to Wayne as his was the first solution to include the 'iferror' component and it worked immediately.
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Trim-EE.xlsx (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2015/06_w24/917928/Trim-EE.xlsx">Trim-EE.xlsx</a></p>
<p class="amcfile">Q_28688136.xlsx (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2015/06_w24/917940/Q-28688136.xlsx">Q-28688136.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">UsingVBA to populate results in column based on criteria in 3 other columns</h2>
<p class="amcdate">2020-02-27T18:42:42-0500</p>

<pre class="amctext">I would like VBA code to identify expiry issues with a list of documents in a spreadsheet and populate the results in Column J, based on the following criteria.
                          
                          I have attached a sample spreadsheet with the anticipated results entered manually in Column J.
                          
                          NOTE: If there is a date in Column H, then any dates entered in Column G are ignored. 
                          
                          If Col I = "" or <> = "Expired" or <> = "Cancelled" or <> = "Replaced", and
                          Col G = "" or <> "", and 
                          Col H <> "" and date > than TODAY, then
                          Col J = ""
                          
                          
                          If Col I = "" or <> = "Expired" or <> = "Cancelled" or <> = "Replaced", and
                          Col G = "" or <> "", and 
                          Col H <> "" and date < than TODAY, then
                          Col J = "Issue"
                          
                          
                          If Col I = "" or <> = "Expired" or <> = "Cancelled" or <> = "Replaced", and
                          Col G <> "" and date < than TODAY + 60 days, and
                          Col H = "", and
                          Col J = "Review Proposed Expiry Date"
                          
                          
                          If Col I = "" or <> = "Expired" or <> = "Cancelled" or <> = "Replaced", and
                          Col H = "", and
                          Col G = "", then
                          Col J = "Missing Expiry Dates"
                          
                          Thanks!
                          Andrea
                          EE_Expiry.xlsm</pre>

<pre class="amctext">Try this formula in J4

=expiryIssue(G4:I4)

With this code

Function expiryIssue(rng As Range) As String 
Application.volatile 
Dim dte1 As Range 
Dim dte2 As Range 
Dim status As String 
Set dte1 = rng.Cells(1, 1) 
Set dte2 = rng.Cells(1, 2) 
status = rng.Cells(1, 3) 
If status <> "Expired" And status <> "Cancelled" And status <> "Replaced" Then 
    If dte2 = "" And dte1 = "" Then 
        expiryIssue = "Missing expiry dates" 
    Else 
        If dte2 = "" Then 
            If dte1 < Date + 60 Then expiryIssue = "Review proposed expiry date" 
        Else 
            If dte1 = "" Then 
                If dte2 < Date Then expiryIssue = "Issue" 
            Else 
                If dte2 < Date Then expiryIssue = "Issue" 
            End If 
        End If 
    End If 
End If 
End Function 


Select allOpen in new window
                                    
                                      formatCodeSnippets('wysiwyg-content','code-20-43039452',true,true,false);</pre>

<pre class="amctext">Thanks very much, Syed, this is great! The one thing I am having difficulty with is taking your solution and applying it to my actual spreadsheet. I've been trying to figure out how to change the column/row references in the VBA but am not having success.
                                    
                                    This is the list of differences between my sample spreadsheet that I provided and my actual spreadsheet:
                                    
                                    Col G (proposed expiry date) is Col H in my actual spreadsheet
                                    Col H (approved expiry date) is Col J in my actual spreadsheet
                                    Col I (Status) is Col BD in my actual spreadsheet
                                    Col J (Expiry Issue) is Col BE in my actual spreadsheet
                                    
                                    Would you be able to provide me with the changes in the VBA so it can work in my actual spreadsheet?
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">No change to VBA

Change 


 =expiryIssue(G4:I4)
  

on the worksheet to your new range.</pre>

<pre class="amctext">Hi Syed,
                                    
                                    I was able to figure out how to change the references based on your solution, so now the code is working in my actual spreadsheet!
                                    
                                    Thanks again...I'm very pleased with your solution. :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of spreadsheet with results (25 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/02_w09/1445294/EE_Expiry.xlsm">EE_Expiry.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Auto-populating and applying color to a cell based on partial text string of another cell (Excel)</h2>
<p class="amcdate">2017-03-06T15:29:16-0500</p>

<pre class="amctext">In my spreadsheet, Column C has the following consistent entry format (initials–date–YES or initials–date–NO) as shown below:
                          ES–DD MMM YYYY–YES
                          MC–DD MMM YYYY–NO
                          (Please note that the dash between the initials and the date, and the date and 'YES' or 'NO', is an EN dash, not a regular dash)
                          
                          'AA' denotes the various users' two-letter initials.
                          
                          I would like to implement the following functionality:
                          If the entry in Column C includes the '–NO' text string, then the corresponding cell in Column E to be auto-colored and auto-populated as follows:
                          Value = n/a
                          Cell color = Pale orange
                          If the entry in Column C includes the '–YES' text string, then there is no impact on Column E.
                          
                          I have included a sample spreadsheet and populated it with the desired outcome as described above.
                          
                          I hope I've provided enough information...please let me know if further details or clarification is needed.
                          
                          Thanks!
                          Andrea
                          
                          Please note that the dash
                          Sample_EE_partial-text-string.xlsx</pre>

<pre class="amctext">Please find attached. This is what you want?
                                    Sample_EE_partial-text-string_V2.xlsx</pre>

<pre class="amctext">You can try attached without disturbing your Column E
                                    Sample_EE_partial-text-string_V1.xlsx</pre>

<pre class="amctext">Thanks, Shums, for the quick response. I noticed that when Column C is blank, column E is being auto-populated with the orange color cell and 'n/a'. I realize now I should have included the criteria that if Column C is blank, then Column E should remain blank. 
                                    
                                    If it's possible to get a revised formula that would be great...
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">Andrea,
                                    
                                    Please try second solution, I already considered it before your response</pre>

<pre class="amctext">Thanks, Shums! I tried the second solution (labelled 'V1', and while the cell in Column E turns orange, the 'n/a' doesn't seem to auto-populate. BTW, I didn't see a formula in the cell - is this solution done with VBA, by any chance? 
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Here you go with VBA
                                    Sample_EE_partial-text-string_V2.xlsm</pre>

<pre class="amctext">Andre,
                                    
                                    Try the last version, I have considered if C would be blank, then also it should not change color nor any formula in Column E.
                                    Sample_EE_partial-text-string_V3.xlsm</pre>

<pre class="amctext">Thanks, Shums, for the quick turnaround. It's now working in terms of the conditional formatting and the 'n/a'. :-)
                                    
                                    The only outstanding issue now, as mentioned above in my first feedback, is that Column E is still populating with 'n/a' (although it's not turning orange, which has been fixed) when Column C is blank.
                                    
                                    So just confirming that I need the formula to be adjusted so that if Column C is blank, Column E is blank (no 'n/a' and no orange color), and then it should be good to go!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Have you tried V3?</pre>

<pre class="amctext">Thanks for your quick responses and solution, Shums, much appreciated!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're Welcome Andrea! Glad I was able to help :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample Excel file showing desired results (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w10/1149326/Sample_EE_partial-text-string.xlsx">Sample_EE_partial-text-string.xlsx</a></p>
<p class="amcfile">Sample (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w10/1149327/Sample_EE_partial-text-string_V2.xlsx">Sample_EE_partial-text-string_V2.xlsx</a></p>
<p class="amcfile">Sample (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w10/1149331/Sample_EE_partial-text-string_V1.xlsx">Sample_EE_partial-text-string_V1.xlsx</a></p>
<p class="amcfile">Sample (21 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w10/1149336/Sample_EE_partial-text-string_V2.xlsm">Sample_EE_partial-text-string_V2.xlsm</a></p>
<p class="amcfile">Sample (23 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/03_w10/1149342/Sample_EE_partial-text-string_V3.xlsm">Sample_EE_partial-text-string_V3.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Need macro to find WO#s meeting a condition, and populate a second sheet with the results</h2>
<p class="amcdate">2017-08-09T20:26:31-0400</p>

<pre class="amctext">Description of spreadsheets:
                          
                          
                            Sheet1, Col A contains a list of unique WOs.
                            Sheet2, Col A contains a list of WOs, some of which have duplicates. Not all WOs in Sheet1, Col A are listed in Sheet2, Col A.
                            If Sheet2, Col E is not blank, then it indicates that a QRY has been sent for that WO.
                          
                          
                          Macro required to do the following actions:
                          
                          
                            Index Sheet2, Col A for any instance of WO #s matching Sheet1, Col A and where Sheet2, Col E is not blank, and if found, then populate Sheet1, Col D for that WO# with "Yes"; otherwise Col D to be left blank.
                            If no matching WO#s found in Sheet2, Col A then Sheet1,Col D to be left blank.
                          
                          
                          I have attached a sample spreadsheet with the correct results entered in Sheet1, Col D.
                          
                          Thanks,
                          Andrea
                          EE_WO_QRY.xlsx</pre>

<pre class="amctext">Hi,
                                    
                                    pls try
                                    Sub macro()
Set rngSh1 = Range(Sheets("Sheet1").Range("A2"), Sheets("Sheet1").Range("A" & Rows.Count).End(xlUp))
Set rngSh2 = Range(Sheets("Sheet2").Range("A2"), Sheets("Sheet2").Range("A" & Rows.Count).End(xlUp).Resize(, 5))
For Each c In rngSh1
    res = Application.VLookup(c.Value, rngSh2, 5)
    If res <> "" Then
        c.Offset(, 3) = "Yes"
    End If
Next
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">Perfect...thanks, Rgonzo!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample Excel file (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w32/1186755/EE_WO_QRY.xlsx">EE_WO_QRY.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Removing duplicate WOs in spreadsheet, ensuring that row with earliest date/time stamp is the row to be retained</h2>
<p class="amcdate">2017-11-07T15:53:03-0500</p>

<pre class="amctext">I receive a master report on a daily basis that has a number of duplicate WOs. I would like to have a macro that would remove all the duplicate WOs in a selective manner, in that it always retains the WO with earliest date/time stamp in column G.
                          
                          I have attached a sample report with the duplicate WOs highlighted in red in Column A, and have highlighted in yellow, in the first section of the report as an illustration, the unique WOs to be retained once the macro is run according to the criteria outlined above.
                          
                          I hope I have provided enough information...
                          
                          Cheers,
                          Andrea
                          EE_KeepEarliestDate_Dupes.xlsx</pre>

<pre class="amctext">Try attached workbook.
                                    Press button to run.
                                    EE_KeepEarliestDate_Dupes.xlsm</pre>

<pre class="amctext">Works like a charm - thanks very much, Ejgil!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of WOs to be retained after macro run (341 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w45/1209699/EE_KeepEarliestDate_Dupes.xlsx">EE_KeepEarliestDate_Dupes.xlsx</a></p>
<p class="amcfile">Keep Earliest date macro (370 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w45/1209731/EE_KeepEarliestDate_Dupes.xlsm">EE_KeepEarliestDate_Dupes.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Sum of minutes from 2 columns based on dates listed in 2 columns</h2>
<p class="amcdate">2016-03-08T15:47:23-0500</p>

<pre class="amctext">I need to total the # of minutes listed in columns B and/or D if the dates entered in column A or column C are fall between specific start and end dates. I have included a sample spreadsheet as follows:
                          
                          Tab called 'RawData':
                          Col A = Comp1_Date
                          Col B = Comp1_Minutes
                          Col C = Ver1_Date
                          Col D = Ver1_Minutes
                          
                          Tab called 'Results':
                          Col A = StartDate
                          Col B = EndDate
                          Col C = Total_Minutes (I have listed the criteria for the results I need in the spreadsheet)
                          
                          I hope what I've provided is sufficient and clear....
                          
                          Thanks!
                          Andrea
                          EE_Sample_TotalMinutes_BetweenDates.xlsx</pre>

<pre class="amctext">To help my understanding... your logic goes like this:
                                     - if Comp1date on row 2 is between StartDate and EndDate (also row 2), then do sum of Comp1Mins.
                                     - or, if Ver1date is between StartDate and EndDate, then do sum of Ver1Mins.
                                    otherwise, set it to zero.</pre>

<pre class="amctext">Trouble is, with that logic, I get no matches at all...
                                    
                                    I'm also confused by your "sum of minutes in column B and/or column D" on the sheet itself...
                                    
                                    I'm doing it in 2 parts right now:
                                    =IF(AND(RawData!A2>=A2,RawData!A2<=B2),SUM(RawData!$B$2:$B$14),0)
                                    EE_Sample_TotalMinutes_BetweenDates.xlsx</pre>

<pre class="amctext">Hi DanCh99,
                                    
                                    I'm sorry for the confusion...
                                    
                                    I have supplied a revised spreadsheet sample, using color coding between the two sheets to show the relationship between the RawData and the results I am looking for, in hope that this better illustrates the desired results. Additionally, I have also manually figured out and entered the correct results in column C on the Results tab. Lastly, I realized that my StartDates and EndDates overlapped by one day, so fixed that issue.
                                    
                                    I hope this helps! :-)
                                    
                                    Thanks,
                                    Andrea
                                    REVISED_-EE_Sample_TotalMinutes_Bet.xlsx</pre>

<pre class="amctext">Hi,
                                    
                                    pls try
                                    
                                    
                                    =SUMPRODUCT((RawData!$A$2:$A$14>=Results!A2)*(RawData!$A$2:$A$14<=Results!B2)*(RawData!$B$2:$B$14))+SUMPRODUCT((RawData!$C$2:$C$14>=Results!A2)*(RawData!$C$2:$C$14<=Results!B2)*(RawData!$D$2:$D$14))

                                    
                                      Select all
                                      Open in new window
                                    Regards
                                    REVISED_-EE_Sample_TotalMinutes_Bet.xlsx</pre>

<pre class="amctext">Perfect! Thanks very much, Rgonzo!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of raw data and outline of results I am looking for (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/03_w11/1085416/EE_Sample_TotalMinutes_BetweenDates.xlsx">EE_Sample_TotalMinutes_BetweenDates.xlsx</a></p>
<p class="amcfile">if sum (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/03_w11/1085428/EE_Sample_TotalMinutes_BetweenDates.xlsx">EE_Sample_TotalMinutes_BetweenDates.xlsx</a></p>
<p class="amcfile">Revised sample file to help better illustrate what I am looking for... (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/03_w11/1085463/REVISED_-EE_Sample_TotalMinutes_Bet.xlsx">REVISED_-EE_Sample_TotalMinutes_Bet.xlsx</a></p>
<p class="amcfile">EE (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2016/03_w11/1085488/REVISED_-EE_Sample_TotalMinutes_Bet.xlsx">REVISED_-EE_Sample_TotalMinutes_Bet.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Revising TRIM formula to also remove file extension</h2>
<p class="amcdate">2014-03-17T15:51:05-0400</p>

<pre class="amctext">I am currently using the following formula to extract the filename from a file path:
                          
                          Filepath:
                          C:\Program Files\xxxx\zzzz\tttt\iiiiiiii\ooooo\wwwwww\YYBG-POP-7E.ai
                          
                          Formula:
                          =TRIM(RIGHT(SUBSTITUTE(A2,"\",REPT(" ",LEN(A2))),LEN(A2)))
                          
                          Results:
                          YYBG-POP-7E.ai
                          YOBP-QRT-4G.doc
                          
                          I would like to revise the formula so it also removes the file extensions, which are either 2 or 3 character extensions, so that the results would be:
                          
                          YYBG-POP-7E
                          YOBP-QRT-4G
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Try this version
                                    
                                    =TRIM(RIGHT(SUBSTITUTE(LEFT(A2,FIND(".",A2)-1),"\",REPT(" ",LEN(A2))),LEN(A2)))
                                    
                                    regards, barry</pre>

<pre class="amctext">Hi Barry, 
                                    
                                    It does the trick! The only tweak, if possible, is to hide the #VALUE if the cell in Column A is blank. Is that feasible?
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">Assuming you are using Excel 2007 or later you can just wrap the formula in IFERROR like this:
                                    
                                    =IFERROR(TRIM(RIGHT(SUBSTITUTE(LEFT(A2,FIND(".",A2)-1),"\",REPT(" ",LEN(A2))),LEN(A2))),"")
                                    
                                    that will return a blank instead of an error.
                                    
                                    In earlier versions you could use a simple IF like
                                    
                                    =IF(A2="","",TRIM(RIGHT(SUBSTITUTE(LEFT(A2,FIND(".",A2)-1),"\",REPT(" ",LEN(A2))),LEN(A2))))
                                    
                                    That specifically returns a blank if A2 is blank
                                    
                                    regards, barry</pre>

<pre class="amctext">Perfect! I'm using Excel 2010, so the Excel 2007 version did the trick. Thanks so much...</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
</body></html>
