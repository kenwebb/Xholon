<!doctype html><html><head><style>pre {background-color:GhostWhite;}</style></head><body>
<div class="amcdiv">
<h2 class="amctitle">Excel conditional formatting rule for specific text string format</h2>
<p class="amcdate">2018-03-14T18:23:12-0400</p>

<pre class="amctext">In Excel, what is the conditional formatting rule for changing a cell color if it contains either of the following strings:
                          "SUP /##"
                          "AIC /##"
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">Make a rule for each string for the cell value equal to the string.
                                    Or a formula for both
                                    =OR(A1="SUP /##",A1="AIC /##")
                                    where A1 is the first cell in the range</pre>

<pre class="amctext">Hi Ejgil,
                                    
                                    For some reason I can’t seem to get this to work. I tried it both ways, then realized I most likely, and I apologize, didn’t explain my question very well. 
                                    
                                    “SUP /##” whereby the ## is a wildcard for a numeric value, such as SUP /18, or SUP /29, etc.
                                    And the same goes for “AIC /##”  (ie., AIC /55, AIC /10
                                    Lastly, the number of digits after the “/“ could be one, two or three digits.
                                    
                                    Hope this clarifies things... :-/
                                    
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    With Ejgil's suggestion, just replace the ## with *, ie:
                                    
                                    =OR(A1="SUP /*",A1="AIC /*")
                                    
                                    Will there always be a space between the 3 letters and the /?
                                    Will there always be the /? If so, would "SUP*" or "AIC*" cover the options?</pre>

<pre class="amctext">Thanks, Rob. For some reason I am not having success in getting this formula to work, so thought it best to supply an example Excel file. The column I am trying to apply the conditional formatting to is column D:
                                    
                                    
                                    The answer is 'Yes' to both of your questions. That being said, this represents an 'incomplete' format, hence the desire for conditional formatting to identify it as such. Once all the columns are populated (as column D is a concatenated string), then the final, complete format will be as shown below, at which point the conditional formatting should no longer take effect:
                                    
                                    SUP or AIC ##/## or SUP or AIC ##/###
                                    
                                    For example:
                                    SUP 17/18
                                    or
                                    SUP 17/181
                                    or 
                                    AIC 17/18
                                    or
                                    AIC 17/181
                                    
                                    I hope this helps...
                                    
                                    Andrea</pre>

<pre class="amctext">Sorry, forgot to upload my sample Excel file!
                                    
                                    Here it is...
                                    
                                    Andrea
                                    EE_ConditionalFormatting.xlsm</pre>

<pre class="amctext">I will take a look later</pre>

<pre class="amctext">You can use
                                    
                                    =OR(LEFT(D2,5)="SUP /",LEFT(D2,5)="AIC /")

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Shaun's suggestion using LEFT works. Don't understand why using a wild card doesn't though.</pre>

<pre class="amctext">Since column D is a composed value, I would use the cells that compose the value, instead of the result.
                                    =AND(OR(A2="AIC",A2="SUP"),OR(B2="",C2=""))
                                    
                                    But what you really want to show are the missing values in B or C, so I would highlight them instead.
                                    Like this for column B and C
                                    =AND(OR($A2="AIC",$A2="SUP"),B2="")</pre>

<pre class="amctext">Thanks for everyone's input...much appreciated! Shaun's solution was the first one to work, and fulfilled my request, and I appreciated the insights and alternate solutions provided by Ejgil, so I have shared the points.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of attempt to apply conditional formatting (31 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/03_w11/1286570/EE_ConditionalFormatting.xlsm">EE_ConditionalFormatting.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Nested IF/AND/OR? Excel formula to determine results based on comparing 'cut-off date'with 'work order complete' date for each of 3 departments</h2>
<p class="amcdate">2017-12-31T13:07:13-0500</p>

<pre class="amctext">I have tried unsuccessfully to create a nested IF/AND formula whereby if two conditions are met, then the work order is 'On Time', otherwise it is 'Late'.
                          
                          Unit_Timeliness:
                          IF UDS![Unit]="DC", AND (UDS![Date_WO_Completed] > Schedule![DC_Cut_Off], THEN "Late" OR
                          IF UDS![Unit]="IFP", AND (UDS![Date_WO_Completed] > Schedule![IFP_Cut_Off], THEN "Late" OR
                          IF UDS![Unit]="PA", AND (UDS![Date_WO_Completed] > Schedule[PA_Cut_Off], THEN "Late"
                          ELSE "On Time"
                          If error, then leave cell BLANK
                          
                          The following formula I came up with is not working properly, in that all the results are indicating that the work orders were completed 'Late', which is not the case:
                          
                          =IF(AND(OR([@Unit]="DC",[@[Date_WO_Completed]]-Schedule.xlsx!AIM_Schedule[DC_Cut_Off]>"0",[@Unit]="PA",[@[Date_WO_Completed]]-Schedule.xlsx!AIM_Schedule[PA_Cut_Off]>"0",[@Unit]="IFP",([@[Date_WO_Completed]]-Schedule.xlsx!AIM_Schedule[IFP_Cut_Off]>"0"))),"Late","On Time")
                          
                          Details of attached files:
                          UDS.xlsx
                          Column name: [Unit]
                          Contains one of the following 3 variables, which are acronyms for 3 different departments:
                          DC
                          PA
                          IFP
                          
                          Column name: [Date_WO_Completed]
                          Contains date that work order was completed by the department
                          
                          Schedule.xlsx
                          Column names:
                          [DC_Cut_Off]*
                          [IFP_Cut_Off]*
                          [PA_Cut_Off]*
                          *Contains 'Cut-off' date for each department against which the work order's completion date is measured against to determine if they delivered the work order 'On Time' or 'Late'.
                          
                          Files as attached.
                          
                          I hope I have provided enough clarity and background...
                          
                          Thanks,
                          Andrea
                          UDS.xlsx
                          Schedule.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    I move Schedule.xlsx Sheet1 to UDS.xlsx and applied below formula:
                                    =IFERROR(IF(OR([@Unit]={"DC","IFP","PA"},[@[Date_WO_Completed]]>AIM_Schedule[DC_Cut_Off],[@[Date_WO_Completed]]>AIM_Schedule[IFP_Cut_Off],[@[Date_WO_Completed]]>AIM_Schedule[PA_Cut_Off]),"Late","On Time"),"")
                                    I changed few cells in Unit to "Open" to check if formula works. As you have "DC", IFP" & "PA" in all your cells.
                                    Is this what you want?
                                    Andrea_UDS.xlsx</pre>

<pre class="amctext">Hi Shums,
                                    
                                    Thanks for the quick response! :-)
                                    
                                    I reviewed the spreadsheet, and noticed that some of the results were not correct. Perhaps I wasn't clear enough in my original post, and if so, my apologies! For instance:
                                    
                                    
                                      The Cut-off date for DC is 13-Sep-2017 (as listed in the Schedule spreadsheet), so any 'DC' work orders that have a 'Date_WO_Complete' (Column D of UDS spreadsheet) that is later than 13-Sep-2017 should be showing as 'Late', but they are showing as 'On Time'. 
                                    
                                    
                                      There are instances where the ''Date_WO_Complete' (Column D of UDS spreadsheet) is blank, in which case I would like the 'Unit_Timeliness' column to remain blank (handling it as an error).
                                    
                                    
                                      The Unit column will always be populated, so I don't need error-handling for blanks in that column.
                                    
                                    
                                    Let me know if you have any questions or need any clarification...
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">Actually, I think I figured this one out! This formula appears to be giving me the results I'm after:
                                    
                                    =IFERROR(IF(AND([@Unit]="DC",[@[Date_WO_Completed]]-AIM_Schedule[DC_Cut_Off]>0),"Late",IF(AND([@Unit]="IFP",[@[Date_WO_Completed]]-AIM_Schedule[IFP_Cut_Off]>0),"Late",IF(AND([@Unit]="PA",[@[Date_WO_Completed]]-AIM_Schedule[PA_Cut_Off]>0),"Late","On Time"))),"")
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">I continued working on this after I posted the question, and eventually landed a formula that worked...</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Spreadsheet that I want the formula to reside (119 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w01/1217190/UDS.xlsx">UDS.xlsx</a></p>
<p class="amcfile">Spreadsheet containing cut-off dates for each department that is referenced by formula (9 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w01/1217191/Schedule.xlsx">Schedule.xlsx</a></p>
<p class="amcfile">Multiple IFS (119 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w01/1217198/Andrea_UDS.xlsx">Andrea_UDS.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Removing duplicate work orders based on latest date and time stamp in Excel report</h2>
<p class="amcdate">2019-03-11T17:04:57-0400</p>

<pre class="amctext">I get a daily report generated in Excel from our workflow system. The report lists all the work orders in Column A, and the date/time various tasks were completed for that work order in Column D. Column A can include duplicate work order entries for those work orders that required a variety of tasks to be completed.
                          
                          I need a macro that removes all duplicate work orders as follows:
                          
                          
                            Determines the latest date/time stamp in Column D for any duplicate work orders
                          
                          
                            Removes all entries for that work order that have older date/time stamps
                          
                          
                            Retains a single entry only for that work order that has the latest date/time stamp
                          
                          
                          I have attached a sample of the report. I have applied conditional formatting in Column A to highlight the duplicate work orders. In Column D, where there are duplicates in Column A, I have highlighted in yellow the rows that should be retained (as they have the latest date/time stamp) after the duplicate work orders are removed to illustrate the results I am hoping for.
                          
                          Thanks!
                          Andrea
                          EE_Duplicate_WO_Removal.xlsx</pre>

<pre class="amctext">I assume you also want to retain all the ID's where there's just one entry like rows 8 to 12. True?</pre>

<pre class="amctext">Try this
                                    EE_Duplicate_WO_Removal.xlsm</pre>

<pre class="amctext">You may try something like this...
                                    
                                    Sub RemoveDuplicateWorkOrders()
    Dim wsData As Worksheet
    Dim lr As Long
    Application.ScreenUpdating = False
    
    Set wsData = Worksheets("PA08")
    wsData.AutoFilterMode = False
    lr = wsData.Cells(Rows.Count, 1).End(xlUp).Row
    
    wsData.Range("Z2:Z" & lr).Formula = "=D2<>MAXIFS($D$2:$D$" & lr & ",$A$2:$A$" & lr & ",A2)"
    With wsData.Range("Z1:Z" & lr)
        .AutoFilter field:=1, Criteria1:=True
        If .SpecialCells(xlCellTypeVisible).Cells.Count > 1 Then
            wsData.Range("Z2:Z" & lr).SpecialCells(xlCellTypeVisible).EntireRow.Delete
        End If
        .AutoFilter
        .ClearContents
    End With
    wsData.Range("A1").AutoFilter
    Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    Please click the button called "Remove Duplicate Work Orders" on PA08 Sheet to run the macro.
                                    EE_Duplicate_WO_Removal.xlsm</pre>

<pre class="amctext">Thanks to everyone for your quick responses! 
                                    
                                    Martin - yes, that's correct, I did want to retain all the IDs where there was just one entry.
                                    
                                    Ejgil - your solution did the trick. 
                                    
                                    Subodh - I tried your solution a few times but the macro didn't appear to run. I tried both clicking on the button, as well as through the Developer > Macro icon.
                                    
                                    Best,
                                    Andrea</pre>

<pre class="amctext">That's very strange?
                                    I just tested it and it worked without an issue.
                                    
                                    Anyways glad your issue has been resolved.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample Excel report with rows highlighted to illustrate results I am hoping for (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/03_w11/1414770/EE_Duplicate_WO_Removal.xlsx">EE_Duplicate_WO_Removal.xlsx</a></p>
<p class="amcfile">Remove duplicates (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/03_w11/1414779/EE_Duplicate_WO_Removal.xlsm">EE_Duplicate_WO_Removal.xlsm</a></p>
<p class="amcfile">EE_Duplicate_WO_Removal.xlsm (22 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/03_w11/1414791/EE_Duplicate_WO_Removal.xlsm">EE_Duplicate_WO_Removal.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Sum number of minutes (process vs rework minutes) by work order between specific date ranges</h2>
<p class="amcdate">2017-07-15T14:41:14-0400</p>

<pre class="amctext">I have a Summary Excel Table in a spreadsheet that is linked to a production tracking spreadsheet that needs to update in real-time as data in entered the production tracking spreadsheet. 
                          
                          Description of the Summary Excel Table spreadsheet:
                          Sheet 1:
                          NOTE: Sheet1 has a number of columns that are not relevant for this specific question, but I left them in to replicate the spreadsheet I will be using to implement this solution.
                          Col A is a list of WO#s pulled from the production tracking spreadsheet
                          Column headings labelled Date1, Date2, etc. through to Date12 = date that process or rework minutes were entered into the spreadsheet. Note that the minutes associated with the date entry are always in the column to the immediate right of the date column (Col D minutes (whether process or rework minutes) are for Col C date entries, etc.).
                          Column headings labelled Min1, Min2, Min3, Min4, Min5, Min6, Min7 = process minutes
                          Columnn headings labelled RWK_Min1, RWK_Min2, etc. .through to RWK_Min6 = rework minutes
                          
                          Sheet2: I would like to be able to...
                          Sum the number of process minutes (in one column) and rework minutes (in another column) by work order # between specific date ranges listed in Sheet2, Rows 2 and 3.
                          
                          I have included a sample spreadsheet as described above, containing Sheet1 and Sheet2, with a description on Sheet2 of the solutions I am hoping for.
                          
                          Lastly, can you let me know if the formulas required for this solution will be a concern in terms of significantly impacting its performance?
                          
                          Thanks!
                          Andrea
                          Summary_Excel_Table.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Please find attached, I have used multiple SUMIFS to provide expected result.
                                    
                                    Kindly note as you have 5k+ rows in both sheets, processing takes longer. I have also deleted some rows which has 0 in WO Col in both the sheets.
                                    
                                    Let me know if it works for you...
                                    Andrea_Summary_Excel_Table.xlsx</pre>

<pre class="amctext">Below is a VBA approach which takes 23 seconds to apply formula in 5k plus rows and won't impact on its performance:
                                    
                                    Sub AddSumifs()
Dim Ws1 As Worksheet, Ws2 As Worksheet
Dim LRow As Long, LR As Long, FinalRow As Long
Dim StartTimer, EndTimer, UsedTime

'Set Variables
Set Ws1 = Worksheets("Sheet1")
Set Ws2 = Worksheets("Sheet2")
LR = Ws1.Range("A" & Rows.Count).End(xlUp).Row
LRow = Ws2.Range("A" & Rows.Count).End(xlUp).Row

StartTimer = Now()

'Disable Events
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
End With

'Clear Old Data
Ws2.Range("A4:E" & LRow).ClearContents

'Add Updated WO from Sheet1 to Sheet2
Ws1.Range("A2:A" & LR).AdvancedFilter xlFilterCopy, CopyToRange:=Ws2.Range("A4"), Unique:=True

'Add Formulas
FinalRow = Ws2.Range("A" & Rows.Count).End(xlUp).Row
Ws2.Range("B4:B" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[Min1],Table1[WO],RC1,Table1[Date2],"">=""&R2C2,Table1[Date2],""<=""&R3C2)+SUMIFS(Table1[Min2],Table1[WO],RC1,Table1[Date3],"">=""&R2C2,Table1[Date3],""<=""&R3C2)+SUMIFS(Table1[Min3],Table1[WO],RC1,Table1[Date4],"">=""&R2C2,Table1[Date4],""<=""&R3C2)+SUMIFS(Table1[Min4],Table1[WO],RC1,Table1[Date5],"">=""&R2C2,Table1[Date5],""<=""&R3C2)+SUMIFS(Table1[Min5],Table1[WO],RC1,Table1[Date6],"">=""&R2C2,Table1[Date6],""<=""&R3C2)+SUMIFS(Table1[Min6],Table1[WO],RC1,Table1[Date8],"">=""&R2C2,Table1[Date8],""<=""&R3C2)+SUMIFS(Table1[Min7],Table1[WO],RC1,Table1[Date12],"">=""&R2C2,Table1[Date12],""<=""&R3C2)"
Ws2.Range("C4:C" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[RWK_Min1],Table1[WO],RC1,Table1[Date1],"">=""&R2C3,Table1[Date1],""<=""&R3C3)+SUMIFS(Table1[RWK_Min2],Table1[WO],RC1,Table1[Date7],"">=""&R2C3,Table1[Date7],""<=""&R3C3)+SUMIFS(Table1[RWK_Min3],Table1[WO],RC1,Table1[Date7],"">=""&R2C3,Table1[Date7],""<=""&R3C3)+SUMIFS(Table1[RWK_Min4],Table1[WO],RC1,Table1[Date9],"">=""&R2C3,Table1[Date9],""<=""&R3C3)+SUMIFS(Table1[RWK_Min5],Table1[WO],RC1,Table1[Date10],"">=""&R2C3,Table1[Date10],""<=""&R3C3)+SUMIFS(Table1[RWK_Min6],Table1[WO],RC1,Table1[Date11],"">=""&R2C3,Table1[Date11],""<=""&R3C3)"
Ws2.Range("D4:D" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[Min1],Table1[WO],RC1,Table1[Date2],"">=""&R2C4,Table1[Date2],""<=""&R3C4)+SUMIFS(Table1[Min2],Table1[WO],RC1,Table1[Date3],"">=""&R2C4,Table1[Date3],""<=""&R3C4)+SUMIFS(Table1[Min3],Table1[WO],RC1,Table1[Date4],"">=""&R2C4,Table1[Date4],""<=""&R3C4)+SUMIFS(Table1[Min4],Table1[WO],RC1,Table1[Date5],"">=""&R2C4,Table1[Date5],""<=""&R3C4)+SUMIFS(Table1[Min5],Table1[WO],RC1,Table1[Date6],"">=""&R2C4,Table1[Date6],""<=""&R3C4)+SUMIFS(Table1[Min6],Table1[WO],RC1,Table1[Date8],"">=""&R2C4,Table1[Date8],""<=""&R3C4)+SUMIFS(Table1[Min7],Table1[WO],RC1,Table1[Date12],"">=""&R2C4,Table1[Date12],""<=""&R3C4)"
Ws2.Range("E4:E" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[RWK_Min1],Table1[WO],RC1,Table1[Date1],"">=""&R2C5,Table1[Date1],""<=""&R3C5)+SUMIFS(Table1[RWK_Min2],Table1[WO],RC1,Table1[Date7],"">=""&R2C5,Table1[Date7],""<=""&R3C5)+SUMIFS(Table1[RWK_Min3],Table1[WO],RC1,Table1[Date7],"">=""&R2C5,Table1[Date7],""<=""&R3C5)+SUMIFS(Table1[RWK_Min4],Table1[WO],RC1,Table1[Date9],"">=""&R2C5,Table1[Date9],""<=""&R3C5)+SUMIFS(Table1[RWK_Min5],Table1[WO],RC1,Table1[Date10],"">=""&R2C5,Table1[Date10],""<=""&R3C5)+SUMIFS(Table1[RWK_Min6],Table1[WO],RC1,Table1[Date11],"">=""&R2C5,Table1[Date11],""<=""&R3C5)"
Ws2.Range("B4:E" & FinalRow).Value = Ws2.Range("B4:E" & FinalRow).Value

EndTimer = Now()
MsgBox (DateDiff("s", StartTimer, EndTimer))

'Enable Events
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Once you upload real time data in Sheet1, just click Add Formulas Button in Sheet2.
                                    Hope this helps...
                                    Andrea_Summary_Excel_Table_v1.xlsm</pre>

<pre class="amctext">This is terrific! Thanks so much, Shums, for taking the time to provide both solutions — very much appreciated. As you can see, I'm opting for the VBA. BTW, I noticed on the VBA solution that Sheet1 no longer has column filters, and the option for them is greyed out. Is this an impact of the VBA, and is Sheet1 still considered a 'table' format that locks down the data structure to maintain column and row integrity?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're Welcome Andrea! Glad I was able to provide both the options :)
                                    
                                    Just add
                                    
                                    Ws1.Range("A1").AutoFilter

                                    
                                      Select all
                                      Open in new window
                                    Before
                                    
                                    EndTimer = Now()

                                    
                                      Select all
                                      Open in new window
                                    Below is full code including one extra line:
                                    
                                    Sub AddSumifs()
Dim Ws1 As Worksheet, Ws2 As Worksheet
Dim LRow As Long, LR As Long, FinalRow As Long
Dim StartTimer, EndTimer

'Set Variables
Set Ws1 = Worksheets("Sheet1")
Set Ws2 = Worksheets("Sheet2")
LR = Ws1.Range("A" & Rows.Count).End(xlUp).Row
LRow = Ws2.Range("A" & Rows.Count).End(xlUp).Row

StartTimer = Now()

'Disable Events
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
End With

'Clear Old Data
Ws2.Range("A4:E" & LRow + 1).ClearContents

'Add Updated WO from Sheet1 to Sheet2
Ws1.Range("A2:A" & LR).AdvancedFilter xlFilterCopy, CopyToRange:=Ws2.Range("A4"), Unique:=True

'Add Formulas
FinalRow = Ws2.Range("A" & Rows.Count).End(xlUp).Row
Ws2.Range("B4:B" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[Min1],Table1[WO],RC1,Table1[Date2],"">=""&R2C2,Table1[Date2],""<=""&R3C2)+SUMIFS(Table1[Min2],Table1[WO],RC1,Table1[Date3],"">=""&R2C2,Table1[Date3],""<=""&R3C2)+SUMIFS(Table1[Min3],Table1[WO],RC1,Table1[Date4],"">=""&R2C2,Table1[Date4],""<=""&R3C2)+SUMIFS(Table1[Min4],Table1[WO],RC1,Table1[Date5],"">=""&R2C2,Table1[Date5],""<=""&R3C2)+SUMIFS(Table1[Min5],Table1[WO],RC1,Table1[Date6],"">=""&R2C2,Table1[Date6],""<=""&R3C2)+SUMIFS(Table1[Min6],Table1[WO],RC1,Table1[Date8],"">=""&R2C2,Table1[Date8],""<=""&R3C2)+SUMIFS(Table1[Min7],Table1[WO],RC1,Table1[Date12],"">=""&R2C2,Table1[Date12],""<=""&R3C2)"
Ws2.Range("C4:C" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[RWK_Min1],Table1[WO],RC1,Table1[Date1],"">=""&R2C3,Table1[Date1],""<=""&R3C3)+SUMIFS(Table1[RWK_Min2],Table1[WO],RC1,Table1[Date7],"">=""&R2C3,Table1[Date7],""<=""&R3C3)+SUMIFS(Table1[RWK_Min3],Table1[WO],RC1,Table1[Date7],"">=""&R2C3,Table1[Date7],""<=""&R3C3)+SUMIFS(Table1[RWK_Min4],Table1[WO],RC1,Table1[Date9],"">=""&R2C3,Table1[Date9],""<=""&R3C3)+SUMIFS(Table1[RWK_Min5],Table1[WO],RC1,Table1[Date10],"">=""&R2C3,Table1[Date10],""<=""&R3C3)+SUMIFS(Table1[RWK_Min6],Table1[WO],RC1,Table1[Date11],"">=""&R2C3,Table1[Date11],""<=""&R3C3)"
Ws2.Range("D4:D" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[Min1],Table1[WO],RC1,Table1[Date2],"">=""&R2C4,Table1[Date2],""<=""&R3C4)+SUMIFS(Table1[Min2],Table1[WO],RC1,Table1[Date3],"">=""&R2C4,Table1[Date3],""<=""&R3C4)+SUMIFS(Table1[Min3],Table1[WO],RC1,Table1[Date4],"">=""&R2C4,Table1[Date4],""<=""&R3C4)+SUMIFS(Table1[Min4],Table1[WO],RC1,Table1[Date5],"">=""&R2C4,Table1[Date5],""<=""&R3C4)+SUMIFS(Table1[Min5],Table1[WO],RC1,Table1[Date6],"">=""&R2C4,Table1[Date6],""<=""&R3C4)+SUMIFS(Table1[Min6],Table1[WO],RC1,Table1[Date8],"">=""&R2C4,Table1[Date8],""<=""&R3C4)+SUMIFS(Table1[Min7],Table1[WO],RC1,Table1[Date12],"">=""&R2C4,Table1[Date12],""<=""&R3C4)"
Ws2.Range("E4:E" & FinalRow).FormulaR1C1 = "=SUMIFS(Table1[RWK_Min1],Table1[WO],RC1,Table1[Date1],"">=""&R2C5,Table1[Date1],""<=""&R3C5)+SUMIFS(Table1[RWK_Min2],Table1[WO],RC1,Table1[Date7],"">=""&R2C5,Table1[Date7],""<=""&R3C5)+SUMIFS(Table1[RWK_Min3],Table1[WO],RC1,Table1[Date7],"">=""&R2C5,Table1[Date7],""<=""&R3C5)+SUMIFS(Table1[RWK_Min4],Table1[WO],RC1,Table1[Date9],"">=""&R2C5,Table1[Date9],""<=""&R3C5)+SUMIFS(Table1[RWK_Min5],Table1[WO],RC1,Table1[Date10],"">=""&R2C5,Table1[Date10],""<=""&R3C5)+SUMIFS(Table1[RWK_Min6],Table1[WO],RC1,Table1[Date11],"">=""&R2C5,Table1[Date11],""<=""&R3C5)"
Ws2.Range("B4:E" & FinalRow).Value = Ws2.Range("B4:E" & FinalRow).Value
Ws1.Range("A1").AutoFilter
EndTimer = Now()
MsgBox (DateDiff("s", StartTimer, EndTimer))

'Enable Events
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Andrea_Summary_Excel_Table_v2.xlsm</pre>

<pre class="amctext">Thanks, Shums, I'll follow up!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example spreadsheet (1.2 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w28/1182168/Summary_Excel_Table.xlsx">Summary_Excel_Table.xlsx</a></p>
<p class="amcfile">Multiple SUMIFS (3.4 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w28/1182182/Andrea_Summary_Excel_Table.xlsx">Andrea_Summary_Excel_Table.xlsx</a></p>
<p class="amcfile">MultipleSumifs (2.1 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w28/1182186/Andrea_Summary_Excel_Table_v1.xlsm">Andrea_Summary_Excel_Table_v1.xlsm</a></p>
<p class="amcfile">Sumifs (1.0 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w29/1182234/Andrea_Summary_Excel_Table_v2.xlsm">Andrea_Summary_Excel_Table_v2.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Adding additional criteria to VBA solution in Excel</h2>
<p class="amcdate">2020-03-01T12:06:00-0500</p>

<pre class="amctext">I realized that I need an additional criteria added to the great solution I received yesterday on this forum. I've been trying to solve it myself but don't have the skillset yet to solve it.
                          
                          
                          I have attached a sample spreadsheet that shows the results I am looking for once the additional criteria is added.
                          
                          The additional criteria is:
                          If Column A = "AIP_ENR" or "AIP_AD" or AIP_GEN" then Expiry Issue = ""
                          
                          The current solution's VBA code is as follows:
                          
                          
                          Function expiryIssue(rng As Range) As String
Application.Volatile
Dim dte1 As Range
Dim dte2 As Range
Dim status As String
Set dte1 = rng.Cells(1, 1)
Set dte2 = rng.Cells(1, 2)
status = rng.Cells(1, 3)
If status <> "Expired" And status <> "Cancelled" And status <> "Replaced" Then
' If there is no Proposed or Approved expiry date
    If dte2 = "" And dte1 = "" Then
        expiryIssue = "Missing expiry dates"
    Else
    'If there is no Approved Expiry date and the Proposed Expiry date is within 60 days of todays date
        If dte2 = "" Then
            If dte1 < Date + 60 Then expiryIssue = "Review proposed expiry date"
        Else
        'If the Approved Expiry date is older than today's date
            If dte1 = "" Then
                If dte2 < Date Then expiryIssue = "Issue"
            Else
                If dte2 < Date Then expiryIssue = "Issue"
            End If
        End If
    End If
End If
End Function

                          
                            Select all
                            Open in new window
                          
                          Thanks!
                          Andrea
                          EE_Expiry_Exclude_Sections.xlsm</pre>

<pre class="amctext">Function expiryIssue(rng As Range) As String
Application.Volatile
Dim dte1 As Range
Dim dte2 As Range
Dim status As String
Set dte1 = rng.Cells(1, 1)
Set dte2 = rng.Cells(1, 2)
status = rng.Cells(1, 3)
Select Case Cells(rng.Row, "A")
    Case "AIP_ENR", "AIP_AD", "AIP_GEN"
        expiryIssue = ""
        Exit Function
End Select
If status <> "Expired" And status <> "Cancelled" And status <> "Replaced" Then
' If there is no Proposed or Approved expiry date
    If dte2 = "" And dte1 = "" Then
        expiryIssue = "Missing expiry dates"
    Else
    'If there is no Approved Expiry date and the Proposed Expiry date is within 60 days of todays date
        If dte2 = "" Then
            If dte1 < Date + 60 Then expiryIssue = "Review proposed expiry date"
        Else
        'If the Approved Expiry date is older than today's date
            If dte1 = "" Then
                If dte2 < Date Then expiryIssue = "Issue"
            Else
                If dte2 < Date Then expiryIssue = "Issue"
            End If
        End If
    End If
End If
End Function

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks, Martin, for a quick and perfect solution!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You’re welcome and I’m glad I was able to help.
                                    
                                    If you expand the “Full Biography" section of my profile you’ll find links to some articles I’ve written that may interest you.
                                    
                                    Marty - Microsoft MVP 2009 to 2017
                                                  Experts Exchange Most Valuable Expert (MVE) 2015, 2017
                                                  Experts Exchange Top Expert Visual Basic Classic 2012 to 2019
                                                  Experts Exchange Top Expert VBA 2018, 2019
                                                  Experts Exchange Distinguished Expert in Excel 2018</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample spreadsheet with hoped for results shown (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/03_w10/1445481/EE_Expiry_Exclude_Sections.xlsm">EE_Expiry_Exclude_Sections.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Summing all minutes from Excel table that is linked to another spreadsheet, while excluding minutes with specific text strings in one column</h2>
<p class="amcdate">2017-07-28T15:16:39-0400</p>

<pre class="amctext">I have an Excel spreadsheet called 'WO_Tracking'. There is another spreadsheet, called 'Linked', that is linked to 'WO_Tracking', and is formatted as an Excel table. There is a third spreadsheet called 'Summary' to serve as a dashboard for supervisors.
                          
                          In the Summary spreadsheet, I am trying to total the following from the 'Linked' spreadsheet:
                          Linked![Minutes] column + Linked![Minutes2] column, excluding minutes in rows that have either 'Cancelled' or 'Deferred' text string in [WO_Change] column
                          
                          I have provided a sample workbook with all three spreadsheets included, and filled in the expected result in red in the Summary tab. The formula needs to be based on the 'Linked' spreadsheet, not the 'WO_Tracking' spreadsheet.
                          
                          Thanks!
                          Andrea
                          Linked_Spreadsheet_Table_Formulas_E.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try below:
                                    
                                    =SUMIFS(Table2[Minutes],Table2[WO_Change],"<>*Cancelled*",Table2[WO_Change],"<>*Deferred*")+SUMIFS(Table2[Minutes2],Table2[WO_Change],"<>*Cancelled*",Table2[WO_Change],"<>*Deferred*")

                                    
                                      Select all
                                      Open in new window
                                    Andrea_Linked_Spreadsheet_Table.xlsx</pre>

<pre class="amctext">Excellent! Thanks very much, Shums :-)
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample workbook with all 3 spreadsheets and the result needed (14 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w30/1184546/Linked_Spreadsheet_Table_Formulas_E.xlsx">Linked_Spreadsheet_Table_Formulas_E.xlsx</a></p>
<p class="amcfile">SumIFS (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w30/1184553/Andrea_Linked_Spreadsheet_Table.xlsx">Andrea_Linked_Spreadsheet_Table.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel formula not working when calculating on cells containing formulas</h2>
<p class="amcdate">2018-01-16T19:59:20-0500</p>

<pre class="amctext">Sheet1 is a linked worksheet, so every cell contains a formula.
                          
                          Sheet2 is a validation spreadsheet to ensure that all minutes entered in Sheet1, Column E have an associated date entry in Sheet1, Column D. To that end, I'm trying to write a validation formula that meets this criteria:
                          
                          If Sheet 1, Column E has a number >= to 1, and Sheet1, Column D does not have a date, then populate Sheet2 with "Missing", otherwise "". 
                          
                          =IF(AND(Sheet1!$D2=0,Sheet1!$E2>=1),"Missing","")
                          
                          The above formula is not working, as despite Sheet1, Column D missing dates in cells D7:D11, Sheet2 does not indicate this by populating B7:B11 with the word "Missing".
                          
                          I have included a spreadsheet to demonstrate the issue.
                          
                          Thanks,
                          Andrea
                          EE_validation.xlsx</pre>

<pre class="amctext">Please try it like this...
                                    
                                    
                                    =IF(AND(Sheet1!$D2="",Sheet1!$E2>=1),"Missing","")

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks, Subodh!</pre>

<pre class="amctext">You're welcome Andrea!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example (131 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/01_w03/1219992/EE_validation.xlsx">EE_validation.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Updating the date and time fields of Excel user form when form saved</h2>
<p class="amcdate">2017-12-10T18:11:28-0500</p>

<pre class="amctext">My Excel user form has a date and time field that auto-populates when the form is opened. This is to reduce the overhead for the user, and to ensure the format is entered correctly. Once the form is saved, the data from the form populates a spreadsheet called 'TrackingSheet'. 
                          
                          I am finding that users have the form open on their computer over the course of the day, or possibly a couple of days, and as a result the date and time being recorded when the form is saved isn't accurate. I would prefer that users continue to keep the form open on their systems, to facilitate data entry. Is there a way to have clicking of the 'Save' button of the user form also update the date and time fields simultaneously, thus ensuring the accuracy of the date/time stamp in the TrackingSheet?
                          
                          I have attached the user form in question.
                          
                          Thanks,
                          Andrea
                          UserForm_EE.xlsm</pre>

<pre class="amctext">Change the formatting of column "D" to d-mmm-yy and replace your sub with this.
                                    
                                    
                                    Private Sub cmdSave_Click()
Dim NextRow As Long

    With Me

        If .cboIDList.Value = "" _
           Or .cboTask.Value = "" _
           Or .txtPA_Unit.Value = "" _
           Or .txtDate = "" _
           Or .txtTime = "" _
           Or .cboInitials = "" _
           Or txtMinutes = "" _
           Or cboStatus = "" Then

            MsgBox "Cannot save as form is not complete yet", vbExclamation, "Incomplete"
            Exit Sub
        End If

        NextRow = Sheets("TrackingSheet").Range("A" & Rows.Count).End(xlUp).Row + 1
        Sheets("TrackingSheet").Range("A" & NextRow).Value = .cboIDList.Value
        Sheets("TrackingSheet").Range("B" & NextRow).Value = lblTaskText.Caption
        Sheets("TrackingSheet").Range("C" & NextRow).Value = .txtPA_Unit.Value
        Sheets("TrackingSheet").Range("D" & NextRow).Value = Format(Date, "d-mmm-yy")  
        Sheets("TrackingSheet").Range("E" & NextRow).Value = Format(TimeValue(Now), "hh:mm AM/PM") 
        Sheets("TrackingSheet").Range("F" & NextRow).Value = .txtMinutes.Value
        Sheets("TrackingSheet").Range("G" & NextRow).Value = .cboInitials.Value
        Sheets("TrackingSheet").Range("H" & NextRow).Value = .cboStatus.Value
        
        .cboIDList.Value = ""
        .cboTask.Value = ""
        .txtPA_Unit.Value = ""
        .txtMinutes.Value = ""
    End With

End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Martin,
                                    
                                    Excellent...thank you!! I was comparing the old and new code to try and understand what you did...if you had a moment, would you be able to explain it to me?
                                    
                                    Thanks for the quick turnaround too!
                                    Andrea</pre>

<pre class="amctext">OK, I changed lines 23 and 24.
                                    
                                    For line 23 Date is a built in function that in my local returns a date like 12/10/2017 . The Format function changes that so that it shows up in d (day number), mmm (abbreviated name of month), yy (two-digit tear) format with dashes in-between. You can find a lot more information about Format on the web.
                                    
                                    For line 24 TimeValue is a built in function that given in input parameter Now (which is date and time) returns a string like 6:08:57 PM . Again Format changes that and you should be able to find the explanation at the same time that you look up Format on the web.
                                    
                                    In any case you’re welcome and I’m glad I was able to help.
                                    
                                    If you expand the “Full Biography” section of my profile you’ll find links to some articles I’ve written that may interest you.
                                    
                                    Marty - Microsoft MVP 2009 to 2017
                                                  Experts Exchange MVE 2015 
                                                  Experts Exchange Top Expert Visual Basic Classic 2012 to 2017</pre>

<pre class="amctext">Thanks, Martin!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of user form (30 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w50/1214591/UserForm_EE.xlsm">UserForm_EE.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Convert index-match formula in workbook to VBA</h2>
<p class="amcdate">2017-07-07T21:46:50-0400</p>

<pre class="amctext">I would like to convert the following index-match formula used in the attached sample spreadsheet to VBA instead (to avoid having formulas in the cells).
                          
                          Description of formulas:
                          When the status is entered in Col E in any of the first 3 (identically structured) tabs in the workbook, if the status is listed in the named range called 'Status' located on the tab called 'Site_Details', then Col F, G and H are populated using index-match based on the values listed in the corresponding row in the 'Site_Details' table.
                          
                          Named ranges: Status, Site, State and Card
                          
                          Formulas:
                          
                          Col F
                          =IFERROR(INDEX(SITE,MATCH(E2,STATUS,0)),"")
                          
                          Col G
                          =IFERROR(INDEX(CARD,MATCH(E2,STATUS,0)),"")
                          
                          Col H
                          =IFERROR(INDEX(STATE,MATCH(E2,STATUS,0)),"")
                          
                          I would like the workbook to perform the functions using VBA instead of formulas.
                          
                          I have attached a sample spreadsheet with the following 3 tabs (3 production cycles), each populated with the same index-match formulas to replicate how this workbook is set up:
                          Planned_07-DEC-17
                          Planned_01-FEB-18
                          Planned_03-MAR-18
                          
                          Thanks!
                          Andrea
                          EE_Convert_Formulas_to_VBA.xlsm</pre>

<pre class="amctext">hi Andrea,
                                    
                                    because you will use this code for many sheets, create a new module and put this there: 
                                    Sub Lookup_Site_Details_From_Status(pTarget As Range)
'170607 s4p
   On Error GoTo Proc_Err
   
   Dim sStatus As String _
      , nRow As Long _
      , nRowLookup As Long _
      , sLookupSheetname As String
      
   Dim wsLookup As Worksheet _
      , rng As Range
   
   If pTarget.Column <> 5 Then 'if column is not E
      Exit Sub 'don't do anything
   End If
   
   sLookupSheetname = "Site_Details"
   
   Set wsLookup = Sheets(sLookupSheetname)
   
   sStatus = pTarget.Value 'value to lookup
   nRow = pTarget.Row
   
   'find complete match on Site_Details
   Set rng = wsLookup.Range("A:A").Find _
      (What:=sStatus _
      , LookIn:=xlValues _
      , LookAt:=xlWhole _
      , MatchCase:=False)
       
   With pTarget.Parent 'refer to the Sheet that the Target cell is on
      If rng Is Nothing Then
         'not found - clear values
         .Cells(nRow, 6) = "" 'F
         .Cells(nRow, 7) = "" 'G
         .Cells(nRow, 8) = "" 'H
      Else
         'found -- store row of cell that matches
         nRowLookup = rng.Row
         'fill information
         .Cells(nRow, 6) = wsLookup.Cells(nRowLookup, 2) 'F Site
         .Cells(nRow, 7) = wsLookup.Cells(nRowLookup, 3) 'G State
         .Cells(nRow, 8) = wsLookup.Cells(nRowLookup, 4) 'H Card
      End If
   End With
   
Proc_Exit:
   On Error Resume Next
   Set wsLookup = Nothing
   Exit Sub
  
Proc_Err:
   MsgBox Err.Description, , _
        "ERROR " & Err.Number _
        & "   Lookup_Site_Details_From_Status"

   Resume Proc_Exit
   Resume
End Sub

                                    
                                      Select all
                                      Open in new window
                                    I took time to write this for you -- please take time to understand it. Spend one+ minutes to comprehend each line. Ask if you have questions.
                                    
                                    I put an error handler in too ... gave you the link on a previous EE question to the first video to learn about that -- and here it is again:
                                    
                                    basic error handling code for VBA (3:48)
                                    https://www.experts-exchange.com/videos/1478/Excel-Error-Handling-Part-1-Basic-Concepts.html
                                    
                                    and the other 2 you should also watch:
                                    2. Run and Fix Code Loop through rows of an Excel spreadsheet using VBA (6:00)
                                    https://www.experts-exchange.com/videos/1498/Excel-Error-Handling-Part-2-VBA-to-Copy-Values-Down-to-Blank-Cells-in-an-Excel-Column.html
                                    
                                    3. Excel Error Handling Part 3 - Run and Fix Bugs (7:51)
                                    https://www.experts-exchange.com/videos/1518/Excel-Error-Handling-Part-3-Run-and-Fix-Bugs.html
                                    
                                    Now to make it run when you change a cell ... in the code behind each worksheet you want to do this: 
                                    Private Sub Worksheet_Change(ByVal Target As Range)
'170607 s4p
   'call procedure to fill information
   'send the cell reference that was just changed
   Call Lookup_Site_Details_From_Status(Target)
   
End Sub

                                    
                                      Select all
                                      Open in new window
                                    ~~~~~~~~~ Compile ~~~~~~~~~
                                     
                                    Whenever you change code, references, or switch versions or operating environment, or modify objects with code behind them, you should always compile and save before executing any code.
                                      
                                    from the menu in a VBE (module) window: Debug, Compile [the name of your project]
                                    (Alt-F11 to switch to the code window)
                                     
                                    Fix any errors on the highlighted lines.
                                    Add needed references, remove unnecessary references, resolve missing references 
                                    (from the menu: Tools, References...)
                                    
                                    keep compiling until nothing happens (this is good!) -- then Save
                                    
                                    also be sure, before compiling, to use Option Explicit at the very TOP of each module so variables that are not declared or are misspelled will be picked up by the compiler as well as many other errors than can be fixed before running.
                                    
                                    ~~~~~~~~~ Add Option Explicit ~~~~~~~~~
                                    
                                    if the top of your module does not have a statement that says Option Explicit, then add this: 
                                     Option Explicit  ' require variable declaration

                                    
                                      Select all
                                      Open in new window
                                     If this was not done when the code was written, you will may need to DIM some variables -- it is best to do that anyway
                                    
                                    btw, if you were using Access (database for Microsoft Office), you could easily link to the lookup information without copying the values ... want to learn? Ask and I will give you links</pre>

<pre class="amctext">Hi Crystal,
                                    
                                    Thanks SO much for your thorough solution - it works perfectly - and your exceptionally informative and patient reply. Very much appreciated. I am heading out of town shortly for the weekend, but when I'm back I will be able to take the time necessary to go through your reply carefully to gain an understanding of what you did and how it works...
                                    
                                    All the best,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of workbook with existing index-match formula (541 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w27/1180586/EE_Convert_Formulas_to_VBA.xlsm">EE_Convert_Formulas_to_VBA.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Populating Excel user form with value from second column of multi-column combobox dropdown</h2>
<p class="amcdate">2017-12-09T11:04:10-0500</p>

<pre class="amctext">The user form called TimeTracker has a combobox, called cboTask, that has a multi-column dropdown menu. This is to assist users with providing more context to their selection, especially as the dropdown list grows.
                          
                          Here is a description and issue:
                          
                          Name of user form: TimeTracker
                          Combobox under label called 'Task': cboTask
                          3-column dropdown: From dynamic named range on sheet called "Tasks", which includes Col A (ID), Col B (Task), Col C (PA Unit)
                          Issue with cboTask: Currently populating the 'Task' field in user form with value in Col A (Tasks!ID)
                          Fix: Would like this field to be populated instead with value from Col B (Tasks!Task)
                          
                          I have included the spreadsheet.
                          
                          Thanks,
                          Andrea
                          TimeTracker-EE.xlsm</pre>

<pre class="amctext">In Formulas Tab->Name Manager, select the TaskLIst named range and change the Refers To formula to
                                    
                                    =OFFSET(Tasks!$B$2,0,0,MAX(COUNTA(Tasks!$B:$B),COUNTA(Tasks!$C:$C)),3)
                                    
                                    if you want to see Task, PA_Unit and Date, or to 
                                    
                                    =OFFSET(Tasks!$B$2,0,0,MAX(COUNTA(Tasks!$B:$B),COUNTA(Tasks!$C:$C)),2)
                                    
                                    if you want to see Task and PA_Unit.</pre>

<pre class="amctext">Thanks, Martin, for your quick response. I tried it, and noticed that I don't see the ID number any longer in the dropdown list. Sorry, I should have mentioned that I'm looking for a solution, if possible, that retains the same columns in the original dropdown, and that VBA code can somehow select the value from the second column.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">I'm confused since if you go back to the original formula it seems to be doing that already.</pre>

<pre class="amctext">Yes, it appears that the spreadsheet is being populated correctly. It’s the user form display that is my problem. When the user selects the dropdown menu for Task, the user form fields for both Task and ID are both populated with ID. On the user form, I would like, if possible, for the Task field to be populated with the value in the Task column (column 2) instead of the value from the ID column (column 1).
                                    
                                    Hope that makes sense...?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">When the user selects the dropdown menu for Task, the user form fields for both Task and ID are both populated with ID.
                                    
                                    Are you seeing the same thing I am? It looks to me like it's already doing what you want. If it's not then please tell me what should appear, for example, in the first row of the combobox display.</pre>

<pre class="amctext">Hi Martin,
                                    
                                    The user form view is the issue, not the spreadsheets, as currently two user form fields have the same value (ID).  I'm hoping that there is VBA code that, while maintaining the current 3-column dropdown for the user, can populate the Task field in the user form from column 2 (Task) instead of column 1 (ID). I already have the ID field below, which is auto-populated based on the user's selection in the Task combobox:</pre>

<pre class="amctext">Sorry that it took me this long to understand but I think I do now. I have to go out but I'll be back in a couple of hours.</pre>

<pre class="amctext">Try this.
                                    29072884.xlsm</pre>

<pre class="amctext">Hi Martin,
                                    
                                    Good news, and a couple of issues...
                                    
                                    The good news is that the user form is now populating correctly - thank you! The 'TaskList' range, however, appeared to have been changed from referencing the 'Tasks' sheet (which was hidden, and is a unique list of the tasks), to the TrackingSheet. As a result, the dropdown was showing duplicate tasks and was out of order, etc. I changed the 'TaskList' range back to the 'Tasks' sheet, and that reverted the dropdown list to an ordered list of unique tasks, which was good. However, I noticed that when I now add new records, Column B (the task description) of the TrackingSheet remains blank. All the other columns are populated correctly.
                                    
                                    So the upshot is:
                                    The user form fields are being populated correctly
                                    The TrackingSheet is being populated correctly with the exception of Column B, which is blank
                                    
                                    Thanks for your efforts on this, and I'm hoping that the TrackingSheet issue can be resolved...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">I didn't realize that the Task sheet existed and that's why I changed the TaskList named range. I'll be back.</pre>

<pre class="amctext">Updated.
                                    29072884a.xlsm</pre>

<pre class="amctext">Thanks so much, Martin, this is perfect! And I apologize for neglecting to mention the hidden Task sheet - out of sight, out of mind. :-(
                                    
                                    I like the way you enhanced the Task combobox dropdown by adding a heading row. Thanks for going the extra mile!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You’re welcome and I’m glad I was able to help.
                                    
                                    If you expand the “Full Biography” section of my profile you’ll find links to some articles I’ve written that may interest you.
                                    
                                    Marty - Microsoft MVP 2009 to 2017
                                                  Experts Exchange MVE 2015 
                                                  Experts Exchange Top Expert Visual Basic Classic 2012 to 2017</pre>

<pre class="amctext">Thanks, Martin, I’ll follow up...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample file (29 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w49/1214498/TimeTracker-EE.xlsm">TimeTracker-EE.xlsm</a></p>
<p class="amcfile">29072884.xlsm (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w49/1214514/29072884.xlsm">29072884.xlsm</a></p>
<p class="amcfile">29072884a.xlsm (29 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w49/1214524/29072884a.xlsm">29072884a.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Trim formula that extracts the date only from the middle of an alpha-numeric string</h2>
<p class="amcdate">2017-06-08T13:44:30-0400</p>

<pre class="amctext">I need a trim formula that extracts the date only (DD MMM YY) from a column that can contain the following two formats only:
                          
                          AA-DD MMM YY
                          AA-DD MMM YY N/A
                          
                          Examples of actual entries:
                          RT–02 Apr 17 N/A
                          RT–21 Mar 17
                          MN–25 Mar 17 N/A
                          
                          Thanks!
                          Andrea</pre>

<pre class="amctext">Must this be strictly be in Excel formula code or will you accept a VBA solution?</pre>

<pre class="amctext">Assuming your string is in A2, then try this...
                                    
                                    =DATEVALUE(MID(A2,4,9))

                                    
                                      Select all
                                      Open in new window
                                    and format as Date.</pre>

<pre class="amctext">Perfect...thanks so much, Subhodh! :-)
                                    
                                    Andrea</pre>

<pre class="amctext">You're welcome Andreamary! Glad I could help. :)</pre>

<pre class="amctext">You can use this function in a formula:
                                    
                                    Public Function ParseDate(ByVal parmCellValue)
    Static oRE As Object
    Dim oMatches As Object
    Dim oM As Object
    Dim oSM As Object
    Dim lngSM As Long

    If oRE Is Nothing Then
        Set oRE = CreateObject("vbscript.regexp")
        oRE.Global = False
        oRE.Pattern = "\b((?:0[1-9]|[12][0-9]|3[01]) (?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (?:\d\d))\b"
    End If

    If oRE.test(parmCellValue) Then
        ParseDate = oRE.Execute(parmCellValue)(0).submatches(0)
    Else
        ParseDate = vbNullString
    End If

End Function

                                    
                                      Select all
                                      Open in new window
                                    Example:
                                    
                                    =ParseDate(A1)

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks, Aikimark! It looks like I was already closing the question as your solution came in. I was actually looking for an Excel formula for this instance, but thanks!
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Write batch file that creates a destination folder with current date and copies files from one network drive folder to another</h2>
<p class="amcdate">2018-10-07T11:18:55-0400</p>

<pre class="amctext">I would like to create a batch file to use in Windows 10 Task Scheduler for the purpose of doing a daily backup of spreadsheets from one network drive folder to another network folder. I would like the batch file to include the step of creating a sub-folder in the destination 'CAP Spreadsheet Backups' folder, named with the current date (YYYY - MMM- DD), where the spreadsheets would be backed up to.
                          
                          I have created the copy action:
                          
                          Copy "\\ncxxx3.corp.xxxx.ca\productiongraphics$\XXX Spreadsheets\*.xls*" "\\ncxxx1\xxx_development$\Publishing\XXX\_XXX Spreadsheet Backups\
                          
                          But I do not know how to add the action to create the sub-folder with the current date to the batch file.
                          
                          Also, do I need to include an action in the batch file to 'End' the task?
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">I'll come up shortly to answer your question.
                                    
                                    
                                    $SourceFolder = "\\ncxxx3.corp.xxxx.ca\productiongraphics$\XXX Spreadsheets\" 
$TargetRoot = "\\ncxxx1\xxx_development$\Publishing\XXX\_XXX Spreadsheet Backups\CAP Spreadsheet Backups"

$CurrentDate = Get-Date -Format yyyy-MM-dd


#Step0: Check if the TargetRootFolder exists, if it doesn't exists create it
if(!(Test-Path $TargetRoot)){
    Write-Host -ForegroundColor Cyan "Creating new folder $TargetRoot"
    New-Item -Path $TargetRoot -ItemType directory| Out-Null #do not say anything on console that you create the folder
}

#Step1: GEt All the excel files on the SourceFolder
$AllFiles = Get-ChildItem -Filter *.xls* -Path $SourceFolder -Recurse

#Now For each file we will get the Current
foreach($file in $AllFiles){
    $FinalTarget ="$TargetRoot\\$CurrentDate"
    #if target folder doesn't exists create it
    if(!(Test-Path $FinalTarget)){
        Write-Host -ForegroundColor Magenta "Creating new folder $FinalTarget"
        New-Item -Path $FinalTarget  -ItemType directory| Out-Null #do not say anything on console that you create the folder
    }
    #And copy the item with the same name on the finaltargetfodler.
    Copy-Item -LiteralPath $file.FullName -Destination "$FinalTarget\\$($file.Name)"
}

                                    
                                      Select all
                                      Open in new window
                                    
                                    This will create the folder CAP Spreadsheet backups, (even if it doesn't exists).
                                    Then will get all the excel files on the source path.
                                    and then will create a folder with the today's date under the (Cap spreadsheet backups\yyyy-MM-dd\)
                                    and finally will copy all the files from source to this latest target. if there is a need to correct something let me know since the "date" and the CAP weren't too clear for me.</pre>

<pre class="amctext">Jose's Powershell should work fine but I haven't tested it. Since you said 'batch', I presume you'd like either .bat or .cmd file...
                                    
                                    > But I do not know how to add the action to create the sub-folder with the current date to the batch file.
                                    
                                    Make file named DateTime-YYYYMMDDHHMMSS_wmic.bat. This sets your date vars:
                                    
                                    
                                    :: Use WMIC to retrieve date and time
FOR /F "skip=1 tokens=1-6" %%G IN ('WMIC Path Win32_LocalTime Get Day^,Hour^,Minute^,Month^,Second^,Year /Format:table') DO (
   IF "%%~L"=="" goto s_done
      Set _yyyy=%%L
      Set _mm=00%%J
      Set _dd=00%%G
      Set _hour=00%%H
      Set _minute=00%%I
      Set _seconds=00%%K
)
:s_done
:: Pad digits with leading zeros
Set _mm=%_mm:~-2%
Set _dd=%_dd:~-2%
Set _hour=%_hour:~-2%
Set _minute=%_minute:~-2%
Set _seconds=%_seconds:~-2%

:: Display the date/time in ISO 8601 format:
Set _isodate=%_yyyy%-%_mm%-%_dd% %_hour%:%_minute%:%_seconds%
REM Echo %_isodate%
set DateTimeNow=%_yyyy%%_mm%%_dd%%_hour%%_minute%%_seconds%
REM echo DateTimeNow=%DateTimeNow%

GOTO:EOF

                                    
                                      Select all
                                      Open in new window
                                    
                                    Revise your main code accordingly. Note: This is currently in debug mode for visual reasons. When you've confirmed it looks correct, remove the ECHO prefixes.
                                    
                                    Open a Command Window to run it.
                                    
                                    
                                    @echo off
setlocal enabledelayedexpansion

call DateTime-YYYYMMDDHHMMSS_wmic.bat

set destdir=\\ncxxx1\xxx_development$\Publishing\XXX\_XXX Spreadsheet Backups\%_yyyy%-%_mm%-%_dd%

ECHO if not exist "%destdir%" md "%destdir%"
ECHO Copy "\\ncxxx3.corp.xxxx.ca\productiongraphics$\XXX Spreadsheets\*.xls*" "%destdir%"

                                    
                                      Select all
                                      Open in new window
                                    
                                    > Also, do I need to include an action in the batch file to 'End' the task?
                                    
                                    No.</pre>

<pre class="amctext">Thanks to you both for your quick responses. 
                                    
                                    Yes, you're right, NVIT, I do need a .bat file. I want to be able to run this within Windows 10 Task Scheduler at a specific time of day.
                                    
                                    As I am not experienced in this area, I thought perhaps I could save Jose's solution as a .bat file, but received error messages so suspect it is not a .bat file...?
                                    
                                    I had success with NVIT's solution when I ran it as outlined - thank you very much! I ran into a challenge when I tried running it in Windows 10 Task Scheduler. For the Task Scheduler, I wasn't sure what to do so I added both .bat files. When I ran the main code, the Excel files did get copied into a newly created folder, but the folder name was "--" and not named with the current date (as it was when run from the CMD line). Would you be able to guide me as to how I get these two .bat files to work together in Task Scheduler (ie., for the main .bat file to reference the DateTime-YYYYMMDDHHMMSS_wmic.bat file so the new folder is correctly named with the current date)?
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">Give this BAT file a try.  I used YYYYMMDD as the date format, I'd recommend that easier sorting / ordering of the subfolders.
                                    
                                    
                                    @echo off
setlocal

REM Get current date in YYYYMMDD
set DateStamp=
for /f "tokens=* skip=1" %%A in ('wmic os get LocalDateTime') do (
    if not defined DateStamp set DateStamp=%%A
)
set DateStamp=%DateStamp:~0,8%

set DestDir=\\ncxxx1\xxx_development$\Publishing\XXX\_XXX Spreadsheet Backups\%DateStamp%\

if not exist "%DestDir%" md "%DestDir%"

copy "\\ncxxx3.corp.xxxx.ca\productiongraphics$\XXX Spreadsheets\*.xls*" "%DestDir%"

                                    
                                      Select all
                                      Open in new window
                                    
                                    (EDIT: Corrected typo of DataStamp to DataStamp)
                                    
                                    
                                    »bp</pre>

<pre class="amctext">DateTime-YYYYMMDDHHMMSS_wmic.bat  must either be in the same folder as the main bat, or somewhere in the PATH. I put my bat files in a c:\utils folder</pre>

<pre class="amctext">Thanks very much for your help, everyone! I was able to run Bill's solution successfully through Windows 10 Task Scheduler. :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Sorry, I meant to mention (for future reference to others who may view this question) that I had to make one tweak to your code, Bill - Line 11 - change the word 'datastamp' to datestamp'...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Hi NVIT,
                                    
                                    Just to confirm that I do have both .bat files in the same folder, but for some reason the folder name is showing as "--" instead of the date...
                                    
                                    Andrea</pre>

<pre class="amctext">Lol</pre>

<pre class="amctext">Andrea. you can safely use powershell or cmd files with task scheduler 
                                    
                                    https://social.technet.microsoft.com/wiki/contents/articles/38580.configure-to-run-a-powershell-script-into-task-scheduler.aspx
                                    
                                    So....
                                    
                                    
                                    You don't need to have both files. With a bat file is enough, and you can use any file (of the answers)... of course, you need to use the real path on the answers.
                                    
                                    @NVIT a batch file is a synonym to say a script, on Task scheduler works any of the 3 files, regular Command (.bat, .cmd) or PowerShell (.ps1).</pre>

<pre class="amctext">@Jose
                                    
                                    Fine. Still, Andrea wasn't specific, so...</pre>

<pre class="amctext">NVIT - I apologize for not being more specific, which is due to my lack of knowledge/experience in this area...with the helpful answers/information you have all provided, I now have a better understanding and can (hopefully) pose my future questions more succinctly. :-)
                                    
                                    Jose - thanks very much for sharing additional knowledge/insights.
                                    
                                    Great forum!
                                    
                                    Andrea</pre>

<pre class="amctext">All good np.
                                    @NVIT, it was not specific so I could answer whatever I don't see the need for you to be picky about my answer.  I did answer to the author not to you or for you specifically.</pre>

<pre class="amctext">Who's being picky?</pre>

<pre class="amctext">Have you enabled Volume Shadow Copy on the server?  Too many people don't even know about this and while if you need long term archive copies of these sheets, Volume Shadow Copy can provide more granular and automated backups.</pre>

<pre class="amctext">Thanks, Lee, for this information...I’ll look into it.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">See my article - it explains it in depth
                                    https://www.experts-exchange.com/articles/30742/A-Guide-to-Volume-Shadow-Copy.html</pre>

<pre class="amctext">Thanks, Lee!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Adding criteria to Excel VBA so blank rows are not calculated</h2>
<p class="amcdate">2020-03-29T21:00:33-0400</p>

<pre class="amctext">The following VBA solution from this forum has been working great. I just need to add the following criteria to stop the calculation from happening on blank rows:
                          
                          If Column A = "" then Column J (Expiry Issue) = ""
                          
                          The existing code is below. Additionally, I have attached a sample Excel file as well as a screen capture depicting what I am looking for.
                          
                          
                          Function expiryIssue(rng As Range) As String
Application.Volatile
Dim dte1 As Range
Dim dte2 As Range
Dim status As String
Set dte1 = rng.Cells(1, 1)
Set dte2 = rng.Cells(1, 2)
status = rng.Cells(1, 3)
Select Case Cells(rng.Row, "A")
    Case "AIP_ENR", "AIP_AD", "AIP_GEN"
        expiryIssue = ""
        Exit Function
End Select
If status <> "Expired" And status <> "Cancelled" And status <> "Replaced" Then
' If there is no Proposed or Approved expiry date
    If dte2 = "" And dte1 = "" Then
        expiryIssue = "Missing expiry dates"
    Else
    'If there is no Approved Expiry date and the Proposed Expiry date is within 60 days of todays date
        If dte2 = "" Then
            If dte1 < Date + 60 Then expiryIssue = "Review proposed expiry date"
        Else
        'If the Approved Expiry date is older than today's date
            If dte1 = "" Then
                If dte2 < Date Then expiryIssue = "Issue"
            Else
                If dte2 < Date Then expiryIssue = "Issue"
            End If
        End If
    End If
End If
End Function

                          
                            Select all
                            Open in new window
                          
                          Thanks!
                          Andrea
                          EE_Expiry_Add_Criteria_Blank_Rows.xlsm
                          Additional_criteria_Mar29.png</pre>

<pre class="amctext">The expiryissue function contains this code
                                    
                                                If dte1 = "" Then
                If dte2 < Date Then expiryIssue = "Issue"
            Else
                If dte2 < Date Then expiryIssue = "Issue"
            End If

                                    
                                      Select all
                                      Open in new window
                                    which looks like a mistake because the 'If' and the 'Else' do the same thing.</pre>

<pre class="amctext">I added lines 32 to 34.
                                    
                                    Function expiryIssue(rng As Range) As String
Application.Volatile
Dim dte1 As Range
Dim dte2 As Range
Dim status As String
Set dte1 = rng.Cells(1, 1)
Set dte2 = rng.Cells(1, 2)
status = rng.Cells(1, 3)
Select Case Cells(rng.Row, "A")
    Case "AIP_ENR", "AIP_AD", "AIP_GEN"
        expiryIssue = ""
        Exit Function
End Select
If status <> "Expired" And status <> "Cancelled" And status <> "Replaced" Then
' If there is no Proposed or Approved expiry date
    If dte2 = "" And dte1 = "" Then
        expiryIssue = "Missing expiry dates"
    Else
    'If there is no Approved Expiry date and the Proposed Expiry date is within 60 days of todays date
        If dte2 = "" Then
            If dte1 < Date + 60 Then expiryIssue = "Review proposed expiry date"
        Else
        'If the Approved Expiry date is older than today's date
            If dte1 = "" Then
                If dte2 < Date Then expiryIssue = "Issue"
            Else
                If dte2 < Date Then expiryIssue = "Issue"
            End If
        End If
    End If
End If
If Cells(rng.Row, "A") = "" Then
    expiryIssue = ""
End If
End Function

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Martin,
                                    
                                    Thanks for your quick turnaround - your solution works great! :-) And thanks for pointing out the code issue - this was my error in trying to tweak the code myself at one point.
                                    
                                    Andrea</pre>

<pre class="amctext">You’re welcome and I’m glad I was able to help.
                                    
                                    If you expand the “Full Biography" section of my profile you’ll find links to some articles I’ve written that may interest you.
                                    
                                    Marty - Microsoft MVP 2009 to 2017
                                                  Experts Exchange Most Valuable Expert (MVE) 2015, 2017
                                                  Experts Exchange Top Expert Visual Basic Classic 2012 to 2019
                                                  Experts Exchange Top Expert VBA 2018, 2019
                                                  Experts Exchange Distinguished Expert in Excel 2018</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of file with current VBA code (28 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/03_w14/1448214/EE_Expiry_Add_Criteria_Blank_Rows.xlsm">EE_Expiry_Add_Criteria_Blank_Rows.xlsm</a></p>
<p class="amcfile">Screen capture depicting solution I am looking for (47 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/03_w14/1448215/Additional_criteria_Mar29.png">Additional_criteria_Mar29.png</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Finding earliest date in table range with multiple non-contiguous date columns while excluding blanks and zeros</h2>
<p class="amcdate">2018-01-20T11:38:50-0500</p>

<pre class="amctext">I am trying to find a formula that returns the earliest date from a table called DC_Table that has 11 non-contiguous 'Date' columns, excluding blank cells or cells = 0.
                          
                          All cells in the DC_Table are linked cells, and for the purposes of providing an spreadsheet example I have added the source spreadsheet to the workbook. It's called DC_WOs_Extracted. 
                          
                          There are several non-continuous columns in DC_Table that are date fields [Date1], [Date2], etc., and the alternating columns are 'Minutes' fields [Min1], [Min2], etc.
                          
                          As shown on the worksheet tab called  'Dates', the following formula works but seems cumbersome. It references the first 3 [Date] columns (ultimately I will need to include columns Date4 through to Date11), and returns the earliest date found:
                          
                          =IF(MIN(DC_Table[[Date1]:[Date1]],DC_Table[[Date2]:[Date2]],DC_Table[[Date3]:[Date3]])<>0,MIN(DC_Table[[Date1]:[Date1]],DC_Table[[Date2]:[Date2]],DC_Table[[Date3]:[Date3]]),"")
                          
                          I am hoping for a formula that is simpler (ie., using the range as opposed to having to list each date column as above), as some of my spreadsheets will have up to 25 [Date] columns. Is that possible?
                          
                          Thanks,
                          Andrea
                          Metrics_DCWOs_01FEB2018_EE.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Better to create a Named Range for non-contiguous columns, in your case, I created a Named Range called, DateCols with below formula:
                                    =DC_Table[Date1],DC_Table[Date2],DC_Table[Date3],DC_Table[Date4],DC_Table[Date5],DC_Table[Date6],DC_Table[Date7],DC_Table[Date8],DC_Table[Date9],DC_Table[Date10],DC_Table[Date11]
                                    Then for Earliest Dates enter below formula:
                                    
                                    =IF(NOT(ISBLANK((DateCols))),SMALL((DateCols),1))

                                    
                                      Select all
                                      Open in new window
                                     
                                    And for Latest Dates enter below formula:
                                    
                                    =IF(NOT(ISBLANK((DateCols))),LARGE((DateCols),1))

                                    
                                      Select all
                                      Open in new window
                                    Whenever you have new date columns, just add in Named Range.
                                    AndreaMary_Metrics_DCWOs_01FEB2018_.xlsx</pre>

<pre class="amctext">I hadn't realized that a range could include non-contiguous columns - this is great - thanks so much, Shums! :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example spreadsheet (170 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/01_w03/1221299/Metrics_DCWOs_01FEB2018_EE.xlsx">Metrics_DCWOs_01FEB2018_EE.xlsx</a></p>
<p class="amcfile">MinMax (170 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/01_w03/1221330/AndreaMary_Metrics_DCWOs_01FEB2018_.xlsx">AndreaMary_Metrics_DCWOs_01FEB2018_.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Change Excel button from static to dynamic name + apply VBA code "On open" action of workbook</h2>
<p class="amcdate">2020-02-27T13:26:02-0500</p>

<pre class="amctext">Attached is a sample spreadsheet with a button associated with a macro that, when clicked, hides rows based on specific text strings in Column J in Sheet1. Clicking the button again releases the hidden rows. The macro code is included below.
                          
                          I would like to do the following:
                          
                          
                            Change the button name from static to dynamic, depending on the state:
                          
                          
                            
                              When macro is applied, and all the rows deemed 'closed' are hidden, the button name = "Active"
                              When macro is not applied, and all rows are visible, the button name = "All"
                            
                          
                          
                          
                          
                            I would like the spreadsheet to always open with the macro applied to Sheet1 (so button name would = "Active" when spreadsheet opened)
                          
                          
                          There are multiple worksheets in this workbook, so I want to ensure the VBA only applies to Sheet1.
                          
                          Lastly, as I am inexperienced at VBA, I wondered if the macro code I supplied could be improved? For instance, could I have combined the 3 conditions (Expired, Replaced, Cancelled) into one section of code instead of repeating them separately as I have done below?
                          
                          
                          Public Hidden As Boolean

Sub Hide_Closed()
Dim LastRow As Long, c As Range
Application.EnableEvents = False
Application.ScreenUpdating = False
LastRow = Cells(Cells.Rows.Count, "A").End(xlUp).Row
On Error Resume Next
If Not Hidden Then
    For Each c In Range("J1:J" & LastRow)
       If c.Value = "Expired" Then
            c.EntireRow.Hidden = True
            Hidden = True
        ElseIf c.Value = "Replaced" Then
            c.EntireRow.Hidden = True
            Hidden = True
        ElseIf c.Value = "Cancelled" Then
            c.EntireRow.Hidden = True
            Hidden = True
        ElseIf c.Value = "" Then
            c.EntireRow.Hidden = False
        End If
    Next
Else
    Hidden = False
    ActiveSheet.Rows.Hidden = False
End If
On Error GoTo 0
Application.EnableEvents = True
Application.ScreenUpdating = True
End Sub

                          
                            Select all
                            Open in new window
                          
                          Thanks!
                          Andrea
                          EE_Button_DynamicName.xlsm</pre>

<pre class="amctext">To start with Sheet1, you use a Workbook_Open sub
                                    
                                    'Put this sub in This Workbook code pane
Private Sub Workbook_Open()
Hidden = False
Worksheets("Sheet1").Activate
Hide_Closed
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    Your sub becomes:
                                    
                                    Sub Hide_Closed()
Dim LastRow As Long
Dim c As Range
Dim shp As Shape

Application.EnableEvents = False
Application.ScreenUpdating = False
On Error Resume Next

With Worksheets("Sheet1")
    If Not Hidden Then
        .Buttons("Button 1").Caption = "Active"
        LastRow = .Cells(.Cells.Rows.Count, "A").End(xlUp).Row
        For Each c In .Range("J1:J" & LastRow).Cells
            Select Case c.Value
            Case "Expired", "Replaced", "Cancelled"
                c.EntireRow.Hidden = True
                Hidden = True
            Case Else
                 c.EntireRow.Hidden = False
            End Select
        Next
    Else
        .Buttons("Button 1").Caption = "All"
        Hidden = False
        .Rows.Hidden = False
    End If

End With

On Error GoTo 0
Application.EnableEvents = True
End Sub

                                    
                                      Select all
                                      Open in new window
                                    EE_Button_DynamicName.xlsm</pre>

<pre class="amctext">Thanks very much for the quick turnaround - your solution works like a charm! 
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example with button (25 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/02_w09/1445253/EE_Button_DynamicName.xlsm">EE_Button_DynamicName.xlsm</a></p>
<p class="amcfile">Your file with new code (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/02_w09/1445284/EE_Button_DynamicName.xlsm">EE_Button_DynamicName.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Index-match formula with multiple 'if' and 'or' criteria</h2>
<p class="amcdate">2017-09-04T16:34:48-0400</p>

<pre class="amctext">I am looking for formula for Sheet2, Col B (Status) as outlined below:
                          
                          Sheet2, Col B (Status) = 'Active' if:
                          If WO in Sheet2, Col A (WO_Pub) is listed in Sheet1, Col C and if Sheet1, Col D is blank
                          OR
                          If WO in Sheet2, Col A (WO_Pub) is listed in Sheet1, Col C and if Sheet1, Col D = 'Cancelled' or 'Lifted', and Col F is blank
                          
                          Sheet2, Col B (Status) = 'Not Active' if:
                          If WO in Sheet2, Col A (WO_Pub) is not listed in Sheet1, Col C
                          OR
                          If WO in Sheet2, Col A (WO_Pub) is listed in Sheet1, Col C and if Sheet1, Col D = 'LIFTED' OR 'Cancelled', and Col F is not blank
                          
                          I would like the formula to ignore case (ie., LIFTED or Lifted, etc.) since I don't have control over the entries in this spreadsheet.
                          
                          I have attached the sample spreadsheet, with the expected results listed in Sheet2, Col B (Status) column in red.
                          
                          Thanks!
                          Andrea
                          EE_AQ_Status.xlsx</pre>

<pre class="amctext">HI Andrea,
                                    
                                    Try below in B2 and drag down:
                                    
                                    =IFERROR(IF(AND(OR(INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))="",INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))="Cancelled",INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))="Lifted"),INDEX(Sheet1!$F:$F,MATCH($A2,Sheet1!$C:$C,0))=""),"Active","Not Active"),"Not Active")

                                    
                                      Select all
                                      Open in new window
                                    Kindly note, your Status for WO 2016-0002058 should be Not Active as Col F is not blank.
                                    Check attached...
                                    Andrea_EE_AQ_Status.xlsx</pre>

<pre class="amctext">Thanks for the quick response, Shums! In regard to WO 2016-0002058, it actually would be considered 'Active' since Sheet1, Col D is blank (as per the first criteria listed under 'Active' conditions in my original question)...let me know your thoughts...thanks! Andrea</pre>

<pre class="amctext">If we gonna consider 1st criteria, then WO 2017-0000544 would be Active? As Col D has "Cancelled".</pre>

<pre class="amctext">Criteria for 'Not Active' are:
                                    As long as Sheet1, Col D = 'Lifted' or 'Cancelled' and Col F is not blank, then the Status = 'Not Active'
                                    OR
                                    The WO in Sheet2, Col A is not found in Sheet1, Col C
                                    
                                    Hope that helps...let me know if you need further clarification...thanks, Shums!
                                    
                                    Andrea</pre>

<pre class="amctext">Ok Try below:
                                    
                                    =IFERROR(IF(INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))=0,"Active",IF(AND(OR(INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))=0,INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))="Cancelled",INDEX(Sheet1!$D:$D,MATCH($A2,Sheet1!$C:$C,0))="Lifted"),INDEX(Sheet1!$F:$F,MATCH($A2,Sheet1!$C:$C,0))=""),"Active","Not Active")),"Not Active")

                                    
                                      Select all
                                      Open in new window
                                    Check attached...
                                    Andrea_EE_AQ_Status_v4.xlsx</pre>

<pre class="amctext">Work like a charm, Shums - I'm delighted!
                                    
                                    Thanks so much...
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example with formula results in red (14 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/09_w36/1191549/EE_AQ_Status.xlsx">EE_AQ_Status.xlsx</a></p>
<p class="amcfile">Andrea_EE_AQ_Status.xlsx (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/09_w36/1191553/Andrea_EE_AQ_Status.xlsx">Andrea_EE_AQ_Status.xlsx</a></p>
<p class="amcfile">Index Match (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/09_w36/1191565/Andrea_EE_AQ_Status_v4.xlsx">Andrea_EE_AQ_Status_v4.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Controlling user entry in Excel user form combo boxes</h2>
<p class="amcdate">2018-02-15T08:40:43-0500</p>

<pre class="amctext">I have an Excel user form with two combo boxes ('Task' and 'Status'):
                          > I tried to set the Style property of both combo boxes to 2 - fmStyleDropDownList to restrict the user to only selecting entries from the dropdown box and not being able to place their cursor in the field and remove or enter text.
                          > The 'Status' combo box appears to work without generating an error message
                          > The 'Task' combo box now gives me the following error message when I go to select an item from the dropdown menu:
                          
                          Run-time error '380'
                          Could not set the Text property. Invalid property value.
                          
                          When I click on Debug, it points me to a highlighted line:
                          
                          
                              .Text = .List(.ListIndex, 1)

                          
                            Select all
                            Open in new window
                          
                          As I am not very savvy in this area, I have attached the Excel file with the user form in question to demonstrate what is happening.
                          
                          Please let me know if you need any more information.
                          
                          Thanks,
                          Andrea
                          Task_Plan_EE.xlsm</pre>

<pre class="amctext">Try it like this...
                                    
                                    
                                    .Text = .List(.ListIndex, 0)

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Subodh,
                                    
                                    Thanks for the quick response! I tested the solution, and while it fixes the issue, it has changed the way the Task field is populated. Instead of being populated with the Task, it is being populated with the ID number. I set up the 3-column dropdown, etc. with the help of this forum, and during the course of the solution, a 'hidden' field was added to the user form which may be impacting this behaviour...? See screen captures below. 
                                    
                                    Is it possible for the task field to revert to being populated by the task, as per the original user form, but still benefit from the solution you have provided?</pre>

<pre class="amctext">Actually the ComboBox will display the content of the first column.
                                    To display the Task which is second column in the ComboBox list, all you can do is, change the order of columns i.e. Task, ID and PA Unit instead of ID, Task and PA Unit.
                                    
                                    In the attached, I created a table with desired column order in range M:O (Columns are hidden) on Task Sheet. 
                                    And then created a named range called "TaskCombo" which I used as the RowSource for the cboTask.
                                    I also commented out the code in UserForm Initialize event which sets the cboTask ComboBox properties as it is not required now.
                                    
                                    See if this is something you can work with.
                                    Task_Plan_EE.xlsm</pre>

<pre class="amctext">Perfect...thanks very much for the solution and explanation, Subodh!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're welcome Andrea! Glad I could help.
                                    Thanks for the feedback.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Excel user form (414 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/02_w07/1274578/Task_Plan_EE.xlsm">Task_Plan_EE.xlsm</a></p>
<p class="amcfile">Task_Plan_EE.xlsm (408 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/02_w07/1274671/Task_Plan_EE.xlsm">Task_Plan_EE.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Referencing date string in worksheet tab as part of formula to determine if deadline met</h2>
<p class="amcdate">2017-06-26T17:05:10-0400</p>

<pre class="amctext">I am hoping that it is possible to reference a date string in the worksheet tab name in a formula. 
                          
                          Production worksheet tab name format:
                          Planning_DD-MMM-YY
                          
                          Number of production worksheet tabs per workbook:
                          3
                          
                          Deadline lookup table:
                          Deadline_Dates tab
                          
                          Formula I am looking for to determine if a WO is completed on time or not:
                          Based on date in production worksheet tab (ie., Planning_12-Oct-17), the formula would check the 'Deadline_Dates' lookup table for the deadline listed for 12-Oct-17 (in this case 05-Apr_17) and determine if the deadline has been met by comparing it against the date listed in Col G (Date_WO_Completed), and then populate Col H as follows:
                          
                          
                            If date in Col G is < or = to deadline date, then Col H = 'Yes'
                          
                          
                            If date in Col G is > than deadline date, then Col H = 'No'
                          
                          
                            If Col G is blank, then Col H is blank.
                          
                          
                          I have included a sample spreadsheet with the 3 production tabs and the desired results listed in red.
                          
                          Thanks,
                          Andrea
                          Index_Match_Date_Deadline_Worksheet.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    I tried many ways to lookup referencing partial sheet name, but unsuccessful. Eventually VBA solution worked. Below is the code:
                                    
                                    Sub UpdatePlanningSheets()
Dim Ws As Worksheet, Ws1 As Worksheet, Ws2 As Worksheet
Dim LR As Long, LR1 As Long

'Disable Events
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
    .Calculation = xlManual
End With

'Set Variables
Set Ws1 = Worksheets("Deadline_Dates")
Set Ws2 = Worksheets("Lookups")
LR1 = Ws1.Range("A" & Rows.Count).End(xlUp).Row

'Get Sheet Names of Every Worksheet & Update Column H
For Each Ws In ThisWorkbook.Worksheets
    If Ws.Name <> Ws1.Name And Ws.Name <> Ws2.Name Then
        LR = Ws.Range("G" & Rows.Count).End(xlUp).Row
        If IsEmpty(Ws.Range("H2:H" & LR + 1)) = False Then
            Ws.Range("H2:H" & LR + 1).ClearContents
        End If
        Ws.Range("K2").FormulaR1C1 = "=RIGHT(CELL(""filename"",R[-1]C1),9)"
        Ws.Range("K2").Value = Ws.Range("K2").Value
        Ws.Range("H2:H" & LR).FormulaR1C1 = "=IF(RC7="""","""",IF(RC7<=VLOOKUP(R2C11,Deadline_Dates!C1:C2,2,0),""Yes"",""No""))"
        Ws.Range("H2:H" & LR).Value = Ws.Range("H2:H" & LR).Value
    End If
Next Ws

'Enable Events
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                                    
                                      Select all
                                      Open in new window
                                    In attached, run macro UpdatePlanningSheets, which will update all three tab's Col H with desired result.
                                    Andrea_Index_Match_Date_Deadline_Wo.xlsm</pre>

<pre class="amctext">Terrific! Thanks so much, Shums! :-)
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w26/1178174/Index_Match_Date_Deadline_Worksheet.xlsx">Index_Match_Date_Deadline_Worksheet.xlsx</a></p>
<p class="amcfile">Reference Sheet Names (24 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w26/1178193/Andrea_Index_Match_Date_Deadline_Wo.xlsm">Andrea_Index_Match_Date_Deadline_Wo.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Expanding existing macro to include several ranges</h2>
<p class="amcdate">2017-08-17T21:49:11-0400</p>

<pre class="amctext">The macro below converts a column of false dates in Column B to real dates in a spreadsheet. I would like to expand the functionality of this macro to convert several columns of false dates in a spreadsheet. 
                          
                          
                          Sub Metrics_PubWOs_RealDates()
Dim cel As Range, rg As Range
Application.ScreenUpdating = False
With ActiveSheet
    Set rg = .Range("b2")
    Set rg = Range(rg, .Cells(.Rows.Count, rg.Column).End(xlUp))
    For Each cel In rg.Cells
        If Application.IsText(cel.Value) Then
            If IsDate(cel.Value) Then cel.Value = CDate(cel.Value)
        End If
    Next
End With
End Sub

                          
                            Select all
                            Open in new window
                          
                          So in addition to converting false dates in Column B, I would like this macro to also convert dates in Columns D, F, H, J, L, N, P, R, T, V, X, Z, AB, AD, AF, AH, AJ, AL, and AN. (Note that all columns requiring this macro to be run has a column header with the text string "Col", in case it's easier to write VBA code using this criteria instead).
                          
                          I have attached an example of the spreadsheet.
                          
                          Thanks,
                          Andrea
                          EE_MultipleRanges.xlsm</pre>

<pre class="amctext">try this
                                    
                                    
                                    Sub Metrics_PubWOs_RealDates()
Dim cel As Range, rg As Range
Application.ScreenUpdating = False
With ActiveSheet
    Range("A2").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
   
    Set rg = Selection
    For Each cel In rg.Cells
        If Application.IsText(cel.Value) Then
            If IsDate(cel.Value) Then cel.Value = CDate(cel.Value)
        End If
    Next
End With
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Terrific...thanks, Hainkurt!</pre>

<pre class="amctext">no it is not terrific!
                                    
                                    but this one is...
                                    
                                    
                                    Sub Metrics_PubWOs_RealDate(rg)
    For Each cel In rg.Cells
        If Application.IsText(cel.Value) Then
            If IsDate(cel.Value) Then cel.Value = CDate(cel.Value)
        End If
    Next
End Sub

Sub Metrics_PubWOs_RealDates()
    Application.ScreenUpdating = False
    Range("A2").Select
    Selection.End(xlDown).Select
    
    Dim r As Integer
    Dim rg As Range
    r = ActiveCell.Row
    
    Dim cols As Variant
    cols = Array("D", "F", "H", "J", "L", "N", "P", "R", "T", "V", "X", "Z", "AB", "AD", "AF", "AH", "AJ", "AL", "AN")
    For Each col In cols
        Set rg = Range(col & 2 & ":" & col & r)
        Metrics_PubWOs_RealDate rg
    Next
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    above one checks every cell, but this one is just those columns...
                                    
                                    :)</pre>

<pre class="amctext">There's no reason to select a range and you are using a Table so use the parts of that Table, i.e. the Data is the DatBodyRange.
                                    
                                    Try this
                                    
                                    
                                    Option Explicit

Sub Metrics_PubWOs_RealDates()
    Dim cel As Range

    For Each cel In ActiveSheet.ListObjects(1).DataBodyRange.SpecialCells(xlCellTypeConstants).Cells
        On Error Resume Next
        If IsDate(cel.Value) Then cel.Value = CDate(cel.Value)
        On Error GoTo 0
    Next cel

End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks to you both for your follow-up - I hadn't realized there were further responses until tonight.
                                    
                                    HainKurt, I appreciated your updated solution but when I tried it I got the following error in Line 20: For Each col In cols:
                                    Compile Error: Variable not defined
                                    
                                    Roy, thanks for your streamlined code. I tried your solution and noticed a couple of issues:
                                    1. It took 10 to 15 minutes for the macro to complete.
                                    2. A work order # in column A was converted to a date.
                                    
                                    Thanks again! BTW, if you think I should be starting this as a new question, given I've already awarded the points, please let me know...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">I do not believe the code too that long to work, I tested it on your example workbook an it was instantaneous, can you attach the actual workbook that took so long. 
                                    
                                    What was the actual order number?</pre>

<pre class="amctext">Hi Roy,
                                    
                                    Thanks for your note. Attached is the actual workbook (confidential information removed) so you can view how the macro performs. 
                                    
                                    The actual work order numbers are located in Col A, called WO. Interestingly, there was only one WO number, that appears 3 times in Col A, that converted to a date — 2017-0000004.
                                    
                                    Thanks for your continued assistance!
                                    
                                    Andrea
                                    EE_TextDates.xlsx</pre>

<pre class="amctext">I've just run the code and it takes seconds to complete. I'll take a look at the WO now</pre>

<pre class="amctext">Excel for some reason thinks that number is a date. I've excluded the column from the check because it's not necessary to check it.
                                    
                                    This runs in seconds for me. I've highlighted the problem cells in yellow so you can find them easily.
                                    EE_TextDates.xlsm</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of spreadsheet (793 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w33/1188385/EE_MultipleRanges.xlsm">EE_MultipleRanges.xlsm</a></p>
<p class="amcfile">Sample of workbook with several columns of text dates (458 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w33/1188636/EE_TextDates.xlsx">EE_TextDates.xlsx</a></p>
<p class="amcfile">EE_TextDates.xlsm (434 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w33/1188640/EE_TextDates.xlsm">EE_TextDates.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel VBA that applies a 'group' number to each 'batch' of unique work order numbers</h2>
<p class="amcdate">2019-05-10T14:46:29-0400</p>

<pre class="amctext">Column A is a list of 'child' WOs. Column B is a list of the 'parent' WO associated with the 'child' work order. There can be a single, or multiple, 'child' work orders associated with a 'parent' work order. 
                          
                          I am looking for a VBA solution that, based on the work orders in Column B, enters a group number to each unique Column B work order into Column C (Parent WO Group No). 
                          
                          I have included a sample spreadsheet with the Column C manually populated (in red) to demonstrate the outcome that I am looking for.
                          
                          Thanks!
                          Andrea
                          EE_WO_Groupings.xlsm</pre>

<pre class="amctext">You can use this macro.
                                    
                                    Sub AssignParentGroup()
Dim lngLastRow As Long
Dim lngRow As Long
Dim intGroup As Integer
Dim cel As Range
Dim rngVisible As Range

    Application.ScreenUpdating = False
    
    With ActiveSheet
        lngLastRow = .Range("B1048576").End(xlUp).Row
        For lngRow = 2 To lngLastRow
            .Cells.AutoFilter
            .Range("A1:A" & lngLastRow).AutoFilter Field:=2, Criteria1:=.Cells(lngRow, "B")
            intGroup = intGroup + 1
            Set rngVisible = Range("A2:D" & Cells(Rows.Count, "B").End(xlUp).Row).SpecialCells(xlCellTypeVisible)
            For Each cel In rngVisible
                Range("C" & cel.Row).Value = intGroup
            Next
            .Cells.AutoFilter
        Next
    End With
    
    Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Martin,
                                    
                                    Thanks very much for the quick response and solution! I just had a couple of questions:
                                    
                                    1) When I ran the macro, I got an error message at this line of code:
                                    
                                                .Range("A1:A" & lngLastRow).AutoFilter Field:=2, Criteria1:=.Cells(lngRow, "B")
                                    
                                    It appears to be associated with column filters I have on, because when I stop the debugger, the column filters are gone, and then the macro runs fine. I'd prefer to be able to maintain column filters if possible, but if not then I can apply them after the macro has run,
                                    
                                    2) I noticed the group numbers start at 7, then 9, 15, 21, etc. Is it possible to have the group number start at 1 instead, and then increase consecutively by 1 (ie., 2, 3, 4, etc)? 
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">This should be better.
                                    
                                    Sub AssignParentGroup()
Dim lngLastRow As Long
Dim lngRow As Long
Dim cel As Range
Dim rngVisible As Range
Dim colPG As New Collection
Dim intEntry As Integer

    Application.ScreenUpdating = False
    lngLastRow = Range("B1048576").End(xlUp).Row

    With Range("A1:D" & lngLastRow)
        .AutoFilter
        
        For lngRow = 2 To lngLastRow
            On Error Resume Next
                colPG.Add .Cells(lngRow, "B"), CStr(.Cells(lngRow, "B"))
            On Error GoTo 0
        Next
        For intEntry = 1 To colPG.Count
            .AutoFilter Field:=2, Criteria1:=colPG(intEntry)
            Set rngVisible = Range("A2:D" & Cells(Rows.Count, "B").End(xlUp).Row).SpecialCells(xlCellTypeVisible)
            For Each cel In rngVisible
                Range("C" & cel.Row).Value = intEntry
            Next
        Next
        .AutoFilter
    End With
    
    Application.ScreenUpdating = True

End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Martin,
                                    
                                    Excellent...thanks so much! Before I mark the above as the solution, I noticed the code was missing the 'End Sub' at the end. Did you want to add this line, or should I mark the above as the solution as is, since the missing line is noted here...?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">I updated the post.</pre>

<pre class="amctext">Thanks, Martin...i'm very pleased with the solution!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You’re welcome and I’m glad I was able to help.
                                    
                                    If you expand the “Full Biography” section of my profile you’ll find links to some articles I’ve written that may interest you.
                                    
                                    Marty - Microsoft MVP 2009 to 2017
                                                  Experts Exchange Most Valuable Expert (MVE) 2015, 2017
                                                  Experts Exchange Top Expert Visual Basic Classic 2012 to 2018
                                                  Experts Exchange Top Expert VBA 2018
                                                  Experts Exchange Distinguished Expert in Excel 2018</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example with solution manually entered (9 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/05_w19/1420303/EE_WO_Groupings.xlsm">EE_WO_Groupings.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Add another condition to an existing formula that supersedes the first condition</h2>
<p class="amcdate">2017-06-21T16:42:10-0400</p>

<pre class="amctext">I would like to add another condition to the current formula in Column C, which is based on the entry in Col B. The current formula is:
                          
                          =IFERROR(IF($B2="","",IF(RIGHT($B2,3)="YES","",TEXT(TODAY(),"dd mmm yyyy"))),"")
                          
                          The format for Col B is always:
                          AA-DD MMM YYYY-NO
                          or
                          AA-DD MMM YYYY-YES
                          
                          I would like to add the following condition to the above formula, based on the entry in Col E:
                          
                          If Col E = "Cancelled" OR "Deferred", then populate Col C with date from Col E (formatted as above — TEXT(TODAY(),"dd mmm yyyy")
                          
                          The format for Col E is always:
                          Cancelled-DD MMM YYYY
                          or
                          Deferred-DD MMM YYYY
                          
                          Lastly, if both Col B and Col E have entries, then I would like the date from Col E to be entered in Col C, not the date from Col B.
                          
                          I have attached a sample spreadsheet to show the results I am hoping for.
                          
                          Thanks!
                          Andrea
                          EE_Sample_TwoConditions.xlsx</pre>

<pre class="amctext">In your sample workbook Col C does not have a formula. Anyway, set the number format for Col C to General, then use this formula in C2:
                                    
                                    =IFERROR(IF(OR(LEFT(E2,9)="Cancelled",LEFT(E2,8)="Deferred"),RIGHT(E2,11),IF(RIGHT(B2,2)="NO",MID(B2,4,11),"")),"")
                                    
                                    Copy down as needed.</pre>

<pre class="amctext">BTW, if you want the dates to really be dates, and not just text values, set Col C to a custom number format of dd mmm yyyy and use this formula instead:
                                    
                                    =IFERROR(DATEVALUE(IF(OR(LEFT(E2,9)="Cancelled",LEFT(E2,8)="Deferred"),RIGHT(E2,11),IF(RIGHT(B2,2)="NO",MID(B2,4,11),""))),"")</pre>

<pre class="amctext">Hi Patrick,
                                    
                                    Thanks very much for the (super-quick) solution plus the tip on making it a real date value...much appreciated!
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w25/1177294/EE_Sample_TwoConditions.xlsx">EE_Sample_TwoConditions.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Need macro that changes contents of cell based on various conditions, and if conditions not met, then cell remains unchanged.</h2>
<p class="amcdate">2017-06-03T22:03:33-0400</p>

<pre class="amctext">I would like to have a macro called "Late_WOs" that does the following, based on the spreadsheet attached:
                          
                          If date in $B$5 is greater than 24-May-17 at 23:00 hrs AND if $K11 does not equal "89" or "99", then replace contents of $D11 with text string = "LATE". If conditions are not met, then no change to $D11 (original text string retained, or if $D11 was blank, then it remains blank).
                          
                          Thanks!
                          Andrea
                          EE.xls</pre>

<pre class="amctext">Try this...
                                    
                                    
                                    Sub Late_WOs()
Dim lr As Long
Dim rng As Range, cell As Range
Dim compDate As Date
lr = Cells(Rows.Count, "K").End(xlUp).Row
Set rng = Range("K11:K" & lr)
compDate = DateValue("24 May 2017") + TimeValue("23:00:00")
If Range("B5").Value > compDate Then
    For Each cell In rng
        Cells(cell.Row, "D").Select
        If cell = 89 Or cell = 99 Then
            Cells(cell.Row, "D") = "Late"
        End If
    Next cell
End If
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Subodh,
                                    
                                    Works great, thanks, with one minor tweak to Row 11  to align with the condition "AND if $K11 does not equal "89" or "99" ""
                                    
                                    
                                    If cell < > 89 Or cell < > 99 Then

                                    
                                      Select all
                                      Open in new window
                                    Thanks so much for the quick response! :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're welcome Andrea!
                                    Ah... it seems I misread the condition. Sorry!
                                    Glad you tweaked it to get the desired output.</pre>

<pre class="amctext">If I am not wrong, should it be
                                    
                                    If cell < > 89 And cell < > 99 Then

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Sorry, here' s correction to my revision to Row 11 above (changed 'Or' to 'And'):
                                    
                                    
                                    If cell < > 89 And cell < > 99 Then

                                    
                                      Select all
                                      Open in new window
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Hi Subodh,
                                    
                                    I should have refreshed before entering my last comment, and I would have seen that you already fixed my error! :-)
                                    
                                    Thanks for this correction!
                                    
                                    Andrea</pre>

<pre class="amctext">You're welcome Andrea! :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of spreadsheet (33 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w22/1166036/EE.xls">EE.xls</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Need macro to find WO#s meeting a condition, and populate a second sheet with the results</h2>
<p class="amcdate">2017-08-09T20:26:31-0400</p>

<pre class="amctext">Description of spreadsheets:
                          
                          
                            Sheet1, Col A contains a list of unique WOs.
                            Sheet2, Col A contains a list of WOs, some of which have duplicates. Not all WOs in Sheet1, Col A are listed in Sheet2, Col A.
                            If Sheet2, Col E is not blank, then it indicates that a QRY has been sent for that WO.
                          
                          
                          Macro required to do the following actions:
                          
                          
                            Index Sheet2, Col A for any instance of WO #s matching Sheet1, Col A and where Sheet2, Col E is not blank, and if found, then populate Sheet1, Col D for that WO# with "Yes"; otherwise Col D to be left blank.
                            If no matching WO#s found in Sheet2, Col A then Sheet1,Col D to be left blank.
                          
                          
                          I have attached a sample spreadsheet with the correct results entered in Sheet1, Col D.
                          
                          Thanks,
                          Andrea
                          EE_WO_QRY.xlsx</pre>

<pre class="amctext">Hi,
                                    
                                    pls try
                                    Sub macro()
Set rngSh1 = Range(Sheets("Sheet1").Range("A2"), Sheets("Sheet1").Range("A" & Rows.Count).End(xlUp))
Set rngSh2 = Range(Sheets("Sheet2").Range("A2"), Sheets("Sheet2").Range("A" & Rows.Count).End(xlUp).Resize(, 5))
For Each c In rngSh1
    res = Application.VLookup(c.Value, rngSh2, 5)
    If res <> "" Then
        c.Offset(, 3) = "Yes"
    End If
Next
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Regards</pre>

<pre class="amctext">Perfect...thanks, Rgonzo!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample Excel file (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w32/1186755/EE_WO_QRY.xlsx">EE_WO_QRY.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Summing multiple columns into a 'Total Minutes' column based on two text string criteria</h2>
<p class="amcdate">2017-07-29T08:12:53-0400</p>

<pre class="amctext">I need to add a summary column in a spreadsheet called "Linked", summing minutes from multiple columns with the following criteria:
                          If [WO_Change] column does not contain text string "Cancelled" or "Deferred", then in [Total_Minutes] column, sum minutes from [Minutes], [Minutes2] and [Minutes3]: otherwise, [Total_Minutes] column to be blank.
                          
                          In attempting to solve this I came up with the following formula in the [Total_Minutes] column, but got some whacky results:
                          
                          =SUM(SUMIF([WO_Change],{"<>*Cancelled*","<>*Deferred*"},([@Minutes]:[@Minutes3])))
                          
                          I  have attached a sample spreadsheet with the "Linked" tab as outlined above.
                          
                          Thanks,
                          Andrea
                          Sum_if_or_EE.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try below  in H2
                                    
                                    =IF(OR(ISNUMBER(SEARCH("*Cancelled",[@[WO_Change]])),ISNUMBER(SEARCH("*Deferred*",[@[WO_Change]]))),"",SUM([@Minutes]+[@Minutes2]+[@Minutes3]))

                                    
                                      Select all
                                      Open in new window
                                    Andrea_Sum_if_or_EE.xlsx</pre>

<pre class="amctext">Terrific! Thanks again, Shums - much appreciated!</pre>

<pre class="amctext">You're Welcome again Andrea! Its always a pleasure to help you :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of spreadsheet plus attempted solution (13 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w30/1184631/Sum_if_or_EE.xlsx">Sum_if_or_EE.xlsx</a></p>
<p class="amcfile">SumIF (13 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w30/1184636/Andrea_Sum_if_or_EE.xlsx">Andrea_Sum_if_or_EE.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Update Excel macro with variable criteria</h2>
<p class="amcdate">2017-08-02T13:00:38-0400</p>

<pre class="amctext">I have a macro that I run on a daily report. Within the macro code, there is a date that needs to be revised every two months for the macro to be effective. I would like to revise a macro if possible so that instead of having to edit the date in the VBA code every publication cycle, that a reference table is included within the VBA code.
                          
                          The current macro does the following:
                          
                          
                            Extracts the publication date from the text string in B4 and copies it into $C$5
                          
                          
                            If date in $B$5 is greater than the hard-coded cut-off date of 19-July-17 at 23:00 hrs AND if $K11 does not equal "89" or "99", then replace contents of $D11 with text string = "LATE". If conditions are not met, then no change to $D11 (original text string retained, or if $D11 was blank, then it remains blank).
                          
                          
                          Current macro code:
                          
                          Sub ProMS_Transfer_Late_WOs()
Dim lr As Long
Dim rng As Range, cell As Range
Dim compDate As Date
lr = Cells(Rows.Count, "K").End(xlUp).Row
Set rng = Range("K11:K" & lr)
compDate = DateValue("19 July 2017") + TimeValue("23:00:00")
Columns("B:B").ColumnWidth = 5
Columns("D:D").ColumnWidth = 32.43
Columns("F:F").ColumnWidth = 6
Columns("G:G").ColumnWidth = 42.14
Range("C5").Select
ActiveCell.FormulaR1C1 = "=TEXT(MID(R4C2,169,11),""dd-mmm-yyyy"")"
If Range("c5").Value > compDate Then
    For Each cell In rng
        Cells(cell.Row, "D").Select
        If cell <> 89 And cell <> 99 Then
            Cells(cell.Row, "D") = "LATE"
        End If
    Next cell
End If
End Sub

                          
                            Select all
                            Open in new window
                          
                          Desired revisions to current macro:
                          
                          
                             Determine the Cut-off Date for the Pub Date listed in $C$5 by finding the $C$5 pub date in the Pub Date list (see below)
                            
                              
                                The Cut-off Date associated with each Pub Date is listed in the column to the right of the Pub Date called Cut-off Date, in the same row
                              
                            
                            If report 'Execution' date (B5) is > than the determined Cut-off Date at 23:00 hrs AND if $K11 does not equal "89" or "99", then replace contents of $D11 with text string = "LATE". If conditions are not met, then no change to $D11 (original text string retained, or if $D11 was blank, then it remains blank).
                          
                          
                          Error handling:
                          If Publication Date in $C$5 is not found in the Pub Cycle list below, a message box pops up saying 'Pub Cycle date not found'.
                          
                          Here is the reference table of Pub Dates and associated Cut-off Dates:
                          Pub Date      Cut-off Date
                          17-Aug-17      24-May-17
                          12-Oct-17            19-Jul-17
                          07-Dec-17      13-Sep-17
                          01-Feb-18      08-Nov-17
                          29-Mar-18      03-Jan-18
                          24-May-18      28-Feb-18
                          19-Jul-18            25-Apr-18
                          13-Sep-18      20-Jun-18
                          08-Nov-18      15-Aug-18
                          03-Jan-19            10-Oct-18
                          28-Feb-19      05-Dec-18
                          25-Apr-19            30-Jan-19
                          20-Jun-19            27-Mar-19
                          15-Aug-19      22-May-19
                          10-Oct-19            17-Jul-19
                          05-Dec-19      11-Sep-19
                          
                          I have attached a sample of the report that the macro is run on.
                          
                          I hope I've provided enough detail and clarity. Just let me know if you need anything more.
                          
                          Thanks!
                          Andrea
                          EE_macro.xls</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try below:
                                    
                                    Sub ProMS_Transfer_Late_WOs()
Dim Ws As Worksheet
Dim LR As Long
Dim Rng As Range, c As Range
Dim CompDate As Date
Set Ws = Worksheets("PA01")
LR = Ws.Cells(Rows.Count, "K").End(xlUp).Row
Set Rng = Ws.Range("K11:K" & LR)
Application.ScreenUpdating = False
CompDate = Ws.Range("D5") + TimeValue("23:00:00")
Ws.Columns("B:B").ColumnWidth = 17.5
Ws.Columns("D:D").ColumnWidth = 10
Ws.Columns("F:F").ColumnWidth = 7
Ws.Columns("G:G").ColumnWidth = 42.14
Ws.Range("C5").FormulaR1C1 = "=TEXT(MID(R4C2,169,11),""dd-mmm-yyyy"")"
Ws.Range("D5").FormulaR1C1 = "=IFERROR(VLOOKUP(DATEVALUE(RC3),Table!C1:C2,2,0),""Pub Cycle date not found"")"
If Ws.Range("D5").Value = "Pub Cycle date not found" Then
    MsgBox "Pub Cycle date not found"
    Exit Sub
ElseIf Ws.Range("C5").Value > CompDate Then
    For Each c In Rng
        If Ws.Cells(c.Row, "K") <> 89 And Ws.Cells(c.Row, "K") <> 99 Then
            Ws.Cells(c.Row, "D").Value = "LATE"
        End If
    Next c
End If
Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Andrea_EE_macro.xlsm</pre>

<pre class="amctext">You don't need a table, it looks like they are all 85 days apart. If this is the case you can just modify your code like this:
                                    
                                    
                                    Sub ProMS_Transfer_Late_WOs()
    Dim lr As Long
    Dim rng As Range, cell As Range
    Dim compDate As Date, intYear As Integer, intMonth As Integer, intDay As Integer
    lr = Cells(Rows.Count, "K").End(xlUp).Row
    Set rng = Range("K11:K" & lr)
    'compDate = DateValue("19 July 2017") + TimeValue("23:00:00") This is not needed
    Columns("B:B").ColumnWidth = 5
    Columns("D:D").ColumnWidth = 32.43
    Columns("F:F").ColumnWidth = 6
    Columns("G:G").ColumnWidth = 42.14
    Range("C5").Select
    ActiveCell.FormulaR1C1 = "=TEXT(MID(R4C2,169,11),""dd-mmm-yyyy"")"
    ' added this part
    Set compDate = CDate(Range("C5").Value) 'not using the time yet
    Set intYear = Year(compDate)
    Set intMonth = Month(compDate)
    Set intDay = Day(compDate)
    Set compDate = DateSerial(intYear, intMonth, intDay - 85) + TimeValue("23:00:00") 'adding the time in here
    ' end of what I added
    If Range("c5").Value > compDate Then
        For Each cell In rng
            Cells(cell.Row, "D").Select
            If cell <> 89 And cell <> 99 Then
                Cells(cell.Row, "D") = "LATE"
            End If
        Next cell
    End If
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Shums and Mike,
                                    
                                    Thanks for your quick responses...much appreciated!
                                    
                                    Shums — I was testing your solution on some of my actual reports and found it wasn't working. In drilling down, I realize it's because my daily reports do not have the table in the second tab, so I get the 'Pub cycle not found' message box. I do store this macro in a Personal.xlsb file. Is it possible for me to add the table tab into that file instead, and have the macro code reference it in that location, since the Personal.xlsb file will always be open and available?
                                    
                                    Mike — I ran your macro and got the following error:
                                    Compile error: Object required, and 'compDate' on line 15 was highlighted
                                    I wasn't sure what that meant...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">If you don't need prompt "Pub Cycle not found" message, then follow Mike's code as corrected below:
                                    
                                    Sub ProMS_Transfer_Late_WOs()
Dim Ws As Worksheet
Dim LR As Long
Dim Rng As Range, c As Range
Dim CompDate As Date, IntYear As Integer, IntMonth As Integer, IntDay As Integer
Set Ws = Worksheets("PA01")
LR = Ws.Cells(Rows.Count, "K").End(xlUp).Row
Set Rng = Ws.Range("K11:K" & LR)
Application.ScreenUpdating = False
Ws.Range("C5").FormulaR1C1 = "=TEXT(MID(R4C2,169,11),""dd-mmm-yyyy"")"
CompDate = CDate(Ws.Range("C5").Value)
IntYear = Year(CompDate)
IntMonth = Month(CompDate)
IntDay = Day(CompDate)
CompDate = DateSerial(IntYear, IntMonth, IntDay - 85) + TimeValue("23:00:00")
Ws.Columns("B:B").ColumnWidth = 17.5
Ws.Columns("D:D").ColumnWidth = 10
Ws.Columns("F:F").ColumnWidth = 7
Ws.Columns("G:G").ColumnWidth = 42.14
If Ws.Range("C5").Value > CompDate Then
    For Each c In Rng
        If Ws.Cells(c.Row, "K") <> 89 And Ws.Cells(c.Row, "K") <> 99 Then
            Ws.Cells(c.Row, "D").Value = "LATE"
        End If
    Next c
End If
Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Shums,
                                    
                                    Thanks for the second solution. It worked fine for the 12-Oct-2017 Pub Date, but when I tested it on the 07-Dec-2017 Pub Date (which has a Cut-off Date of 13-Sep-2017) with a report 'Execution' date in B5 of 07-Sep-2017, it interpreted the work orders as late. Just to confirm:
                                    
                                    If 'Execution' date (B5) of report is < or = to Cut-off Date at 23:00, no work orders are converted to LATE as described above.
                                    If 'Execution' date (B5) of report is > Cut-off Date at 23:00, work orders that do not have '89' or '99' in Col K are converted to LATE as described above.
                                    
                                    I have attached the test DEC report in case that helps.
                                    
                                    Thanks,
                                    Andrea
                                    Test-Report_DEC.xls</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    I tried and it worked...try attached...
                                    Test-Report_DEC.xlsm</pre>

<pre class="amctext">Hi Shums,
                                    
                                    Just to confirm what's not working at my end: the work orders in the test DEC report are being changed to LATE , and they should not be.
                                    
                                    In the DEC report, B5 date (07-Sep-2017)  is < the DEC Cut-off date of 13-Sep-2017, so the macro should not change any work orders to LATE. When I run the macro, however, the work orders are being changed to LATE.
                                    
                                    Hope that helps...
                                    
                                    Andrea</pre>

<pre class="amctext">Try attached...
                                    Test-Report_DEC.xlsm</pre>

<pre class="amctext">Hi Shums,
                                    
                                    I tried your latest version and it appears to be doing the same thing as the previous version: identifying the work orders as LATE when, in fact, they are not, since the cut-off date for 07-DEC-2017 is 13-Sep-2017, and the B5 date in the test report is 07-Sep-2017. The reason I am testing this scenario is to ensure the macro will work correctly when run anytime, and only changing work orders to LATE if the report execution date is > than the cut-off date.
                                    
                                    Maybe we can return to your first solution provided in the file called "Andrea_EE_macro" , in which the code inserted the correct 'Cut-off Date' into D5. The only challenge with that solution was having the table in the report because my daily reports will not have the table in them. I do store this macro in a Personal.xlsb file. Is it possible for me to add the table tab into that file instead, and have the macro code reference it in that location, since the Personal.xlsb file will always be open and available?
                                    
                                    I'm sorry this is taking up so much of your time. I hope I am being clear enough in my feedback...
                                    
                                    Andrea</pre>

<pre class="amctext">Hi Shums,
                                    
                                    I just noticed that the following line of macro code referred to "C5", which is the Pub Date and not the report Execution date. So I tested revising the code to "B5", and it's working:
                                    
                                    I changed this line:
                                    If Ws.Range("C5").Value > CompDate Then
                                    
                                    To read:
                                    If Ws.Range("B5").Value > CompDate Then
                                    
                                    So thanks very much for your patient work on this solution! I will close the question, and share the points to acknowledge both you and Mike's much appreciated contributions.
                                    
                                    Cheers
                                    Andrea</pre>

<pre class="amctext">Thanks for your approach, Mike, and for taking it through to completion, Shums!</pre>

<pre class="amctext">Glad it worked out and sorry for not being able to return to this question sooner to help more.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample report that macro is used for (34 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185361/EE_macro.xls">EE_macro.xls</a></p>
<p class="amcfile">VBA (21 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185382/Andrea_EE_macro.xlsm">Andrea_EE_macro.xlsm</a></p>
<p class="amcfile">DEC report not returning correct results after macro run (25 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185409/Test-Report_DEC.xls">Test-Report_DEC.xls</a></p>
<p class="amcfile">VBA (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185413/Test-Report_DEC.xlsm">Test-Report_DEC.xlsm</a></p>
<p class="amcfile">VBA (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185437/Test-Report_DEC.xlsm">Test-Report_DEC.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Using conditional formatting in Excel to identify late responses to inquiries</h2>
<p class="amcdate">2018-05-30T11:13:53-0400</p>

<pre class="amctext">To identify late responses to inquiries during our production cycle, I would like to apply conditional formatting in my Excel spreadsheet based on the following conditions. I have attached a sample spreadsheet to illustrate the examples. 
                          
                          Conditional formatting:
                          If Column G or Column K is not blank, then Column F, Column J = no color
                          If Column F date is <= 5 networkdays from today's date, then Column F cell = no color
                          If Column F date is > 5 networkdays from today's date, and Column J is blank, Column F cell = pink
                          If Column F date is > 5 networkdays from today's date, and Column J has a date > 5 networkdays from today's date, Column F and Column J cells = pink
                          If Column F date is > 5 networkdays from today's date, and Column J has a date <= 5 networkdays from today's date, Column F cell = pink, Column J cell = no color
                          
                          Thanks!
                          Andrea
                          EE_Example.xlsx</pre>

<pre class="amctext">1)  If Column G or Column K is not blank, then Column F, Column J = no color
                                    =OR(G2<>"",K2<>"")  
                                       Applies to: F2:F#;J2:J#
                                    
                                    2)  If Column F date is <= 5 networkdays from today's date, then Column F cell = no color
                                    =AND(F2>TODAY(),F2<=WORKDAY(TODAY(),5))
                                       Applies to: F2:F#
                                    
                                    3)  If Column F date is > 5 networkdays from today's date, and Column J is blank, Column F cell = pink
                                    =AND(F2>WORKDAY(TODAY(),5),J2="")
                                       Applies to: F2:F#
                                    
                                    4)  If Column F date is > 5 networkdays from today's date, and Column J has a date > 5 networkdays from today's date, Column F and Column J cells = pink
                                    =AND(F2>WORKDAY(TODAY(),5),J2>WORKDAY(TODAY(),5)
                                       Applies to: F2:F#;J2:J#
                                    
                                    5)  If Column F date is > 5 networkdays from today's date, and Column J has a date <= 5 networkdays from today's date, Column F cell = pink, Column J cell = no color
                                    =AND(F2>WORKDAY(TODAY(),5),J2<=WORKDAY(TODAY(),5)
                                       Applies to: F2:F#  with Pink
                                    
                                    =AND(F2>WORKDAY(TODAY(),5),J2<=WORKDAY(TODAY(),5)
                                       Applies to: J2:J#  with no colour
                                    
                                    Note: if all rules start in row 2, applies to range must also start in row 2. # refers to last row of required selection.</pre>

<pre class="amctext">Just to clarify, I have assumed that "5 days From Today's Date" is in the future.</pre>

<pre class="amctext">Hi Rob,
                                    
                                    Thanks for your quick response. Yes, 5 days from today's date is in the future. My rows start on row 3, so I adjusted the formulas accordingly. I got a couple of errors when entering about a parenthesis missing, and in looking over your other formulas, it appeared it was just a matter of adding the ")" at the end of the formulas, so I did that. 
                                    
                                    I updated my Example Excel file (as attached) with all the formulas listed above, but unfortunately am not getting the results of any cells turning pink. From there, I checked that the order in which I entered the conditions matched the list you provided, but it didn't seem to make a difference. 
                                    
                                    I wondered if you might have a look at my updated Excel spreadsheet to see if I did anything wrong at my end, as I can't seem to figure out why it isn't working.
                                    
                                    Thanks very much!
                                    Andrea
                                    
                                    
                                    Is it a matter of the order in which the conditions are entered
                                    EE_Example_CondFormat_Added.xlsx</pre>

<pre class="amctext">BTW, the cells I am applying conditional formatting to have data validation (dropdown to enter the day’s date). Would that be having an impact on the conditional formatting formulas working, by any chance?
                                    
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Firstly, apologies about the missing brackets; I had written the formulas on the fly as it were without using Excel so didn't get the brackets checked/confirmed as would have happened in Excel.
                                    
                                    See attached file.
                                    
                                    I have re-ordered the rules so all the pink formats come first and ticked the "Stop if true" option and have also made slight changes to the formulas to lock the reference to columns F, J & K but still to no avail.
                                    
                                    So I have copied the 5 rules to cells to the right of the data; for the format to occur the result has to be True. For all of those samples the only rule that gives true is a no-format rule. I have found an error in this rule, it was referring to F rather than G.
                                    
                                    Strictly speaking, the No-Format rules are not required; if the cells to which they apply have no format anyway the condition which results in True and gives no format will do nothing.
                                    
                                    Can you explain for each of the samples what you would expect and why?
                                    
                                    Thanks
                                    Rob
                                    EE_Example_CondFormat_Added.xlsx</pre>

<pre class="amctext">I am thinking that you might have misunderstood my question about 5 days from today being in the future.
                                    
                                    With your sample number 2 (2018-0002345) - the original query was dated 10 May, the SLA date was extended to 15 May. The extended date is more than 5 days ago so should be formatted pink. Is that correct??
                                    
                                    Based on that assumption, the rules have been reversed ("<TODAY -5" rather than ">TODAY+5") in the attached and the pink formatting is happening.
                                    EE_Example_CondFormat_Added.xlsx</pre>

<pre class="amctext">Hi Rob,
                                    
                                    Sorry, I did misunderstand your question! Reversing the rules aligns the formulas with what I was looking for.
                                    
                                    Thanks very much for supplying the updated spreadsheet with the rules on the right. It is very helpful as I go through the various scenarios.
                                    
                                    I now have the answers I need...much appreciated! :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Thanks for the feedback.  You may have noticed that I added a condition on the front of each rule for column F not being blank; this avoids the blank rows included in the Applies To range being formatted.</pre>

<pre class="amctext">Hi Rob,
                                    Thanks for the helpful explanation...good to know...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of conditional formatting (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/05_w22/1323755/EE_Example.xlsx">EE_Example.xlsx</a></p>
<p class="amcfile">Original example with conditional formatting solutions entered (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/05_w22/1323957/EE_Example_CondFormat_Added.xlsx">EE_Example_CondFormat_Added.xlsx</a></p>
<p class="amcfile">Conditional Formatting (13 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/05_w22/1324421/EE_Example_CondFormat_Added.xlsx">EE_Example_CondFormat_Added.xlsx</a></p>
<p class="amcfile">Conditional Formatting (13 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/05_w22/1324434/EE_Example_CondFormat_Added.xlsx">EE_Example_CondFormat_Added.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Finding correct regular expression to batch rename 130 files</h2>
<p class="amcdate">2017-12-16T11:58:34-0500</p>

<pre class="amctext">I am using Adobe Bridge to batch rename 130 files in a folder. It can handle regular expressions, so I am looking for the correct expression to achieve the following:
                          
                          Original filename formats:
                          127155aaaa_58_Road to Cottage Lake Black.jpg
                          001000_Cottage Map.jpg
                          
                          Description of revised filename:
                          Starting from left of entire filename -- Retain first 3 numbers of original filename
                          Starting from the left of '.jpg' file extension -- retain all text and spaces to left, up to and including the first instance of "_"
                          Retain ".jpg" file extension
                          
                          Desired filename after batch renaming:
                          127_Road to Cottage Lake Black.jpg
                          001_Cottage Map.jpg
                          
                          I hope I've provided enough details.
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">This is a fairly complex regular expression.
                                    
                                    Easy to do in PERL.
                                    
                                    In Adobe... Whew... Likely best to rename each file with a set of regular expressions, each rename pruning cruft, till only your desired text remains in each file.
                                    
                                    Complex.
                                    
                                    I'd personally use PERL + have it work the first time.</pre>

<pre class="amctext">I have no idea what Regex engine uses Adobe Bridge.
                                    
                                    This *should* work:
                                    
                                    Search: 
(\d{3})(.*_)(.*\.jpg)

Replace: 
$1_$3

                                    
                                      Select all
                                      Open in new window
                                    
                                    HTH,
                                    Dan</pre>

<pre class="amctext">For some reason my comment didn’t show up, so I’ll write it again...
                                    
                                    You’re solution works perfectly, Dan - thanks very much!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Revise current Excel lookup formula to change source of lookup based on whether a specific column contains a date or not</h2>
<p class="amcdate">2018-10-08T13:10:50-0400</p>

<pre class="amctext">I am currently using the following LOOKUP formula in spreadsheet EE_Pub (columns N, O and P) to find 'last match' values in spreadsheet EE_Cat (columns J, K and L), unless the value in column K of EE_Cat spreadsheet = "No Change" or "CX'd" in which case it ignores these rows.
                          
                          =IFERROR(LOOKUP(2,1/('C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$I$2:$I$1200=$M2)/('C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$K$2:$K$1200<>"CX'd")/('C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$K$2:$K$1200<>"No Change"),'C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$J$2:$J$1200),"")
                          
                          I need to update the lookup formula to incorporate additional conditions:
                          
                          If Column L of EE_Cat spreadsheet (Stage_4) column is blank, use the current lookup formula that finds last match:
                          
                          =IFERROR(LOOKUP(2,1/('C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$I$2:$I$1200=$M2)/('C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$K$2:$K$1200<>"CX'd")/('C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$K$2:$K$1200<>"No Change"),'C:\Temp\[EE_Cat_Test.xlsx]Sheet1'!$J$2:$J$1200),"")
                          
                          If Column L of EE_Cat spreadsheet (Stage_4) column contains a date, then lookup formula needs to change from last match, to row that has the latest date in EE_Cat spreadsheet (Stage_4) column (based on Column M value in EE_Pub-Test spreadsheet as per the current lookup formula).
                          
                          Note that Column L is always formatted as: AA–08 Jan 16  13:02
                          
                          I have provided the two sample spreadsheets. I have highlighted the cells and included comments on the EE_Pub spreadsheet containing the results I am looking for with the updated formula.
                          
                          I hope I have provided sufficient information, and that it is clear enough...
                          
                          Thanks!
                          Andrea
                          EE_Cat.xlsx
                          EE_Pub-Test.xlsx</pre>

<pre class="amctext">Try this
                                    Formulas in columns R, S and T.
                                    It is array formulas.
                                    EE_Pub-Test.xlsx</pre>

<pre class="amctext">Hi Ejgil,
                                    
                                    Thanks very much for providing this solution. All the results in columns R, S and T looked good except, for some reason, in Row 8. I've added comments to the specific cells in Row 8 showing the desired result (as attached).
                                    
                                    BTW, can array formulas work in linked workbooks that are also shared? I know that shared spreadsheets are not recommended by this forum for good reason, and I apologize for this, but unfortunately our corporate environment use them (and I am not high enough up the food chain to change that policy). That being said, if the result in Row 8 is resolved using the array formulas you have provided, then I feel I should proceed to accept it as the solution for this question even if I can't use it, since I forgot to mention the shared, linked workbooks in my original question. If you can let me know if there is another solution that doesn't use array formulas, then I can post that as a separate question.
                                    
                                    I look forward to your feedback...
                                    
                                    Thanks,
                                    Andrea
                                    EE_Pub-Test_Solution.xlsx</pre>

<pre class="amctext">I don't know what the problem is with the values.
                                    On open the workbook show  this in row 8 "Unique_7 | CLR |CF–21 Dec 15  13:46"
                                    Changing links to the "EE-Cat.xlsx" file,  the values change to "Unique_89 |CLR | CF–06 Jan 16  13:02"
                                    That is the correct result.
                                    Do you link to another file?
                                    The file is not opened, so the array formulas work as link to the closed workbook.
                                    
                                    I have never used a shared workbook, so don't know how it will work.
                                    You have to try.
                                    
                                    The array formulas are because the dates are found in a text with the Datevalue formula, and that lead to error if the argument is not a datevalue.
                                    And blank cells are not a datevalue, so with If and Iserror statements errors are set to 0, and that require array formulas.
                                    If the values in column L in Cat file was real dates, the formula can be normal.
                                    See attached where the dates are in column M in Cat file, and the normal formula in column U in Pub file.
                                    The search is done on column M, but the results are from column L.
                                    
                                    Save both files in the same folder before opening, then the links should work.
                                    EE_Pub-Test_Solution-A.xlsx
                                    EE_Cat-A.xlsx</pre>

<pre class="amctext">Thanks very much, Ejgil, for your very helpful, detailed explanation, plus providing an alternative solution if the array formula isn't an option with a shared, linked spreadsheet...much appreciated!
                                    
                                    I will have my first opportunity tomorrow to go over your answer/Excel files in detail so I can respond...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Source file (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/10_w41/1391575/EE_Cat.xlsx">EE_Cat.xlsx</a></p>
<p class="amcfile">File with links to EE_Cat file (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/10_w41/1391576/EE_Pub-Test.xlsx">EE_Pub-Test.xlsx</a></p>
<p class="amcfile">Formulas (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/10_w41/1392026/EE_Pub-Test.xlsx">EE_Pub-Test.xlsx</a></p>
<p class="amcfile">Solution reviewed and comments added (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/10_w41/1392093/EE_Pub-Test_Solution.xlsx">EE_Pub-Test_Solution.xlsx</a></p>
<p class="amcfile">Normal formula (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/10_w41/1392339/EE_Pub-Test_Solution-A.xlsx">EE_Pub-Test_Solution-A.xlsx</a></p>
<p class="amcfile">Real dates (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/10_w41/1392340/EE_Cat-A.xlsx">EE_Cat-A.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Help with user form in Excel (combobox and linking entry to next available row in spreadsheet)</h2>
<p class="amcdate">2017-11-23T16:15:50-0500</p>

<pre class="amctext">I have created a user form called Time Tracker, and been able to link the first combobox (called cboIDList) to the range called ID.
                          
                          I am having difficulty with the next steps:
                          
                          
                            Autopopulating the combobox called cboPA_Unit, which is to be based on the value that users selects for cboIDList and references the range called PA_Unit.
                          
                          
                            Autopopulating the combobox called cboDesc, which is based on the value that users selects for cboIDList, and references the range called Description
                          
                          
                            Getting data of a completed user form to populate the next available row in a target spreadsheet
                          
                          
                          For example, if the user opens the user form and selects 2017-0001 in the dropdown for the ID combo box, then the PA Unit and Description combo boxes would both autopopulate with "Unit 1" and "Reduce Publication Files" respectively.
                          
                          The txtDate field should already be autopopulated with the current date:
                          
                          
                            I would like users to be able to edit the date if necessary, in case they were away and need to back date a record.
                          
                          
                          Once the user completes the form by entering a value in the 'Minutes' text box, then I would like the data from the form to populate the next available row in the spreadsheet called TrackingSheet as follows:
                          
                          TrackingSheet!Column A = reflects value entered in cboIDList
                          TrackingSheet!Column B = reflects value entered in cboPA_List
                          Tracking Sheet!Column C = reflects value entered in cboDesc
                          TrackingSheet!Column D = reflects value entered in txtDate
                          TrackingSheet!Column E = reflects value entered in txtMinutes
                          
                          If the user form is not completely filled out, then no data should be entered into the TrackingSheet.
                          
                          Description of my attached sample spreadsheet:
                          
                          Dynamic named ranges:
                          ID = Tasks!Column A
                          PA_Unit = Tasks! Column B
                          Description = Tasks!Column C
                          
                          I think I've covered it. I am new at user forms, so if you feel there are glaring issues or error handling that I should add, it would be very helpful to know.
                          
                          I have attached a sample spreadsheet with my user form completed thus far, as described above.
                          ProdMainTimeTracker.xlsm</pre>

<pre class="amctext">The first part is easy, Though I'm not quite sure why you are using comboboxes when there aren't multiple values.
                                    
                                    
                                    Private Sub cboIDList_Change()
Dim idx As Long

    With Me
        idx = .cboIDList.ListIndex
        
        If idx <> -1 Then
            .cboDesc.Value = Sheets("Tasks").Range("C" & idx + 2).Value
            .cboPA_Unit.Value = Sheets("Tasks").Range("B" & idx + 2).Value
        End If

    End With
    
End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    For the data part, you are already populating a textbox with the current date and the user can easily change that if they want.
                                    
                                    As for transferring the data from the userform to the sheet 'TrackingSheet', you could use this code,
                                    
                                    Dim NextRow As Long

    With Me
    
        If .cboIDList.Value = "" _
            Or .cboDesc.Value = "" _
            Or .cboPA_Unit.Value = "" _
            Or .txtDate = "" _
            Or txtMinutes = "" Then
            
            MsgBox "Form not completed!", vbCritical, "Incomplete"
            Exit Sub
        End If
    

        NextRow = Sheets("TrackingSheet").Range("A" & Rows.Count).End(xlUp).Row + 1
        Sheets("TrackingSheet").Range("A" & NextRow).Value = .cboIDList.Value
        Sheets("TrackingSheet").Range("B" & NextRow).Value = .cboPA_Unit.Value
        Sheets("TrackingSheet").Range("C" & NextRow).Value = .cboDesc.Value
        Sheets("TrackingSheet").Range("D" & NextRow).Value = .txtDate.Value
        Sheets("TrackingSheet").Range("E" & NextRow).Value = .txtMinutes.Value
        
    End With

                                    
                                      Select all
                                      Open in new window
                                     
                                    which I've put in the Click event of the command button cmdSave I've added to the userform in the attached file.
                                    ProdMainTimeTracker-with-Save-butto.xlsm</pre>

<pre class="amctext">Terrific - thanks very much, Norie!
                                    
                                    I will change the combo boxes, since they aren't necessary, as you mentioned. The one thing I realized as I tested is that I should have included the clearing of the form of data after clicking the 'Save' button as part of the criteria. I'll see if I can figure that out. :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Thanks for the quick response...</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">User form so far (19 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w47/1212332/ProdMainTimeTracker.xlsm">ProdMainTimeTracker.xlsm</a></p>
<p class="amcfile">Original file updated with save button added to userform. (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w47/1212338/ProdMainTimeTracker-with-Save-butto.xlsm">ProdMainTimeTracker-with-Save-butto.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Dynamic named range question related to Excel user form combo box</h2>
<p class="amcdate">2018-04-02T16:19:47-0400</p>

<pre class="amctext">I've created an Excel user form to track time spent on projects. Each employee will have their own User Form workbook. Each workbook will have a 'Tasks' list linked to a single Master Project List so that everyone has the same list of projects within their User Form workbook.
                          
                          DESCRIPTION OF WORKBOOK WITH USER FORM:
                          User form: Opens when workbook opens, or when 'Add a record' button is clicked, and is the form employees use to enter the project name and # of minutes worked on it. The 'Task' field is a combo box, pulling from a dynamically named range as described under 'Tasks' tab below.
                          Tracking sheet tab: A hidden spreadsheet that is updated by entering records in the User Form
                          Tracking view tab: The employee view (read-only) of records, populated from the hidden tracking sheet as described in previous line
                          Tasks tab:
                          
                          
                            Linked to a 'Master Project List' spreadsheet so it will update whenever new projects are added to the Master Project List
                          
                          
                            There is a dynamic named range on the Tasks tab called "TaskList" that serves as the dropdown list for the User Form's combo box called cboTask. It includes a number of 'blank' linked rows originating from the Master Project List that serve as placeholders so that the list of projects in the Tasks tab will update as soon as they are added to the Master Project List
                          
                          
                            The Master Task List resides as a separate workbook, but for the purposes of posting this question on EE, I have added it as a tab to this workbook
                          
                          
                          CHALLENGE:
                          On the User Form is a combo-box listing the projects. Because of the dynamic named range including the blank placeholder rows as described above, these rows show up in the drop down box and can be accidentally selected. When a blank row is accidentally selected, it populates the following fields with "0":
                          
                          
                            Task
                          
                          
                            ID
                          
                          
                            Product/Unit
                          
                          
                          DESIRED SOLUTION(S):
                          Is there any way that the dynamic named range on the 'Tasks' tab called TaskList can be set to ignore the rows that have links but are not populated with data, so that the combo box dropdown on the User Form is limited to showing the projects, and not also all the blank placeholder rows?
                          
                          
                          If the above is not possible, then is there a way to update the existing error-handling for the 'Save' button such that if the cboTask = 0, then it would trigger the error message? I attempted this myself, but did not have success.
                          
                          Please let me know if you have any questions or need clarification on any details...
                          
                          Thanks!
                          Andrea
                          Task_Plan_AC.xlsm</pre>

<pre class="amctext">Where is the data in the Master Task List coming from, is it manually inputted?</pre>

<pre class="amctext">Hi Mason,
                                    
                                    Yes, the Master Task List is manually updated as new projects come online...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">The blank rows are a poor idea. Why not simply sort the source as it is entered.</pre>

<pre class="amctext">I've just looked at your WorkBook and you have a Table for the Tasks, so I can see no advantage in using a Named Range. Tables are Dynamic anyway.
                                    
                                    Providing that the format is correct then this will do what you want
                                    Task_Plan_AC.xlsm</pre>

<pre class="amctext">I've amended the code for the Status combo, note I have removed all unused rows in the Table.
                                    
                                    Now the zeros do not appear in cboStatus
                                    
                                    Also, removed TaskList
                                    Task_Plan_AC.xlsm</pre>

<pre class="amctext">Hi Roy,
                                    
                                    Thanks for your replies. I've tried out the updated file, and unfortunately ran into a few issues. 
                                    
                                    The 'Tracking View" tab (not the "Tasks" tab) is meant to be the active spreadsheet for the employee. It provides read-only views of their saved records, and has the button to re-activate the User Form if/ as needed (as the employee can choose to cancel the User Form to view their read-only records). When I opened the file, the tab that was active was the "Tasks" tab. When I switched to the "Tracking View" tab and clicked on 'Add a Record' button to open the User Form and select an item from the Task drop down, the drop down menu did not contain the list of tasks, as shown below:
                                    
                                    
                                    I then tested the User form, and when I tried to save a record, I received an error message "Run-time error 438". The default date in the user form was 30-Dec-99 instead of the current date (is that actually a zero value in a date format, which perhaps is causing the error message?).
                                    
                                    
                                    Please let me know if you have any questions about my feedback...
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">I've only answered the question relating to the combobox. I haven't changed or looked at the other code.I'll have a look at the rest of the code.
                                    
                                    The workbook opened on the last used sheet, which is how Excel works. If you need it to always open on a specific sheet then you require code to force that to happen.</pre>

<pre class="amctext">Is this right now?
                                    Task_Plan_AC.xlsm</pre>

<pre class="amctext">Hi Roy,
                                    
                                    Thanks for your helpful tip on ensuring that the spreadsheet opens on a specific tab.
                                    
                                    I opened your latest file, and the default date is working fine now - thanks!
                                    
                                     I then tested out entering a record, and noticed that unfortunately the drop down for the combo box is still problematic, as shown in the screen capture below. I've also included a second screen capture of how the drop down should look:
                                    
                                    
                                    Andrea</pre>

<pre class="amctext">Slight modification made. I hadn't allowed for you opening the userform on a different sheet.
                                    
                                    Note the other Tables don't need those empty rows.
                                    Task_Plan_AC--1-.xlsm</pre>

<pre class="amctext">I,m not a big fan of hiding the Application but I've added an error handler in case problems occur loading the form. Without this if an error occurs then the application will remain invisible. I can't actually see any need for it in the Open event of the userform.
                                    
                                    Also, your code opens the userform to the right of my screen, is this what you intended?</pre>

<pre class="amctext">Hi Roy,
                                    
                                    Yes, having the userform open to the right is intentional. Thanks for your replies. I just got back from being out of town so haven’t had a chance to review your most recent feedback, but will have time tomorrow evening to do so and get back to you...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">No problem</pre>

<pre class="amctext">Hi Roy,
                                    
                                    I'm sorry about the delay in getting back to you. I tested out the latest file, and there are a couple of issues:
                                    
                                    1. I am receiving a runtime error when trying to save a record. 
                                    2. The combo box still shows the blank rows below the list of tasks, which can be selected, populating 3 fields with zeroes.
                                    
                                    
                                    
                                    I do appreciate your efforts, Roy. I suspect that how I have set this workbook up in the first place is causing problems that may not be fixable...? My idea of setting up the combo box that references a dynamically named range, that in turn links to an external spreadsheet may be fundamentally problematic. I am not savvy enough in Excel to determine this, but at this point maybe it's best to abandon my idea. Perhaps you can advise?
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">the debugging error occurs because you haven't assigned a value to NextRow before saving.
                                    
                                    The empty rows are because you have empty rows in the source Table, the only way around this would be to have a separate table for each ComboBox</pre>

<pre class="amctext">Thanks for all your help with this, Roy. I have the answers I need to proceed...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Let me know if you need further help. I can split the Table and use two for populating the comboboxes if you want.</pre>

<pre class="amctext">I've split the Table and removed the empty rows on the ComboBox
                                    Task_Plan_AC--1---3-.xlsm</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of User Form workbook (439 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/04_w14/1293868/Task_Plan_AC.xlsm">Task_Plan_AC.xlsm</a></p>
<p class="amcfile">Task_Plan_AC.xlsm (413 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/04_w14/1294022/Task_Plan_AC.xlsm">Task_Plan_AC.xlsm</a></p>
<p class="amcfile">Task_Plan_AC.xlsm (379 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/04_w14/1294081/Task_Plan_AC.xlsm">Task_Plan_AC.xlsm</a></p>
<p class="amcfile">Task_Plan_AC.xlsm (380 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/04_w14/1294555/Task_Plan_AC.xlsm">Task_Plan_AC.xlsm</a></p>
<p class="amcfile">Task_Plan_AC--1-.xlsm (379 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/04_w14/1294995/Task_Plan_AC--1-.xlsm">Task_Plan_AC--1-.xlsm</a></p>
<p class="amcfile">Task_Plan_AC--1---3-.xlsm (384 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/04_w15/1296823/Task_Plan_AC--1---3-.xlsm">Task_Plan_AC--1---3-.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Macro to move columns in Excel and delete unnecessary rows and paste results into Word file</h2>
<p class="amcdate">2017-08-05T10:37:14-0400</p>

<pre class="amctext">We need to extract a table from a PDF document into Excel and clean it up by moving columns around and deleting unnecessary rows, and then paste the results into a new Word file. This task is done several times weekly, so we would like to create a macro to automate the task.
                          
                          Details:
                          
                          
                            The number of columns in Excel, and their position in the table may vary, but the column headings that we need are always named the same.
                          
                          
                            The Excel table will always reside in Sheet2.
                          
                          
                          Macro steps;
                          
                          
                            Move Column called IDENT to right of Column called NAME
                          
                          
                            Move Column called TYPE to right of Column called IDENT
                          
                          
                            Move Column called LATITUDE to right of Column called TYPE
                          
                          
                            Move Column called LONGITUDE to right of Column called LATITUDE
                          
                          
                            Remove all remaining columns to right of LONGITUDE that contain data
                          
                          
                            Under Column B (NAME) find first row with "-" in cell, and delete this entire row and all subsequent entire rows to last row containing any data
                          
                          
                            Copy the table, and then paste `as text only`, into a new Word file
                          
                          
                          I have attached a sample of the Excel table pre-cleanup.
                          
                          Thanks!
                          Andrea
                          EE_Table_Cleanup.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try below, it will save as word file with the name "WayPoint" in the same folder where you will save attached file:
                                    
                                    Option Explicit
Sub ColumnAdjustments()
Dim Ws As Worksheet
Dim LRow As Long, LCol As Long, FRow As Long
Dim MyCol As Variant, ColIndex As Integer
Dim ColFound As Range, ColCounter As Integer, CopyRng As Range
Dim AppWord As New Word.Application
Dim WordDoc As Word.Document

Set Ws = Worksheets("Sheet2")
MyCol = Array("NUM", "NAME", "IDENT", "TYPE", "LATITUDE", "LONGITUDE")
ColCounter = 1
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
    .Calculation = xlManual
End With

For ColIndex = LBound(MyCol) To UBound(MyCol)
    Set ColFound = Ws.Rows("1:1").Find(MyCol(ColIndex), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)
    If Not ColFound Is Nothing Then
        If ColFound.Column <> ColCounter Then
            ColFound.EntireColumn.Cut
            Ws.Columns(ColCounter).Insert Shift:=xlToRight
            Application.CutCopyMode = False
        End If
        ColCounter = ColCounter + 1
    End If
Next ColIndex
LRow = Ws.Range("A" & Rows.Count).End(xlUp).Row
LCol = Ws.Cells(1, Columns.Count).End(xlToLeft).Column
Ws.Range(Ws.Cells(1, 7), Ws.Cells(LRow, LCol)).Delete
Ws.Range("C1").End(xlDown).Offset(1).Resize(Ws.UsedRange.Rows.Count).EntireRow.Delete
Ws.Columns.AutoFit
LRow = Ws.Range("A" & Rows.Count).End(xlUp).Row
Ws.Range("A1:F" & LRow).Copy

AppWord.Visible = True
Set WordDoc = AppWord.Documents.Add

With WordDoc
    .Content.Paste
    .SaveAs Filename:=ThisWorkbook.Path & "\" & "Waypoint" & ".docx"
End With
Application.CutCopyMode = False
AppWord.Quit
Set WordDoc = Nothing
Set AppWord = Nothing
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Please make sure you have clicked Word Reference before running the code. Here is the link which will guide you how to get reference ticked :)
                                    Andrea_Table_Cleanup_v1.xlsm</pre>

<pre class="amctext">Super! Thanks so much, Shums! The only tweak I need is for the Excel data to be pasted into Word `as text` so it has a tabs between each value (so we can apply a paragraph style with the tab values already established)...</pre>

<pre class="amctext">Try below:
                                    
                                    Option Explicit
Sub ColumnAdjustments()
Dim Ws As Worksheet
Dim LRow As Long, LCol As Long, FRow As Long
Dim MyCol As Variant, ColIndex As Integer
Dim ColFound As Range, ColCounter As Integer, CopyRng As Range
Dim AppWord As New Word.Application
Dim WordDoc As Word.Document

Set Ws = Worksheets("Sheet2")
MyCol = Array("NUM", "NAME", "IDENT", "TYPE", "LATITUDE", "LONGITUDE")
ColCounter = 1
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
    .Calculation = xlManual
End With

For ColIndex = LBound(MyCol) To UBound(MyCol)
    Set ColFound = Ws.Rows("1:1").Find(MyCol(ColIndex), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)
    If Not ColFound Is Nothing Then
        If ColFound.Column <> ColCounter Then
            ColFound.EntireColumn.Cut
            Ws.Columns(ColCounter).Insert Shift:=xlToRight
            Application.CutCopyMode = False
        End If
        ColCounter = ColCounter + 1
    End If
Next ColIndex
LRow = Ws.Range("A" & Rows.Count).End(xlUp).Row
LCol = Ws.Cells(1, Columns.Count).End(xlToLeft).Column
Ws.Range(Ws.Cells(1, 7), Ws.Cells(LRow, LCol)).Delete
Ws.Range("C1").End(xlDown).Offset(1).Resize(Ws.UsedRange.Rows.Count).EntireRow.Delete
Ws.Columns.AutoFit
LRow = Ws.Range("A" & Rows.Count).End(xlUp).Row
Ws.Range("A1:F" & LRow).Copy

AppWord.Visible = True
Set WordDoc = AppWord.Documents.Add

With WordDoc
    .Content.PasteSpecial DataType:=wdPasteText
    .SaveAs Filename:=ThisWorkbook.Path & "\" & "Waypoint" & ".docx"
End With
Application.CutCopyMode = False
AppWord.Quit
Set WordDoc = Nothing
Set AppWord = Nothing
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                                    
                                      Select all
                                      Open in new window
                                    Andrea_Table_Cleanup_v2.xlsm</pre>

<pre class="amctext">I gave that a try, and tried it a couple of times, and it still seems to be pasting into Word as a table instead of text (so not with tabs between the data)...</pre>

<pre class="amctext">Sorry, just check the last one, you tried before refreshing the page :)</pre>

<pre class="amctext">Perfection!! Thanks a bunch, Shums, for a quick and excellent solution! :-)</pre>

<pre class="amctext">Very much appreciated, Shums!</pre>

<pre class="amctext">You're Welcome Andrea! Glad I was able to help :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of Excel table (9 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185932/EE_Table_Cleanup.xlsx">EE_Table_Cleanup.xlsx</a></p>
<p class="amcfile">Excel Automation (20 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185937/Andrea_Table_Cleanup_v1.xlsm">Andrea_Table_Cleanup_v1.xlsm</a></p>
<p class="amcfile">V2 (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/08_w31/1185940/Andrea_Table_Cleanup_v2.xlsm">Andrea_Table_Cleanup_v2.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel formula to count number of cells with fill color that contain text, and number of cells with no fill that do not contain text</h2>
<p class="amcdate">2018-02-08T18:02:30-0500</p>

<pre class="amctext">The attached spreadsheet uses conditional formatting to guide the data entry clerk in filling it out properly. 
                          
                          Column H and Column I have conditional formatting as follows:
                          
                          If Column F includes the word 'YES', then all subsequent columns should be completed (cells have no fill color)
                          If Column F includes the word 'NO', then conditional formatting then changes cell color in Col H and I to orange, indicating to the user that these cells should not be filled out.
                          
                          At the end of the production cycle, I would like to review the data entry for errrors. Specifically:
                          
                          Col H and Col I:
                          # of cells with no fill color that are blank (formula result should be 4 cells in Col H, 3 cells in Col I)
                          # of cells with fill color that are not blank (formula result should be 2 cells in Col H, 1 cell in Col I)
                          
                          Thanks,
                          Andrea
                          EE_ColorCells.xlsx</pre>

<pre class="amctext"># of cells with no fill color that are blank (formula result should be 4 cells in Col H, 3 cells in Col I)
                                    
                                    H: =SUMPRODUCT((RIGHT($F$2:$F$24,3)="YES")*(H$2:H$24=""))
                                    I: =SUMPRODUCT((RIGHT($F$2:$F$24,3)="YES")*(I$2:I$24=""))
                                    
                                    
                                      # of cells with fill color that are not blank (formula result should be 2 cells in Col H, 1 cell in Col I)
                                    
                                    H: =SUMPRODUCT((RIGHT($F$2:$F$24,2)="NO")*(H$2:H$24<>""))
                                    i: =SUMPRODUCT((RIGHT($F$2:$F$24,2)="NO")*(I$2:I$24<>""))</pre>

<pre class="amctext">Perfect! Thanks very much, Ejgil...
                                    
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/02_w06/1271485/EE_ColorCells.xlsx">EE_ColorCells.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Add criteria to existing formula that references another worksheet in Excel</h2>
<p class="amcdate">2018-03-01T15:27:30-0500</p>

<pre class="amctext">Column J in UDS! has the current formula:
                          =IF(LEN([@[Work_Order_ID]])<10,"Land Use","WO")
                          
                          I would like to revise the Column J formula as follows:
                          IF(LEN([@[Work_Order_ID]])<10,"Land Use"
                          If ([@[Work_Order_ID]]) is listed in PLAN10!Id (Column A), and the PLAN10!Close Work Order (Column E) = "Yes", then UDS!Type_Task (Column J) = "AFI"
                          Else
                          UDS!Type_Task (Column J) = "WO"
                          
                          I have attached a sample spreadsheet, and entered the results in red under UDS!Type_Task that I am hoping for.
                          
                          Thanks,
                          Andrea
                          EE_Example.xlsx</pre>

<pre class="amctext">See column K in attached
                                    EE_Example.xlsx</pre>

<pre class="amctext">Perfect, and a very quick turnaround! Thanks very much, Ejgil!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example file (26 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/03_w09/1280627/EE_Example.xlsx">EE_Example.xlsx</a></p>
<p class="amcfile">Formula (26 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/03_w09/1280645/EE_Example.xlsx">EE_Example.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Median formula not working</h2>
<p class="amcdate">2017-07-29T00:15:56-0400</p>

<pre class="amctext">I have an Excel spreadsheet called 'WO_Tracking'. There is another spreadsheet, called 'Linked', that is linked to 'WO_Tracking', and is formatted as an Excel table. There is a third spreadsheet called 'Summary' to serve as a dashboard for supervisors.
                          
                          In the Summary spreadsheet, in cell A2, I am trying to get the median (excluding cells with zero values) of Column F (Total Minutes) in the 'Linked' spreadsheets, using the following formula:
                          =MEDIAN(Table2[Total_Minutes])
                          
                          But I am only getting '0' as a result. 
                          
                          I have provided a sample workbook with all three spreadsheets included. The formula needs to be based on the 'Linked' spreadsheet, not the 'WO_Tracking' spreadsheet.
                          
                          Thanks!
                          Andrea
                          Linked_Spreadsheet_Median_Formula_E.xlsx</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Replace your formula in summary sheet with this: =MEDIAN(IF(Table2>0,Table2)).
                                    
                                    Best regards.</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Please try below Array Formula confirmed with Ctrl+Shift+Enter:
                                    
                                    =MEDIAN(IF(Table2[Total_Minutes]>0,Table2[Total_Minutes]))

                                    
                                      Select all
                                      Open in new window
                                    Andrea_Linked_Spreadsheet_Median.xlsx</pre>

<pre class="amctext">Hi Yamaafg,
                                    
                                    Thanks for responding to my question. I tried your solution but got the same result of "0" as I was getting with my formula.
                                    
                                    Andrea</pre>

<pre class="amctext">Works like a charm -- thanks so much, Shums! :-)</pre>

<pre class="amctext">You're welcome Andrea! Pleased to help :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Median formula (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w30/1184599/Linked_Spreadsheet_Median_Formula_E.xlsx">Linked_Spreadsheet_Median_Formula_E.xlsx</a></p>
<p class="amcfile">Median Formula (15 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w30/1184611/Andrea_Linked_Spreadsheet_Median.xlsx">Andrea_Linked_Spreadsheet_Median.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Refining my clunky SUMIF formula referencing an Excel table</h2>
<p class="amcdate">2017-06-11T09:58:18-0400</p>

<pre class="amctext">I am just learning to work with formulas in Excel tables. The following formula that I created works, but seems clunky having to duplicate the range criteria, and I have not been able to successfully streamline it:
                          
                          =SUMIF(Table1[WO1],$A2,Table1[WO1_Process_Min])+SUMIF(Table1[WO1],$A2,Table1[WO1_RWK_Min])
                          
                          My attempts have caused errors in the sum_range:
                          
                          =SUMIF(Table1[WO1],$A299,Table1[@[WO1_Process_Min]],[@[WO1_RWK_Min]])
                          
                          Is it possible to simplify the formula so that SUMIF only has to be entered once?
                          
                          Thanks,
                          Andrea</pre>

<pre class="amctext">try use SUMIFS function instead of SUMIF.
                                    
                                    SUMIFS function allows you to put multiple criteria</pre>

<pre class="amctext">if you need to sum 2 different columns, you will need to use the "+" operator</pre>

<pre class="amctext">I've attached a sample of the workbook. Sheet1 contains the Excel table. Sheet2 is a roll-up of Sheet1, which is to sum all the minutes worked per work order (1 through 5). I've started by totalling WO1, and Sheet2, Col B contains the formula that I am trying to simplify:
                                    
                                    =SUMIF(Table1[WO1],$A2,Table1[WO1_Process_Min])+SUMIF(Table1[WO1],$A2,Table1[WO1_RWK_Min])
                                    
                                    Hope this helps,
                                    
                                    Andrea
                                    EE_SUMIF.xlsm</pre>

<pre class="amctext">well, i guess your original formula could be the simplest based on your requirements and it cannot be further simplified since you're summing 2 different ranges.
                                    
                                    
                                    =SUMIF(Table1[WO1],$A2,Table1[WO1_Process_Min])+SUMIF(Table1[WO1],$A2,Table1[WO1_RWK_Min])

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">This is the formula using SUMIF for your WO1
                                    
                                    =SUMIF(Table1[WO1],"="&$A2,Table1[[WO1_Process_Min]:[WO1_RWK_Min]])

                                    
                                      Select all
                                      Open in new window
                                    
                                    and this one is for all your WO's as you indicated in your question you will see the total in Col C of sheet2
                                    
                                    =SUMIF(Table1[WO1],"="&$A2,Table1[[WO1_Process_Min]:[WO5_RWK_Min]])

                                    
                                      Select all
                                      Open in new window
                                    
                                    check Col D
                                    
                                    I put in Col C the total as you did for each column to verify its the same as D
                                    
                                    chk the file
                                    gowlfow
                                    EE_SUMIF-V01.xlsm</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try below formula in B2 and drag down:
                                    
                                    =SUMPRODUCT(Table1[[WO1_Process_Min]:[WO1_RWK_Min]]*(Table1[WO1]=A2))

                                    
                                      Select all
                                      Open in new window
                                    Andrea_EE_SUMIF.xlsm</pre>

<pre class="amctext">Works perfectly - thanks, Shums!
                                    
                                    Thanks, Gowflow, for your response - in reviewing it for WO1 it appeared to give me the total minutes for [WO1_Process_Min] only, and didn't include the RWK minutes. For my purposes, I needed the separate totals for each of the 5 WOs.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Very pleased. :-)</pre>

<pre class="amctext">You're Welcome Andrea! Pleased to help :)</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of SUMIF formula (3.2 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w24/1167630/EE_SUMIF.xlsm">EE_SUMIF.xlsm</a></p>
<p class="amcfile">EE_SUMIF-V01.xlsm (3.2 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w24/1167636/EE_SUMIF-V01.xlsm">EE_SUMIF-V01.xlsm</a></p>
<p class="amcfile">Multiple Range Sum (3.2 MB) <a href="https://filedb.experts-exchange.com/incoming/2017/06_w24/1167637/Andrea_EE_SUMIF.xlsm">Andrea_EE_SUMIF.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Need to make Excel 'isnumber search' formula case sensitive</h2>
<p class="amcdate">2017-11-02T10:49:46-0400</p>

<pre class="amctext">I have a conditional formatting formula that changes a cell color in Column H based on if the cell in Column F contains "NO":
                          
                          Format of Column F data:
                          AA–DD MMM YY–YES or  AA–DD MMM YY–NO
                          
                          Examples of Column F data:
                          MC–13 Oct 17–YES
                          MC–14 Oct 17–YES
                          MC–31 Oct 17–NO
                          
                          Conditional Format formula:
                          
                          =ISNUMBER(SEARCH("*NO*",$F2))

                          
                            Select all
                            Open in new window
                          
                          This formula has been working fine until we hit November, whereby the month also contains "No" so the formula is no longer working properly:
                          MC–01 Nov 17–YES
                          MC–01 Nov 17–NO
                          
                          I need to revise the conditional format formula so it is case sensitive, so it only detects 'NO' in all capital letters:
                          
                          =ISNUMBER(SEARCH("*NO*",$F2))  'this formula needs to be case sensitive, detecting only 'NO' and not 'No'

                          
                            Select all
                            Open in new window
                          
                          I have attached a sample spreadsheet.
                          
                          Thanks!
                          Andrea
                          CaseSensitive_Search_IsNumber_EE.xlsm</pre>

<pre class="amctext">for case sensitive replace the SEARCH function with FIND function</pre>

<pre class="amctext">If the cell contents will always be in the format that the contents end with Yes or No then you don't need to use the SEARCH or FIND function.
                                    
                                    See screenshot below showing the format.</pre>

<pre class="amctext">i modified the conditonal formatting on sheet  WO_List
                                    
                                    see attached.
                                    
                                    also with FIND you do not need to use asterisks 
                                    
                                    just put  =ISNUMBER(FIND("NO",$F2))
                                    CaseSensitive_Search_IsNumber_EE.xlsm</pre>

<pre class="amctext">Thanks to you both for responding so quickly with solutions! While Rob's solution worked for this specific instance, I also appreciated the versatility of Jim's formula in case the format in Column F changes so that 'NO' and 'YES' are no longer at the end of the string (a very likely scenario in the near future, actually), so thought it best to share the points. Hope that works for everyone! :-)
                                    
                                    Best regards,
                                    Andrea</pre>

<pre class="amctext">Glad to be of help.</pre>

<pre class="amctext">You're welcome</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample spreadsheet (24 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w44/1202779/CaseSensitive_Search_IsNumber_EE.xlsm">CaseSensitive_Search_IsNumber_EE.xlsm</a></p>
<p class="amcfile">CaseSensitive_Search_IsNumber_EE.xlsm (23 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w44/1202784/CaseSensitive_Search_IsNumber_EE.xlsm">CaseSensitive_Search_IsNumber_EE.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Enabling Excel user form to scroll to previous records + hiding application</h2>
<p class="amcdate">2017-12-05T20:59:25-0500</p>

<pre class="amctext">I am working on an Excel user form, and have created a form that enters data into a sheet called 'TrackingSheet'. I would like to make the following enhancements:
                          
                          
                            Have only the user form visible, and not the Excel application.
                            Enable the user to scroll back to previous records within the user form (read-only view)
                          
                          
                          I have attached the user form I have created.
                          
                          Thanks,
                          Andrea
                          ProdMainTimeTracker_EE.xlsm</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try attached...
                                    
                                    Before clicking Previous or Next Button, select any item from List Box. Will this work for you?
                                    Andrea_Mary_ProdMainTimeTracker_EE.xlsm</pre>

<pre class="amctext">@Shums: One suggestion - your code hides the Excel application permanently. When I re-opened it, the application crashed.
                                    
                                    You may need to add to your "cancel" button something like
                                    
                                    
                                    Private Sub cmdCancel_Click()
    Unload Me
    ThisWorkbook.Close SaveChanges:=True
   'RESTORE EXCEL VISIBILITY>>>
    Application.Visible = True
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">@ Neil,
                                    
                                    It doesn't crash here :) I tried many times before uploading final version. I haven't used Application.Visible = True or hiding Excel Application completely as probably Andrea doesn't wanted user to know if its Excel.
                                    
                                    I just noticed date format was not displaying properly :)
                                    Andrea_Mary_ProdMainTimeTracker_EE.xlsm</pre>

<pre class="amctext">Very cool, Shums, thanks so much for this!!
                                    Cheers,
                                    Andrea
                                    BTW, if I want to view the VBA for the form, how do I access it?</pre>

<pre class="amctext">Andrea,
                                    
                                    Once you open this file, open another excelfile. You will be able to see developer tab even userform is on top view.</pre>

<pre class="amctext">:) ah OK. Maybe I had put Excel into an unstable state some other way... quite likely ...</pre>

<pre class="amctext">Thanks, Shums, for letting me know how to access the developer tab...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">User form (26 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w49/1213943/ProdMainTimeTracker_EE.xlsm">ProdMainTimeTracker_EE.xlsm</a></p>
<p class="amcfile">UserForm (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w49/1214187/Andrea_Mary_ProdMainTimeTracker_EE.xlsm">Andrea_Mary_ProdMainTimeTracker_EE.xlsm</a></p>
<p class="amcfile">UserForm (27 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/12_w49/1214244/Andrea_Mary_ProdMainTimeTracker_EE.xlsm">Andrea_Mary_ProdMainTimeTracker_EE.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">In Excel, find last column with value > 0 and populate column M with the date listed in the heading row of the last column</h2>
<p class="amcdate">2017-10-24T15:21:01-0400</p>

<pre class="amctext">I need to identify the last date that each work order was worked on. To do so, I need a formula in Column M as follows:
                          
                          
                            For each row in Column M in Sheet1 of spreadsheet, find the last column between Col B and Col L that has a value > 0, and then enter the date listed in the heading row of the last column into the cell of the corresponding row under Column M.
                          
                          
                          I have attached a sample spreadsheet and have populated the desired results in red in Column M, as well as shaded the corresponding 'last column' cells in green to illustrate what I am after.
                          
                          Thanks!
                          Andrea
                          EE_Last_Date.xlsx</pre>

<pre class="amctext">Place this formula in M3 and then copy down as far as needed.
                                    
                                    
                                    =LOOKUP(2,1/(B3:L3<>0),B$1:L$1)

                                    
                                      Select all
                                      Open in new window
                                    
                                    »bp</pre>

<pre class="amctext">Perfect - thanks very much, Bill!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample file with desired results (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201174/EE_Last_Date.xlsx">EE_Last_Date.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Word macro that references an Excel file to update work order numbers</h2>
<p class="amcdate">2019-02-16T10:41:26-0500</p>

<pre class="amctext">I would like a macro for Word 2016 that searches through the file for each work order number, then checks for the work order number in Column A of an Excel list, and if found, then replaces the work order number in the Word file based on the value listed in Column C of the Excel list. (Column C is a formula that concatenates Column A [the work order number] and Column B [initials]).
                          
                          Additional notes:
                          
                          
                            Excel spreadsheet is in a table format
                          
                          
                            Column A and Column C are dynamic named ranges, as the number of work orders listed in the spreadsheet will change/fluctuate
                          
                          
                            I would like the original formatting of the work order number in Word to be retained when the work order number is updated in the file.
                          
                          
                            If the work order is not found in Column A of the Excel file, then no action is required in the Word file.
                          
                          
                          The format of the work order number is:
                           ####-####### (4 numbers, followed by a dash, then 7 numbers)
                          
                          I have attached the following files:
                          1. Cycle_Changes_Depot.docx
                          2. WO_Initials_List.xlsm
                          3. Cycle_Changes_Depot_After_Update.docx (this is an example file of the results I am looking for after the macro is run)
                          
                          I hope I've included all the relevant information/files. Please let me know if you have any questions or need anything further.
                          
                          Thanks!
                          Andrea
                          Cycle_Changes_Depot.docx
                          Cycle_Changes_Depot_After_Update.docx
                          WO_Initials_List.xlsm</pre>

<pre class="amctext">It isn't clear which file is meant in the first sentence, so this Excel-hosted macro will simply step throught the sheet and modify the input document.
                                    
                                    Sub AugmentWO()
    Dim wdApp As Word.Application
    Dim wdDoc As Word.Document
    Dim strWO As String
    Dim strConcatenate As String
    Dim xlWks As Excel.Worksheet
    Dim r As Integer
    Dim strWordFile As String
    
    Set xlWks = Sheets("WO_Initial")
    r = 2
    
    'create a word application instance if necessary
    On Error Resume Next
        Set wdApp = GetObject(, "Word.Application")
    On Error GoTo 0
    If wdApp Is Nothing Then
        Set wdApp = CreateObject("Word.Application")
    End If
    
    'open the document
    strWordFile = "J:\Allwork\ee\29136233\Cycle_Changes_Depot.docx"
    Set wdDoc = wdApp.Documents.Open(strWordFile)
    
    'do find and replace for each valid row of the sheet
    Do
        strWO = xlWks.Cells(r, 1)
        strConcatenate = xlWks.Cells(r, 3)
        r = r + 1
        With wdDoc.Range.Find
            .Text = strWO
            .Replacement.Text = strConcatenate
            .Execute Replace:=wdReplaceAll
        End With
    Loop Until xlWks.Cells(r, 1) = ""
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Graham,
                                    
                                    Thanks for your quick response. I've added this macro into my Excel file. When I try to run it, I get a compile error on the following line:
                                    
                                    
                                    Dim wdApp As Word.Application

                                    
                                      Select all
                                      Open in new window
                                    
                                    I have attached the screen capture of the error in hopes that it can be resolved...
                                    
                                    Thanks,
                                    Andrea
                                    Compile_Error.PNG</pre>

<pre class="amctext">Hi Graham,
                                    
                                    Update: I figured out the issue above (Tools > References > checking MS Word) and then ran the macro, which worked perfectly, thanks! So please ignore my previous response.
                                    
                                    One thing I realize now, and should have included in my question, is that we will be running it on the same Word files more than once as we add new work orders, so there will be a mix of work order numbers: some that have already been updated to match Column C of the Excel file, and some that are not updated.
                                    
                                    Currently, when I rerun the macro, it adds additional instances of "(*)", as shown below:
                                    
                                    2017-0004801 (TPG) (TPG)
                                    
                                    Is it possible to have the macro revised so that:
                                    If the work order number is found in Column A, and the work order number in the Word file already matches the value in Column C of the Excel file, then no action required.
                                    
                                    Graham, given that this is an additional request, please don't hesitate to let me know if I should be posing this as a new question instead of adding it to this one.
                                    
                                    Thanks again for your assistance,
                                    Andrea</pre>

<pre class="amctext">Sorry -  I was away for an extended weekend. Well done for figuring out that I had neglected to tell you that a reference was needed.
                                    
                                    I have added a few lines to the code:
                                    
                                    Sub AugmentWO()
    Dim wdApp As Word.Application
    Dim wdDoc As Word.Document
    Dim strWO As String
    Dim strConcatenate As String
    Dim xlWks As Excel.Worksheet
    Dim r As Integer
    Dim strWordFile As String
    
    Set xlWks = Sheets("WO_Initial")
    r = 2
    
    'create a word application instance if necessary
    On Error Resume Next
        Set wdApp = GetObject(, "Word.Application")
    On Error GoTo 0
    If wdApp Is Nothing Then
        Set wdApp = CreateObject("Word.Application")
    End If
    
    'open the document
    strWordFile = "J:\Allwork\ee\29136233\Cycle_Changes_Depot.docx"
    Set wdDoc = wdApp.Documents.Open(strWordFile)
    
    'do find and replace for each valid row of the sheet
    Do
        strWO = xlWks.Cells(r, 1)
        strConcatenate = xlWks.Cells(r, 3)
        r = r + 1
        With wdDoc.Range.Find
            .Text = strConcatenate 'look for concatenated text
            If Not .Execute Then
                .Text = strWO 'not there, so perform change
                .Replacement.Text = strConcatenate
                .Execute Replace:=wdReplaceAll
            End If
        End With
    Loop Until xlWks.Cells(r, 1) = ""
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Hi Graham,
                                    
                                    I'm sorry for my tardiness in responding - I was assigned to a special project this week and so this has been my first chance to review the updated macro. It works perfectly - I'm very pleased. Thanks so much!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Word file before macro is run (28 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/02_w07/1412478/Cycle_Changes_Depot.docx">Cycle_Changes_Depot.docx</a></p>
<p class="amcfile">Example of results after macro is run (28 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/02_w07/1412479/Cycle_Changes_Depot_After_Update.docx">Cycle_Changes_Depot_After_Update.docx</a></p>
<p class="amcfile">Excel list of work order numbers (10 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/02_w07/1412480/WO_Initials_List.xlsm">WO_Initials_List.xlsm</a></p>
<p class="amcfile">Screen capture of compile error (16 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/02_w08/1412536/Compile_Error.PNG">Compile_Error.PNG</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Looking to SQL to see if it can streamline a cumbersome Excel task</h2>
<p class="amcdate">2018-03-11T14:01:57-0400</p>

<pre class="amctext">There is a bimonthly task that I do, comparing ~ 4000 rows of data in Excel between the 'Start' and 'End' of a production cycle to determine the changes that occurred. Currently I'm using index-match in a rather cumbersome process in Excel to get my results. I am hoping there is a much faster way of doing this task, and to that end am posting my question in the Access forum in case SQL is an option.
                          
                          Description:
                          I'm looking for a (?SQL query) based on two tables (EE_Start_Final and EE_End_Final tables) that extracts a list of all Chart #'s from both tables that meet the following criteria:
                          [Chart #] in Start table <> [Chart #] in End table
                          OR
                          [Chart #] in End table <> [Chart #] in Start table
                          OR
                          [Chart #]&[Type] in Start table <> [Chart #]&[Type] in End table
                          OR
                          [Chart #]&[BookA_#] in Start table <>[Chart #]&[BookA_#] in End table
                          OR
                          [Chart #]&[BookB_#] in Start table <>[Chart #]&[BookB_#] in End table
                          OR
                          [Chart #]&[BookC] in Start table <>[Chart #]&[BookC] in End table
                          
                          The resulting Query table extracted based on the above criteria to include, in following order:
                          LIst of (unique)[Chart #]'s
                          [Type] from Start table
                          [Type] from End table
                          [BookA_#] from Start table
                          [BookA_#] from End table
                          [BookB_#] from Start table
                          [BookB_#] from End table
                          [BookC] from Start table
                          [BookC] from End table
                          
                          I have attached a sample database with the Start and End tables as described. I did try a union join in SQL, but wasn't able to proceed any further and wasn't sure if that was the direction to take.
                          
                          Please let me know if you have any questions. Also, if you recommend using another approach or software instead of Access, or if you think Excel can do the job better, please include your recommendations. Excel is the most readily available tool in my environment at the moment, which is why I've been it for solutions but if MS Access can do the job better, then that software can be made available to me.
                          
                          Thanks!
                          Andrea
                          Cycle_Start_End_Compare.accdb</pre>

<pre class="amctext">Given those two sets of data, what is your desired output?
                                    
                                    Combinations like this:
                                    
                                    [Chart #] in Start table <> [Chart #] in End table
                                    OR
                                    [Chart #] in End table <> [Chart #] in Start table
                                    
                                    Are called a full outer join in database terminology.  They are implemented by creating a left join query and a right join query and then unioning the two.
                                    
                                    You should also reconsider your naming standard since you are moving to a relational database.  Object names should use only the upper and lower case letters, numbers, and the underscore.  I prefer CamelCase which capitalizes the first letter of each word over the_underscore which separates words with the underscore.  NEVER use embedded spaces or special characters such as the #.  Also do not use Access, VBA, or SQL function or property names such as Name, Month, Year since they can cause subtle errors or conflicts.  For example, is Me.Name the name of your form or is it a control named "Name" on your form?</pre>

<pre class="amctext">Hi,
                                    
                                    Below will be your SQL query based on information provided:
                                    
                                    
                                    SELECT DISTINCT
	s.[Chart #],
	e.[Chart #],
	s.[Type],
	e.[Type],
	s.[BookA_#],
	e.[BookA_#],
	s.[BookB_#],
	e.[BookB_#],
	s.[BookC],
	e.[BookC]
FROM EE_Start_Final s 
INNER JOIN EE_End_Final e ON
	s.[Chart #] <> e.[Chart #] OR
	s.[Chart #] + s.[Type] <> e.[Chart #] + e.[Type] OR
	s.[Chart #] + s.[BookA_#] <> e.[Chart #] + e.[BookA_#] OR
	s.[Chart #] + s.[BookB_#] <> e.[Chart #]+ e.[BookB_#] OR
	s.[Chart #] + s.[BookC] <> e.[Chart #] + e.[BookC] 

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">E.g. 
                                    
                                    
                                    SELECT *
FROM EE_Start AS S 
  INNER JOIN EE_End AS E ON S.UniqueChart = E.UniqueChart
WHERE (((S.[Chart #])<>[E].[Chart #])) 
  OR (((S.Type)<>[ E].[Type])) 
  OR (((S.[Book_A_#])<>[E].[Book_A_#])) 
  OR (((S.[Book_B_#])<>[E].[Book_B_#])) 
  OR (((S.Book_C)<>[E].[Book_C]));

                                    
                                      Select all
                                      Open in new window
                                    
                                    You don't need to test for the concatenated values with [Chart #], cause you test it already on its own. 
                                    
                                    The onle question is: can rows be added or deleted? Then you need a FULL JOIN.</pre>

<pre class="amctext">Thanks for the quick responses, which I am going through now and trying them out...
                                    
                                    Ste5an, rows can be added and deleted, so it sounds like I need a FULL JOIN. How would I modify the code for that? Also, when I ran the query I got a dialog box saying 'Enter parameter value' for 'E.Type'...how do I rectify that.
                                    
                                    Thanks,
                                    Andrea</pre>

<pre class="amctext">The dialog box comes from a typo. It must be [E].[Type] not [ E].Type:
                                    
                                    
                                    SELECT *
FROM EE_Start AS S 
  INNER JOIN EE_End AS E ON S.UniqueChart = E.UniqueChart
WHERE (((S.[Chart #])<>[E].[Chart #])) 
  OR (((S.Type)<>[E].[Type])) 
  OR (((S.[Book_A_#])<>[E].[Book_A_#])) 
  OR (((S.[Book_B_#])<>[E].[Book_B_#])) 
  OR (((S.Book_C)<>[E].[Book_C]));

                                    
                                      Select all
                                      Open in new window
                                    
                                    As already posted, you need to simulate it:
                                    
                                    
                                    SELECT 'C' AS ChangeType, *
FROM EE_Start AS S
INNER JOIN EE_End AS E ON S.UniqueChart = E.UniqueChart
WHERE
 (((S.[Chart #])<>[E].[Chart #])) OR (((S.Type)<>[E].[Type])) OR (((S.[Book_A_#])<>[E].[Book_A_#])) OR (((S.[Book_B_#])<>[E].[Book_B_#])) OR (((S.Book_C)<>[E].[Book_C]))
UNION ALL
SELECT 'D' AS ChangeType, *
FROM EE_Start AS S
LEFT JOIN EE_End AS E ON S.UniqueChart = E.UniqueChart
WHERE E.UniqueChart IS NULL
UNION ALL
SELECT 'A' AS ChangeType, *
FROM EE_Start AS S
RIGHT JOIN EE_End AS E ON S.UniqueChart = E.UniqueChart
WHERE S.UniqueChart IS NULL

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">@Andreamary
                                    None of the suggested queries returns the set of data I think you need and they all have typos.  Once we see what you want returned, that will clarify what the query needs to do.
                                    
                                    PS - although the + works as a concatenation operator under some conditions, it works differently than the & which is the standard Access query concatenation operator.  So, unless you want the specific property that + provides, always use the &.
                                    
                                    A + B = sum of a + b when both are numeric
                                    A + B = AB when one or both are strings
                                    A + B = Null when one or both values are null
                                    
                                    A & B = always = AB  even when both are numeric or one of them is null.</pre>

<pre class="amctext">Hi all,
                                    
                                    Pat, thank you for your guidance on Access. As you can probably tell, I have very little recent experience in it, and none in SQL. To clarify the results I am after, I have attached the expected results (included the column order I am hoping for) of this query in an Excel spreadsheet (since this is the current and only way I know how to do this task). 
                                    
                                    Nishant, I tried your solution but received many errors unfortunately.
                                    
                                    Ste5an, thanks for your updated solution. In terms of the charts listed, they almost matched the results I was expecting. The one chart that was missing — City 1-Chart4-E — should be listed due to changes in the book section of the comparison, in Book B and in Book C. This is captured in my results as attached. Is it possible for the code to be revised so this change is captured? Also, is it possible for the results to be formatted with the same columns, in the same order, as my attached results? Not being savvy in Access myself, I'm not sure if what I am asking is possible or realistic.
                                    
                                    Thanks again for your contributions...
                                    
                                    Andrea
                                    Start_End_Changes_Results.xlsx</pre>

<pre class="amctext">The problem is, that there is a NULL instead of a empty string. In databases these are two different things. Even when they look the same in the grid view.
                                    
                                    Either
                                    
                                    
                                    SELECT 'C' AS ChangeType ,
       *
FROM   EE_Start S
       INNER JOIN EE_End E ON S.UniqueChart = E.UniqueChart
WHERE     Nz(S.[Chart #] , '') <> Nz(E.[Chart #] , '')
       OR Nz(S.[Type]    , '') <> Nz(E.[Type]    , '')
       OR Nz(S.[Book_A_#], '') <> Nz(E.[Book_A_#], '')
       OR Nz(S.[Book_B_#], '') <> Nz(E.[Book_B_#], '')
       OR Nz(S.[Book_C]  , '') <> Nz(E.[Book_C]  , '')
UNION ALL
SELECT 'D' AS ChangeType ,
       *
FROM   EE_Start S
       LEFT JOIN EE_End E ON S.UniqueChart = E.UniqueChart
WHERE  E.UniqueChart IS NULL
UNION ALL
SELECT 'A' AS ChangeType ,
       *
FROM   EE_Start S
       RIGHT JOIN EE_End E ON S.UniqueChart = E.UniqueChart
WHERE  S.UniqueChart IS NULL;

                                    
                                      Select all
                                      Open in new window
                                    or
                                    
                                    
                                    SELECT 'C' AS ChangeType ,
       *
FROM   EE_Start S
       INNER JOIN EE_End E ON S.UniqueChart = E.UniqueChart
WHERE     S.[Chart #]  & '' <> E.[Chart #]  & ''
       OR S.[Type]     & '' <> E.[Type]     & ''
       OR S.[Book_A_#] & '' <> E.[Book_A_#] & ''
       OR S.[Book_B_#] & '' <> E.[Book_B_#] & ''
       OR S.[Book_C]   & '' <> E.[Book_C]   & ''
UNION ALL
SELECT 'D' AS ChangeType ,
       *
FROM   EE_Start S
       LEFT JOIN EE_End E ON S.UniqueChart = E.UniqueChart
WHERE  E.UniqueChart IS NULL
UNION ALL
SELECT 'A' AS ChangeType ,
       *
FROM   EE_Start S
       RIGHT JOIN EE_End E ON S.UniqueChart = E.UniqueChart
WHERE  S.UniqueChart IS NULL;

                                    
                                      Select all
                                      Open in new window
                                    
                                    Cause SQL has a tri-value logic with NULL and comparison with NULL is special: 'test' <> NULL evaluates to UNKOWN, not to TRUE. Such test require the special IS NULL or IS NOT NULL test predicates. 
                                    
                                    Or we use Nz(valu1, value2). If value1 is NULL, then the second value is returned.
                                    
                                    Or we use the specialty of the string concatenation of NULL & '' which becomes '' (empty string).</pre>

<pre class="amctext">Thanks so much for your solution (and explanation)...much appreciated, Ste5an! Using this approach in Access will save me a lot of time. :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You can colorize the differences on a report or form by using Conditional Formatting.  Please start a new thread if you need help with that.</pre>

<pre class="amctext">Thanks, Pat,, for that information....
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're welcome.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Cycle_Start_End_Compare.accdb (448 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/03_w11/1284420/Cycle_Start_End_Compare.accdb">Cycle_Start_End_Compare.accdb</a></p>
<p class="amcfile">Expected results in Excel format (8 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/03_w11/1284562/Start_End_Changes_Results.xlsx">Start_End_Changes_Results.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">In Excel, find first column in row with value > 0 and populate column N with the date listed in the heading row of this first column</h2>
<p class="amcdate">2017-10-25T20:39:06-0400</p>

<pre class="amctext">In column M of the attached spreadsheet, I have a formula (thanks to this forum) that identifies the last date that each work order was worked on:
                          
                          
                          =LOOKUP(2,1/(B3:L3<>0),B$1:L$1)

                          
                            Select all
                            Open in new window
                          
                          I now need to identify the earliest date that each work order was worked on in Column N of the same spreadsheet, as follows:
                          
                          
                            For each row in Column N in Sheet1 of spreadsheet, find the first column between Col B and Col L that has a value > 0, and then enter the date listed in the heading row of this first column into the cell of the corresponding row under Column N.
                          
                          
                          I have attached a sample spreadsheet and have populated the desired results in red in Column N, as well as shaded the corresponding 'first column' cells in orange to illustrate what I am after.
                          
                          Thanks!
                          Andrea
                          EE_First_Date.xlsx</pre>

<pre class="amctext">Hi,
                                    
                                    See attached.
                                    
                                    Alan.
                                    EE-29064726-EE_First_Date-Version1.xlsx</pre>

<pre class="amctext">Perfect - thanks so much, Alan!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">You're most welcome Andrea - happy to help.
                                    
                                    Alan.</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example with desired results in Column N (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201413/EE_First_Date.xlsx">EE_First_Date.xlsx</a></p>
<p class="amcfile">EE-29064726-EE_First_Date-Version1.xlsx (11 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201415/EE-29064726-EE_First_Date-Version1.xlsx">EE-29064726-EE_First_Date-Version1.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Revising VBA code's behavior when column is blank</h2>
<p class="amcdate">2017-07-07T20:01:26-0400</p>

<pre class="amctext">This VBA solution (as per the attached spreadsheet and shown below) works perfectly as long as there is at least one date value entered in Column G. When Column G is completely blank, however, then the code changes the column heading in Column H of that tab to 'No'. Is it possible to revise the code so that if there are no dates in Column G in the spreadsheet, then nothing happens?
                          
                          The attached spreadsheet illustrates the issue in that the third tab, Planning_01-Feb-18, which has no values in Column G, has changed the heading in Column H to 'No'.
                          
                          If it helps to see my original question for more context, it is ID # 42193721.
                          
                          Current VBA code:
                          
                          
                          Sub UpdatePlanningSheets()
Dim Ws As Worksheet, Ws1 As Worksheet, Ws2 As Worksheet
Dim LR As Long, LR1 As Long

'Disable Events
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
    .Calculation = xlManual
End With

'Set Variables
Set Ws1 = Worksheets("Deadline_Dates")
Set Ws2 = Worksheets("Lookups")
LR1 = Ws1.Range("A" & Rows.Count).End(xlUp).Row

'Get Sheet Names of Every Worksheet & Update Column G
For Each Ws In ThisWorkbook.Worksheets
    If Ws.Name <> Ws1.Name And Ws.Name <> Ws2.Name Then
        LR = Ws.Range("G" & Rows.Count).End(xlUp).Row
        If IsEmpty(Ws.Range("H2:H" & LR + 1)) = False Then
            Ws.Range("H2:H" & LR + 1).ClearContents
        End If
        Ws.Range("K2").FormulaR1C1 = "=RIGHT(CELL(""filename"",R[-1]C1),9)"
        Ws.Range("K2").Value = Ws.Range("K2").Value
        Ws.Range("H2:H" & LR).FormulaR1C1 = "=IF(RC7="""","""",IF(RC7<=VLOOKUP(R2C11,Deadline_Dates!C1:C2,2,0),""Yes"",""No""))"
        Ws.Range("H2:H" & LR).Value = Ws.Range("H2:H" & LR).Value
    End If
Next Ws

'Enable Events
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                          
                            Select all
                            Open in new window
                          
                          I hope I have provided enough information...
                          
                          Thanks,
                          Andrea
                          Index_Match_Date_Deadline_WO.xlsm</pre>

<pre class="amctext">hi Andrea,
                                    
                                    after LR = Ws.Range("G" & Rows.Count).End(xlUp).Row, add:
                                            If LR = 1 Then 'no data
           GoTo NextWorkSheet
        End If

                                    
                                      Select all
                                      Open in new window
                                    before Next Ws, add a line label: 
                                    NextWorkSheet:

                                    
                                      Select all
                                      Open in new window
                                    by the way, you should be releasing object variables when the procedure is done: 
                                       set Ws=nothing
   set Ws1 = nothing
   set Ws2 = nothing

                                    
                                      Select all
                                      Open in new window
                                    error handlers are good to add. Here is a short video on error handling. There are 2 other videos in this series if you wish to know more. 
                                    basic error handling code for VBA (3:48)
                                    https://www.experts-exchange.com/videos/1478/Excel-Error-Handling-Part-1-Basic-Concepts.html</pre>

<pre class="amctext">Hi Crystal,
                                    
                                    Thanks very much...it works perfectly! I am not very savvy with VBA, so I wasn't sure where to add the code for 'releasing object variables'. Below is the updated code...could you just let me know where to add the 'Set Ws=nothing', etc code in?
                                    
                                    BTW, thanks for suggesting the videos re: error handling. 
                                    
                                    
                                    Sub UpdatePlanningSheets()
Dim Ws As Worksheet, Ws1 As Worksheet, Ws2 As Worksheet
Dim LR As Long, LR1 As Long

'Disable Events
With Application
    .ScreenUpdating = False
    .DisplayStatusBar = True
    .StatusBar = "!!! Please Be Patient...Updating Records !!!"
    .EnableEvents = False
    .Calculation = xlManual
End With

'Set Variables
Set Ws1 = Worksheets("Deadline_Dates")
Set Ws2 = Worksheets("Lookups")
LR1 = Ws1.Range("A" & Rows.Count).End(xlUp).Row

'Get Sheet Names of Every Worksheet & Update Column G
For Each Ws In ThisWorkbook.Worksheets
    If Ws.Name <> Ws1.Name And Ws.Name <> Ws2.Name Then
        LR = Ws.Range("G" & Rows.Count).End(xlUp).Row
        If LR = 1 Then 'no data
        GoTo NextWorkSheet
        End If
        If IsEmpty(Ws.Range("H2:H" & LR + 1)) = False Then
            Ws.Range("H2:H" & LR + 1).ClearContents
        End If
        Ws.Range("K2").FormulaR1C1 = "=RIGHT(CELL(""filename"",R[-1]C1),9)"
        Ws.Range("K2").Value = Ws.Range("K2").Value
        Ws.Range("H2:H" & LR).FormulaR1C1 = "=IF(RC7="""","""",IF(RC7<=VLOOKUP(R2C11,Deadline_Dates!C1:C2,2,0),""Yes"",""No""))"
        Ws.Range("H2:H" & LR).Value = Ws.Range("H2:H" & LR).Value
    End If
NextWorkSheet: Next Ws

'Enable Events
With Application
    .ScreenUpdating = True
    .DisplayStatusBar = True
    .StatusBar = False
    .EnableEvents = True
    .Calculation = xlAutomatic
End With
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">hi Andrea,
                                    
                                    you're welcome
                                    
                                    >> could you just let me know where to add the 'Set Ws=nothing', etc code in? <<
                                    at the end ... just before End Sub -- watch the video, and then the other 2 (Excel is the example application). It is Friday! Make it a 'movie' night :)</pre>

<pre class="amctext">Thanks again for the quick turnaround on a solution...much appreciated! And I'll follow up with the videos.
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">you're welcome, Andrea ~ happy to help</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of current VBA code results when no date in Column G (24 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/07_w27/1180573/Index_Match_Date_Deadline_WO.xlsm">Index_Match_Date_Deadline_WO.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Need Excel macro to populate a column based on two criteria that includes referencing a second tab</h2>
<p class="amcdate">2019-08-14T10:54:15-0400</p>

<pre class="amctext">I have a spreadsheet with two tabs: WO_List and Depot_WOs. I need a macro to populate the WO_List tab's Column F (IFP Initials) based on following criteria:
                          If Column F (IFP Initials) is blank AND the WO # in Column A (WO) of the WO_List is in Column A (Depot_WOs) of the Depot_WOs tab, then populate Column F (IFP Initials) with "Non-IP"; otherwise, leave blank
                          
                          Pseudo-code:
                          IF WO_List $F2 = BLANK, and if WO_List $A2 = Depot_WOs(A:A), then "Non-IFP", otherwise ""
                          
                          I've attached a sample spreadsheet.
                          
                          Screen capture showing that first row met criteria, so Col F populated with "Non-IP"
                          Example.PNG
                          EE_Depot_WOs.xlsm</pre>

<pre class="amctext">Please give this a try....
                                    
                                    Place the following code on a Standard Module like Module1.
                                    
                                    
                                    Sub PopulateColumnF_WOList()
Dim wsWO As Worksheet, wsDepot As Worksheet
Dim lr As Long
Dim Rng As Range, Cel As Range
Dim n

Application.ScreenUpdating = False

Set wsWO = Worksheets("WO_List")
Set wsDepot = Worksheets("Depot_WOs")

lr = wsWO.Cells(Rows.Count, 1).End(xlUp).Row
Set Rng = wsWO.Range("A2:A" & lr)

For Each Cel In Rng
    If wsWO.Cells(Cel.Row, "F") = "" Then
        n = Application.Match(Cel.Value, wsDepot.Range("A:A"), 0)
        If Not IsError(n) Then
            wsWO.Cells(Cel.Row, "F").Value = "Non-IP"
        End If
    End If
Next Cel
Application.ScreenUpdating = True
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks very much, Subodh, it worked like a charm! :-)
                                    
                                    Andrea</pre>

<pre class="amctext">You're welcome Andrea! Glad it worked as desired.
                                    Thanks for the feedback!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Screen capture of first row met criteria and Col F populated with "Non-IP" (12 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/08_w33/1429122/Example.PNG">Example.PNG</a></p>
<p class="amcfile">Sample spreadsheet (56 KB) <a href="https://filedb.experts-exchange.com/incoming/2019/08_w33/1429123/EE_Depot_WOs.xlsm">EE_Depot_WOs.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">UsingVBA to populate results in column based on criteria in 3 other columns</h2>
<p class="amcdate">2020-02-27T18:42:42-0500</p>

<pre class="amctext">I would like VBA code to identify expiry issues with a list of documents in a spreadsheet and populate the results in Column J, based on the following criteria.
                          
                          I have attached a sample spreadsheet with the anticipated results entered manually in Column J.
                          
                          NOTE: If there is a date in Column H, then any dates entered in Column G are ignored. 
                          
                          If Col I = "" or <> = "Expired" or <> = "Cancelled" or <> = "Replaced", and
                          Col G = "" or <> "", and 
                          Col H <> "" and date > than TODAY, then
                          Col J = ""
                          
                          
                          If Col I = "" or <> = "Expired" or <> = "Cancelled" or <> = "Replaced", and
                          Col G = "" or <> "", and 
                          Col H <> "" and date < than TODAY, then
                          Col J = "Issue"
                          
                          
                          If Col I = "" or <> = "Expired" or <> = "Cancelled" or <> = "Replaced", and
                          Col G <> "" and date < than TODAY + 60 days, and
                          Col H = "", and
                          Col J = "Review Proposed Expiry Date"
                          
                          
                          If Col I = "" or <> = "Expired" or <> = "Cancelled" or <> = "Replaced", and
                          Col H = "", and
                          Col G = "", then
                          Col J = "Missing Expiry Dates"
                          
                          Thanks!
                          Andrea
                          EE_Expiry.xlsm</pre>

<pre class="amctext">Try this formula in J4

=expiryIssue(G4:I4)

With this code

Function expiryIssue(rng As Range) As String 
Application.volatile 
Dim dte1 As Range 
Dim dte2 As Range 
Dim status As String 
Set dte1 = rng.Cells(1, 1) 
Set dte2 = rng.Cells(1, 2) 
status = rng.Cells(1, 3) 
If status <> "Expired" And status <> "Cancelled" And status <> "Replaced" Then 
    If dte2 = "" And dte1 = "" Then 
        expiryIssue = "Missing expiry dates" 
    Else 
        If dte2 = "" Then 
            If dte1 < Date + 60 Then expiryIssue = "Review proposed expiry date" 
        Else 
            If dte1 = "" Then 
                If dte2 < Date Then expiryIssue = "Issue" 
            Else 
                If dte2 < Date Then expiryIssue = "Issue" 
            End If 
        End If 
    End If 
End If 
End Function 


Select allOpen in new window
                                    
                                      formatCodeSnippets('wysiwyg-content','code-20-43039452',true,true,false);</pre>

<pre class="amctext">Thanks very much, Syed, this is great! The one thing I am having difficulty with is taking your solution and applying it to my actual spreadsheet. I've been trying to figure out how to change the column/row references in the VBA but am not having success.
                                    
                                    This is the list of differences between my sample spreadsheet that I provided and my actual spreadsheet:
                                    
                                    Col G (proposed expiry date) is Col H in my actual spreadsheet
                                    Col H (approved expiry date) is Col J in my actual spreadsheet
                                    Col I (Status) is Col BD in my actual spreadsheet
                                    Col J (Expiry Issue) is Col BE in my actual spreadsheet
                                    
                                    Would you be able to provide me with the changes in the VBA so it can work in my actual spreadsheet?
                                    
                                    Thanks!
                                    Andrea</pre>

<pre class="amctext">No change to VBA

Change 


 =expiryIssue(G4:I4)
  

on the worksheet to your new range.</pre>

<pre class="amctext">Hi Syed,
                                    
                                    I was able to figure out how to change the references based on your solution, so now the code is working in my actual spreadsheet!
                                    
                                    Thanks again...I'm very pleased with your solution. :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of spreadsheet with results (25 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/02_w09/1445294/EE_Expiry.xlsm">EE_Expiry.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Updating Word macro to expand criteria in identifying wrongly-formatted strings</h2>
<p class="amcdate">2020-05-20T13:39:17-0400</p>

<pre class="amctext">My current macro (a solution that was provided by Experts Exchange and has been working great!) searches for the following string and pastes it into a new Word file, one string per line:
                          ####-####### (4 numbers, followed by a dash, then 7 numbers)
                          
                          
                          The macro also flags the following two instances of wrongly formatted strings, stops the macro and generates a pop-up error message so that the user can fix the string, then rerun the macro:
                          ####-###### (4 numbers, followed by a dash, then 6 numbers)
                          ####-######## (4 numbers, followed by a dash, then 8 numbers)
                          
                          I would like to macro to be updated so that it also identifies the following strings as wrongly formatted as well, generating the same pop-up error message:
                          ########## (10 numbers, no dash)
                          ########### (11 numbers, no dash)
                          ############ (12 numbers, no dash)
                          
                          
                          I've attached a sample Word file showing the the 3 examples of wrongly-formatted text strings that can occur.
                          
                          The current code is shown below:
                          
                          
                          Sub Extract_WOs()
'
' Extract_WOs Macro
'
' Keyboard Shortcut: Ctrl+y
'
    Set Activedoc = ActiveDocument
    strRes = ""
    Dim reg As Object 'VBScript_RegExp_55.regexp
    Dim Match As Object ' VBScript_RegExp_55.Match
    Dim Matches As Object 'VBScript_RegExp_55.MatchCollection

    ' instanciation
    Set reg = CreateObject("VBScript.RegExp")
    With reg
        .Global = True
        .MultiLine = True
        .Ignorecase = True
        .Pattern = "\b\d{4}-(\d{6}|\d{8})\b"
    Set Matches = .Execute(Activedoc.Range.Text)
    End With
    For Each Match In Matches
        ActiveDocument.Range(Match.firstIndex, Match.firstIndex + Match.Length).Select
        MsgBox "Value: " & Match.Value & " is wrong"
        Exit Sub
    Next Match
    reg.Pattern = "\b\d{4}-\d{7}\b"
    Set Matches = reg.Execute(Activedoc.Range.Text)
    For Each Match In Matches
        strRes = strRes & Match.Value & vbCrLf
    Next Match

    
    If strRes <> "" Then
        Set newDoc = Documents.Add
        newDoc.Range.Text = strRes
    Else
        MsgBox "No Matches"
    End If
End Sub

                          
                            Select all
                            Open in new window
                          
                          Thanks very much!
                          Andrea
                          Sample_EE_Wrong_WO_Numbers.docx</pre>

<pre class="amctext">Here you go:

Sub Extract_WOs()
'
' Extract_WOs Macro
'
' Keyboard Shortcut: Ctrl+y
'
    Set Activedoc = ActiveDocument
    strRes = ""
    Dim reg As Object 'VBScript_RegExp_55.regexp
    Dim Match As Object ' VBScript_RegExp_55.Match
    Dim Matches As Object 'VBScript_RegExp_55.MatchCollection

    ' instanciation
    Set reg = CreateObject("VBScript.RegExp")
    With reg
        .Global = True
        .MultiLine = True
        .Ignorecase = True
        .Pattern = "\b\d{4}-(\d{6}|\d{8})\b"
        Set Matches = .Execute(Activedoc.Range.Text)
    End With
    For Each Match In Matches
        ActiveDocument.Range(Match.firstIndex, Match.firstIndex + Match.Length).Select
        MsgBox "Value: " & Match.value & " is wrong"
        Exit Sub
    Next Match
    With reg
        .Pattern = "\b(\d{10}|\d{11}|\d{12})\b"
        Set Matches = .Execute(Activedoc.Range.Text)
    End With
    For Each Match In Matches
        ActiveDocument.Range(Match.firstIndex, Match.firstIndex + Match.Length).Select
        MsgBox "Value: " & Match.value & " is wrong"
        Exit Sub
    Next Match
    reg.Pattern = "\b\d{4}-\d{7}\b"
    Set Matches = reg.Execute(Activedoc.Range.Text)
    For Each Match In Matches
        strRes = strRes & Match.value & vbCrLf
    Next Match
    
    If strRes <> "" Then
        Set NewDoc = Documents.Add
        NewDoc.Range.Text = strRes
    Else
        MsgBox "No Matches"
    End If
End Sub
Select allOpen in new window
                                    
                                      formatCodeSnippets('wysiwyg-content','code-20-43090153',true,true,false);</pre>

<pre class="amctext">Great solution - thanks, John!

Andrea</pre>

<pre class="amctext">Glad to help. Thanks for the testimonial!</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample WO file with examples of wrong work order numbers (18 KB) <a href="https://filedb.experts-exchange.com/incoming/2020/05_w21/1458641/Sample_EE_Wrong_WO_Numbers.docx">Sample_EE_Wrong_WO_Numbers.docx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Updating a formula that removes a specific text string from a concatenation in Excel</h2>
<p class="amcdate">2018-09-23T16:04:48-0400</p>

<pre class="amctext">The current formula in Column E, shown below, concatenates Columns A, B, C and D to create a unique Product Number:
                          
                          
                          =A2&IF(B2<>"","-"&B2,"")&IF(C2&D2<>"","-"&C2&D2,"")

                          
                            Select all
                            Open in new window
                          
                          I need to update the current formula whereby if the specific text string "-AAU" is in Column B, it is not to be included in the final concatenated Product Number in Column E.
                          
                          I have included a sample spreadsheet that has the current formula in Column E, and the updated, desired results I am looking for in Column F. 
                          
                          Thanks in advance for assistance with this...
                          
                          Andrea
                          Product_Numbering.xlsx</pre>

<pre class="amctext">Try this
                                    
                                    
                                    =A2&IF(B2<>"",IF(RIGHT(B2,4)="-AAU","-AAU","-"&B2),"")&IF(C2&D2<>"","-"&C2&D2,"")

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks very much, Ejgil, it works like a charm!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of current formula + column showing desired results of an updated formula (9 KB) <a href="https://filedb.experts-exchange.com/incoming/2018/09_w39/1386873/Product_Numbering.xlsx">Product_Numbering.xlsx</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Removing duplicate WOs in spreadsheet, ensuring that row with earliest date/time stamp is the row to be retained</h2>
<p class="amcdate">2017-11-07T15:53:03-0500</p>

<pre class="amctext">I receive a master report on a daily basis that has a number of duplicate WOs. I would like to have a macro that would remove all the duplicate WOs in a selective manner, in that it always retains the WO with earliest date/time stamp in column G.
                          
                          I have attached a sample report with the duplicate WOs highlighted in red in Column A, and have highlighted in yellow, in the first section of the report as an illustration, the unique WOs to be retained once the macro is run according to the criteria outlined above.
                          
                          I hope I have provided enough information...
                          
                          Cheers,
                          Andrea
                          EE_KeepEarliestDate_Dupes.xlsx</pre>

<pre class="amctext">Try attached workbook.
                                    Press button to run.
                                    EE_KeepEarliestDate_Dupes.xlsm</pre>

<pre class="amctext">Works like a charm - thanks very much, Ejgil!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of WOs to be retained after macro run (341 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w45/1209699/EE_KeepEarliestDate_Dupes.xlsx">EE_KeepEarliestDate_Dupes.xlsx</a></p>
<p class="amcfile">Keep Earliest date macro (370 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w45/1209731/EE_KeepEarliestDate_Dupes.xlsm">EE_KeepEarliestDate_Dupes.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Resetting user form in Excel when 'Save' button is clicked</h2>
<p class="amcdate">2017-11-27T22:35:16-0500</p>

<pre class="amctext">I have created a user form called Time Tracker. The date in the user form is autopopulated with the current date when the form is opened. When the Save button is clicked, the data from the user form populates the next available row in columns A to G in a sheet called 'TrackingSheet'. All fields in the user form must be completed for the form to save, otherwise an error message pops up.
                          
                          I would like the user form to reset once the Save button is clicked so users can add additional records in the same session. When reset, all fields except the date field, which is autopopulated, would be blank.
                          
                          I have included the spreadsheet to assist with this question.
                          
                          Thanks,
                          Andrea
                          ProdMainTimeTracker_EE.xlsm</pre>

<pre class="amctext">try update the Sub cmdSave_Click to:
                                    
                                    
                                    Private Sub cmdSave_Click()
Dim NextRow As Long

    With Me

        If .cboIDList.Value = "" _
           Or .txtDesc.Value = "" _
           Or .txtPA_Unit.Value = "" _
           Or .txtDate = "" _
           Or .cboInitials = "" _
           Or txtMinutes = "" _
           Or cboStatus = "" Then

            MsgBox "Form not completed!", vbCritical, "Incomplete"
            Exit Sub
        End If

        NextRow = Sheets("TrackingSheet").Range("A" & Rows.Count).End(xlUp).Row + 1
        Sheets("TrackingSheet").Range("A" & NextRow).Value = .cboIDList.Value
        Sheets("TrackingSheet").Range("B" & NextRow).Value = .txtPA_Unit.Value
        Sheets("TrackingSheet").Range("C" & NextRow).Value = .txtDesc.Value
        Sheets("TrackingSheet").Range("D" & NextRow).Value = .txtDate.Value
        Sheets("TrackingSheet").Range("E" & NextRow).Value = .txtMinutes.Value
        Sheets("TrackingSheet").Range("F" & NextRow).Value = .cboInitials.Value
        Sheets("TrackingSheet").Range("G" & NextRow).Value = .cboStatus.Value
        
        .cboIDList.Value = ""
        .txtPA_Unit.Value = ""
        .txtDesc.Value = ""
        .txtDate.Value = ""
        .txtMinutes.Value = ""
        .cboInitials.Value = ""
        .cboStatus.Value = ""
    End With

End Sub

                                    
                                      Select all
                                      Open in new window
                                    
                                    remove line:
                                    
                                    
                                    .txtDate.Value = ""

                                    
                                      Select all
                                      Open in new window
                                    
                                    in case you want to retain Date value after the Save button was clicked.</pre>

<pre class="amctext">I use UserForms in many applications. To save repeating lines of code I wrote a UDF to reset controls. Place it in a Standard module
                                    
                                    
                                    
                                    
                                    '---------------------------------------------------------------------------------------
' DateTime  : 09/05/2007 08:43
' DateTime  : 09/05/2007 08:43
' Author    : Roy Cox (royUK)
' Website   : [URL="http://www.excel-it.com"]click here for more examples and Excel Consulting[/URL]
' Purpose   : Loops through controls of UserForm & clears setting
'
' Disclaimer; This code is offered as is with no guarantees. You may use it in your
'             projects but please leave this header intact.

'---------------------------------------------------------------------------------------
Option Explicit

Public Function ClearAll(frm As MSForms.UserForm) As Boolean
    ' clear out all controls
    Dim Octrl    As Control
    ' if any error occurs, just exit
    On Error GoTo ExitFunc

    ' loop through controls, figure out type and
    ' use appropriate method to clear it
    For Each Octrl In frm.Controls
        Select Case TypeName(Octrl)
            Case "TextBox":  Octrl = Empty
            Case "CheckBox", "OptionButton": Octrl.Value = False
            Case "ComboBox", "ListBox": Octrl.ListIndex = -1
            Case Else:
        End Select
    Next Octrl

ExitFunc:advan
    Set Octrl = Nothing
End Function

                                    
                                      Select all
                                      Open in new window
                                    
                                    At the end of the save code just add, this will work on any userform in the workbook
                                    
                                    
                                    ClearAll Me

                                    
                                      Select all
                                      Open in new window
                                    
                                    
                                    Private Sub cmdSave_Click()
    Dim NextRow As Long

    With Me

        If .cboIDList.Value = "" _
           Or .txtDesc.Value = "" _
           Or .txtPA_Unit.Value = "" _
           Or .txtDate = "" _
           Or .cboInitials = "" _
           Or txtMinutes = "" _
           Or cboStatus = "" Then

            MsgBox "Form not completed!", vbCritical, "Incomplete"
            Exit Sub
        End If

        NextRow = Sheets("TrackingSheet").Range("A" & Rows.Count).End(xlUp).Row + 1
        Sheets("TrackingSheet").Range("A" & NextRow).Value = .cboIDList.Value
        Sheets("TrackingSheet").Range("B" & NextRow).Value = .txtPA_Unit.Value
        Sheets("TrackingSheet").Range("C" & NextRow).Value = .txtDesc.Value
        Sheets("TrackingSheet").Range("D" & NextRow).Value = .txtDate.Value
        Sheets("TrackingSheet").Range("E" & NextRow).Value = .txtMinutes.Value
        Sheets("TrackingSheet").Range("F" & NextRow).Value = .cboInitials.Value
        Sheets("TrackingSheet").Range("G" & NextRow).Value = .cboStatus.Value

    End With
''/// reset controls
    ClearAll Me
End Sub

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks to you both for providing solutions. I am testing both of them. 
                                    
                                    Roy, I am getting an error message as follows:
                                    
                                    
                                      Compile error: Sub or Function not defined
                                      
                                      Module: Public Function ClearAll(frm As MSForms.UserForm) As Boolean
                                      ExitFunc: advan
                                    
                                    
                                    I've attached the updated spreadsheet for your review in case I've applied your code incorrectly.
                                    
                                    Thanks,
                                    Andrea
                                    ProdMainTimeTracker_CoxSolution.xlsm</pre>

<pre class="amctext">in your module, change:
                                    
                                    
                                    ExitFunc: advan

                                    
                                      Select all
                                      Open in new window
                                    
                                    to:
                                    
                                    
                                    ExitFunc:

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Sorry, I don't know how that typo happened.
                                    
                                    See attached
                                    ProdMainTimeTracker_CoxSolution.xlsm</pre>

<pre class="amctext">Thanks to you both. Ryan, I appreciated your timely response with a working solution, and assistance on another solution!
                                    
                                    Roy, thanks for your solution which is now working with that minor tweak. I did want the date field to be retained, which did not seem to be the case with your code, so if you are able to let me know how to address that, that would be great.
                                    
                                    I've tried to award the points as fairly as possible. :-)
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">It's quite simple and the Function remains dynamic. Just use the controls' Tag Property/ Any control that is not to be cleared simply put a character, e.g. an asterisk, in the control's Tag property at design time. The amended code will ignore any controls that are marked that way.
                                    
                                    
                                    Option Explicit



'---------------------------------------------------------------------------------------
' DateTime  : 09/05/2007 08:43
' DateTime  : 09/05/2007 08:43
' Author    : Roy Cox (royUK)
' Website   : [URL="http://www.excel-it.com"]click here for more examples and Excel Consulting[/URL]
' Purpose   : Loops through controls of UserForm & clears setting
'
' Disclaimer; This code is offered as is with no guarantees. You may use it in your
'             projects but please leave this header intact.

'---------------------------------------------------------------------------------------
Option Explicit

Public Function ClearAll(frm As MSForms.UserForm) As Boolean
''/// clear out all controls
    Dim Octrl As Control
    ''/// if any error occurs, just exit
    On Error GoTo ExitFunc

    ''/// loop through controls, figure out type and
    ''/// use appropriate method to clear it
    For Each Octrl In frm.Controls
    ''/// check the control's Tag Property
        If octl.Tag = "" Then
            Select Case TypeName(Octrl)
            Case "TextBox": Octrl = Empty
            Case "CheckBox", "OptionButton": Octrl.Value = False
            Case "ComboBox", "ListBox": Octrl.ListIndex = -1
            Case Else:
            End Select
        Next Octrl
    End If
ExitFunc:
    Set Octrl = Nothing
End Function

                                    
                                      Select all
                                      Open in new window</pre>

<pre class="amctext">Thanks, Roy, for your instructions on this!
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of user form (24 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w48/1212836/ProdMainTimeTracker_EE.xlsm">ProdMainTimeTracker_EE.xlsm</a></p>
<p class="amcfile">Updated spreadsheet with Roy's code for review (26 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w48/1212961/ProdMainTimeTracker_CoxSolution.xlsm">ProdMainTimeTracker_CoxSolution.xlsm</a></p>
<p class="amcfile">ProdMainTimeTracker_CoxSolution.xlsm (25 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/11_w48/1213000/ProdMainTimeTracker_CoxSolution.xlsm">ProdMainTimeTracker_CoxSolution.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Macro for changing structure of data in Excel</h2>
<p class="amcdate">2017-10-28T18:10:19-0400</p>

<pre class="amctext">I have a spreadsheet that contains extracted data from another source, and I need to change the structure of the data to a more usable format for output to a pivot table. As I will be receiving the data in this format on a regular basis and need to perform this restructuring task every time, I would like to automate this task with a macro.
                          
                          Spreadsheet description:
                          Each WO task has same 5 column headings: WO#, WO_Type, Date, Min, and Min_Type, and the WO numbers are repeated in each 5-column section across the spreadsheet:
                          Column A to E: WO task 1
                          Column F to J: WO task 2
                          Column K to O: WO task 3
                          Column P to T: WO task 4
                          
                          While the current spreadsheet has 455 rows, the number of rows will vary each time.
                          
                          I would like a macro that does the following:
                          
                          
                            Copies data from A2 to E2 and down to last row containing data, and pastes this data into B2 of table in "Tasks" tab.
                          
                          
                            Copies data from F2 to J2 down to last row containing data, and pastes this date into next available blank row in Column B of table in "Tasks" tab
                          
                          
                            Copies data from K2 to O2 down to last row containing data, and pastes this date into next available blank row in Column B of table in "Tasks" tab
                          
                          
                            Copies data from P2 to T2 down to last row containing data, and pastes this date into next available blank row in Column B of table in "Tasks" tab
                          
                          
                          I have attached the spreadsheet with sample data.
                          
                          Thanks,
                          Andrea
                          EE_RestructureData.xlsm</pre>

<pre class="amctext">I think this does what you want, please check and let me know if it needs any revision.
                                    
                                    Note I have removed all the unused rows in the destination table as this makes it extremely difficult to calculate where to paste the data. I have replaced CFS with ="CFS" to ensure this is copied down as data is added.
                                    EE_RestructureData.xlsm</pre>

<pre class="amctext">Hi Roy,
                                    
                                    Thanks very much for improving the process as outlined. I ran the macro, and it transferred all the records from Column A to E (WO task 1), which was good, but it did not appear to transfer the remaining records for WO task 2 (Column F to J), etc. through to WO task 4. Sheet 1 should end up with 1816 rows of data, I believe. 
                                    
                                    Can the macro be revised to do this?
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">Hi Andrea,
                                    
                                    Try attached...
                                    AndreaMary_RestructureData.xlsm</pre>

<pre class="amctext">Hi Andrea
                                    
                                    Sorry
                                    
                                    I've adjusted the code. Try this
                                    
                                    
                                    Option Explicit

Sub TransferData()
    Dim oTblSource As ListObject, oTblMain As ListObject
    Dim iX As Integer
    Dim lRw As Long
    Set oTblSource = Sheets("Sheet1").ListObjects(1)
    Set oTblMain = Sheets("Tasks").ListObjects(1)

    With oTblMain
        For iX = 1 To oTblSource.ListColumns.Count Step 5    '
            lRw = .ListRows.Count + 1
            oTblSource.ListColumns(iX).DataBodyRange.Resize(, 5).Copy
            oTblMain.ListRows(1).Range.Cells(lRw, 2).PasteSpecial xlValues
        Next iX
    End With
    Application.CutCopyMode = False
End Sub

                                    
                                      Select all
                                      Open in new window
                                    EE_RestructureData.xlsm</pre>

<pre class="amctext">Thanks to you both! 
                                    
                                    Roy, thanks for the revised macro, it worked well with a couple of minor issues - the first row was blank, for some reason, and the date field came in numerically as opposed to formatted as a date.
                                    
                                    Shums, your solution worked perfectly.
                                    
                                    I did my best to award the points fairly, balancing Roy's quick response time and willingness to revise the first iteration vs. Shum's solution working right out of the gate. :-)
                                    
                                    Best regards,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Sample of spreadsheet (136 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201930/EE_RestructureData.xlsm">EE_RestructureData.xlsm</a></p>
<p class="amcfile">EE_RestructureData.xlsm (129 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w44/1201955/EE_RestructureData.xlsm">EE_RestructureData.xlsm</a></p>
<p class="amcfile">Consolidate Columns (135 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w44/1202034/AndreaMary_RestructureData.xlsm">AndreaMary_RestructureData.xlsm</a></p>
<p class="amcfile">EE_RestructureData.xlsm (129 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w44/1202038/EE_RestructureData.xlsm">EE_RestructureData.xlsm</a></p>
</div>
<div class="amcdiv">
<h2 class="amctitle">Excel file links to two spreadsheets yet linking not behaving consistently (based on source spreadsheets being open vs closed)</h2>
<p class="amcdate">2017-10-25T16:01:06-0400</p>

<pre class="amctext">I have a Summary spreadsheet called "PA_Summary_KPI_07DEC2017.xlsm" that is linked to two other spreadsheets, but the linked files are behaving differently.
                          
                          Description of links in  "PA_Summary_KPI_07DEC2017.xlsm" spreadsheet: 
                          Column B, C, D and E:
                          
                          
                            linked to spreadsheet called "Metrics_UnitWOs_07DEC2017.xlsm"
                            links only work when linked spreadsheet is open; otherwise, no data visible in Columns B, C, D and E of Summary spreadsheet
                          
                          Column F, G and H
                          
                          
                            linked to spreadsheet called "Metrics_CAP_ADDWOs_07DEC2017.xlsm"
                            links always work and data always visible, whether linked spreadsheet is open or closed
                          
                          
                          I would like to understand what is causing the different linking behavior between the two spreadsheets, and how I can fix it so that no linked spreadsheets need to be open when I open the Summary spreadsheet.
                          
                          I have attached all 3 spreadsheets to illustrate the issue.
                          
                          Thanks,
                          Andrea
                          Metrics_CAP_ADDWOs_07DEC2017.xlsm
                          Metrics_UnitWOs_07DEC2017.xlsm
                          PA_Summary_KPI_07DEC2017_EE.xlsm</pre>

<pre class="amctext">F, G and H retrieve from ranges, and B, C, D and E retrieve from a table, and for some strange reason that is not possible.
                                    A workaround could be to import the entire table to a sheet, and then use that.
                                    See attached.
                                    It is set to update on open.
                                    Typically it will work when the workbooks are in the same folder, as when I made it, but perhaps you must change the connection link on the Data tab.
                                    PA_Summary_KPI_07DEC2017_EE.xlsm</pre>

<pre class="amctext">Thanks very much, Ejgil...
                                    
                                    Cheers,
                                    Andrea</pre>

<pre class="amctext">BoldItalicUnderlineOrdered List DefaultLower AlphaLower GreekLower RomanUpper AlphaUpper Roman  Unordered List DefaultCircleDiscSquare  Decrease IndentIncrease IndentInsert LinkQuoteIncreaseCtrl+'DecreaseCtrl+Shift+'Code SnippetInsert ImageInsert VideoUpload FileHelpCharacters : 0</pre>

<p class="amcfiles">FILES:</p>
<p class="amcfile">Example of file linking issue - 1 (392 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201383/Metrics_CAP_ADDWOs_07DEC2017.xlsm">Metrics_CAP_ADDWOs_07DEC2017.xlsm</a></p>
<p class="amcfile">Example of file linking issue - 2 (231 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201385/Metrics_UnitWOs_07DEC2017.xlsm">Metrics_UnitWOs_07DEC2017.xlsm</a></p>
<p class="amcfile">Example of file linking issue - 3 (134 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201386/PA_Summary_KPI_07DEC2017_EE.xlsm">PA_Summary_KPI_07DEC2017_EE.xlsm</a></p>
<p class="amcfile">With table import (227 KB) <a href="https://filedb.experts-exchange.com/incoming/2017/10_w43/1201401/PA_Summary_KPI_07DEC2017_EE.xlsm">PA_Summary_KPI_07DEC2017_EE.xlsm</a></p>
</div>
</body></html>
